/* Rabbit Ear 0.9.12 alpha 2021-01-xx (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";var e=Object.create(null);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var t=function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}},n=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},r=function resize_up(e,t){var r=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return n(r,e)}))},o=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},i=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return o(n)===Math.min(t,o(e))?e:n},c=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},a=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return c(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},u=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return c(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},s=Object.freeze({__proto__:null,resize:n,resize_up:r,resize_down:function resize_down(e,t){var r=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return n(r,e)}))},clean_number:i,semi_flatten_arrays:a,flatten_arrays:u}),l=1e-6,d=180/Math.PI,p=Math.PI/180,v=2*Math.PI,_=Object.freeze({__proto__:null,EPSILON:l,R2D:d,D2R:p,TWO_PI:v}),g=function fn_true(){return!0},m=function fn_square(e){return e*e},h=function fn_add(e,t){return e+(t||0)},b=function fn_not_undefined(e){return void 0!==e},k=function fn_and(e,t){return e&&t},w=function fn_vec2_angle(e){return Math.atan2(e[1],e[0])},E=function fn_to_vec2(e){return[Math.cos(e),Math.sin(e)]},O=function fn_equal(e,t){return e===t},C=function fn_epsilon_equal(e,t){return Math.abs(e-t)<l},M=function include(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>-t},j=function exclude(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>t},P=g,S=g,N=M,I=j,L=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>-t&&e<1+t},q=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>t&&e<1-t},T=function ray_limiter(e){return e<-l?0:e},F=function segment_limiter(e){return e<-l?0:e>1.000001?1:e},V=Object.freeze({__proto__:null,fn_true:g,fn_square:m,fn_add:h,fn_not_undefined:b,fn_and:k,fn_cat:function fn_cat(e,t){return e.concat(t)},fn_vec2_angle:w,fn_to_vec2:E,fn_equal:O,fn_epsilon_equal:C,include:M,exclude:j,include_l:P,exclude_l:S,include_r:N,exclude_r:I,include_s:L,exclude_s:q,line_limiter:function line_limiter(e){return e},ray_limiter:T,segment_limiter:F}),B=Object.create(null),G=[1,0,0,1],D=G.concat(0,0),R=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},U=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},Z=Object.freeze({__proto__:null,identity2x2:G,identity2x3:D,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:R,invert_matrix2:function invert_matrix2(e){var t=R(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return G.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:U,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,d=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,d,p]}}),H=function magnitude(e){return Math.sqrt(e.map(m).reduce(h,0))},$=function magnitude2(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},W=function mag_squared(e){return e.map(m).reduce(h,0)},X=function normalize(e){var t=H(e);return 0===t?e:e.map((function(e){return e/t}))},Y=function scale(e,t){return e.map((function(e){return e*t}))},J=function scale2(e,t){return[e[0]*t,e[1]*t]},K=function add(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},Q=function add2(e,t){return[e[0]+t[0],e[1]+t[1]]},ee=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},te=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(h,0)},ne=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},re=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},oe=function lerp(e,t,n){var r=1-n;return e.map((function(e,o){return e*r+(t[o]||0)*n}))},ie=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},ce=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},ae=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce(h,0))},ue=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},se=function flip(e){return e.map((function(e){return-e}))},fe=function rotate90(e){return[-e[1],e[0]]},le=function rotate270(e){return[e[1],-e[0]]},de=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e.map((function(e){return Math.abs(e)})).reduce(h,0)<t},pe=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return 1-Math.abs(te(X(e),X(t)))<n},ve=Object.freeze({__proto__:null,magnitude:H,magnitude2:$,mag_squared:W,normalize:X,normalize2:function normalize2(e){var t=$(e);return 0===t?e:[e[0]/t,e[1]/t]},scale:Y,scale2:J,add:K,add2:Q,subtract:ee,subtract2:function subtract2(e,t){return[e[0]-t[0],e[1]-t[1]]},dot:te,dot2:function dot2(e,t){return e[0]*t[0]+e[1]*t[1]},midpoint:ne,midpoint2:function midpoint2(e,t){return J(Q(e,t),.5)},average:re,lerp:oe,cross2:ie,cross3:ce,distance:ae,distance2:ue,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},flip:se,rotate90:fe,rotate270:le,degenerate:de,parallel:pe,parallel2:function parallel2(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return Math.abs(ie(e,t))<n}}),_e=Object.freeze([1,0,0,0,1,0,0,0,1]),ge=Object.freeze(_e.concat(0,0,0)),me=function is_identity3x4(e){return ge.map((function(t,n){return Math.abs(t-e[n])<l})).reduce((function(e,t){return e&&t}),!0)},he=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},ye=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},be=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},Ae=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},xe=function invert_matrix3(e){var t=Ae(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ke=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _e.concat(e,t,n)},we=function single_axis_rotate(e,t,n,r,o){var i=_e.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return i[3*n+n]=c,i[3*n+r]=(o?1:-1)*a,i[3*r+n]=(o?-1:1)*a,i[3*r+r]=c,i},Ee=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,1,2,!0)},Oe=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,0,2,!1)},Ce=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,0,1,!0)},Me=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],o=[0,1,2].map((function(e){return r[e]||0})),i=n(3,X(t)),c=_slicedToArray(i,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),d=Math.sin(e),p=1-l,v=_e.concat(-o[0],-o[1],-o[2]),_=_e.concat(o[0],o[1],o[2]);return be(_,be([p*a*a+l,p*u*a+s*d,p*s*a-u*d,p*a*u-s*d,p*u*u+l,p*s*u+a*d,p*a*s+u*d,p*u*s-a*d,p*s*s+l,0,0,0],v))},je=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},Pe=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,d=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,d,p,0]},Se=Object.freeze({__proto__:null,identity3x3:_e,identity3x4:ge,is_identity3x4:me,multiply_matrix3_vector3:he,multiply_matrix3_line3:ye,multiply_matrices3:be,determinant3:Ae,invert_matrix3:xe,make_matrix3_translate:ke,make_matrix3_rotateX:Ee,make_matrix3_rotateY:Oe,make_matrix3_rotateZ:Ce,make_matrix3_rotate:Me,make_matrix3_scale:je,make_matrix3_reflectZ:Pe}),ze=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},Ne=function get_vector(){if(arguments[0]instanceof B.vector)return arguments[0];var e=u(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(b)),e.filter((function(e){return"number"==typeof e}))},Ie=function get_vector_of_vectors(){return a(arguments).map((function(e){return Ne(e)}))},Le=function get_segment(){if(arguments[0]instanceof B.segment)return arguments[0];var e=a(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:e.map((function(e){return Ne(e)}))},qe=function get_line(){var e=a(arguments);return 0===e.length?ze([],[]):e[0]instanceof B.line||e[0]instanceof B.ray||e[0]instanceof B.segment?e[0]:e[0].constructor===Object&&void 0!==e[0].vector?ze(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?ze(Ne(e)):ze.apply(void 0,_toConsumableArray(e.map((function(e){return Ne(e)}))))},Te=qe,Fe=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},Ve=function get_rect(){if(arguments[0]instanceof B.rect)return arguments[0];var e=u(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return Fe.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(b)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return Fe.apply(void 0,_toConsumableArray(n))},Be=function get_circle_params(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{radius:e,origin:[].concat(n)}},Ge=function get_circle(){if(arguments[0]instanceof B.circle)return arguments[0];var e=Ie(arguments),t=u(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length){if(1===e[1].length)return Be.apply(void 0,[e[1][0]].concat(_toConsumableArray(e[0])));if(1===e[0].length)return Be.apply(void 0,[e[0][0]].concat(_toConsumableArray(e[1])));if(e[0].length>1&&e[1].length>1)return Be.apply(void 0,[ue.apply(void 0,_toConsumableArray(e))].concat(_toConsumableArray(e[0])))}else switch(t.length){case 0:return Be(1,0,0,0);case 1:return Be(t[0],0,0,0);default:return Be.apply(void 0,[t.pop()].concat(_toConsumableArray(t)))}return Be(1,0,0,0)},De=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete De[2][e]}));var Re=function matrix_map_3x4(e){return De[e<8?0:e<13?1:2]},Ue=function get_matrix_3x4(){var e=u(arguments),t=_toConsumableArray(ge);return Re(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Ze=Object.freeze({__proto__:null,get_vector:Ne,get_vector_of_vectors:Ie,get_segment:Le,get_line:qe,get_ray:Te,get_rect_params:Fe,get_rect:Ve,get_circle:Ge,get_matrix_3x4:Ue}),He=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce(k,!0)},$e=function equivalent_vector2(e,t){return[0,1].map((function(n){return C(e[n],t[n])})).reduce(k,!0)},We=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),r=e.map((function(e){return n(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return r[0].map((function(e,n){return Math.abs(r[0][n]-r[t+1][n])<l})).reduce(k,!0)})).reduce(k,!0)},Xe=Object.freeze({__proto__:null,equivalent_vector2:$e,equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):He(arguments,C))},equivalent_vectors:We,equivalent:function equivalent(){var e=a.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return He(e,C);case"boolean":case"string":return He(e,O);case"object":return e[0].constructor===Array?We.apply(void 0,_toConsumableArray(e)):He(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),Ye=Object.freeze({__proto__:null,sort_points_along_vector2:function sort_points_along_vector2(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))}}),Je=function smallest_comparison_search(e,t,n){for(var r,o=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),i=1/0,c=0;c<o.length;c+=1)o[c].d<i&&(r=c,i=o[c].d);return r},Ke=function nearest_point_on_line(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;t=n(e.length,t),r=n(e.length,r);var c=W(e),a=ee(r,t),u=te(e,a),s=u/c,d=o(s,i);return K(t,Y(e,d))},Qe=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return ee(n[(t+1)%n.length],e)}));return e.map((function(e,r){return Ke(n[r],e,t,F)})).map((function(e,n){return{point:e,i:n,distance:ae(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},et=function nearest_point_on_circle(e,t,n){return K(t,Y(X(ee(n,t)),e))},tt=Object.freeze({__proto__:null,smallest_comparison_search:Je,nearest_point2:function nearest_point2(e,t){var n=Je(e,t,ue);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Je(e,t,ae);return void 0===n?void 0:t[n]},nearest_point_on_line:Ke,nearest_point_on_polygon:Qe,nearest_point_on_circle:et,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),nt=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=v;for(;t<0;)t+=v;for(;e>v;)e-=v;for(;t>v;)t-=v;var n=t-e;return n>=0?n:v-(e-t)},rt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],o=Math.atan2(r,n);return o<0&&(o+=v),o},ot=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],o=Math.atan2(r,n);return o<0&&(o+=v),o},it=function clockwise_bisect2(e,t){return E(w(e)-rt(e,t)/2)},ct=function counter_clockwise_bisect2(e,t){return E(w(e)+ot(e,t)/2)},at=function bisect_lines2(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=ie(e,n),c=te(e,n),a=i>-o?[ct(e,n)]:[it(e,n)];a[1]=i>-o?fe(a[0]):le(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/i,d=[e,n].map((function(e){return X(e)})),p=Math.abs(ie.apply(void 0,_toConsumableArray(d)))<o,v=p?ne(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],_=a.map((function(e){return{vector:e,origin:v}}));return p&&delete _[c>-o?1:0],_},ut=function counter_clockwise_order_radians(){var e=u(arguments),t=e.map((function(e,t){return t})).sort((function(t,n){return e[t]-e[n]}));return t.slice(t.indexOf(0),t.length).concat(t.slice(0,t.indexOf(0)))},st=function counter_clockwise_sectors_radians(){var e=u(arguments),t=ut(e).map((function(t){return e[t]}));return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return nt(e[0],e[1])}))},ft=function counter_clockwise_subsect_radians(e,t,n){var r=nt(t,n)/e;return Array.from(Array(e-1)).map((function(e,n){return t+r*(n+1)}))},lt=Object.freeze({__proto__:null,is_counter_clockwise_between:function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=v;for(;e>t;)e-=v;for(;e<t;)e+=v;return e<n},clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=v;for(;t<0;)t+=v;for(;e>v;)e-=v;for(;t>v;)t-=v;var n=e-t;return n>=0?n:v-(t-e)},counter_clockwise_angle_radians:nt,clockwise_angle2:rt,counter_clockwise_angle2:ot,clockwise_bisect2:it,counter_clockwise_bisect2:ct,bisect_lines2:at,counter_clockwise_order_radians:ut,counter_clockwise_order2:function counter_clockwise_order2(){return ut(Ie(arguments).map(w))},counter_clockwise_sectors_radians:st,counter_clockwise_sectors2:function counter_clockwise_sectors2(){return st(Ie(arguments).map(w))},counter_clockwise_subsect_radians:ft,counter_clockwise_subsect2:function counter_clockwise_subsect2(e,t,n){var r=Math.atan2(t[1],t[0]),o=Math.atan2(n[1],n[0]);return ft(e,r,o).map(E)}}),dt=function overlap_line_point(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=ee(n,t),c=W(e),a=Math.sqrt(c);if(a<o)return!1;var u=ie(i,e.map((function(e){return e/a}))),s=te(i,e)/c;return Math.abs(u)<o&&r(s,o/a)},pt=function intersect_line_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:P,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:l,a=ie(X(e),X(n));if(!(Math.abs(a)<c)){var u=ie(e,n),s=-u,d=[r[0]-t[0],r[1]-t[1]],p=[-d[0],-d[1]],v=ie(d,n)/u,_=ie(p,e)/s;return o(v,c/H(e))&&i(_,c/H(n))?K(t,Y(e,v)):void 0}},vt=function circumcircle(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+o*(e[1]+t[1]),u=i*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-o*(n[0]-t[0]));if(Math.abs(s)<l){var d=Math.min(e[0],t[0],n[0]),p=Math.min(e[1],t[1],n[1]),v=.5*(Math.max(e[0],t[0],n[0])-d),_=.5*(Math.max(e[1],t[1],n[1])-p);return{origin:[d+v,p+_],radius:Math.sqrt(v*v+_*_)}}var g=[(c*a-o*u)/s,(r*u-i*a)/s],m=g[0]-e[0],h=g[1]-e[1];return{origin:g,radius:Math.sqrt(m*m+h*h)}},_t=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(h,0)},gt=function centroid(e){var t=1/(6*_t(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],o=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*o,(e[1]+r[1])*o]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},mt=function enclosing_rectangle(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return Fe(t[0],t[1],r[0],r[1])},ht=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return v*(n/e)}))},yt=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return i(e,14)}))}))},bt=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return yt(ht(e),t)},At=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=ht(e).map((function(e){return e+n}));return yt(r,t)},xt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:dt(t,n,e,P)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),o=e.map((function(e,r,o){return{point:pt(t,n,ee(e,o[(r+1)%o.length]),o[(r+1)%o.length],S,q),at_index:r}})).filter((function(e){return null!=e.point}));if(2==o.length){var i=o.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(i[1].at_index+1).concat(e.slice(0,i[0].at_index+1));c.push(i[0].point),c.push(i[1].point);var a=e.slice(i[0].at_index+1,i[1].at_index+1);return a.push(i[1].point),a.push(i[0].point),[c,a]}if(1==o.length&&1==r.length){r[0].type="v",o[0].type="e";var u=r.concat(o).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var d=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(d[1].at_index).concat(e.slice(0,d[0].at_index+1)),e.slice(d[0].at_index,d[1].at_index+1)]}return[e.slice()]},kt=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),o=[];o.push(r[0]);var i=0,c=0,a=function _loop(){c+=1;var e=o.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-o[e][0])<t&&Math.abs(n[1]-o[e][1])<t)})).map((function(t){for(var n=Math.atan2(o[e][1]-t[1],o[e][0]-t[0]);n<i;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(o[e][0]-t.node[0],2)+Math.pow(o[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),o.filter((function(e){return e===n[0].node})).length>0)return{v:o};o.push(n[0].node),i=Math.atan2(o[e][1]-n[0].node[1],o[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},wt=function recurse_skeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return pt(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,I,I)})),o=t.map((function(e,t){return Ke(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[o[0],r[0]]}]);var i=r.map((function(e,t){return ae(e,o[t])})),c=0;i.forEach((function(e,t){e<i[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[o[c],r[c]]}],u=it(se(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurse_skeleton(e,t,n))},Et=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:ee(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[ee(e[0],e[1]),ee(e[2],e[1])]})).map((function(e){return it.apply(void 0,_toConsumableArray(e))}));return wt(_toConsumableArray(e),t,n)},Ot=Object.freeze({__proto__:null,circumcircle:vt,signed_area:_t,centroid:gt,enclosing_rectangle:mt,make_regular_polygon:bt,make_regular_polygon_side_aligned:At,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return bt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return At(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return bt(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return At(e,t/2/Math.sin(Math.PI/e))},split_convex_polygon:xt,convex_hull:kt,straight_skeleton:Et}),Ct=function vector_origin_to_ud(e){var t=e.vector,n=e.origin,r=H(t),o=fe(t),i=te(n,o)/r;return i<0?{u:Y(o,-1/r),d:-i}:{u:Y(o,1/r),d:i}},Mt=function ud_to_vector_origin(e){var t=e.u,n=e.d;return{vector:le(t),origin:Y(t,n)}},jt=Object.freeze({__proto__:null,vector_origin_to_ud:Ct,ud_to_vector_origin:Mt}),Pt=function acos_safe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},St=function rotate_vector2(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=r*Math.cos(n)+o*Math.sin(n),c=o*Math.cos(n)-r*Math.sin(n);return[e[0]+i,e[1]+c]},zt=function intersect_circle_circle(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=e<n?e:n,c=e<n?n:e,a=e<n?t:r,u=e<n?r:t,s=[a[0]-u[0],a[1]-u[1]],d=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2));if(!(d<o)){var p=s.map((function(e,t){return e/d*c+u[t]}));if(Math.abs(c+i-d)<o||Math.abs(c-(i+d))<o)return[p];if(!(d+i<c||c+i<d)){var v=Pt((i*i-d*d-c*c)/(-2*d*c)),_=St(u,p,+v),g=St(u,p,-v);return[_,g]}}},Nt=function intersect_circle_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=fe(u),d=ee(r,t),p=ie(d,u);if(!(Math.abs(p)>e+i)){var v=Math.sqrt(Math.pow(e,2)-Math.pow(p,2)),_=function f(e,n){return t[n]-s[n]*p+u[n]*e},g=Math.abs(e-Math.abs(p))<i?[v].map((function(e){return[e,e].map(_)})):[-v,v].map((function(e){return[e,e].map(_)})),m=g.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return g.filter((function(e,t){return o(m[t],i)}))}},It=function overlap_convex_polygon_point(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l;return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ie(X(ee(e[1],e[0])),ee(t,e[0]))})).map((function(e){return n(e,r)})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},Lt=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!$e(e[0],e[t]))return[e[0],e[t]]},qt=function intersect_convex_polygon_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return pt(ee(e[1],e[0]),e[0],t,n,r,o,i)})).filter((function(e){return void 0!==e}));switch(c.length){case 0:return;case 1:return[c];default:return Lt(c)||[c[0]]}},Tt=function intersect_convex_polygon_line(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,a=qt(e,t,n,o,i,c);switch(i){case I:r=N;break;case q:r=L;break;default:return a}var u=qt(e,t,n,L,r,c);if(void 0!==u){var s=Lt(u);if(void 0===s)switch(i){case S:return;case I:return It(e,n,j,c)?u:void 0;case q:return It(e,K(n,t),j,c)||It(e,n,j,c)?u:void 0}return It(e,ne.apply(void 0,_toConsumableArray(s)),j,c)?s:a}},Ft={polygon:function polygon(e){return[e]},rect:function rect(e){return[e]},circle:function circle(e){return[e.radius,e.origin]},line:function line(e){return[e.vector,e.origin]},ray:function ray(e){return[e.vector,e.origin]},segment:function segment(e){return[e.vector,e.origin]}},Vt={polygon:{line:function line(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))},ray:function ray(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))},segment:function segment(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))}},circle:{circle:function circle(e,t,n,r,o){return zt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[o]))},line:function line(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))},ray:function ray(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))},segment:function segment(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))}},line:{polygon:function polygon(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},ray:function ray(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}},ray:{polygon:function polygon(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}},segment:{polygon:function polygon(e,t,n,r,o){return Tt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},segment:function segment(e,t,n,r,o){return pt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}}},Bt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},Gt={polygon:j,rect:j,circle:j,line:S,ray:I,segment:q},Dt=function intersect(e,n,r){var o=t(e),i=t(n),c=Bt[o],a=Bt[i],u=Ft[o](e),s=Ft[i](n),l=e.domain_function||Gt[o],d=n.domain_function||Gt[i];return Vt[c][a](u,s,l,d,r)},Rt=function overlap_line_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:S,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:l,a=ie(e,n),u=-a;if(Math.abs(a)<c)return dt(e,t,r,o,c)||dt(se(e),K(t,e),r,o,c)||dt(n,r,t,i,c)||dt(se(n),K(r,n),t,i,c);var s=[r[0]-t[0],r[1]-t[1]],d=[-s[0],-s[1]],p=ie(s,n)/a,v=ie(d,e)/u;return o(p,c/H(e))&&i(v,c/H(n))},Ut=function overlap_convex_polygons(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:q,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;if(It(e,t[0],r,o))return!0;if(It(t,e[0],r,o))return!0;for(var i=e.map((function(e,t,n){return[ee(n[(t+1)%n.length],e),e]})),c=t.map((function(e,t,n){return[ee(n[(t+1)%n.length],e),e]})),a=0;a<i.length;a+=1)for(var u=0;u<c.length;u+=1)if(Rt(i[a][0],i[a][1],c[u][0],c[u][1],n,n,o))return!0;return!1},Zt=function overlap_circle_point(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;return r(e-ue(t,n),o)},Ht={polygon:function polygon(e){return[e]},rect:function rect(e){return[e]},circle:function circle(e){return[e.radius,e.origin]},line:function line(e){return[e.vector,e.origin]},ray:function ray(e){return[e.vector,e.origin]},segment:function segment(e){return[e.vector,e.origin]},vector:function vector(e){return[e]}},$t={polygon:{polygon:function polygon(e,t,n,r,o){return Ut.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[q,j,o]))},vector:function vector(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},circle:{vector:function vector(e,t,n,r,o){return Zt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[j,o]))}},line:{line:function line(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},ray:function ray(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},ray:{line:function line(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},segment:{line:function line(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},segment:function segment(e,t,n,r,o){return Rt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},vector:{polygon:function polygon(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},circle:function circle(e,t,n,r,o){return Zt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[j,o]))},line:function line(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},ray:function ray(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},segment:function segment(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},vector:function vector(e,t,n,r,o){return $e.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[o]))}}},Wt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment",vector:"vector"},Xt={polygon:j,rect:j,circle:j,line:S,ray:I,segment:q,vector:S},Yt=function overlap(e,n,r){var o=t(e),i=t(n),c=Wt[o],a=Wt[i],u=Ht[o](e),s=Ht[i](n),l=e.domain_function||Xt[o],d=n.domain_function||Xt[i];return $t[c][a](u,s,l,d,r)},Jt=function line_point_from_parameter(e,t,n){return K(t,Y(e,n))},Kt=function get_intersect_parameters(e,t,n,r,o){return e.map((function(e,t,n){return[ee(n[(t+1)%n.length],e),e]})).map((function(e){return function line_line_parameter(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:L,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=ie(X(e),X(n));if(!(Math.abs(c)<i)){var a=ie(e,n),u=-a,s=ee(r,t),d=se(s),p=ie(s,n)/a;return o(ie(d,e)/u,i/H(n))?p:void 0}}(t,n,e[0],e[1],r,o)})).filter(b).sort((function(e,t){return e-t}))},Qt=function get_min_max(e,t,n){for(var r=0,o=e.length-1;r<o&&!t(e[r+1]-e[r],n);)r++;for(;o>r&&!t(e[o]-e[o-1],n);)o--;if(!(r>=o))return[e[r],e[o]]},en=function clip_line_in_convex_polygon(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=Kt(e,t,n,L,i);if(!(c.length<2)){var a=2*i/H(t),u=Qt(c,r,a);if(void 0!==u){var s=u.map((function(e,t){return o(e)?e:e<.5?0:1}));if(!(Math.abs(s[0]-s[1])<2*i/H(t))){var d=Jt(t,n,(s[0]+s[1])/2);return It(e,d,r,i)?s.map((function(e){return Jt(t,n,e)})):void 0}}}},tn={preserve:{magnitude:function magnitude(){return H(this)},isEquivalent:function isEquivalent(){return We(this,Ne(arguments))},isParallel:function isParallel(){return pe.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},isCollinear:function isCollinear(e){return Yt(this,e)},dot:function dot(){return te.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},distanceTo:function distanceTo(){return ae.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},overlap:function overlap(e){return Yt(this,e)}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return X(this)},scale:function scale(){return Y(this,arguments[0])},flip:function flip(){return se(this)},rotate90:function rotate90(){return fe(this)},rotate270:function rotate270(){return le(this)},cross:function cross(){return ce(n(3,this),n(3,Ne(arguments)))},transform:function transform(){return he(Ue(arguments),n(3,this))},add:function add(){return K(this,n(this.length,Ne(arguments)))},subtract:function subtract(){return ee(this,n(this.length,Ne(arguments)))},rotateZ:function rotateZ(e,t){return he(Ue(U(e,t)),n(3,this))},lerp:function lerp(e,t){return oe(this,n(this.length,Ne(e)),t)},midpoint:function midpoint(){return ne.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},bisect:function bisect(){return ct(this,Ne(arguments))}}},nn={};Object.keys(tn.preserve).forEach((function(e){nn[e]=tn.preserve[e]})),Object.keys(tn.vector).forEach((function(e){nn[e]=function(){return B.vector.apply(B,_toConsumableArray(tn.vector[e].apply(this,arguments)))}}));var rn={fromAngle:function fromAngle(e){return B.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return B.vector.fromAngle(e*p)}},on={vector:{P:Array.prototype,A:function VectorArgs(){this.push.apply(this,_toConsumableArray(Ne(arguments)))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:nn,S:rn}},cn={fromPoints:function fromPoints(){var e=Ie(arguments);return this.constructor({vector:ee(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=Ie(arguments);return this.constructor({vector:fe(ee(e[1],e[0])),origin:re(e[0],e[1])})}},an={isParallel:function isParallel(){var e=r(this.vector,qe(arguments).vector);return pe.apply(void 0,_toConsumableArray(e))},isCollinear:function isCollinear(){var e=qe(arguments);return dt(this.vector,this.origin,e.origin)&&pe.apply(void 0,_toConsumableArray(r(this.vector,e.vector)))},isDegenerate:function isDegenerate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;return de(this.vector,e)},reflectionMatrix:function reflectionMatrix(){return B.matrix(Pe(this.vector,this.origin))},nearestPoint:function nearestPoint(){var e=Ne(arguments);return B.vector(Ke(this.vector,this.origin,e,this.clip_function))},transform:function transform(){var e=this.dimension,t=ye(Ue(arguments),n(3,this.vector),n(3,this.origin));return this.constructor(n(e,t.vector),n(e,t.origin))},translate:function translate(){var e=K.apply(void 0,_toConsumableArray(r(this.origin,Ne(arguments))));return this.constructor(this.vector,e)},intersect:function intersect(){return Dt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},overlap:function overlap(){return Yt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},bisect:function bisect(e,t){var n=this,r=qe(e);return at(this.vector,this.origin,r.vector,r.origin,t).map((function(e){return n.constructor(e)}))}},un={line:{P:Object.prototype,A:function A(){var e=qe.apply(void 0,arguments);this.vector=B.vector(e.vector),this.origin=B.vector(n(this.vector.length,e.origin));var t=Ct({vector:this.vector,origin:this.origin});this.u=t.u,this.d=t.d,Object.defineProperty(this,"domain_function",{writable:!0,value:P})},G:{dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},an,{inclusive:function inclusive(){return this.domain_function=P,this},exclusive:function exclusive(){return this.domain_function=S,this},clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=K(this.origin,Y(this.vector,-e/2)),n=Y(this.vector,e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}}),S:Object.assign({ud:function ud(){return this.constructor(Mt(arguments[0]))}},cn)}},sn={ray:{P:Object.prototype,A:function A(){var e=qe.apply(void 0,arguments);this.vector=B.vector(e.vector),this.origin=B.vector(n(this.vector.length,e.origin)),Object.defineProperty(this,"domain_function",{writable:!0,value:N})},G:{dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},an,{inclusive:function inclusive(){return this.domain_function=N,this},exclusive:function exclusive(){return this.domain_function=I,this},flip:function flip(){return B.ray(se(this.vector),this.origin)},scale:function scale(e){return B.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return B.ray(this.vector.normalize(),this.origin)},clip_function:T,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}}),S:cn}},fn={segment:{P:Array.prototype,A:function A(){var e=Le.apply(void 0,arguments);this.push.apply(this,_toConsumableArray([e[0],e[1]].map((function(e){return B.vector(e)})))),this.vector=B.vector(ee(this[1],this[0])),this.origin=this[0],Object.defineProperty(this,"domain_function",{writable:!0,value:L})},G:{points:function points(){return this},magnitude:function magnitude(){return H(this.vector)},dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},an,{inclusive:function inclusive(){return this.domain_function=L,this},exclusive:function exclusive(){return this.domain_function=q,this},clip_function:F,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=Ue(r),c=this.points.map((function(e){return n(3,e)})).map((function(e){return he(i,e)})).map((function(t){return n(e,t)}));return B.segment(c)},translate:function translate(){var translate=Ne(arguments),e=this.points.map((function(e){return K.apply(void 0,_toConsumableArray(r(e,translate)))}));return B.segment(e)},midpoint:function midpoint(){return B.vector(re(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}}),S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},ln=function pointOnEllipse(e,t,n,r,o,i){var c=Math.cos(o),a=Math.sin(o),u=Math.cos(i),s=Math.sin(i);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},dn=function pathInfo(e,t,n,r,o,i,c){var a=i;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=ln(e,t,n,r,o,a),l=ln(e,t,n,r,o,a+u/2),d=ln(e,t,n,r,o,a+u),p=u/2>Math.PI?1:0,v=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:d[0],y3:d[1],fa:p,fs:v}},pn=function cln(e){return i(e,4)},vn=function ellipticalArcTo(e,t,n,r,o,i,c){return"A".concat(pn(e)," ").concat(pn(t)," ").concat(pn(n)," ").concat(pn(r)," ").concat(pn(o)," ").concat(pn(i)," ").concat(pn(c))},_n={circle:{A:function CircleArgs(){var e=Ge.apply(void 0,arguments);this.radius=e.radius,this.origin=B.vector.apply(B,_toConsumableArray(e.origin))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return B.vector(et(this.radius,this.origin,Ne(arguments)))},intersect:function intersect(e){return Dt(this,e)},overlap:function overlap(e){return Yt(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=dn(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=vn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),o=vn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return B.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=vt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=vt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},gn=function getFoci(e,t,n,r){var o=t>n,i=o?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(i),a=o?Math.cos(r):Math.sin(r),u=o?Math.sin(r):Math.cos(r);return[B.vector(e[0]+c*a,e[1]+c*u),B.vector(e[0]-c*a,e[1]-c*u)]},mn={ellipse:{A:function A(){var e=u(arguments).filter((function(e){return!isNaN(e)})),t=n(5,e);this.rx=t[0],this.ry=t[1],this.origin=B.vector(t[2],t[3]),this.spin=t[4],this.foci=gn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=dn(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=vn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),o=vn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return ln(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return B.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},hn={area:function area(){return _t(this)},centroid:function centroid(){return B.vector(gt(this))},enclosingRectangle:function enclosingRectangle(){return B.rect(mt(this))},straightSkeleton:function straightSkeleton(){return Et(this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,o){return t[o]+n[o]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],o=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),i=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(i+e)*o,t[1]+Math.sin(i+e)*o]}));return B.polygon(n)},translate:function translate(){var e=Ne.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=Ue.apply(void 0,arguments),t=this.map((function(t){return he(e,n(3,t))}));return B.polygon(t)},nearest:function nearest(){var e=Ne.apply(void 0,arguments),t=Qe(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},split:function split(){var e=qe.apply(void 0,arguments),t=xt;return t(this,e.vector,e.origin).map((function(e){return B.polygon(e)}))},overlap:function overlap(){return Yt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},intersect:function intersect(){return Dt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},clip:function clip(e,t){var n=e.domain_function?e.domain_function:P,r=en(this,e.vector,e.origin,this.domain_function,n,t);return r?B.segment(r):void 0},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")}},yn=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},bn={rect:{P:Array.prototype,A:function A(){var e=Ve.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=B.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(yn(this))),Object.defineProperty(this,"domain_function",{writable:!0,value:M})},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return B.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:Object.assign({},hn,{inclusive:function inclusive(){return this.domain_function=M,this},exclusive:function exclusive(){return this.domain_function=j,this},area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}}),S:{fromPoints:function fromPoints(){return B.rect(mt(Ie(arguments)))}}}},An={polygon:{P:Array.prototype,A:function A(){this.push.apply(this,_toConsumableArray(a(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return ee(e[1],e[0])})),Object.defineProperty(this,"domain_function",{writable:!0,value:M})},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:Object.assign({},hn,{inclusive:function inclusive(){return this.domain_function=M,this},exclusive:function exclusive(){return this.domain_function=j,this},segments:function segments(){return this.sides}}),S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(bt.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(kt.apply(void 0,arguments))}}}},xn=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},kn={matrix:{P:Array.prototype,A:function A(){var e=this;Ue(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return B.matrix.apply(B,_toConsumableArray(Array.from(this)))},set:function set(){return xn(this,Ue(arguments))},isIdentity:function isIdentity(){return me(this)},multiply:function multiply(e){return xn(this,be(this,e))},determinant:function determinant(){return Ae(this)},inverse:function inverse(){return xn(this,xe(this))},translate:function translate(e,t,n){return xn(this,be(this,ke(e,t,n)))},rotateX:function rotateX(e){return xn(this,be(this,Ee(e)))},rotateY:function rotateY(e){return xn(this,be(this,Oe(e)))},rotateZ:function rotateZ(e){return xn(this,be(this,Ce(e)))},rotate:function rotate(e,t,n){var r=Me(e,t,n);return xn(this,be(this,r))},scale:function scale(e){return xn(this,be(this,je(e)))},reflectZ:function reflectZ(e,t){var n=Pe(e,t);return xn(this,be(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return B.vector(he(this,n(3,Ne(t))))},transformVector:function transformVector(e){return B.vector(he(this,n(3,Ne(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=qe(t);return B.line(ye(this,r.vector,r.origin))}},S:{}}},wn=Object.assign({},on,un,sn,fn,_n,mn,bn,An,kn),En=function create(e,t){var n=Object.create(wn[e].proto);return wn[e].A.apply(n,t),n};Object.assign(B,{vector:function vector(){return En("vector",arguments)},circle:function circle(){return En("circle",arguments)},ellipse:function ellipse(){return En("ellipse",arguments)},rect:function rect(){return En("rect",arguments)},polygon:function polygon(){return En("polygon",arguments)},line:function line(){return En("line",arguments)},ray:function ray(){return En("ray",arguments)},segment:function segment(){return En("segment",arguments)},matrix:function matrix(){return En("matrix",arguments)}}),Object.keys(wn).forEach((function(e){var t={};t.prototype=null!=wn[e].P?Object.create(wn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,B[e].prototype=t.prototype,B[e].prototype.constructor=B[e],Object.keys(wn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:wn[e].G[n]})})),Object.keys(wn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:wn[e].M[n]})})),Object.keys(wn[e].S).forEach((function(t){return Object.defineProperty(B[e],t,{value:wn[e].S[t].bind(B[e].prototype)})})),wn[e].proto=t.prototype}));var On=B;On.core=Object.assign(Object.create(null),_,s,Ze,V,ve,Xe,Ye,Ot,lt,Z,Se,tt,jt,{enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return It(t,e,M)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return It(t,e,M)})).reduce((function(e,t){return e&&t}),!0);return!n&&r},intersect_convex_polygon_line:Tt,intersect_circle_circle:zt,intersect_circle_line:Nt,intersect_line_line:pt,overlap_convex_polygons:Ut,overlap_convex_polygon_point:It,overlap_line_line:Rt,overlap_line_point:dt,clip_line_in_convex_polygon:en}),On.typeof=t,On.intersect=Dt,On.overlap=Yt;var Cn=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},Mn=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},jn=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var o=r+1;o<e.length;o+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][o])return!1;return!0}})},Pn=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Sn={vertices:function setup_vertex(e,t){return Cn.call(this,e,t),e},edges:function setup_edge(e,t){return Mn.call(this,e,t),e},faces:function setup_face(e,t){return jn.call(this,e,t),Pn.call(this,e,t),e}},zn=1.1,Nn="Rabbit Ear",In={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},Ln=Object.freeze([].concat(In.file).concat(In.frame).concat(In.graph).concat(In.orders)),qn=Object.freeze(["edges_vector","vertices_sectors","faces_angles","faces_matrix"]),Tn=Array.from("MmVvBbFfUu"),Fn={vertices:"vertex",edges:"edge",faces:"face"},Vn={b:"boundary",m:"mountain",v:"valley",f:"mark",u:"unassigned"};Tn.forEach((function(e){Vn[e.toUpperCase()]=Vn[e]}));var Bn={};Tn.forEach((function(e){Bn[e]=e.toLowerCase()}));var Gn={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},Dn=function edge_assignment_to_foldAngle(e){return Gn[e]||0},Rn=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},Un=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},Zn=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},Hn=function get_graph_keys_with_prefix(e,t){return Zn(e,"".concat(t,"_"))},$n=function get_graph_keys_with_suffix(e,t){return Un(e,"_".concat(t))},Wn=function transpose_graph_arrays(e,t){var n=Hn(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),o=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return o.forEach((function(n,r){o[r][t]=e[t][r]}))})),o},Xn=function fold_object_certainty(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length?0:[].concat(Ln,qn).filter((function(t){return e[t]})).length/Object.keys(e).length},Yn=Object.freeze({__proto__:null,singularize:Fn,edges_assignment_names:Vn,edges_assignment_to_lowercase:Bn,edges_assignment_degrees:Gn,edge_assignment_to_foldAngle:Dn,edge_foldAngle_to_assignment:Rn,filter_keys_with_suffix:Un,filter_keys_with_prefix:Zn,get_graph_keys_with_prefix:Hn,get_graph_keys_with_suffix:$n,transpose_graph_arrays:Wn,transpose_graph_array_at_index:function transpose_graph_array_at_index(e,t,n){var r=Hn(e,t);if(0!==r.length){var o={};return r.forEach((function(t){o[t]=e[t][n]})),o}},fold_object_certainty:Xn}),Jn="class",Kn="index",Qn="vertices",er="edges",tr="faces",nr="boundaries",rr="vertices_coords",or="edges_vertices",ir="faces_edges",cr="edges_assignment",ar="edges_foldAngle",ur="faces_re:layer",sr="boundary",fr="stroke-width",lr=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},dr=function count(e,t){return lr.apply(void 0,_toConsumableArray(Hn(e,t).map((function(t){return e[t]}))))};dr.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return lr(t,n,r)},dr.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return lr(t,n,r)},dr.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return lr(t,n,r)};var pr=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},vr=function remove_geometry_indices(e,t,n){var r,o,i,c=dr(e,t),a=pr(n),u=[];for(r=0,o=0,i=0;r<c;r+=1,o+=1){for(;r===a[i];)u[r]=void 0,r+=1,i+=1;r<c&&(u[r]=o)}return $n(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,o){e[t][r][o]=u[n]}))}))})),a.reverse(),Hn(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},_r=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,o=t.length,i=Array(o).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},gr=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:_r}),mr=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},hr=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},o=0;o<t.length;o+=1){var i="".concat(t[o][0]," ").concat(t[o][1]),c="".concat(t[o][1]," ").concat(t[o][0]);void 0!==r[i]?n[o]=r[i]:(r[i]=o,r[c]=o)}return n},yr=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On.core.EPSILON,r=e.length,o=0;o<r;o+=1)if(Math.abs(e[o]-t[o])>n)return!1;return!0},br=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,r=t.map((function(){return[]})),o=0;o<t.length-1;o+=1)for(var i=o+1;i<t.length;i+=1)r[o][i]=yr(t[o],t[i],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},d=0;d<t.length&&(l(d,d),s!==t.length);d+=1);return a.filter((function(e){return e.length}))},Ar=function remove_isolated_vertices(e){var t=_r(e);return{map:vr(e,Qn,t),remove:t}},xr=function remove_circular_edges(e){var t=mr(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),$n(e,er).forEach((function(t){return e[t].forEach((function(r,o){for(var i=r.length-1;i>=0;i-=1)!0===n[r[i]]&&e[t][o].splice(i,1)}))}))}return{map:vr(e,er,t),remove:t}},kr=function remove_duplicate_edges(e){var t=hr(e),n=Object.keys(t),r=vr(e,er,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},wr=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,n=br(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=On.core).average.apply(t,_toConsumableArray(e))})),$n(e,Qn).forEach((function(t){return e[t].forEach((function(n,o){return e[t][o].forEach((function(n,i){e[t][o][i]=r[n]}))}))})),Hn(e,Qn).filter((function(e){return e!==rr})).forEach((function(t){return delete e[t]}));var o=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:o}},Er=Object.freeze({__proto__:null,remove_isolated_vertices:Ar,remove_circular_edges:xr,remove_duplicate_edges:kr,remove_duplicate_vertices:wr}),Or=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(xr(e),kr(e)),"object"===_typeof(t)&&!0===t.vertices&&Ar(e),e},Cr={edges:"edgeOrders",faces:"faceOrders"},Mr=function implied_count(e,t){return Math.max(function array_in_array_max_number(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}($n(e,t).map((function(t){return e[t]}))),e[Cr[t]]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[Cr[t]]):-1)+1};Mr.vertices=function(e){return Mr(e,"vertices")},Mr.edges=function(e){return Mr(e,"edges")},Mr.faces=function(e){return Mr(e,"faces")};var jr=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,o=e.vertices_sectors,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],d=(l.indexOf(u)+l.length-1)%l.length,p=l[d],v="".concat(s," ").concat(p);if(c[v])return Object.assign(i,c),a.vertices.pop(),a;if(c[v]=!0,i[v])return;a.vertices.push(s),a.edges.push(v),a.angles.push(o[s][d]),u=s,s=p}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},Pr=Object.freeze({__proto__:null,planar_vertex_walk:jr}),Sr=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return On.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-On.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},zr=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:On.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},Nr=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Sr,sort_vertices_along_vector:zr}),Ir=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},Lr=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=Vr({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},qr=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=Ir({edges_vertices:r}));var o=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?o:o.map((function(e,n){return Sr({vertices_coords:t},e,n)}))},Tr=function make_vertices_faces(e){var t=e.faces_vertices,n=Array.from(Array(Mr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Fr=function make_vertices_faces_sorted(e){var t=e.vertices_vertices,n=e.faces_vertices,r=Gr({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},Vr=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},Br=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},Gr=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},Dr=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;o||(o=Xr({vertices_coords:t,edges_vertices:r}));var i=Br({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=i["".concat(t," ").concat(e)],r=i["".concat(e," ").concat(t)];return void 0!==n?o[n]:void 0!==r?On.core.flip(o[r]):void 0}))}))},Rr=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;return Dr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:o}).map((function(e){return 1===e.length?[On.core.TWO_PI]:On.core.counter_clockwise_sectors2(e)}))},Ur=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,o=e.edges_vertices,i=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=no({vertices_coords:n,edges_vertices:o,edges_foldAngle:i,edges_assignment:c,faces_vertices:a,faces_faces:u},t)),r||(r=Tr({faces_vertices:a}));var l=r.map((function(e){return e[0]})).map((function(e){return void 0===e?On.core.identity3x4:s[e]}));return n.map((function(e){return On.core.resize(3,e)})).map((function(e,t){return On.core.multiply_matrix3_vector3(l[t],e)}))},Zr=function make_edges_faces(e){var t=e.faces_edges,n=Array.from(Array(Mr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Hr={M:-180,m:-180,V:180,v:180},$r=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return Hr[e]||0}))},Wr=function make_edges_coords(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))}))},Xr=function make_edges_vector(e){var t=e.vertices_coords,n=e.edges_vertices;return Wr({vertices_coords:t,edges_vertices:n}).map((function(e){return On.core.subtract(e[1],e[0])}))},Yr=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=Wr({vertices_coords:t,edges_vertices:n})),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Jr=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,n=[-t,+t];return Yr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Kr=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,o=e.vertices_sectors,i=e.edges_vertices,c=e.edges_vector;n||(n=qr({vertices_coords:t,edges_vertices:i,vertices_edges:r})),o||(o=Rr({vertices_coords:t,vertices_vertices:n,edges_vertices:i,edges_vector:c}));var a=Vr({edges_vertices:i});return jr({vertices_vertices:n,vertices_sectors:o}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},Qr=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var o=e.length;e.forEach((function(e,i,c){var a=c[(i+1)%o];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},eo=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),o=[],i=r.indexOf(!1),c=i+1;c<r.length;c+=1)r[c]&&o.push(e[c]);for(var a=0;a<i;a+=1)r[a]&&o.push(e[a]);return o},to=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Qr({faces_vertices:t})),0===n.length)return[];var o=[[{face:r}]],i={};i[r]=!0;var c=function _loop(){var e=o[o.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){i[e.face]&&(r[t]=!0),i[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return eo(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),o[o.length]=c};do{c()}while(o[o.length-1].length>0);return o.length>0&&0===o[o.length-1].length&&o.pop(),o},no=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=o?$r({edges_assignment:o}):Array(n.length).fill(0));var u=Vr({edges_vertices:n}),s=i.map((function(){return On.core.identity3x4}));return to({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,o=e.edge_vertices.map((function(e){return t[e]})),i=e.edge_vertices.join(" "),c=u[i],a=On.core.make_matrix3_rotate(r[c]*Math.PI/180,(n=On.core).subtract.apply(n,_toConsumableArray(On.core.resize_up(o[1],o[0]))),o[0]);s[e.face]=On.core.multiply_matrices3(s[e.parent],a)}))})),s},ro=function make_faces_coloring_from_matrix(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},oo=Object.freeze({__proto__:null,make_vertices_edges:Ir,make_vertices_edges_sorted:Lr,make_vertices_vertices:qr,make_vertices_faces:Tr,make_vertices_faces_sorted:Fr,make_vertices_to_edge_bidirectional:Vr,make_vertices_to_edge:Br,make_vertices_to_face:Gr,make_vertices_vertices_vector:Dr,make_vertices_sectors:Rr,make_vertices_coords_folded:Ur,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),o=n[e[1]].filter((function(e){return e!==t}));return r.concat(o)}))},make_edges_faces:Zr,make_edges_foldAngle:$r,make_edges_assignment:function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_coords:Wr,make_edges_vector:Xr,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return Xr({vertices_coords:t,edges_vertices:n}).map((function(e){return On.core.magnitude(e)}))},make_edges_coords_min_max:Yr,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,n=[+t,-t];return Yr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Jr,make_planar_faces:Kr,make_faces_vertices:function make_faces_vertices(e){return Kr(e).map((function(e){return e.vertices}))},make_faces_edges:function make_faces_edges(e){return Kr(e).map((function(e){return e.edges}))},make_faces_faces:Qr,get_face_face_shared_vertices:eo,make_face_spanning_tree:to,make_faces_matrix:no,make_faces_center:function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return On.core.centroid(e)}))},make_faces_coloring_from_matrix:ro,make_faces_coloring:function make_faces_coloring(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=[];return o[r]=!0,to({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){o[e.face]=t%2==0}))})),o}}),io=function populate(e){if("object"===_typeof(e)&&e.edges_vertices){if(e.vertices_edges=Ir(e),e.vertices_vertices=qr(e),e.vertices_edges=Lr(e),e.vertices_coords&&(e.edges_vector=Xr(e),e.vertices_sectors=Rr(e)),function set_edges_angles(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=Dn(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=Rn(e.edges_foldAngle[r]);for(var o=e.edges_assignment.length;o<t;o+=1)e.edges_assignment[o]="U",e.edges_foldAngle[o]=0}(e),e.vertices_coords){var t=Kr(e);e.faces_vertices=t.map((function(e){return e.vertices})),e.faces_edges=t.map((function(e){return e.edges})),e.faces_angles=t.map((function(e){return e.angles}))}else e.faces_vertices=[],e.faces_edges=[];return e.vertices_faces=e.vertices_vertices?Fr(e):Tr(e),e.edges_faces=Zr(e),e.faces_faces=Qr(e),e.vertices_coords&&(e.faces_matrix=no(e)),e}},co=function fn_and(e,t){return e&&t},ao=function fn_cat(e,t){return e.concat(t)},uo=function fn_def(e){return void 0!==e},so=function fn_add(e,t){return e+t},fo=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON;return Jr(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},lo=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,i=Jr({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(i[a][1][0]<i[u][0][0]||i[u][1][0]<i[a][0][0])&&(i[a][1][1]<i[u][0][1]||i[u][1][1]<i[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},po=Object.freeze({__proto__:null,get_edges_vertices_span:fo,get_edges_edges_span:lo}),vo=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var i=fo({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)i[c][a]&&(i[c][a]=On.core.overlap_line_point(On.core.subtract(r[c][1],r[c][0]),r[c][0],t[a],On.core.exclude_s,o));return i.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},_o=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,o=e.edges_origin,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON;r||(r=Xr({vertices_coords:t,edges_vertices:n})),o||(o=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=lo({vertices_coords:t,edges_vertices:n},i),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=On.core.intersect_line_line(r[u],o[u],r[s],o[s],On.core.exclude_s,On.core.exclude_s,i),c[s][u]=c[u][s]):c[u][s]=void 0;return c},go=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,o){r[n][o]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},mo=function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},ho=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},yo=function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},bo=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:go,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:mo,invert_map:ho,invert_simple_map:yo}),Ao=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return On.core.subtract(e[1],e[0])})),o=n.map((function(e){return e[0]})),i=_o({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:o},1e-6),c=vo({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==i.reduce(ao,[]).filter(uo).length||0!==c.reduce(ao,[]).filter(uo).length){var a={vertices:e.vertices_coords.length};i.forEach((function(t){return t.filter(uo).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),i.forEach((function(e,t){e.forEach((function(e,n){e&&(i[t][n]=e[0])}))}));var u=i.map((function(e){return e.filter(uo)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=zr({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(ao,[]);if(e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(ao,[]),e.edges_assignment&&e.edges_foldAngle&&e.edges_foldAngle.length>e.edges_assignment.length)for(var l=e.edges_assignment.length;l<e.edges_foldAngle.length;l+=1)e.edges_assignment[l]=Rn(e.edges_foldAngle[l]);return e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]})).map((function(t,n){return void 0===t?Dn(e.edges_assignment[n]):t}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},xo=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],ko=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:On.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[Qn,er,tr].map((function(t){return Hn(e,t)})).reduce(ao,[]).filter((function(e){return!xo.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var o=wr(e,t/2),i=kr(e),c=xr(e),a=Ao(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?o.map:go(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?go(i.map,c.map):go(r.edges.map,i.map,c.map);break}var u=ho(a.edges.backmap),s=go(i.map,c.map,u);r.vertices.map=void 0===r.vertices.map?o.map:go(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?s:go(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},wo=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var o=t.map((function(t){return e.vertices_coords.map((function(e){return On.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===o[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),o.map((function(e){return void 0===e?i++:e}))},Eo=[Qn,er,tr],Oo=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return On.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},Co=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},o=0;o<e.edges_vertices.length;o+=1)r["".concat(e.edges_vertices[o][0]," ").concat(e.edges_vertices[o][1])]=o,r["".concat(e.edges_vertices[o][1]," ").concat(e.edges_vertices[o][0])]=o;for(var i=0;i<t.edges_vertices.length;i+=1){var c=r["".concat(t.edges_vertices[i][0]," ").concat(t.edges_vertices[i][1])];void 0!==c&&(n[i]=c)}return n},Mo=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(o,i){return o.forEach((function(o,c){e[t][i][c]=r[n][o]}))}))}))}))},jo=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On.core.EPSILON,r={},o={},i={};Eo.forEach((function(e){r[e]=Hn(t,e),o[e]=$n(t,e)})),Eo.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),i.vertices=Oo(e,t,n),Mo(t,o,[Qn],i);var c=dr.edges(e);i.edges=Array.from(Array(dr.edges(t))).map((function(e,t){return c+t}));var a=Co(e,t);Object.keys(a).forEach((function(e){i.edges[e]=a[e]}));var u=dr.faces(e);return i.faces=Array.from(Array(dr.faces(t))).map((function(e,t){return u+t})),Mo(t,o,[er,tr],i),Eo.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,o){var c=i[n][o];e[r][c]=t}))}))})),i},Po=function subgraph(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(o){n[o]=Array.from(Array(dr[o](e))).map((function(e,t){return t})),r[o]=pr(t[o]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return vr(e,t,n[t])})),e},So=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=Ir({edges_vertices:n}));for(var o=r.map((function(e){return"B"===e||"b"===e})),i=[],c=[],a=-1,u=0;u<o.length;u+=1)if(o[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};o[a]=!1,i.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return o[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];o[a]=!1,i.push(a)}return{vertices:c,edges:i}},zo=Object.freeze({__proto__:null,get_boundary:So,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,o=e.edges_vertices;r||(r=qr({vertices_coords:t,vertices_edges:n,edges_vertices:o}));var i=Vr({edges_vertices:o}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var d=t[l],p=r[l],v=p.map((function(e){return t[e]})).map((function(e){return[e[0]-d[0],e[1]-d[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,_=p[v],g=i[l<_?"".concat(l," ").concat(_):"".concat(_," ").concat(l)];c.push(g);for(var m=l,h=_,b=0;b<1e4;){var k=r[h],w=k.indexOf(m),E=k[(w+1)%k.length],O=i[h<E?"".concat(h," ").concat(E):"".concat(E," ").concat(h)];if(O===c[0])return u;a.push(h),c.push(O),m=h,h=E,b+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),No=function apply_matrix_to_graph(e,t){return Un(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return On.core.resize(3,e)})).map((function(e){return On.core.multiply_matrix3_vector3(t,e)}))})),Un(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return On.core.multiply_matrices3(e,t)}))})),e},Io={scale:function transform_scale(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var c=(n=On.core).get_vector.apply(n,o),a=On.core.resize(3,c),u=On.core.make_matrix3_scale(t,a);return No(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=(t=On.core).get_vector.apply(t,o),a=On.core.resize(3,c),u=(n=On.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return No(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];var a=(n=On.core).get_vector.apply(n,i),u=On.core.resize(3,a),s=(r=On.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return No(e,s)},transform:No},Lo=function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},qo=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=On.core.resize(n[0].length,t),o=n.map((function(e,t){return{d:On.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return o?o.i:void 0}},To=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var o=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return On.core.nearest_point_on_line(On.core.subtract(e[1],e[0]),e[0],t,On.core.segment_limiter)}));return On.core.smallest_comparison_search(t,o,On.core.distance)}},Fo=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var o=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return On.core.overlap_convex_polygon_point(e.face,t)})).shift();return void 0===o?void 0:o.i}},Vo=Fo,Bo=Object.freeze({__proto__:null,nearest_vertex:qo,nearest_edge:To,face_containing_point:Fo,nearest_face:Vo}),Go=function clone(e){var t,n;if("object"!==_typeof(e))return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},Do=function is_folded_form(e){return e.frame_classes&&e.frame_classes.includes("foldedForm")||e.file_classes&&e.file_classes.includes("foldedForm")},Ro=Object.freeze({__proto__:null,is_folded_form:Do}),Uo={},Zo={stroke:"black"},Ho={},$o={m:{stroke:"red"},v:{stroke:"blue"},f:{stroke:"lightgray"}},Wo=function edges_assignment_indices(e){var t={u:[],f:[],v:[],m:[],b:[]},n=e[cr].map((function(e){return Bn[e]}));return e.edges_vertices.map((function(e,t){return n[t]||"u"})).forEach((function(e,n){return t[e].push(n)})),t},Xo=function edges_path_data(e){return function edges_coords(e){var t=e.vertices_coords,n=e.edges_vertices;return t&&n?n.map((function(e){return e.map((function(e){return t[e]}))})):[]}(e).map((function(e){return function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])}(e)})).join("")},Yo=function edges_paths_assign(t){var n=function edges_path_data_assign(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment;if(!t||!n)return{};if(!r)return{u:Xo({vertices_coords:t,edges_vertices:n})};var o=Wo({vertices_coords:t,edges_vertices:n,edges_assignment:r});return Object.keys(o).forEach((function(e){o[e]=Xo({vertices_coords:t,edges_vertices:o[e].map((function(e){return n[e]}))})})),Object.keys(o).forEach((function(e){""===o[e]&&delete o[e]})),o}({vertices_coords:t.vertices_coords,edges_vertices:t.edges_vertices,edges_assignment:t.edges_assignment});return Object.keys(n).forEach((function(t){var r=e.svg.path(n[t]);r.setAttributeNS(null,Jn,Vn[t]),n[t]=r})),n},Jo=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},Ko={back:{fill:"white"},front:{fill:"#ddd"}},Qo={},ei={stroke:"black","stroke-linejoin":"bevel"},ti={fill:"none"},ni=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},ri=function finalize_faces(e,t,n,r){var o=Do(e),i=null!=e[ur]&&e[ur].length===e.faces_vertices.length,c=[["front"],["back"]],a=function get_faces_winding(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return On.core.cross2(On.core.subtract(e[1],e[0]),On.core.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(e).map((function(e){return e<0}));return a.map((function(e){return e?c[0]:c[1]})).forEach((function(e,n){t[n].setAttributeNS(null,Jn,e),ni(t[n],o?Ko[e]:Qo[e]),ni(t[n],r[e])})),(i?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e[ur]).map((function(e){return t[e]})):t).forEach((function(e){return n.appendChild(e)})),Object.defineProperty(n,"front",{get:function get(){return t.filter((function(e,t){return a[t]}))}}),Object.defineProperty(n,"back",{get:function get(){return t.filter((function(e,t){return!a[t]}))}}),ni(n,o?ei:ti),n},oi={fill:"none"},ii={stroke:"black",fill:"white"},ci=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},ai={vertices:function vertices_circle(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();return t&&t.vertices_coords?(t.vertices_coords.map((function(t){return e.svg.circle(t[0],t[1],.01)})).forEach((function(e){return r.appendChild(e)})),r.setAttributeNS(null,"fill","none"),Object.keys(n).forEach((function(e){return r.setAttributeNS(null,e,n[e])})),r):r},edges:function edges_paths(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t)return r;var o=Do(t),i=Yo(t);return Object.keys(i).forEach((function(e){i[e].setAttributeNS(null,Jn,Vn[e]),Jo(i[e],o?Ho[e]:$o[e]),Jo(i[e],n[e]),Jo(i[e],n[Vn[e]]),r.appendChild(i[e]),Object.defineProperty(r,Vn[e],{get:function get(){return i[e]}})})),Jo(r,o?Uo:Zo),Jo(r,n.stroke?{stroke:n.stroke}:{}),r},faces:function faces_draw_function(t,n){return null!=t&&null!=t.faces_vertices?function faces_vertices_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t||!t.vertices_coords||!t.faces_vertices)return r;var o=t.faces_vertices.map((function(e){return e.map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}))})).map((function(t){return e.svg.polygon(t)}));return o.forEach((function(e,t){return e.setAttributeNS(null,Kn,t)})),r.setAttributeNS(null,"fill","white"),ri(t,o,r,n)}(t,n):function faces_edges_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t||ir in t==0||or in t==0||rr in t==0)return r;var o=t.faces_edges.map((function(e){return e.map((function(e){return t.edges_vertices[e]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}))})).map((function(t){return e.svg.polygon(t)}));return o.forEach((function(e,t){return e.setAttributeNS(null,Kn,t)})),r.setAttributeNS(null,"fill","white"),ri(t,o,r,n)}(t,n)},boundaries:function boundaries_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!(t&&t.vertices_coords&&t.edges_vertices&&t.edges_assignment))return r;var o=So(t).vertices.map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}));if(0===o.length)return r;var i=e.svg.polygon(o);return i.setAttributeNS(null,Jn,sr),r.appendChild(i),ci(r,Do(t)?oi:ii),Object.keys(n).forEach((function(e){return r.setAttributeNS(null,e,n[e])})),r}},ui=function draw_group(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=ai[e].apply(ai,n);return o.setAttributeNS(null,Jn,e),o},si=function DrawGroups(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[nr,tr,er,Qn].map((function(n){return ui(n,e,t[n])}))};[nr,tr,er,Qn].forEach((function(e){si[e]=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ui(e,t,n[e])}}));var fi=function fold_classes(e){return[e.file_classes?e.file_classes:[],e.frame_classes?e.frame_classes:[]].reduce((function(e,t){return e.concat(t)}))},li=function bounding_rect(e){var t=e.vertices_coords;if(!(null==t||t.length<=0)){var n=Array(2).fill(1/0),r=Array(2).fill(-1/0);return t.forEach((function(e){e[0]<n[0]&&(n[0]=e[0]),e[0]>r[0]&&(r[0]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>r[1]&&(r[1]=e[1])})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?void 0:[n[0],n[1],r[0]-n[0],r[1]-n[1]]}},di=function make_svg_attributes(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r={overflow:"visible"};if(!e)return r;var o=li(e);if(o&&n){r.viewBox=o.join(" ");var i=Math.min(o[2],o[3]);r[fr]=i/100,r.width=o[2],r.height=o[3]}return r.class=["origami"].concat(fi(e)).join(" "),r},pi=function drawInto(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i=r.filter((function(e){return"object"===_typeof(e)})).shift()||{},c=r.filter((function(e){return"boolean"==typeof e})).shift(),a=di(t,i,c);Object.keys(a).forEach((function(t){return e.setAttributeNS(null,t,a[t])}));var u=si(t,i);return u.filter((function(e){return e.childNodes.length>0})).forEach((function(t){return e.appendChild(t)})),Object.keys(si).forEach((function(t,n){return Object.defineProperty(e,t,{get:function get(){return u[n]}})})),e},vi=function FOLDtoSVG(t,n,r){return pi(e.svg(),t,n,r)};Object.keys(si).forEach((function(e){vi[e]=si[e]})),vi.drawInto=pi;var _i=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,o=e.edges_faces,i=e.faces_edges,c=e.faces_vertices;if(o&&o[t])return o[t];var a=r[t];if(void 0!==n){for(var u=[],s=0;s<n[a[0]].length;s+=1)for(var l=0;l<n[a[1]].length;l+=1)n[a[0]][s]===n[a[1]][l]&&u.push(n[a[0]][s]);return u}if(i){for(var d=[],p=0;p<i.length;p+=1)for(var v=0;v<i[p].length;v+=1)i[p][v]===t&&d.push(p);return d}c&&console.warn("todo: find_adjacent_faces_to_edge")},gi=function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],o=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];if(o.forEach((function(n,r){return[cr,ar].filter((function(n){return e[n]&&void 0!==e[n][t]})).forEach((function(r){n[r]=e[r][t]}))})),e.vertices_coords&&(e.edges_length||e.edges_vector)){var i=o.map((function(t){return t.edges_vertices.map((function(t){return e.vertices_coords[t]}))}));e.edges_vector&&o.forEach((function(e,t){e.edges_vector=On.core.subtract(i[t][1],i[t][0])})),e.edges_length&&o.forEach((function(e,t){var n;e.edges_length=(n=On.core).distance2.apply(n,_toConsumableArray(i[t]))}))}return o},mi=function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,o){var i=o[(n+1)%o.length],c=r[e].indexOf(i);r[e][c]=t})))},hi=function update_vertices_edges(e,t,n,r,o){var i=e.vertices_edges;i&&(i[n]=_toConsumableArray(o),r.map((function(e){return i[e].indexOf(t)})).forEach((function(e,t){i[r[t]][e]=o[t]})))},yi=function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))},bi=function update_edges_faces(e,t,n){var r=e.edges_faces;r&&t.forEach((function(e){return r[e]=_toConsumableArray(n)}))},Ai=function update_faces_vertices(e,t,n,r){var o=e.faces_vertices;o&&r.map((function(e){return o[e]})).forEach((function(e){return e.map((function(e,t,r){var o=(t+1)%r.length;return e===n[0]&&r[o]===n[1]||e===n[1]&&r[o]===n[0]?o:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(n){return e.splice(n,0,t)}))}))},xi=function update_faces_edges(e,t,n,r,o){var i=e.edges_vertices,c=e.faces_edges;c&&o.map((function(e){return c[e]})).forEach((function(e){var o=e.indexOf(t),c=e[(o+e.length-1)%e.length],a=e[(o+1)%e.length],u=[[c,t],[t,a]].map((function(e){var t=e.map((function(e){return i[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==i[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==i[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("split_edge() bad faces_edges")}));return o===e.length-1?(e.splice(o,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[o,1].concat(_toConsumableArray(s))),s}))},ki=function split_edge(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:On.core.EPSILON;if(e.edges_vertices.length<t)return{};var o,i=e.edges_vertices[t];n||(n=(o=On.core).midpoint.apply(o,_toConsumableArray(i)));var c=i.map((function(t){return e.vertices_coords[t]})).map((function(e){return On.core.distance(e,n)<r}));if(c[0])return{vertex:i[0],edges:{}};if(c[1])return{vertex:i[1],edges:{}};var a=e.vertices_coords.length;e.vertices_coords[a]=n;var u=[0,1].map((function(t){return t+e.edges_vertices.length}));gi(e,t,a).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][u[n]]=t[r]}))})),mi(e,a,i),hi(e,t,a,i,u);var s=_i(e,t);s&&(yi(e,a,s),bi(e,u,s),Ai(e,a,i,s),xi(e,t,a,u,s));var l=vr(e,er,[t]);return u.forEach((function(e,t){u[t]=l[u[t]]})),l.splice(-2),l[t]=u,{vertex:a,edges:{map:l,new:u,remove:t}}},wi=function rebuild_edge(e,t,n){var r=e.edges_vertices.length,o=function make_edge(e,t,n){var r,o,i=e.vertices_coords,c=t.map((function(e){return i[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=On.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(o=On.core).subtract.apply(o,_toConsumableArray(c)),edges_faces:[n,n]}}(e,n,t);return Object.keys(o).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][r]=o[t]})),r},Ei=function build_faces(e,t,n){var r=[0,1].map((function(t){return e.faces_vertices.length+t}));return function make_faces(e,t,n){var r=e.edges_vertices,o=e.faces_vertices,i=e.faces_edges;e.faces_faces;var c=n.map((function(e){return o[t].indexOf(e)})),a=function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(o[t],c).map((function(e){return{faces_vertices:e}}));if(i){var u=Vr({edges_vertices:r});a.map((function(e){return e.faces_vertices.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return u[e]}))})).forEach((function(e,t){a[t].faces_edges=e}))}return a}(e,t,n).forEach((function(t,n){return Object.keys(t).forEach((function(o){e[o][r[n]]=t[o]}))})),r},Oi=function intersect_convex_face_line(e,t,n,r){var o=e.vertices_coords,i=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:On.core.EPSILON,s=c[t].map((function(e){return o[e]})).map((function(e){return On.core.overlap_line_point(n,r,e,(function(){return!0}),u)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})),l=s.map((function(e){return c[t][e]})),d=s.concat(s.map((function(e){return e+c[t].length}))).map((function(e,t,n){return n[t+1]-e==1})).reduce((function(e,t){return e||t}),!1);if(!d){if(l.length>1)return{vertices:l,edges:[]};var p=a[t].map((function(e){return i[e].map((function(e){return o[e]}))})).map((function(e){return On.core.intersect_line_line(n,r,On.core.subtract(e[1],e[0]),e[0],On.core.include_l,On.core.exclude_s,u)})).map((function(e,n){return{coords:e,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).filter((function(e){return!l.map((function(t){return i[e.edge].includes(t)})).reduce((function(e,t){return e||t}),!1)}));return p.length+l.length===2?{vertices:l,edges:p}:void 0}},Ci=function split_convex_face(e,t,n,r,o){var i=Oi(e,t,n,r,o);if(void 0!==i){var c=function split_at_intersections(e,t){var n,r,o=t.vertices,i=t.edges.map((function(t){var r=ki(e,n?n[t.edge]:t.edge,t.coords);return n=n?go(n,r.edges.map):r.edges.map,r}));return o.push.apply(o,_toConsumableArray(i.map((function(e){return e.vertex})))),i.forEach((function(e){e.edges.remove=r?r[e.edges.remove]:e.edges.remove;var t=yo(e.edges.map);r=r?mo(r,t):t})),{vertices:o,edges:{map:n,remove:i.map((function(e){return e.edges.remove}))}}}(e,i);c.edges.new=wi(e,t,c.vertices),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,o=e.edges_vertices,i=o[t][0],c=o[t][1];r[i]=Sr({vertices_coords:n},r[i].concat(c),i),r[c]=Sr({vertices_coords:n},r[c].concat(i),c)}(e,c.edges.new),function update_vertices_edges(e,t){var n=e.edges_vertices,r=e.vertices_edges,o=e.vertices_vertices;if(r&&o){var i=n[t];i.map((function(e){return o[e]})).map((function(e,t){return e.indexOf(i[(t+1)%i.length])})).forEach((function(e,n){return r[i[n]].splice(e,0,t)}))}}(e,c.edges.new);var a=Ei(e,t,c.vertices);!function update_vertices_faces(e,t,n){var r={};n.forEach((function(t,n){return e.faces_vertices[t].forEach((function(e){r[e]||(r[e]=[]),r[e].push(t)}))})),e.faces_vertices[t].forEach((function(n){var o,i=e.vertices_faces[n].indexOf(t),c=r[n];-1!==i&&c?(o=e.vertices_faces[n]).splice.apply(o,[i,1].concat(_toConsumableArray(c))):console.warn("update_vertices_faces not supposed to be here")}))}(e,t,a),function update_edges_faces(e,t,n,r){var o={};r.forEach((function(t,n){return e.faces_edges[t].forEach((function(e){o[e]||(o[e]=[]),o[e].push(t)}))})),[].concat(_toConsumableArray(e.faces_edges[t]),[n]).forEach((function(n){for(var r,i=o[n],c=[],a=0;a<e.edges_faces[n].length;a++)e.edges_faces[n][a]===t&&c.push(a);if(0!==c.length&&i){c.reverse().forEach((function(t){return e.edges_faces[n].splice(t,1)}));var u=c[c.length-1];(r=e.edges_faces[n]).splice.apply(r,[u,0].concat(_toConsumableArray(i)))}else console.warn("update_edges_faces not supposed to be here",u,i,JSON.parse(JSON.stringify(e.edges_faces[n])))}))}(e,t,c.edges.new,a),function update_faces_faces(e,t,n){var r=e.faces_vertices,o=e.faces_faces,i=o[t],c=n.map((function(e){return r[e]})),a=i.map((function(e,t){for(var o=r[e],i=[0,0],a=0;a<c.length;a++){for(var u=0,s=0;s<o.length;s++)-1!==c[a].indexOf(o[s])&&u++;i[a]=u}return i[0]>=2?n[0]:i[1]>=2?n[1]:void 0}));n.forEach((function(e,t,r){o[e]=[r[(t+1)%n.length]]})),i.forEach((function(e,n){for(var r=0;r<o[e].length;r++)o[e][r]===t&&(o[e][r]=a[n],o[a[n]].push(e))}))}(e,t,a);var u=vr(e,tr,[t]);return a.forEach((function(e,t){a[t]=u[a[t]]})),u.splice(-2),u[t]=a,c.faces={map:u,new:a,remove:t},c}},Mi={};Mi.prototype=Object.create(Object.prototype),Mi.prototype.constructor=Mi;var ji=Object.assign({clean:Or,populate:io,fragment:ko,subgraph:Po,assign:jo,svg:vi},Io);Object.keys(ji).forEach((function(e){Mi.prototype[e]=function(){return ji[e].apply(ji,[this].concat(Array.prototype.slice.call(arguments)))}}));var Pi={addVertices:wo,splitEdge:ki,faceSpanningTree:to,explodeFaces:Lo};Object.keys(Pi).forEach((function(e){Mi.prototype[e]=function(){return Pi[e].apply(Pi,[this].concat(Array.prototype.slice.call(arguments)))}})),Mi.prototype.splitFace=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=(t=On.core).get_line.apply(t,r);return Ci(this,e,i.vector,i.origin)},Mi.prototype.copy=function(){return Object.assign(Object.create(Mi.prototype),Go(this))},Mi.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===_typeof(e)&&(!0!==n.append&&Ln.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:zn,file_creator:Nn},Go(e)))},Mi.prototype.clear=function(){var e=this;In.graph.forEach((function(t){return delete e[t]})),In.orders.forEach((function(t){return delete e[t]})),delete this.file_frames},Mi.prototype.folded=function(){var e=Ur.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)));return Object.assign(Object.create(Mi.prototype),Object.assign(Go(this),{vertices_coords:e},{frame_classes:["foldedForm"]}))};var Si=function shortenKeys(e,t,n){var r=this,o=Object.create(null);return Object.keys(e).forEach((function(t){o[t.substring(r.length+1)]=e[t]})),o},zi=function getComponent(e){return Wn(this,e).map(Si.bind(e)).map(Sn[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Mi.prototype,e,{get:function get(){return zi.call(this,e)}})})),Object.defineProperty(Mi.prototype,"boundary",{get:function get(){var e=this,t=So(this),n=On.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),Object.assign(n,t)}});var Ni={vertices:qo,edges:To,faces:Fo};Mi.prototype.nearest=function(){var e=this,t=On.core.get_vector(arguments),n=Object.create(null),r={};return["vertices","edges","faces"].forEach((function(o){Object.defineProperty(n,Fn[o],{get:function get(){return void 0!==r[o]||(r[o]=Ni[o](e,t)),r[o]}}),Zn(e,o).forEach((function(t){return Object.defineProperty(n,t,{get:function get(){return e[t][n[Fn[o]]]}})}))})),n};var Ii=Mi.prototype,Li=function clip(e,t){var n=e.vertices_coords,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_assignment,c=e.boundaries_vertices;return c||(c=So({vertices_edges:r,edges_vertices:o,edges_assignment:i}).vertices),On.polygon(c.map((function(e){return n[e]}))).clip(t)},qi=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var o=kr(e).map;return r.map((function(e){return o[e]}))},Ti={};Ti.prototype=Object.create(Ii),Ti.prototype.constructor=Ti;Ti.prototype.copy=function(){return Object.assign(Object.create(Ti.prototype),Go(this))},Ti.prototype.folded=function(){var e=Ur.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)));return Object.assign(Object.create(Ii),Object.assign(Go(this),{vertices_coords:e},{frame_classes:["foldedForm"]}))};var Fi=function edges_array(e){var t=this;return e.mountain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-180;return e.forEach((function(e){t.edges_assignment[e]="M",t.edges_foldAngle[e]=n})),e},e.valley=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180;return e.forEach((function(e){t.edges_assignment[e]="V",t.edges_foldAngle[e]=n})),e},e.flat=function(){return e.forEach((function(e){t.edges_assignment[e]="F",t.edges_foldAngle[e]=0})),e},e};["line","ray","segment"].forEach((function(e){Ti.prototype[e]=function(){var t=On[e].apply(On,arguments);if(t){var n=Li(this,t);if(n){var r=wo(this,n),o=qi(this,r),i=ko(this).edges.map;return io(this),Fi.call(this,o.map((function(e){return i[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){Ti.prototype[e]=function(){var t=this,n=On[e].apply(On,arguments);if(n){var r=n.segments(96).map((function(e){return On.segment(e)})).map((function(e){return Li(t,e)})).filter((function(e){return void 0!==e}));if(r){var o=[],i=[];r.forEach((function(e){var n=wo(t,e);o.push.apply(o,_toConsumableArray(n)),i.push.apply(i,_toConsumableArray(qi(t,n)))}));var c=ko(this).edges.map;return io(this),Fi.call(this,i.map((function(e){return c[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}}));var Vi=Ti.prototype,Bi=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),o=r.filter((function(e){return t[e]})),i=r.filter((function(e){return!t[e]}));return i.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),o.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=i.length+t})),n},Gi=function get_face_sidedness(e,t,n,r){var o=[n[0]-t[0],n[1]-t[1]],i=e[0]*o[1]-e[1]*o[0];return r?i>0:i<0},Di=function make_face_center_fast(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},Ri=function prepare_graph_crease(e,t,n,r){var o=dr.faces(e),i=Array.from(Array(o));e["faces_re:layer"]||(e["faces_re:layer"]=Array(o).fill(0)),e["faces_re:preindex"]=i.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=no(e,r)),e.faces_coloring=ro(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return On.core.invert_matrix3(e)})).map((function(e){return On.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=i.map((function(t,n){return Di(e,n)})),e["faces_re:sidedness"]=i.map((function(t,n){return Gi(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},Ui=function two_furthest_points(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],o=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<o[1]&&(o=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-o[1])>Math.abs(r[0]-n[0])?[o,t]:[n,r]},Zi={M:"V",m:"V",V:"M",v:"M"},Hi=function opposingCrease(e){return Zi[e]||e},$i=function flat_fold(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",i=Hi(o);if(null==r){var c=Fo(e,n);r=void 0===c?0:c}t=On.core.resize(3,t),n=On.core.resize(3,n),Ri(e,t,n,r);var a=Go(e);a.vertices_coords.forEach((function(e){return e.splice(2)}));var u=Array.from(Array(dr.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=a.faces_coloring[t],r=Ci(a,t,a["faces_re:creases"][t].vector,a["faces_re:creases"][t].origin);if(void 0!==r)return a.edges_assignment[r.edges.new]=n?o:i,a.edges_foldAngle[r.edges.new]=n?Gn[o]||0:Gn[i]||0,r.faces.map[r.faces.remove].forEach((function(t){a.faces_center[t]=Di(a,t),a["faces_re:sidedness"][t]=Gi(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,a.faces_center[t],e.faces_coloring[r.faces.remove]),a["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],a["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();a["faces_re:layer"]=Bi(a["faces_re:layer"],a["faces_re:sidedness"]);var s=void 0===u[0]?0:a["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return a["faces_re:sidedness"][e.new]})).shift().new,l=e.faces_matrix[0];"M"!==o&&"m"!==o&&"V"!==o&&"v"!==o||(l=void 0!==u[0]||e["faces_re:sidedness"][0]?On.core.multiply_matrices3(e.faces_matrix[0],On.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var d=no(a,s).map((function(e){return On.core.multiply_matrices3(l,e)}));a.faces_coloring=ro({faces_matrix:d});var p=On.core.multiply_matrix3_line3(l,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),v=On.core.normalize(On.core.rotate270(p.vector)),_=u.map((function(t,n){return void 0===t?void 0:a.edges_vertices[t.edges.new].map((function(e){return a.vertices_coords[e]})).map((function(t){return On.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return a["re:construction"]=0===_.length?{type:"flip",direction:v}:{type:"fold",assignment:o,direction:v,edge:Ui(_)},a.faces_matrix=d,a["vertices_re:foldedCoords"]=Ur(a,s),a.faces_matrix=d,delete e["faces_re:creases"],delete a["faces_re:creases"],delete e["faces_re:sidedness"],delete a["faces_re:sidedness"],delete e["faces_re:preindex"],delete a["faces_re:preindex"],delete e.faces_coloring,delete a.faces_coloring,delete e.faces_center,delete a.faces_center,a},Wi={};Wi.prototype=Object.create(Ii),Wi.prototype.constructor=Wi,Wi.prototype.flatFold=function(){var e=this,t=On.core.get_line(arguments),n=$i(this,t.vector,t.origin);return[Qn,er,tr].map((function(t){return Hn(e,t)})).reduce(ao,[]).forEach((function(t){return delete e[t]})),Object.assign(this,n),this},Wi.prototype.copy=function(){return Object.assign(Object.create(Wi.prototype),Go(this))},Wi.prototype.folded=function(){var e=Ur.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)));return Object.assign(Object.create(Wi.prototype),Object.assign(Go(this),{vertices_coords:e},{frame_classes:["foldedForm"]}))};var Xi=Wi.prototype,Yi=Object.assign(Object.create(null),{assign:jo,add_vertices:wo,add_edges:qi,split_edge:ki,split_face:Ci,flat_fold:$i,clean:Or,get_circular_edges:mr,get_duplicate_edges:hr,get_duplicate_vertices:br,get_collinear_vertices:vo,count:dr,implied:Mr,fragment:ko,remove:vr,populate:io,subgraph:Po,explode_faces:Lo,clip:Li,svg:vi,intersect_convex_face_line:Oi,join_collinear_edges:function join_collinear_edges(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.vertices_edges,o=e.edges_vector;arguments.length>1&&void 0!==arguments[1]||On.core.EPSILON,o||(o=Xr({vertices_coords:t,edges_vertices:n})),r||(r=Ir({edges_vertices:n}));for(var i=r.map((function(e,t){return 2===e.length?t:void 0})).filter((function(e){return void 0!==e})),c=i.map((function(e){return r[e]})).map((function(e){return e.map((function(e){return o[e]}))})).map((function(e){var t;return(t=On.core).parallel.apply(t,_toConsumableArray(e))})),a=i.filter((function(e,t){return c[t]})),u=a.map((function(e){return r[e]})).map((function(e){return e[0]<e[1]?e:[e[1],e[0]]})),s={},l=0;l<u.length;l++)void 0===s[u[l][1]]?s[u[l][1]]=!0:console.log("WARNING. cannot safely remove edges. some overlaps");var d=u.map((function(e){return e[0]})),p=u.map((function(e){return e[1]})),v=p.map((function(e){return n[e]})).map((function(e,t){return e[0]===a[t]?e[1]:e[1]===a[t]?e[0]:void console.log("WARNING, removed edge cannot find vertex")}));return d.forEach((function(e,t){n[e][0]===a[t]?n[e][0]=v[t]:n[e][1]===a[t]?n[e][1]=v[t]:console.log("WARNING, joining edges cannot find vertex")})),{vertices:a,edges:p}}},oo,Io,zo,Pr,Bo,Yn,Nr,po,bo,Ro,Er,gr),Ji={},Ki=function make_rect_vertices_coords(e,t){return[[0,0],[e,0],[e,t],[0,t]]},Qi=function make_closed_polygon(e){return io({vertices_coords:e,edges_vertices:e.map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array(e.length).fill("B")})},ec=[null,null,null,"triangle",null,"pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];ec.map((function(e,t){return null===e?t:void 0})).filter((function(e){return void 0!==e})).forEach((function(e){return delete ec[e]})),ec.forEach((function(e,t){Ji[e]=function(){return Qi(On.core.make_regular_polygon_side_length(t))}})),Ji.square=function(){return Qi(Ki(1,1))},Ji.rectangle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Qi(Ki(e,t))},Ji.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return Qi(On.core.make_regular_polygon(e))},Ji.kite=function(){return io({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:Array.from("BBBBBBVVF")})};var tc=Object.create(null),nc={graph:Ii,cp:Vi,origami:Xi},rc={graph:function graph(){return{}},cp:Ji.square,origami:Ji.square};Object.keys(nc).forEach((function(e){tc[e]=function(){var t=Array.from(arguments).filter((function(e){return Xn(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Object.assign.apply(Object,[Object.create(nc[e]),t.length?{}:rc[e]()].concat(_toConsumableArray(t),[{file_spec:zn,file_creator:Nn}]))},tc[e].prototype=nc[e],tc[e].prototype.constructor=tc[e],Object.keys(Ji).forEach((function(t){tc[e][t]=function(){return tc[e](Ji[t].apply(Ji,arguments))}}))})),Object.assign(tc.graph,Yi);var oc=function cubrt(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)},ic=function axiom6ud(e,t,n,r){if(Math.abs(1-On.core.dot2(e.u,n)/e.d)<.02)return[];var o=On.core.rotate90(e.u),i=On.core.subtract2(On.core.add2(n,On.core.scale2(e.u,e.d)),On.core.scale2(r,2)),c=On.core.subtract2(On.core.scale2(e.u,e.d),n),a=On.core.dot2(r,t.u)-t.d,u=2*On.core.dot2(c,o),s=On.core.dot2(c,c),l=On.core.dot2(On.core.add2(i,c),o),d=On.core.dot2(i,c),p=On.core.dot2(o,t.u),v=On.core.dot2(c,t.u),_=p,g=a+l*p+v,m=a*u+d*p+l*v,h=a*s+d*v,b=0;return Math.abs(m)>On.core.EPSILON&&(b=1),Math.abs(g)>On.core.EPSILON&&(b=2),Math.abs(_)>On.core.EPSILON&&(b=3),function polynomial(e,t,n,r,o){switch(e){case 1:return[-o/r];case 2:var i=Math.pow(r,2)-4*n*o;if(i<-On.core.EPSILON)return[];var c=-r/(2*n);if(i<On.core.EPSILON)return[c];var a=Math.sqrt(i)/(2*n);return[c+a,c-a];case 3:var u=n/t,s=r/t,l=o/t,d=(3*s-Math.pow(u,2))/9,p=(9*u*s-27*l-2*Math.pow(u,3))/54,v=Math.pow(d,3)+Math.pow(p,2),_=-u/3;if(v>0){var g=Math.sqrt(v);return[_+oc(p+g)+oc(p-g)]}if(Math.abs(v)<On.core.EPSILON){var m=Math.pow(p,1/3);return p<0?[]:[_+2*m,_-m]}var h=Math.sqrt(-v),b=Math.atan2(h,p)/3,k=Math.pow(Math.pow(p,2)-v,1/6),w=k*Math.cos(b),E=k*Math.sin(b);return[_+2*w,_-w-Math.sqrt(3)*E,_-w+Math.sqrt(3)*E];default:return[]}}(b,_,g,m,h).map((function(t){return On.core.add2(On.core.scale2(e.u,e.d),On.core.scale2(o,t))})).map((function(e){return{p:e,u:On.core.normalize2(On.core.subtract2(e,n))}})).map((function(e){return{u:e.u,d:On.core.dot2(e.u,On.core.midpoint2(e.p,n))}}))},cc=Object.freeze({__proto__:null,axiom1ud:function axiom1ud(e,t){var n=On.core.normalize2(On.core.rotate90(On.core.subtract2(t,e)));return{u:n,d:On.core.dot2(On.core.add2(e,t),n)/2}},axiom2ud:function axiom2ud(e,t){var n=On.core.normalize2(On.core.subtract2(t,e));return{u:n,d:On.core.dot2(On.core.add2(e,t),n)/2}},axiom3ud:function axiom3ud(e,t){var n=function intersection_ud(e,t){var n=On.core.cross2(e.u,t.u);if(!(Math.abs(n)<On.core.EPSILON))return[(e.d*t.u[1]-t.d*e.u[1])/n,(t.d*e.u[0]-e.d*t.u[0])/n]}(e,t);return void 0===n?[{u:e.u,d:(e.d+t.d*On.core.dot2(e.u,t.u))/2}]:[On.core.add2,On.core.subtract2].map((function(n){return On.core.normalize2(n(e.u,t.u))})).map((function(e){return{u:e,d:On.core.dot2(n,e)}}))},axiom4ud:function axiom4ud(e,t){var n=On.core.rotate90(e.u);return{u:n,d:On.core.dot2(t,n)}},axiom5ud:function axiom5ud(e,t,n){var r=On.core.dot2(t,e.u),o=e.d-r,i=On.core.distance2(t,n);if(o>i)return[];var c=Math.sqrt(i*i-o*o),a=On.core.scale2(e.u,o),u=On.core.add2(t,a),s=On.core.scale2(On.core.rotate90(e.u),c);return(c<On.core.EPSILON?[u]:[On.core.add2(u,s),On.core.subtract2(u,s)]).map((function(e){return On.core.normalize2(On.core.subtract2(n,e))})).map((function(e){return{u:e,d:On.core.dot2(t,e)}}))},axiom6ud:ic,axiom7ud:function axiom7ud(e,t,n){var r=On.core.rotate90(e.u),o=On.core.dot2(r,t.u);if(!(Math.abs(o)<On.core.EPSILON)){var i=On.core.dot2(n,r),c=On.core.dot2(n,t.u);return{u:r,d:(t.d+2*i*o-c)/(2*o)}}}}),ac=function axiom3(e,t){return On.core.bisect_lines2(e.vector,e.origin,t.vector,t.origin)},uc=function axiom5(e,t,n){return(On.core.intersect_circle_line(On.core.distance2(t,n),t,e.vector,e.origin,On.core.include_l)||[]).map((function(e){var t;return{vector:On.core.normalize2(On.core.rotate90((t=On.core).subtract2.apply(t,_toConsumableArray(On.core.resize_up(e,n))))),origin:On.core.midpoint2(n,e)}}))},sc=function axiom6(e,t,n,r){return ic(On.core.vector_origin_to_ud(e),On.core.vector_origin_to_ud(t),n,r).map(On.core.ud_to_vector_origin)},fc=function axiom7(e,t,n){var r,o=On.core.intersect_line_line(e.vector,e.origin,t.vector,n,On.core.include_l,On.core.include_l);return void 0===o?void 0:{vector:On.core.normalize2(On.core.rotate90((r=On.core).subtract2.apply(r,_toConsumableArray(On.core.resize_up(o,n))))),origin:On.core.midpoint2(n,o)}},lc=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){var n;return{vector:On.core.normalize2((n=On.core).subtract2.apply(n,_toConsumableArray(On.core.resize_up(t,e)))),origin:e}},axiom2:function axiom2(e,t){var n;return{vector:On.core.normalize2(On.core.rotate90((n=On.core).subtract2.apply(n,_toConsumableArray(On.core.resize_up(t,e))))),origin:On.core.midpoint2(e,t)}},axiom3:ac,axiom4:function axiom4(e,t){return{vector:On.core.rotate90(On.core.normalize2(e.vector)),origin:t}},axiom5:uc,axiom6:sc,axiom7:fc}),dc=function reflect_point(e,t){var n=On.core.make_matrix2_reflect(e.vector,e.origin);return On.core.multiply_matrix2_vector2(n,t)},pc=function validate_axiom1_2(e,t){return[e.points.map((function(e){return On.core.overlap_convex_polygon_point(t,e,ear.math.include)})).reduce((function(e,t){return e&&t}),!0)]},vc=[null,pc,pc,function validate_axiom3(e,t){var n=e.lines.map((function(e){return On.core.clip_line_in_convex_polygon(t,e.vector,e.origin,On.core.include,On.core.include_l)}));if(void 0===n[0]||void 0===n[1])return[!1,!1];var r=ac(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.lines[1].origin),o=r.map((function(e){return void 0===e?void 0:On.core.intersect_convex_polygon_line(t,e.vector,e.origin,ear.math.include_s,ear.math.exclude_l)})),i=[0,1].map((function(e){return void 0!==o[e]})),c=r.map((function(e,t){return void 0===e?void 0:[dc(e,n[0][0]),dc(e,n[0][1])]})).map((function(e,t){return void 0!==e&&(On.core.overlap_line_point(On.core.subtract(n[1][1],n[1][0]),n[1][0],e[0],On.core.include_s)||On.core.overlap_line_point(On.core.subtract(n[1][1],n[1][0]),n[1][0],e[1],On.core.include_s)||On.core.overlap_line_point(On.core.subtract(e[1],e[0]),e[0],n[1][0],On.core.include_s)||On.core.overlap_line_point(On.core.subtract(e[1],e[0]),e[0],n[1][1],On.core.include_s))}));return[0,1].map((function(e){return!0===c[e]&&!0===i[e]}))},function validate_axiom4(e,t){var n=On.core.intersect_line_line(e.lines[0].vector,e.lines[0].origin,On.core.rotate90(e.lines[0].vector),e.points[0],On.core.include_l,On.core.include_l);return[[e.points[0],n].filter((function(e){return void 0!==e})).map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)})).reduce((function(e,t){return e&&t}),!0)]},function validate_axiom5(e,t){var n=uc(e.lines[0].vector,e.lines[0].origin,e.points[0],e.points[1]);if(0===n.length)return[];var r=e.points.map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)})).reduce((function(e,t){return e&&t}),!0);return n.map((function(t){return dc(t,e.points[1])})).map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)})).map((function(e){return e&&r}))},function validate_axiom6(e,t){var n=sc(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.lines[1].origin,e.points[0],e.points[1]);if(0===n.length)return[];if(!e.points.map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)})).reduce((function(e,t){return e&&t}),!0))return n.map((function(){return!1}));var r=n.map((function(t){return dc(t,e.points[0])})).map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)})),o=n.map((function(t){return dc(t,e.points[1])})).map((function(e){return On.core.overlap_convex_polygon_point(t,e,On.core.include)}));return n.map((function(e,t){return r[t]&&o[t]}))},function validate_axiom7(e,t){var n=On.core.overlap_convex_polygon_point(t,e.points[0],On.core.include),r=fc(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.points[0]);if(void 0===r)return[!1];var o=dc(r,e.points[0]),i=On.core.overlap_convex_polygon_point(t,o,On.core.include),c=void 0!==On.core.intersect_convex_polygon_line(t,e.lines[1].vector,e.lines[1].origin,On.core.include_s,On.core.include_l);return[n&&i&&c]}];delete vc[0];var _c=function validate_axiom(e,t,n){var r="object"===_typeof(n)&&n.vertices_coords?So(n).vertices.map((function(e){return n.vertices_coords[e]})):n;return vc[e](t,r)};Object.keys(vc).forEach((function(e){_c[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _c.apply(void 0,[e].concat(n))}}));var gc=function check_params(e){return{points:(e.points||[]).map((function(e){return On.core.get_vector(e)})),lines:(e.lines||[]).map((function(e){return On.core.get_line(e)})),lines_ud:(e.lines||[]).map((function(e){return void 0!==e.u&&void 0!==e.d?e:void 0})).filter((function(e){return void 0!==e}))}},mc=function axiom_boundaryless(e,t){var n=t.lines_ud.length===t.lines.length,r=n?cc["axiom".concat(e,"ud")].apply(cc,_toConsumableArray(t.lines_ud).concat(_toConsumableArray(t.points))):lc["axiom".concat(e)].apply(lc,_toConsumableArray(t.lines).concat(_toConsumableArray(t.points)));return function axiom_returns_array(e){switch(e){case 3:case"3":case 5:case"5":case 6:case"6":return!0;default:return!1}}(e)?r:[r].filter((function(e){return void 0!==e})).map((function(e){return n?On.line.ud(e):On.line(e)}))},hc=function filter_with_boundary(e,t,n,r){null!=r&&_c(e,t,r).forEach((function(e,t){e&&delete valid_solutions[t]}))},yc=function axiom(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=gc(t),o=mc(e,r);return hc(e,r,0,n),o};Object.keys(lc).forEach((function(e){yc[e]=lc[e]})),Object.keys(cc).forEach((function(e){yc[e]=cc[e]})),[1,2,3,4,5,6,7].forEach((function(e){yc[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return yc.apply(void 0,[e].concat(n))}})),yc.validate=_c;var bc=function line_line_for_arrows(e,t){return On.core.intersect_line_line(e.vector,e.origin,t.vector,t.origin,On.core.include_l,On.core.include_l)},Ac=function reflect_point(e,t){var n=On.core.make_matrix2_reflect(e.vector,e.origin);return On.core.multiply_matrix2_vector2(n,t)},xc=function boundary_for_arrows(e){var t=e.vertices_coords;return On.core.convex_hull(t)},kc=function widest_perp(e,t,n){var r=xc(e);if(void 0===n){var o,i=On.core.clip_line_in_convex_polygon(r,t.vector,t.origin,On.core.exclude,On.core.include_l);n=(o=On.core).midpoint.apply(o,_toConsumableArray(i))}var c=On.core.rotate270(t.vector),a=On.core.clip_line_in_convex_polygon(r,c,n,On.core.exclude,On.core.include_l).map((function(e){return On.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=On.core.scale(On.core.normalize(c),a);return On.segment(On.core.add(n,On.core.flip(u)),On.core.add(n,u))},wc=function between_2_segments(e,t,n){var r,o=t.map((function(e){return On.core.midpoint(e[0],e[1])})),i=(r=On.line).fromPoints.apply(r,_toConsumableArray(o)),c=On.intersect(n,i),a=On.line(n.vector.rotate90(),c);return On.segment(e.lines.map((function(e){return On.intersect(e,a)})))},Ec=[null,function axiom_1_arrows(e,t){return yc(1,e).map((function(e){return[kc(t,e)]}))},function axiom_2_arrows(e){return[[On.segment(e.points)]]},function axiom_3_arrows(e,t){var n=xc(t),r=e.lines.map((function(e){return On.core.clip_line_in_convex_polygon(n,e.vector,e.origin,On.core.exclude,On.core.include_l)})),o=r.map((function(e){return On.core.subtract(e[1],e[0])})),i=On.core.intersect_line_line(o[0],r[0][0],o[1],r[1][0],On.core.exclude_s,On.core.exclude_s);return i?yc(3,e).map((function(t){return function between_2_intersecting_segments(e,t,n,r){var o=e.lines.map((function(e){return e.vector})),i=o.map(On.core.flip),c=o.concat(i).map((function(e){return On.ray(e,t)})),a=c.filter((function(e){return On.core.dot(e.vector,n.vector)>0&&On.core.cross2(e.vector,n.vector)>0})).shift(),u=c.filter((function(e){return On.core.dot(e.vector,n.vector)>0&&On.core.cross2(e.vector,n.vector)<0})).shift(),s=c.filter((function(e){return On.core.dot(e.vector,n.vector)<0&&On.core.cross2(e.vector,n.vector)>0})).shift(),l=c.filter((function(e){return On.core.dot(e.vector,n.vector)<0&&On.core.cross2(e.vector,n.vector)<0})).shift(),d=[a,u,s,l].map((function(e){return On.core.intersect_convex_polygon_line(r,e.vector,e.origin,On.core.exclude_s,On.core.exclude_r).shift().shift()})),p=d.map((function(e){return On.core.distance(e,t)})),v=p[0]<p[1]?d[0]:d[1],_=p[0]<p[1]?On.core.add(u.origin,u.vector.normalize().scale(p[0])):On.core.add(a.origin,a.vector.normalize().scale(p[1])),g=p[2]<p[3]?d[2]:d[3],m=p[2]<p[3]?On.core.add(l.origin,l.vector.normalize().scale(p[2])):On.core.add(s.origin,s.vector.normalize().scale(p[3]));return[On.segment(v,_),On.segment(g,m)]}(e,i,t,n)})):[wc(e,r,yc(3,e).filter((function(e){return void 0!==e})).shift())]},function axiom_4_arrows(e,t){return yc(4,e).map((function(n){return[kc(t,n,bc(n,e.lines[0]))]}))},function axiom_5_arrows(e){return yc(5,e).map((function(t){return[On.segment(e.points[1],Ac(t,e.points[1]))]}))},function axiom_6_arrows(e){return yc(6,e).map((function(t){return e.points.map((function(e){return On.segment(e,Ac(t,e))}))}))},function axiom_7_arrows(e,t){return yc(7,e).map((function(n){return[On.segment(e.points[0],Ac(n,e.points[0])),kc(t,n,bc(n,e.lines[1]))]}))}];delete Ec[0];var Oc=function axiom_arrows(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.points?t.points.map((function(e){return On.core.get_vector(e)})):void 0,r=t.lines?t.lines.map((function(e){return On.core.get_line(e)})):void 0,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];return Ec[e].apply(Ec,[{points:n,lines:r}].concat(i))};Object.keys(Ec).forEach((function(e){Oc[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oc.apply(void 0,[e].concat(n))}}));var Cc=Object.assign(Object.create(null),{axiom_arrows:Oc,simple_arrow:function simple_arrow(e,t){var n=On.core.convex_hull(e.vertices_coords),r=On.core.enclosing_rectangle(n),o=function widest_perpendicular(e,t,n){if(void 0===n){var r,o=On.core.clip_line_in_convex_polygon(e,t.vector,t.origin,On.core.exclude,On.core.include_l);n=(r=On.core).midpoint.apply(r,_toConsumableArray(o))}var i=On.core.rotate270(t.vector),c=On.core.clip_line_in_convex_polygon(e,i,n,On.core.exclude,On.core.include_l).map((function(e){return On.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),a=On.core.scale(On.core.normalize(i),c);return On.segment(On.core.add(n,On.core.flip(a)),On.core.add(n,a))}(n,t),i=ear.math.subtract(o[1],o[0]),c=ear.math.magnitude(i),a=ear.math.dot(i,[1,0]),u=r.width<r.height?r.width:r.height;return o.head={width:.1*u,height:.15*u},o.bend=a>0?.3:-.3,o.padding=.05*c,o}}),Mc=function maekawa_assignments(e){var t=function get_unassigned_indices(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),o=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-o[t])}))},jc={V:1,v:1,M:-1,m:-1},Pc=function upOrDown(e,t){return t%2==0?jc[e]:-jc[e]},Sc=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},zc=function get_sectors_layer(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On.core.EPSILON,r=0,o=e.map((function(e,t){return t%2==0?e:-e})).map((function(e){return r+=e})),i=o.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+n})),c=o.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-n})),a=function test(t){var n=[];t.forEach((function(e,t){n[e]=t}));for(var r=t.length+(t.length===e.length?0:-1),a=function _loop(e){var r=(e+1)%t.length,a=Sc(t,n[e],n[r]),u=a.map((function(t){return o[e]<i[t]})).reduce(co,!0),s=a.map((function(t){return o[e]>c[t]})).reduce(co,!0);if(!u&&!s)return{v:!1}},u=0;u<r;u+=1){var s=a(u);if("object"===_typeof(s))return s.v}return!0},u=function final_test(e){var n=yo(e);return n[0]>n[n.length-1]?"M"===t[0]:"V"===t[0]},s=function recurse(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n=n.slice(0,o).concat([r],n.slice(o,n.length)),!a(n))return[];if(r>=e.length-1)return u(n)?[n]:[];var i=Pc(t[(r+1)%e.length],r),c=1===i?Array.from(Array(n.length-o)).map((function(e,t){return o+t+1})):Array.from(Array(o+1)).map((function(e,t){return t}));return c.map((function(e){return recurse(n,r+1,e)})).reduce((function(e,t){return e.concat(t)}),[]).map(yo)};return s()},Nc=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var o=0;o<e.length;o+=1){if(t>n&&("V"===e[o]||"v"===e[o]))return o;if(n>t&&("M"===e[o]||"m"===e[o]))return o}},Ic=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(so,0)}))},Lc=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){var t;return(t=On.core).counter_clockwise_angle_radians.apply(t,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return Ic(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return On.core.is_counter_clockwise_between(t,e[n],e[(n+1)%e.length])?t:void 0}))},qc=Object.freeze({__proto__:null,alternating_sum:Ic,alternating_sum_difference:function alternating_sum_difference(e){var t=e.reduce(so,0)/2;return Ic(e).map((function(e){return e-t}))},kawasaki_solutions_radians:Lc,kawasaki_solutions:function kawasaki_solutions(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return Lc(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))}}),Tc=Object.assign(Object.create(null),{maekawa_assignments:Mc,sectors_layer:zc,layer_solver:function layer_solver(e,t){null==t&&(t=e.map((function(){return"U"})));var n=Mc(t),r=n.map((function(t){return zc(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},fold_angles4:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Nc(t);if(void 0!==r){var o=e[(r+1)%e.length],i=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(o)*Math.cos(i)+Math.sin(o)*Math.sin(i)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(o)*Math.sin(i)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},qc),Fc="undefined"!=typeof window&&void 0!==window.document,Vc="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;"object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.constructor&&self.constructor.name;var Bc=function(){var e={};if(Vc){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Fc&&(e=window);return e}(),Gc="http://www.w3.org/2000/svg",Dc=function svg(){return Bc.document.createElementNS(Gc,"svg")};Dc.g=function(){return Bc.document.createElementNS(Gc,"g")},Dc.path=function(e){var t=Bc.document.createElementNS(Gc,"path");return t.setAttributeNS(null,"d",e),t},Dc.polygon=function(e){var t=Bc.document.createElementNS(Gc,"polygon"),n=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");return t.setAttributeNS(null,"points",n),t},Dc.circle=function(e,t,n){var r=Bc.document.createElementNS(Gc,"circle");return r.setAttributeNS(null,"cx",e),r.setAttributeNS(null,"cy",t),r.setAttributeNS(null,"r",n),r},Dc.NS=Gc,Dc.svg=Dc;var Rc,Uc={axioms:{ar:[null,"   ","        ","        ","          ","         ","            ","          "],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una lnea entre dos puntos","dobla dos puntos juntos","dobla y une dos lneas","dobla una lnea sobre s misma, doblndola hacia un punto","dobla un punto hasta una lnea, doblndola a travs de otro punto","dobla un punto hacia una lnea y otro punto hacia otra lnea","dobla un punto hacia una lnea y otra lnea sobre s misma"],fr:[null,"crez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-mme  l'aide d'un pli qui passe par un point","rabattez un point sur une ligne  l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-mme"],hi:[null,"        ","         ","        ","                  ","                 ","                   ","                      "],jp:[null,"2","2","2","","","",""],ko:[null,"    ","   ","   ","      ","  ,    ","       ","       "],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto at uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto at uma linha e outro ponto at outra linha","dobre um ponto at uma linha e outra linha sobre si mesma"],ru:[null,"    ","   ","   ","   ,   ","   ,    ","         ","        "],tr:[null,"iki noktadan geen bir izgi boyunca katla","iki noktay birbirine katla","iki izgiyi birbirine katla","bir noktadan kvrarak kendi zerindeki bir izgi boyunca katla","baka bir noktadan kvrarak bir noktay bir izgiye katla","bir noktay bir izgiye ve baka bir noktay baka bir izgiye katla","bir noktay bir izgiye ve baka bir izgiyi kendi zerine katla"],vi:[null,"to mt np gp i qua hai im","to np gp bng cch gp mt im ny sang im khc","to np gp bng cch gp mt ng ln mt ng khc","to mt np gp i qua mt im v a mt ng ln trn chnh n","to mt np gp i qua im u tin v a im th hai ln ng thng","to mt np gp mang im u tin n ng u tin v im th hai cho ng th hai","to mt np gp mang li mt im cho mt ng v a mt ng th hai ln trn chnh n"],zh:[null,"","","","","","",""]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaa",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"",mountain:"",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",blintz:"",squash:"",flip:""}}},Zc=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(On.core.mag_squared(t)<On.core.EPSILON)return[];for(var o=On.core.normalize(t),i=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return On.core.cross3(e,o)})).sort((function(e,t){return On.core.magnitude(t)-On.core.magnitude(e)})).shift(),c=[On.core.normalize(i)],a=1;a<4;a+=1)c.push(On.core.cross3(c[a-1],o));var u=c.map((function(e){return On.core.scale(e,n)})),s=[-r,r].map((function(e){return On.core.scale(o,e)})),l=0===r?e:e.map((function(e,t){return On.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return On.core.add(e,t)}))})).reduce(ao,[])},Hc=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=Bc.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(ao,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(ao,[]),o=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(ao,[]),i=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(ao,[]).reduce(ao,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(o,3)),c.setIndex(i),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,o=e.edges_coords,i=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=Bc.THREE;o||(o=n.map((function(e){return e.map((function(e){return t[e]}))}))),i||(i=o.map((function(e){return On.core.subtract(e[1],e[0])}))),o=o.map((function(e){return e.map((function(e){return On.core.resize(3,e)}))})),i=i.map((function(e){return On.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(ao,[]).reduce(ao,[]).reduce(ao,[]),d=o.map((function(e,t){return Zc(e,i[t],c,a)})).reduce(ao,[]).reduce(ao,[]),p=i.map((function(e){if(On.core.mag_squared(e)<On.core.EPSILON)throw"degenerate edge";var t=On.core.normalize(e);On.core.scale(t,c);var n=On.core.scale(On.core.normalize(On.core.cross3(e,[0,0,-1])),c),r=On.core.scale(On.core.normalize(On.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(ao,[]).reduce(ao,[]),v=o.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(ao,[]),_=new u.BufferGeometry;return _.setAttribute("position",new u.Float32BufferAttribute(d,3)),_.setAttribute("normal",new u.Float32BufferAttribute(p,3)),_.setAttribute("color",new u.Float32BufferAttribute(l,3)),_.setIndex(v),_.computeVertexNormals(),_}}),$c={init:function init(){}};function SVG(){return $c.init.apply($c,arguments)}var Wc="class",Xc="function",Yc="undefined",Jc="number",Kc="string",Qc="object",ea="svg",ta="path",na="id",ra="style",oa="viewBox",ia="transform",ca="points",aa="stroke",ua="none",sa="arrow",fa="head",la="tail",da=("undefined"==typeof window?"undefined":_typeof(window))!==Yc&&_typeof(window.document)!==Yc,pa=("undefined"==typeof process?"undefined":_typeof(process))!==Yc&&null!=process.versions&&null!=process.versions.node,va=("undefined"==typeof self?"undefined":_typeof(self))===Qc&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,_a=Object.freeze({__proto__:null,isBrowser:da,isNode:pa,isWebWorker:va}),ga=function(){var e={};if(pa){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else da&&(e=window);return e}(),ma="http://www.w3.org/2000/svg",ha={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},ya=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},ba=function arcPath(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==o)return"";var c=ya(r,n),a=ya(o,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],d=Math.atan2(s,l)>0?0:1,p=i?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return p+=["a ",n,n,0,d,1,u[0],u[1]].join(" "),i&&(p+=" Z"),p},Aa=function arcArguments(e,t,n,r,o){return[ba(e,t,n,r,o,!1)]},xa={arc:{nodeName:ta,attributes:["d"],args:Aa,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",Aa.apply(void 0,n))}}}},ka=function wedgeArguments(e,t,n,r,o){return[ba(e,t,n,r,o,!0)]},wa={wedge:{nodeName:ta,args:ka,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",ka.apply(void 0,n))}}}},Ea=128,Oa=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-Ea)/Ea*2+1})).map((function(o){return[e+(o+1)*n*.5,t+Math.pow(o,2)*r]}))},Ca={parabola:{nodeName:"polyline",attributes:[ca],args:function parabolaPathString(e,t,n,r){return[Oa(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Ma=function regularPolygonArguments(e,t,n,r){var o=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return o.map((function(t,n){return t+r*e[n]}))}))},ja={regularPolygon:{nodeName:"polygon",attributes:[ca],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[Ma(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Pa={roundRect:{nodeName:ta,attributes:["d"],args:function roundRectArguments(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o>n/2&&(o=n/2),o>r/2&&(o=r/2);var i=n-2*o,c=r-2*o,a="A".concat(o," ").concat(o," 0 0 1");return["M".concat(e+(n-i)/2,",").concat(t),"h".concat(i),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-o,",").concat(t+r),"h".concat(-i),a,"".concat(e,",").concat(t+r-o),"v".concat(-c),a,"".concat(e+o,",").concat(t)].join(" ")}}},Sa={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},za=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===Xc},Na=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return za(arguments[0])&&_typeof(arguments[0])!==Kc?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return za(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},Ia=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===Jc})).concat(t.filter((function(e){return _typeof(e)===Qc&&null!==e})).map((function(e){return _typeof(e.x)===Jc?[e.x,e.y]:_typeof(e[0])===Jc?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},La=function magnitudeSq2(e){return Math.pow(e[0],2)+Math.pow(e[1],2)},qa=function magnitude2(e){return Math.sqrt(La(e))},Ta=function distanceSq2(e,t){return La(Ba(e,t))},Fa=function distance2(e,t){return Math.sqrt(Ta(e,t))},Va=function add2(e,t){return[e[0]+t[0],e[1]+t[1]]},Ba=function sub2(e,t){return[e[0]-t[0],e[1]-t[1]]},Ga=function scale2(e,t){return[e[0]*t,e[1]*t]},Da=Object.freeze({__proto__:null,magnitudeSq2:La,magnitude2:qa,distanceSq2:Ta,distance2:Fa,add2:Va,sub2:Ba,scale2:Ga}),Ra=[la,fa],Ua=function stringifyPoint(e){return e.join(",")},Za=function pointsToPath(e){return"M"+e.map((function(e){return e.join(",")})).join("L")+"Z"},Ha=function setArrowheadOptions(e,t,n){"boolean"===_typeof(t)?e.options[n].visible=t:_typeof(t)===Qc?(Object.assign(e.options[n],t),null==t.visible&&(e.options[n].visible=!0)):null==t&&(e.options[n].visible=!0)},$a=function setArrowStyle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.getElementsByClassName("".concat(sa,"-").concat(n))[0];Object.keys(t).map((function(e){return{key:e,fn:r[Sa.toCamel(e)]}})).filter((function(e){return _typeof(e.fn)===Xc})).forEach((function(e){return e.fn(t[e.key])}))},Wa=function redraw(e){var t=function makeArrowPaths(e){var t=[[0,1],[2,3]].map((function(t){return t.map((function(t){return e.points[t]||0}))})),n=Ba(t[1],t[0]),r=Va(t[0],Ga(n,.5)),o=qa(n),i=Ra.map((function(t){return e[t].visible?(1+e[t].padding)*e[t].height*2.5:0})).reduce((function(e,t){return e+t}),0);if(o<i){var c=0===o?[i,0]:Ga(n,i/o);t=[Ba,Va].map((function(e){return e(r,Ga(c,.5))})),n=Ba(t[1],t[0])}var a=[n[1],-n[0]],u=Va(r,Ga(a,e.bend)),s=t.map((function(e){return Ba(u,e)})),l=s.map((function(e){return qa(e)})),d=s.map((function(e,t){return 0===l[t]?e:Ga(e,1/l[t])})),p=d.map((function(e){return Ga(e,-1)})),v=p.map((function(e){return[e[1],-e[0]]})),_=Ra.map((function(t,n){return e[t].padding?e[t].padding:e.padding?e.padding:0})),g=Ra.map((function(t,n){return e[t].height*(e[t].visible?1:0)})).map((function(e,t){return e+_[t]})),m=t.map((function(e,t){return Va(e,Ga(d[t],g[t]))}));a=[(n=Ba(m[1],m[0]))[1],-n[0]],r=Va(m[0],Ga(n,.5)),u=Va(r,Ga(a,e.bend));var h=m.map((function(t,n){return Va(t,Ga(Ba(u,t),e.pinch))})),b=Ra.map((function(t,n){return[Va(m[n],Ga(p[n],e[t].height)),Va(m[n],Ga(v[n],e[t].width/2)),Va(m[n],Ga(v[n],-e[t].width/2))]}));return{line:"M".concat(Ua(m[0]),"C").concat(Ua(h[0]),",").concat(Ua(h[1]),",").concat(Ua(m[1])),tail:Za(b[0]),head:Za(b[1])}}(e.options);return Object.keys(t).map((function(t){return{path:t,element:e.getElementsByClassName("".concat(sa,"-").concat(t))[0]}})).filter((function(e){return e.element})).map((function(e){return e.element.setAttribute("d",t[e.path]),e})).filter((function(t){return e.options[t.path]})).forEach((function(t){return t.element.setAttribute("visibility",e.options[t.path].visible?"visible":"hidden")})),e},Xa=function setPoints$3(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.options.points=Ia.apply(void 0,_toConsumableArray(Na.apply(void 0,n))).slice(0,4),Wa(e)},Ya={setPoints:Xa,points:Xa,bend:function bend$1(e,t){return e.options.bend=t,Wa(e)},pinch:function pinch$1(e,t){return e.options.pinch=t,Wa(e)},padding:function padding(e,t){return e.options.padding=t,Wa(e)},head:function head(e,t){return Ha(e,t,fa),$a(e,t,fa),Wa(e)},tail:function tail(e,t){return Ha(e,t,la),$a(e,t,la),Wa(e)},getLine:function getLine(e){return e.getElementsByClassName("".concat(sa,"-line"))[0]},getHead:function getHead(e){return e.getElementsByClassName("".concat(sa,"-").concat(fa))[0]},getTail:function getTail(e){return e.getElementsByClassName("".concat(sa,"-").concat(la))[0]}},Ja=Object.keys({head:{visible:!1,width:8,height:10,padding:0},tail:{visible:!1,width:8,height:10,padding:0},bend:0,padding:0,pinch:.618,points:[]}),Ka=function matchingOptions(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)if(_typeof(t[r])===Qc)for(var o=Object.keys(t[r]),i=0;i<o.length;i++)if(Ja.includes(o[i]))return t[r]},Qa={arrow:{nodeName:"g",attributes:[],args:function args(){return[]},methods:Ya,init:function init(e){e.setAttribute(Wc,sa);var t=["line",la,fa].map((function(t){return SVG.path().setClass("".concat(sa,"-").concat(t)).appendTo(e)}));t[0].setAttribute(ra,"fill:none;"),t[1].setAttribute(aa,ua),t[2].setAttribute(aa,ua),e.options={head:{visible:!1,width:8,height:10,padding:0},tail:{visible:!1,width:8,height:10,padding:0},bend:0,padding:0,pinch:.618,points:[]};for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];Ya.setPoints.apply(Ya,[e].concat(r));var i=Ka.apply(void 0,r);return i&&Object.keys(i).filter((function(e){return Ya[e]})).forEach((function(t){return Ya[t](e,i[t])})),e}}},eu=function makeCurvePath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=[e[0]||0,e[1]||0],o=[e[2]||0,e[3]||0],i=Ba(o,r),c=Va(r,Ga(i,.5)),a=[i[1],-i[0]],u=Va(c,Ga(a,t)),s=Va(r,Ga(Ba(u,r),n)),l=Va(o,Ga(Ba(u,o),n));return"M".concat(r[0],",").concat(r[1],"C").concat(s[0],",").concat(s[1]," ").concat(l[0],",").concat(l[1]," ").concat(o[0],",").concat(o[1])},tu=function getNumbersFromPathCommand(e){return e.slice(1).split(/[, ]+/).map((function(e){return parseFloat(e)}))},nu=function getCurveEndpoints(e){var t=function getMoveTos(e){return e.match(/[Mm][(0-9), .-]+/).map((function(e){return tu(e)}))}(e).shift(),n=function getCurveTos(e){return e.match(/[Cc][(0-9), .-]+/).map((function(e){return tu(e)}))}(e).shift(),r=t?[t[t.length-2],t[t.length-1]]:[0,0],o=n?[n[n.length-2],n[n.length-1]]:[0,0];return[].concat(r,o)},ru=function setPoints$2(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Ia.apply(void 0,_toConsumableArray(Na.apply(void 0,n))).slice(0,4);return e.setAttribute("d",eu(o,e._bend,e._pinch)),e},ou={curve:{nodeName:ta,attributes:["d"],args:function curveArguments(){return[eu(Ia.apply(void 0,_toConsumableArray(Na.apply(void 0,arguments))))]},methods:{setPoints:ru,bend:function bend(e,t){return e._bend=t,ru.apply(void 0,[e].concat(_toConsumableArray(nu(e.getAttribute("d")))))},pinch:function pinch(e,t){return e._pinch=t,ru.apply(void 0,[e].concat(_toConsumableArray(nu(e.getAttribute("d")))))}}}},iu={};Object.assign(iu,xa,wa,Ca,ja,Pa,Qa,ou);var cu=Object.keys(iu),au=[ha.h,ha.p,ha.i],uu=[ha.g,ha.v,ha.t,cu],su={svg:[ha.s,ha.d].concat(au).concat(uu),g:uu,text:[ha.cT],linearGradient:[ha.cG],radialGradient:[ha.cG],defs:au,filter:[ha.cF],marker:uu,symbol:uu,clipPath:uu,mask:uu},fu=Object.create(null);Object.keys(su).forEach((function(e){fu[e]=su[e].reduce((function(e,t){return e.concat(t)}),[])}));var lu=function viewBoxValue(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=1,c=n/i-n,a=e-c-o,u=t-c-o,s=n+2*c+2*o,l=r+2*c+2*o;return[a,u,s,l].join(" ")};function viewBox$1(){var e=Ia.apply(void 0,_toConsumableArray(Na(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?lu.apply(void 0,_toConsumableArray(e)):void 0}var du=function cdata(e){return(new ga.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},pu=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},vu=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},_u=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),vu(e,t)},gu={removeChildren:pu,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(Sa.toKebab(n),t[n])}))}},mu=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},hu=function parse(e){return(new ga.DOMParser).parseFromString(e,"text/xml")},yu=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return mu(e.documentElement)},bu=function sync(e){if(_typeof(e)===Kc||e instanceof String)try{return yu(hu(e))}catch(e){return e}if(null!=e.childNodes)return e},Au=function Load(e){return function isFilename(e){return _typeof(e)===Kc&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&da&&_typeof(ga.fetch)===Xc?function async(e){return new Promise((function(t,n){if(_typeof(e)===Kc||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return yu(hu(e))})).then((function(e){return e.nodeName===ea?e:e.getElementsByTagName(ea)[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof ga.Document)return asyncDone(e)}))}(e):bu(e)};var xu=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:Kc,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=ga.document.createElementNS(ma,ra);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(ga.document.styleSheets)for(var t=0;t<ga.document.styleSheets.length;t+=1){var n=ga.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),o=0;o<r.length;o+=1){var i=r[o];"cssText"in i?e.push(i.cssText):e.push("".concat(i.selectorText," {\n").concat(i.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,o=!1,i=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[i]+n[l],o=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(o=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],o=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],o||(i-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=o?n[l]:u[i++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\//)>-1?c=c+=o?n[l]:u[--i]+n[l]:n[l].search(/\/>/)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[i]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new ga.XMLSerializer).serializeToString(e));return t.download&&da&&!pa&&function downloadInBrowser(e,t){var n=new ga.Blob([t],{type:"text/plain"}),r=ga.document.createElement("a");r.setAttribute("href",ga.URL.createObjectURL(n)),r.setAttribute("download",e),ga.document.body.appendChild(r),r.click(),ga.document.body.removeChild(r)}(t.filename,r),t.output===ea?e:r},ku=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=1===n.length&&_typeof(n[0])===Kc?n[0]:viewBox$1.apply(void 0,n);return o&&e.setAttribute(oa,o),e},wu=function getViewBox(e){var t=e.getAttribute(oa);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},Eu=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var o=r.matrixTransform(e.getScreenCTM().inverse());return[o.x,o.y]},Ou=Object.freeze({__proto__:null,setViewBox:ku,getViewBox:wu,convertToViewBox:Eu}),Cu=function loadSVG(e,t){var n=Au(t);if(null!=n)return _typeof(n.then)===Xc?n.then((function(t){return _u(e,t)})):_u(e,n)},Mu=function getFrame(e){var t=wu(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===Xc){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},ju="svg-background-rectangle",Pu=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(ra);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(ra),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(du(t)),n},Su={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),pu(e)},size:ku,setViewBox:ku,getViewBox:wu,padding:function setPadding(e,t){var n=wu(e);return void 0!==n&&ku.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(Wc)===ju})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(Mu(e))))).setAttribute(Wc,ju),n.setAttribute(aa,ua),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return Mu(e)[2]},getHeight:function getHeight(e){return Mu(e)[3]},stylesheet:function stylesheet(e,t){return Pu.call(this,e,t)},load:Cu,save:xu},zu={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},Nu={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},Iu=Object.values(Nu).reduce((function(e,t){return e.concat(t)}),[]),Lu=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},qu=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return Lu(e,n,t[r])})),e.hasOwnProperty("press"))||Lu(e,"press",(n=zu.math).vector.apply(n,_toConsumableArray(t)))},Tu=function TouchEvents(e){var t=[],n=[];Object.keys(Nu).forEach((function(e){Nu[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){qu(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),qu(e,t)}};Object.keys(Nu).forEach((function(t){var o="on"+Sa.capitalized(t);Object.defineProperty(e,o,{set:function set(o){return null==o?function removeHandler(t){return Nu[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):Nu[t].forEach((function(i){var c=function handlerFunc(n){var i=null!=n.touches?n.touches[0]:n;if(void 0!==i){var c,a=Eu(e,i.clientX,i.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return Lu(n,e,a[t])})),!n.hasOwnProperty("position"))Lu(n,"position",(c=zu.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}o(n)};e.addEventListener&&(n[i].push(c),e.addEventListener(i,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return Iu.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},Fu=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},Vu=function Animation(e){var t,n,r={},o=0,i=function removeHandlers(){ga.cancelAnimationFrame&&ga.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,o=0};Object.defineProperty(e,"play",{set:function set(e){if(i(),null!=e){var c=Fu();r[c]=function handlerFunc(i){t||(t=i,o=0),e({time:.001*(i-t),frame:o}),o+=1,r[c]&&(n=ga.requestAnimationFrame(r[c]))},ga.requestAnimationFrame&&(n=ga.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:i,enumerable:!0})},Bu=[["cx","cy"],["x","y"]],Gu=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),Bu.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},o=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),i=function setPosition(){Ia.apply(void 0,_toConsumableArray(Na.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),_typeof(t.delegate)===Xc&&t.delegate.apply(t.pointsContainer,[o,t.pointsContainer])};return t.delegate=void 0,t.setPosition=i,t.onMouseMove=function(e){return n.selected?i(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(Ta(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),[ea,"updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),o},Du=function controls(e,t,n){var r,o,i=Array.from(Array(t)).map((function(){return Gu(e)})),c=function protocol(e){return _typeof(o)===Xc?o.call(i,e,r,i):void 0};i.forEach((function(e){e.delegate=c,e.pointsContainer=i}));e.onPress=function mousePressedHandler(e){i.length>0&&(r=i.map((function(t,n){return{i:n,d:Ta(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,i[r].selected=!0)},e.onMove=function mouseMovedHandler(e){i.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){i.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(i,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(i,"selected",{get:function get(){return i[r]}}),Object.defineProperty(i,"add",{value:function value(t){i.push(Gu(e))}}),i.removeAll=function(){for(;i.length>0;)i.pop().remove()};var a={onChange:function onChange(e,t){if(o=e,!0===t){var n=i.length-1;e.call(i,i[n],n,i)}},position:function position(e){return i.forEach((function(t,n){return t.setPosition(e.call(i,t,n,i))}))},svg:function svg(e){return i.forEach((function(t,n){t.svg=e.call(i,t,n,i)}))}};return Object.keys(a).forEach((function(e){i[e]=function(){return _typeof(arguments[0])===Xc&&a[e].apply(a,arguments),i}})),i.parent=function(e){return null!=e&&null!=e.appendChild&&i.forEach((function(t){e.appendChild(t.svg)})),i},i},Ru=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Du.call.apply(Du,[e,e].concat(n))}},Uu=(new ga.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,Zu={svg:{args:function args(){return[viewBox$1(Ia.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:Su,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Kc})).forEach((function(t){return Cu(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof Uu})).filter((function(e){return _typeof(e.appendChild)===Xc})).forEach((function(t){return t.appendChild(e)})),Tu(e),Vu(e),Ru(e)}}},Hu=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n.map((function(e){return bu(e)})).filter((function(e){return void 0!==e}));return o.filter((function(e){return e.tagName===ea})).forEach((function(t){return vu(e,t)})),o.filter((function(e){return e.tagName!==ea})).forEach((function(t){return e.appendChild(t)})),e},$u={g:{init:Hu,methods:{load:Hu}}},Wu=Object.assign(Object.create(null),{svg:[oa],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:[ca],polyline:[ca],path:["d"],text:["x","y"],mask:[na],symbol:[na],clipPath:[na,"clip-rule"],marker:[na,"markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),Xu=function setRadius(e,t){return e.setAttribute(Wu.circle[2],t),e},Yu=function setOrigin(e,t,n){return _toConsumableArray(Ia.apply(void 0,_toConsumableArray(Na(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wu.circle[n],t)})),e},Ju=function fromPoints(e,t,n,r){return[e,t,Fa([e,t],[n,r])]},Ku={circle:{args:function args(e,t,n,r){var o=Ia.apply(void 0,_toConsumableArray(Na(e,t,n,r)));switch(o.length){case 0:case 1:return[,,].concat(_toConsumableArray(o));case 2:case 3:return o;default:return Ju.apply(void 0,_toConsumableArray(o))}},methods:{radius:Xu,setRadius:Xu,origin:Yu,setOrigin:Yu,center:Yu,setCenter:Yu,position:Yu,setPosition:Yu}}},Qu=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Wu.ellipse[n],t)})),e},es=function setCenter(e,t,n){return _toConsumableArray(Ia.apply(void 0,_toConsumableArray(Na(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wu.ellipse[n],t)})),e},ts={ellipse:{args:function args(e,t,n,r){var o=Ia.apply(void 0,_toConsumableArray(Na(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(o));default:return o}},methods:{radius:Qu,setRadius:Qu,origin:es,setOrigin:es,center:es,setCenter:es,position:es,setPosition:es}}},ns=function Args$1(e,t,n,r){return Ia.apply(void 0,_toConsumableArray(Na(e,t,n,r))).slice(0,4)},rs={line:{args:ns,methods:{setPoints:function setPoints$1(e,t,n,r,o){return ns(t,n,r,o).forEach((function(t,n){return e.setAttribute(Wu.line[n],t)})),e}}}},os=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,is=/-?[0-9]*\.?\d+/g,cs={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(cs).forEach((function(e){var t=cs[e];cs[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var as=function getD(e){var t=e.getAttribute("d");return null==t?"":t},us=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.setAttribute("d","".concat(as(e)).concat(t).concat(Na.apply(void 0,r).join(" "))),e},ss=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=os.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(is);return e.en=cs[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(as(e))},fs={addCommand:us,appendCommand:us,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:ss,get:ss,getD:function getD(e){return e.getAttribute("d")}};Object.keys(cs).forEach((function(e){fs[cs[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return us.apply(void 0,[t,e].concat(r))}}));var ls={path:{methods:fs}},ds=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Wu.rect[n],t)})),e},ps=function setRectOrigin(e,t,n){return _toConsumableArray(Ia.apply(void 0,_toConsumableArray(Na(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wu.rect[n],t)})),e},vs=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},_s={rect:{args:function args(e,t,n,r){var o=Ia.apply(void 0,_toConsumableArray(Na(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:case 3:return vs([,,].concat(_toConsumableArray(o)));default:return vs(o)}},methods:{origin:ps,setOrigin:ps,center:ps,setCenter:ps,size:ds,setSize:ds}}},gs={style:{init:function init(e,t){e.textContent="",e.appendChild(du(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(du(t)),e}}}},ms={text:{args:function args(e,t,n){return Ia.apply(void 0,_toConsumableArray(Na(e,t,n))).slice(0,2)},init:function init(e,t,n,r,o){var i=[t,n,r,o].filter((function(e){return _typeof(e)===Kc})).shift();i&&e.appendChild(ga.document.createTextNode(i))}}},hs=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===Kc||e instanceof String})).shift()||Fu()},ys=function args(){return[hs.apply(void 0,arguments)]},bs={mask:{args:ys},clipPath:{args:ys},symbol:{args:ys},marker:{args:ys,methods:{size:ku,setViewBox:ku}}},As=function getPoints(e){var t=e.getAttribute(ca);return null==t?"":t},xs=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},ks=function stringifyArgs(){return[xs.apply(void 0,_toConsumableArray(Ia.apply(void 0,_toConsumableArray(Na.apply(void 0,arguments)))))]},ws=function setPoints(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute(ca,ks.apply(void 0,n)[0]),e},Es=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute(ca,[As(e),ks.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},Os=function Args(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===Kc?[arguments.length<=0?void 0:arguments[0]]:ks.apply(void 0,arguments)},Cs={polyline:{args:Os,methods:{setPoints:ws,addPoint:Es}},polygon:{args:Os,methods:{setPoints:ws,addPoint:Es}}},Ms=Object.assign({},Zu,$u,Ku,ts,rs,ls,_s,gs,ms,bs,Cs),js={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(ha).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===Wu[e]})).forEach((function(e){Wu[e]=[]})),[[[ea,"defs","g"].concat(ha.v,ha.t),js.presentation],[["filter"],js.effects],[ha.cT.concat("text"),js.text],[ha.cF,js.effects],[ha.cG,js.gradient]].forEach((function(e){return e[0].forEach((function(t){Wu[t]=Wu[t].concat(e[1])}))}));var Ps=function getClassList(e){if(null==e)return[];var t=e.getAttribute(Wc);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},Ss={addClass:function addClass(e,t){var n=Ps(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,Wc,n.join(" "))},removeClass:function removeClass(e,t){var n=Ps(e).filter((function(e){return e!==t}));e.setAttributeNS(null,Wc,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,Wc,t)},setId:function setId(e,t){e.setAttributeNS(null,na,t)}},zs=function getAttr(e){var t=e.getAttribute(ia);return null==t||""===t?void 0:t},Ns={clearTransform:function clearTransform(e){return e.removeAttribute(ia),e}};["translate","rotate","scale","matrix"].forEach((function(e){Ns[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.setAttribute(ia,[zs(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var Is={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){Is[Sa.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===Kc)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(na);return"url(#".concat(t,")")}return""}(n))}}));var Ls={};(Rc=ha.v).push.apply(Rc,_toConsumableArray(Object.keys(iu))),Object.keys(iu).forEach((function(e){iu[e].attributes=void 0===iu[e].attributes?_toConsumableArray(js.presentation):iu[e].attributes.concat(js.presentation)})),Object.assign(Ls,Ms,iu),Object.keys(ha).forEach((function(e){return ha[e].filter((function(e){return void 0===Ls[e]})).forEach((function(e){Ls[e]={}}))}));var qs=function passthrough(){return Array.from(arguments)};Object.keys(Ls).forEach((function(e){Ls[e].nodeName||(Ls[e].nodeName=e),Ls[e].init||(Ls[e].init=qs),Ls[e].args||(Ls[e].args=qs),Ls[e].methods||(Ls[e].methods={}),Ls[e].attributes||(Ls[e].attributes=Wu[e]||[])}));var Ts=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){Ls[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};Ts(Na(ha.t,ha.v,ha.g,ha.s,ha.p,ha.i,ha.h,ha.d),Ss),Ts(Na(ha.t,ha.v,ha.g,ha.s,ha.p,ha.i,ha.h,ha.d),gu),Ts(Na(ha.v,ha.g,ha.s),Ns),Ts(Na(ha.t,ha.v,ha.g),Is);var Fs={svg:{version:"1.1",xmlns:ma},style:{type:"text/css"}},Vs=function RequiredAttributes(e,t){Fs[t]&&Object.keys(Fs[t]).forEach((function(n){return e.setAttribute(n,Fs[t][n])}))},Bs={},Gs=function constructor(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=ga.document.createElementNS(ma,Ls[e].nodeName);return Vs(c,e),(t=Ls[e]).init.apply(t,[c].concat(o)),(n=Ls[e]).args.apply(n,o).forEach((function(t,n){null!=Ls[e].attributes[n]&&c.setAttribute(Ls[e].attributes[n],t)})),Ls[e].attributes.forEach((function(e){Object.defineProperty(c,Sa.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(Ls[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=Ls[e].methods[t]).call.apply(n,[Bs,c].concat(Array.prototype.slice.call(arguments)))}})})),fu[e]&&fu[e].forEach((function(e){var t=function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t};Ls[e].static&&Object.keys(Ls[e].static).forEach((function(n){t[n]=function(){var t;return(t=Ls[e].static)[n].apply(t,[c].concat(Array.prototype.slice.call(arguments)))}})),Object.defineProperty(c,e,{value:t})})),c};Bs.Constructor=Gs;var Ds={};Object.keys(ha).forEach((function(e){return ha[e].forEach((function(e){Ds[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Gs.apply(void 0,[e].concat(n))}}))}));var Rs=function getFoldObject(e){return e.filter((function(e){return function possibleFoldObject(e){if(_typeof(e)!==Qc)return!1;var t=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(e).map((function(e){return t.includes(e)})).reduce((function(e,t){return e||t}),!1)}(e)})).shift()},Us=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Xc})).forEach((function(t){return t.call(e,e)}))};$c.init=function(){var e=arguments,t=Gs.apply(void 0,[ea].concat(Array.prototype.slice.call(arguments)));return"loading"===ga.document.readyState?ga.document.addEventListener("DOMContentLoaded",(function(){return Us.apply(void 0,[t].concat(_toConsumableArray(e)))})):Us.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t},SVG.NS=ma,SVG.linker=function Linker(e){e.graph&&e.origami&&(e.svg=this,function link_rabbitear_math(e,t){["segment","circle","ellipse","rect","polygon"].filter((function(e){return t[e]&&t[e].prototype})).forEach((function(n){t[n].prototype.svg=function(){return e.path(this.svgPath())}}))}(this,e),function link_rabbitear_graph(e,t){var n="origami";Ls[n]={nodeName:"svg",init:function init(e){for(var n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return(n=t.graph.svg).drawInto.apply(n,[e].concat(o))},args:function args(){return[]},methods:Ls.svg.methods,attributes:Ls.svg.attributes,static:{}},Object.keys(t.graph.svg).forEach((function(e){Ls[n].static[e]=function(n){for(var r,o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];var a=(r=t.graph.svg)[e].apply(r,i);return n.appendChild(a),a}})),fu[n]=_toConsumableArray(fu.svg),fu.svg.push(n),fu.g.push(n),e[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Gs.apply(void 0,[n].concat(t))},Object.keys(t.graph.svg).forEach((function(r){e[n][r]=t.graph.svg[r]}))}(this,e))}.bind(SVG),SVG.use=function use(e){e.origami&&function bindRabbitEar(e,t){zu.math.vector=t.vector}(0,e),e.render_into_svg&&function bindFoldToSvg(e,t){var n=Ls.svg.init;Ls.svg.init=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=Rs(o);if(c){var a=t.options.apply(t,o);t.render_into_svg(e,c,a)}return n.apply(void 0,[e].concat(o))}}(0,e)}.bind(SVG),Object.assign(SVG,Ds),SVG.core=Object.assign(Object.create(null),{load:Au,save:xu,coordinates:Ia,flatten:Na,attributes:Wu,children:fu,cdata:du,detect:_a},Sa,Ss,gu,Da,Ns,Ou);var Zs=Object.assign(e,tc,{math:On.core,axiom:yc,diagram:Cc,vertex:Tc,svg:Dc,text:Uc,webgl:Hc});return Object.defineProperty(Zs,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(Zs)}),Object.keys(On).filter((function(e){return"core"!==e})).forEach((function(e){Zs[e]=On[e]})),SVG.use(Zs),Zs.use(SVG),Zs}));
