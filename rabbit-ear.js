/* Rabbit Ear alpha 4 2021-01-06 (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var e="undefined"!=typeof window&&void 0!==window.document,t="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,n=("object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.constructor&&self.constructor.name,function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}}),r=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},i=function resize_up$1(e,t){var n=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return r(n,e)}))},o=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},c=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return o(n)===Math.min(t,o(e))?e:n},a=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},u=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},s=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},l=Object.freeze({__proto__:null,resize:r,resize_up:i,resize_down:function resize_down(e,t){var n=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return r(n,e)}))},clean_number:c,semi_flatten_arrays:u,flatten_arrays:s}),v=Object.create(null),d=[1,0,0,1],p=d.concat(0,0),h=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},m=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},b=Object.freeze({__proto__:null,identity2x2:d,identity2x3:p,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:h,invert_matrix2:function invert_matrix2(e){var t=h(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:m,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),a=r*o+i*c,u=r*-c+i*o,s=i*o+-r*c,l=i*-c+-r*o,v=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,v,d]}}),k=180/Math.PI,w=Math.PI/180,E=2*Math.PI,M=1e-6,O=Object.freeze({__proto__:null,R2D:k,D2R:w,TWO_PI:E,EPSILON:M}),j=function fn_square(e){return e*e},C=function fn_add(e,t){return e+(t||0)},S=function fn_not_undefined(e){return void 0!==e},P=function fn_vec2_angle(e){return Math.atan2(e[1],e[0])},N=function fn_to_vec2(e){return[Math.cos(e),Math.sin(e)]},I=function magnitude(e){return Math.sqrt(e.map(j).reduce(C,0))},L=function mag_squared(e){return e.map(j).reduce(C,0)},q=function normalize(e){var t=I(e);return 0===t?e:e.map((function(e){return e/t}))},T=function scale(e,t){return e.map((function(e){return e*t}))},F=function add$1(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},V=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},G=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(C,0)},B=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},D=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},R=function lerp(e,t,n){var r=1-n;return e.map((function(e,i){return e*r+(t[i]||0)*n}))},U=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},Z=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},X=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},$=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce((function(e,t){return e+t}),0))},H=function flip(e){return e.map((function(e){return-e}))},Y=function rotate90(e){return[-e[1],e[0]]},W=function rotate270(e){return[e[1],-e[0]]},J=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return Math.abs(e.reduce(C,0))<t},K=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return 1-Math.abs(G(q(e),q(t)))<n},Q=Object.freeze({__proto__:null,magnitude:I,mag_squared:L,normalize:q,scale:T,add:F,subtract:V,dot:G,midpoint:B,average:D,lerp:R,cross2:U,cross3:Z,distance2:X,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},distance:$,flip:H,rotate90:Y,rotate270:W,degenerate:J,parallel:K}),ee=Object.freeze([1,0,0,0,1,0,0,0,1]),te=Object.freeze(ee.concat(0,0,0)),ne=function is_identity3x4(e){return te.map((function(t,n){return Math.abs(t-e[n])<M})).reduce((function(e,t){return e&&t}),!0)},re=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},ie=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},oe=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},ce=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},ae=function invert_matrix3(e){var t=ce(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ue=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ee.concat(e,t,n)},se=function single_axis_rotate(e,t,n,r,i){var o=ee.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return o[3*n+n]=c,o[3*n+r]=(i?1:-1)*a,o[3*r+n]=(i?-1:1)*a,o[3*r+r]=c,o},fe=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,1,2,!0)},le=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,0,2,!1)},ve=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,0,1,!0)},de=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=r(3,q(t)),o=[0,1,2].map((function(e){return n[e]||0})),c=_slicedToArray(i,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),v=Math.sin(e),d=Math.sqrt(i[1]*i[1]+i[2]*i[2]),p=Math.abs(d)<1e-6?0:u/d,h=Math.abs(d)<1e-6?1:s/d,m=ee.concat(-o[0],-o[1],-o[2]),b=ee.concat(o[0],o[1],o[2]),k=[1,0,0,0,h,p,0,-p,h,0,0,0],w=[1,0,0,0,h,-p,0,p,h,0,0,0],E=[d,0,a,0,1,0,-a,0,d,0,0,0],M=[d,0,-a,0,1,0,a,0,d,0,0,0],O=[l,v,0,-v,l,0,0,0,1,0,0,0];return oe(b,oe(w,oe(M,oe(O,oe(E,oe(k,m))))))},pe=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},_e=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),a=r*o+i*c,u=r*-c+i*o,s=i*o+-r*c,l=i*-c+-r*o,v=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,v,d,0]},ge=Object.freeze({__proto__:null,identity3x3:ee,identity3x4:te,is_identity3x4:ne,multiply_matrix3_vector3:re,multiply_matrix3_line3:ie,multiply_matrices3:oe,determinant3:ce,invert_matrix3:ae,make_matrix3_translate:ue,make_matrix3_rotateX:fe,make_matrix3_rotateY:le,make_matrix3_rotateZ:ve,make_matrix3_rotate:de,make_matrix3_scale:pe,make_matrix3_reflectZ:_e}),he=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},me=function get_vector$1(){if(arguments[0]instanceof v.vector)return arguments[0];var e=s(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(S)),e.filter((function(e){return"number"==typeof e}))},ye=function get_vector_of_vectors(){return u(arguments).map((function(e){return me(e)}))},be=function get_segment(){if(arguments[0]instanceof v.segment)return arguments[0];var e=u(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:ye(e)},xe=function get_line(){var e=u(arguments);return 0===e.length?he([],[]):e[0]instanceof v.line||e[0]instanceof v.ray||e[0]instanceof v.segment?e[0]:e[0].constructor===Object?he(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?he(me(e)):he.apply(void 0,_toConsumableArray(e.map((function(e){return me(e)}))))},Ae=xe,ke=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},we=function get_rect(){if(arguments[0]instanceof v.rect)return arguments[0];var e=s(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return ke.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(S)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return ke.apply(void 0,_toConsumableArray(n))},Ee=function get_circle_params(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{radius:e,origin:[].concat(n)}},Me=function get_circle(){if(arguments[0]instanceof v.circle)return arguments[0];var e=ye(arguments),t=s(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length){if(1===e[1].length)return Ee.apply(void 0,[e[1][0]].concat(_toConsumableArray(e[0])));if(1===e[0].length)return Ee.apply(void 0,[e[0][0]].concat(_toConsumableArray(e[1])));if(e[0].length>1&&e[1].length>1)return Ee.apply(void 0,[X.apply(void 0,_toConsumableArray(e))].concat(_toConsumableArray(e[0])))}else switch(t.length){case 0:return Ee(1,0,0,0);case 1:return Ee(t[0],0,0,0);default:return Ee.apply(void 0,[t.pop()].concat(_toConsumableArray(t)))}return Ee(1,0,0,0)},Oe=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete Oe[2][e]}));var je=function matrix_map_3x4(e){return Oe[e<8?0:e<13?1:2]},Ce=function get_matrix_3x4(){var e=s(arguments),t=_toConsumableArray(te);return je(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Se=Object.freeze({__proto__:null,get_vector:me,get_vector_of_vectors:ye,get_segment:be,get_line:xe,get_ray:Ae,get_rect_params:ke,get_rect:we,get_circle:Me,get_matrix_3x4:Ce}),Pe=function fEqual(e,t){return e===t},Ne=function fEpsilonEqual(e,t){return Math.abs(e-t)<M},ze=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce((function(e,t){return e&&t}),!0)},Ie=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),n=e.map((function(e){return r(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return n[0].map((function(e,r){return Math.abs(n[0][r]-n[t+1][r])<M})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)},Le=Object.freeze({__proto__:null,equivalent_vec2:function equivalent_vec2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):ze(arguments,Ne))},equivalent_vectors:Ie,equivalent:function equivalent(){var e=u.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return ze(e,Ne);case"boolean":case"string":return ze(e,Pe);case"object":return e[0].constructor===Array?Ie.apply(void 0,_toConsumableArray(e)):ze(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),qe=function ray_limiter(e){return e<-M?0:e},Te=function segment_limiter(e){return e<-M?0:e>1.000001?1:e},Fe=function smallest_comparison_search(e,t,n){for(var r,i=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),o=1/0,c=0;c<i.length;c+=1)i[c].d<o&&(r=c,o=i[c].d);return r},Ve=function nearest_point_on_line(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;t=r(e.length,t),n=r(e.length,n);var c=L(e),a=V(n,t),u=G(e,a),s=u/c,l=i(s,o);return F(t,T(e,l))},Ge=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return V(n[(t+1)%n.length],e)}));return e.map((function(e,r){return Ve(n[r],e,t,Te)})).map((function(e,n){return{point:e,i:n,distance:$(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},Be=function nearest_point_on_circle(e,t,n){return F(t,T(q(V(n,t)),e))},De=Object.freeze({__proto__:null,ray_limiter:qe,segment_limiter:Te,smallest_comparison_search:Fe,nearest_point2:function nearest_point2(e,t){var n=Fe(e,t,X);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Fe(e,t,$);return void 0===n?void 0:t[n]},nearest_point_on_line:Ve,nearest_point_on_polygon:Ge,nearest_point_on_circle:Be,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),Re=function include_l(){return!0},Ue=function include_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t},Ze=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t&&e<1+t},Xe=function exclude_l(){return!0},$e=function exclude_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t},He=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t&&e<1-t},Ye=function intersect_lines(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=U(e,n),u=-a;if(!(Math.abs(U(q(e),q(n)))<c)){var s=U(V(r,t),n),l=U(V(t,r),e),v=s/a,d=l/u;return i(v,c/I(e))&&o(d,c/I(n))?F(t,T(e,v)):void 0}},We=Object.freeze({__proto__:null,include_l:Re,include_r:Ue,include_s:Ze,exclude_l:Xe,exclude_r:$e,exclude_s:He,intersect_lines:Ye}),Je=function collinear(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=V(e,n),c=L(t);if(Math.sqrt(c)<i)return!1;var a=Math.sqrt(c),u=U(o,t.map((function(e){return e/a}))),s=G(o,t)/c;return Math.abs(u)<i&&r(s,i/a)},Ke=function point_on_line(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Math.abs(U(V(e,n),q(t)))<r},Qe=Object.freeze({__proto__:null,collinear:Je,point_on_line:Ke,point_on_ray_inclusive:function point_on_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Je(e,t,n,Ue,r)},point_on_ray_exclusive:function point_on_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Je(e,t,n,$e,r)},point_on_segment_inclusive:function point_on_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Je(e,V(n,t),t,Ze,r)},point_on_segment_exclusive:function point_on_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Je(e,V(n,t),t,He,r)}}),et=function overlap_lines(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=U(e,n),u=-a;if(Math.abs(a)<c)return Je(r,e,t,i,c)||Je(r,H(e),F(t,e),i,c)||Je(t,n,r,o,c)||Je(t,H(n),F(r,n),o,c);var s=U(V(r,t),n),l=U(V(t,r),e),v=s/a,d=l/u;return i(v,c/I(e))&&o(d,c/I(n))},tt=function overlap_segment_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(V(t,e),e,V(r,n),n,Ze,Ze,i)},nt=function overlap_segment_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(V(t,e),e,V(r,n),n,He,He,i)},rt=Object.freeze({__proto__:null,overlap_lines:et,overlap_line_line_inclusive:function overlap_line_line_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,Re,Re,i)},overlap_line_ray_inclusive:function overlap_line_ray_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,Re,Ue,i)},overlap_line_segment_inclusive:function overlap_line_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,V(r,n),n,Re,Ze,i)},overlap_ray_ray_inclusive:function overlap_ray_ray_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,Ue,Ue,i)},overlap_ray_segment_inclusive:function overlap_ray_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,V(r,n),n,Ue,Ze,i)},overlap_segment_segment_inclusive:tt,overlap_line_line_exclusive:function overlap_line_line_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,Xe,Xe,i)},overlap_line_ray_exclusive:function overlap_line_ray_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,Xe,$e,i)},overlap_line_segment_exclusive:function overlap_line_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,V(r,n),n,Xe,He,i)},overlap_ray_ray_exclusive:function overlap_ray_ray_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,n,r,$e,$e,i)},overlap_ray_segment_exclusive:function overlap_ray_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return et(e,t,V(r,n),n,$e,He,i)},overlap_segment_segment_exclusive:nt}),it=function point_in_convex_poly_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return U(q(V(t[1],t[0])),V(e,t[0]))>-n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},ot=function point_in_convex_poly_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return U(q(V(t[1],t[0])),V(e,t[0]))>n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},ct=function point_in_poly(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++)t[r][1]>e[1]!=t[i][1]>e[1]&&e[0]<(t[i][0]-t[r][0])*(e[1]-t[r][1])/(t[i][1]-t[r][1])+t[r][0]&&(n=!n);return n},at=function overlap_convex_polygons(e,t,n,r,i){for(var o=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),c=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),a=0;a<o.length;a+=1)for(var u=0;u<c.length;u+=1)if(n(o[a][0],o[a][1],c[u][0],c[u][1],i))return!0;return!!r(t[0],e,i)||!!r(e[0],t,i)},ut=function overlap_convex_polygons_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return at(e,t,nt,ot,n)},st=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:it,point_in_convex_poly_exclusive:ot,point_in_poly:ct,overlap_convex_polygons_inclusive:function overlap_convex_polygons_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return at(e,t,tt,it,n)},overlap_convex_polygons_exclusive:ut,enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return it(e,t)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return it(e,t)})).reduce((function(e,t){return e&&t}),!0);return!n&&r}}),ft=function quick_equivalent_2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},lt=function intersect_line_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(e,t,V(r,n),n,Re,Ze,i)},vt=function intersect_line_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(e,t,V(r,n),n,Xe,He,i)},dt=function intersect_ray_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(e,t,V(r,n),n,Ue,Ze,i)},pt=function intersect_ray_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(e,t,V(r,n),n,$e,He,i)},_t=function intersect_seg_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(V(t,e),e,V(r,n),n,Ze,Ze,i)},gt=function intersect_seg_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Ye(V(t,e),e,V(r,n),n,He,He,i)},ht=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=t-e;return n>=0?n:E-(e-t)},mt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],i=Math.atan2(r,n);return i<0&&(i+=E),i},yt=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],i=Math.atan2(r,n);return i<0&&(i+=E),i},bt=function clockwise_bisect2(e,t){return N(P(e)-mt(e,t)/2)},xt=function counter_clockwise_bisect2(e,t){return N(P(e)+yt(e,t)/2)},At=function bisect_lines2(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=U(e,n),c=G(e,n),a=o>-i?[xt(e,n)]:[bt(e,n)];a[1]=o>-i?Y(a[0]):W(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/o,l=[e,n].map((function(e){return q(e)})),v=Math.abs(U.apply(void 0,_toConsumableArray(l)))<i,d=v?B(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],p=a.map((function(e){return{vector:e,origin:d}}));return v&&delete p[c>-i?1:0],p},kt=function counter_clockwise_order_radians(){var e=s(arguments),t=e.map((function(e,t){return t})).sort((function(t,n){return e[t]-e[n]}));return t.slice(t.indexOf(0),t.length).concat(t.slice(0,t.indexOf(0)))},wt=function counter_clockwise_sectors_radians(){var e=s(arguments),t=kt(e).map((function(t){return e[t]}));return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ht(e[0],e[1])}))},Et=function counter_clockwise_subsect_radians(e,t,n){var r=ht(t,n)/e;return Array.from(Array(e-1)).map((function(e,n){return t+r*(n+1)}))},Mt=Object.freeze({__proto__:null,is_counter_clockwise_between:function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=E;for(;e>t;)e-=E;for(;e<t;)e+=E;return e<n},clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=e-t;return n>=0?n:E-(t-e)},counter_clockwise_angle_radians:ht,clockwise_angle2:mt,counter_clockwise_angle2:yt,clockwise_bisect2:bt,counter_clockwise_bisect2:xt,bisect_lines2:At,counter_clockwise_order_radians:kt,counter_clockwise_order2:function counter_clockwise_order2(){return kt(ye(arguments).map(P))},counter_clockwise_sectors_radians:wt,counter_clockwise_sectors2:function counter_clockwise_sectors2(){return wt(ye(arguments).map(P))},counter_clockwise_subsect_radians:Et,counter_clockwise_subsect2:function counter_clockwise_subsect2(e,t,n){var r=Math.atan2(t[1],t[0]),i=Math.atan2(n[1],n[0]);return Et(e,r,i).map(N)}}),Ot=function circumcircle(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+i*(e[1]+t[1]),u=o*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-i*(n[0]-t[0]));if(Math.abs(s)<M){var l=Math.min(e[0],t[0],n[0]),v=Math.min(e[1],t[1],n[1]),d=.5*(Math.max(e[0],t[0],n[0])-l),p=.5*(Math.max(e[1],t[1],n[1])-v);return{origin:[l+d,v+p],radius:Math.sqrt(d*d+p*p)}}var h=[(c*a-i*u)/s,(r*u-o*a)/s],m=h[0]-e[0],b=h[1]-e[1];return{origin:h,radius:Math.sqrt(m*m+b*b)}},jt=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(C,0)},Ct=function centroid(e){var t=1/(6*jt(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],i=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*i,(e[1]+r[1])*i]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},St=function enclosing_rectangle(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return ke(t[0],t[1],r[0],r[1])},Pt=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return E*(n/e)}))},Nt=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return c(e,14)}))}))},zt=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(Pt(e),t)},It=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=Pt(e).map((function(e){return e+n}));return Nt(r,t)},Lt=function split_polygon(){return console.warn("split polygon not done")},qt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:Ke(e,t,n)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),i=e.map((function(e,r,i){return{point:vt(t,n,e,i[(r+1)%i.length]),at_index:r}})).filter((function(e){return null!=e.point}));if(2==i.length){var o=i.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(o[1].at_index+1).concat(e.slice(0,o[0].at_index+1));c.push(o[0].point),c.push(o[1].point);var a=e.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[c,a]}if(1==i.length&&1==r.length){r[0].type="v",i[0].type="e";var u=r.concat(i).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var v=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(v[1].at_index).concat(e.slice(0,v[0].at_index+1)),e.slice(v[0].at_index,v[1].at_index+1)]}return[e.slice()]},Tt=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),i=[];i.push(r[0]);var o=0,c=0,a=function _loop(){c+=1;var e=i.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-i[e][0])<t&&Math.abs(n[1]-i[e][1])<t)})).map((function(t){for(var n=Math.atan2(i[e][1]-t[1],i[e][0]-t[0]);n<o;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(i[e][0]-t.node[0],2)+Math.pow(i[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),i.filter((function(e){return e===n[0].node})).length>0)return{v:i};i.push(n[0].node),o=Math.atan2(i[e][1]-n[0].node[1],i[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},Ft=function recurseSkeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return Ye(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,$e,$e)})),i=t.map((function(e,t){return Ve(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[i[0],r[0]]}]);var o=r.map((function(e,t){return $(e,i[t])})),c=0;o.forEach((function(e,t){e<o[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[i[c],r[c]]}],u=bt(H(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurseSkeleton(e,t,n))},Vt=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:V(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[V(e[0],e[1]),V(e[2],e[1])]})).map((function(e){return bt.apply(void 0,_toConsumableArray(e))}));return Ft(e,t,n)},Gt=Object.freeze({__proto__:null,circumcircle:Ot,signed_area:jt,centroid:Ct,enclosing_rectangle:St,make_regular_polygon:zt,make_regular_polygon_side_aligned:It,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return It(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return It(e,t/2/Math.sin(Math.PI/e))},split_polygon:Lt,split_convex_polygon:qt,convex_hull:Tt,straight_skeleton:Vt}),Bt=function acossafe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},Dt=function rotatePoint(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=r*Math.cos(n)+i*Math.sin(n),c=i*Math.cos(n)-r*Math.sin(n);return[e[0]+o,e[1]+c]},Rt=function circle_circle(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=e.radius<t.radius?e.radius:t.radius,i=e.radius<t.radius?t.radius:e.radius,o=e.radius<t.radius?e.origin:t.origin,c=e.radius<t.radius?t.origin:e.origin,a=[o[0]-c[0],o[1]-c[1]],u=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));if(!(u<n)){var s=a.map((function(e,t){return e/u*i+c[t]}));if(Math.abs(i+r-u)<n||Math.abs(i-(r+u))<n)return[s];if(!(u+r<i||i+r<u)){var l=Bt((r*r-u*u-i*i)/(-2*u*i)),v=Dt(c,s,+l),d=Dt(c,s,-l);return[v,d]}}},Ut=function intersect_circle_line(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:M,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=[-u[1],u[0]],l=[r[0]-t[0],r[1]-t[1]],v=l[0]*u[1]-u[0]*l[1];if(!(Math.abs(v)>e+o)){var d=Math.sqrt(Math.pow(e,2)-Math.pow(v,2)),p=function f(e,n){return t[n]-s[n]*v+u[n]*e},h=Math.abs(e-Math.abs(v))<o?[d].map((function(e){return[e,e].map(p)})):[-d,d].map((function(e){return[e,e].map(p)})),m=h.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return h.filter((function(e,t){return i(m[t],o)}))}},Zt=function line_func(){return!0},Xt=function ray_func(e,t){return e>-t},$t=function segment_func(e,t){return e>-t&&e<1+t},Ht=function circle_line(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Ut(e.radius,e.origin,t.vector,t.origin,Zt,n)},Yt=function circle_ray(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Ut(e.radius,e.origin,t.vector,t.origin,Xt,n)},Wt=function circle_segment(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Ut(e.radius,e.origin,t.vector,t.origin,$t,n)},Jt=Object.freeze({__proto__:null,circle_circle:Rt,intersect_circle_line:Ut,circle_line:Ht,circle_ray:Yt,circle_segment:Wt}),Kt=function cuberoot(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},Qt=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){return v.line(q(V.apply(void 0,_toConsumableArray(i(t,e)))),e)},axiom2:function axiom2(e,t){return v.line(q(Y(V.apply(void 0,_toConsumableArray(i(t,e))))),B(e,t))},axiom3:function axiom3(e,t,n,r){return At(e,t,n,r).map(v.line)},axiom4:function axiom4(e,t){return v.line(Y(q(e)),t)},axiom5:function axiom5(e,t,n,r){return(Ut($(n,r),n,e,t,(function(){return!0}))||[]).map((function(e){return v.line(q(Y(V.apply(void 0,_toConsumableArray(i(e,r))))),B(r,e))}))},axiom7:function axiom7(e,t,n,r){var o=Ye(e,t,n,r,Re,Re);return void 0===o?void 0:v.line(q(Y(V.apply(void 0,_toConsumableArray(i(o,r))))),B(r,o))},axiom6:function axiom6(e,t,n,r,i,o){var c=i[0],a=i[1];if(Math.abs(e[0])>M)var u=e[1]/e[0],s=t[1]-u*t[0];else var l=t[0];var d=o[0],p=o[1];if(Math.abs(n[0])>M)var h=n[1]/n[0],m=r[1]-h*r[0];else var b=r[0];if(void 0!==u&&void 0!==h)var k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=h*h+1,j=2*h*m,C=m*m-d*d-p*p,S=h*c+(s-a),P=c*(m-p)-d*(s-a),N=h-u,I=u*d+(m-p),L=u*c+(s-a);else if(void 0===u&&void 0===h)k=1,w=0,E=l*l-c*c-a*a,O=1,j=0,C=b*b-d*d-p*p,P=a*(b-d)-p*(l-c),N=0,I=b-d,L=S=l-c;else{if(void 0===u){var q=c;c=d,d=q;var T=a;a=p,p=T,u=h,h=void 0,s=m,m=void 0,b=l,l=void 0}k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=1,j=0,C=b*b-d*d-p*p,S=c,P=(s-a)*(b-d)-c*p,N=1,I=-u*(b-d)-p,L=u*c+(s-a)}var F=function solveCubic(e,t,n,r){if(Math.abs(e)<M){if(e=t,t=n,n=r,Math.abs(e)<M)return e=t,t=n,Math.abs(e)<M?[]:[-t/e];var i=t*t-4*e*n;return Math.abs(i)<M?[-t/(2*e)]:i>0?[(-t+Math.sqrt(i))/(2*e),(-t-Math.sqrt(i))/(2*e)]:[]}var o,c=(3*e*n-t*t)/(3*e*e),a=(2*t*t*t-9*e*t*n+27*e*e*r)/(27*e*e*e);if(Math.abs(c)<M)o=[Kt(-a)];else if(Math.abs(a)<M)o=[0].concat(c<0?[Math.sqrt(-c),-Math.sqrt(-c)]:[]);else{var u=a*a/4+c*c*c/27;if(Math.abs(u)<M)o=[-1.5*a/c,3*a/c];else if(u>0){var s=Kt(-a/2-Math.sqrt(u));o=[s-c/(3*s)]}else{var l=2*Math.sqrt(-c/3),v=Math.acos(3*a/c/l)/3,d=2*Math.PI/3;o=[l*Math.cos(v),l*Math.cos(v-d),l*Math.cos(v-2*d)]}}for(var p=0;p<o.length;p+=1)o[p]-=t/(3*e);return o}(O*N*L,(O*I+j*N)*L-(k*S*S+w*S*N+E*N*N),(j*I+C*N)*L-(2*k*S*P+w*(S*I+P*N)+2*E*N*I),C*I*L-(k*P*P+w*P*I+E*I*I)),V=[];if(null!=F&&F.length>0)for(var G=0;G<F.length;++G){if(void 0!==u&&void 0!==h)var B=F[G],D=h*B+m;else D=F[G],B=b;if(D!=p){var R=-1*(B-d)/(D-p),U=(D*D-p*p+B*B-d*d)/(2*(D-p));V.push(v.line.fromPoints([0,U],[1,R]))}else{var Z=(B+d)/2;V.push(v.line.fromPoints([Z,0],[0,1]))}}return V}}),en=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!ft(e[0],e[t]))return[e[0],e[t]]},tn=function convex_poly_line_intersect(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter((function(e){return null!=e}));switch(o.length){case 0:return;case 1:return[o];default:return en(o)||[o[0]]}},nn=function poly_include_exclude_func(e,t,n,r,i){var o,c=tn(e,t,n,r,i);switch(e){case vt:o=lt;break;case pt:o=dt;break;case gt:o=_t;break;case lt:case dt:case _t:default:return c}var a=tn(o,t,n,r,i);if(void 0!==a){var u=en(a);if(void 0===u)switch(e){case vt:return;case pt:return ot(r,t,i)?a:void 0;case gt:return ot(n,t,i)||ot(r,t,i)?a:void 0}return ot(B.apply(void 0,_toConsumableArray(u)),t,i)?u:c}},rn=function convex_poly_line_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(vt,e,t,n,r)},on=function convex_poly_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(pt,e,t,n,r)},cn=function convex_poly_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(gt,e,t,n,r)},an=Object.freeze({__proto__:null,convex_poly_line_inclusive:function convex_poly_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(lt,e,t,n,r)},convex_poly_line_exclusive:rn,convex_poly_ray_inclusive:function convex_poly_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(dt,e,t,n,r)},convex_poly_ray_exclusive:on,convex_poly_segment_inclusive:function convex_poly_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return nn(_t,e,t,n,r)},convex_poly_segment_exclusive:cn}),un=function convexPolyLine(e,t){return rn(e,t.vector,t.origin)},sn=function convexPolyRay(e,t){return on(e,t.vector,t.origin)},fn=function convexPolySegment(e,t){return cn(e,t[0],t[1])},ln=function lineFunc(e,t,n,r,i){return Ye(e.vector,e.origin,t.vector,t.origin,n,r,i)},vn={polygon:{line:un,ray:sn,segment:fn},circle:{circle:Rt,line:Ht,ray:Yt,segment:Wt},line:{polygon:function polygon(e,t){return un(t,e)},circle:function circle(e,t){return Ht(t,e)},line:function line(e,t,n){return ln(e,t,Xe,Xe,n)},ray:function ray(e,t,n){return ln(e,t,Xe,$e,n)},segment:function segment(e,t,n){return ln(e,t,Xe,He,n)}},ray:{polygon:function polygon(e,t){return sn(t,e)},circle:function circle(e,t){return Yt(t,e)},line:function line(e,t,n){return ln(t,e,Xe,$e,n)},ray:function ray(e,t,n){return ln(e,t,$e,$e,n)},segment:function segment(e,t,n){return ln(e,t,$e,He,n)}},segment:{polygon:function polygon(e,t){return fn(t,e)},circle:function circle(e,t){return Wt(t,e)},line:function line(e,t,n){return ln(t,e,Xe,He,n)},ray:function ray(e,t,n){return ln(t,e,$e,He,n)},segment:function segment(e,t,n){return ln(e,t,He,He,n)}}},dn={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},pn=function intersect(e,t){var r,i=dn[n(e)],o=dn[n(t)];return(r=vn[i])[o].apply(r,arguments)},_n=Object.assign(Object.create(null),rt,Qe,st),gn=function get_unique_pair$1(e){for(var t=1;t<e.length;t+=1)if(!ft(e[0],e[t]))return[e[0],e[t]]},hn=function get_unique_points(e){for(var t=[],n=0;n<e.length;n+=1){for(var r=!1,i=0;i<t.length;i+=1)ft(e[n],t[i])&&(r=!0);r||t.push(e[n])}return t},mn=function sortPointsAlongVector(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))},yn=function collinear_check(e,t,n){var r=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return V.apply(void 0,_toConsumableArray(e))}));return r.map((function(e,n){return K(e,t)?n:void 0})).filter(S).map((function(t){return Ke(n,r[t],e[t])})).reduce((function(e,t){return e||t}),!1)},bn=function clip_intersections(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter(S)},xn=function clip_line_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=(bn(vt,e,t,n,r),bn(lt,e,t,n,r));if(void 0!==i){var o=gn(i);if(void 0!==o)return ot(B.apply(void 0,_toConsumableArray(o)),e,r)?o:void 0}},An=function clip_ray_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=(bn(pt,e,t,n,r),bn(dt,e,t,n,r));if(void 0!==i){var o=gn(i);return void 0===o?ot(n,e,r)?[n,i[0]]:void 0:ot(B.apply(void 0,_toConsumableArray(o)),e,r)?o:void 0}},kn=function clip_segment_func(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=[t,n],o=i.map((function(t){return it(t,e,r)}));if(!0===o[0]&&!0===o[1])return[_toConsumableArray(t),_toConsumableArray(n)];var c=bn(_t,e,t,n,r),a=hn(c);if(2===a.length)return a;if(a.length>2){var u=mn(a,V(n,t));return[u[0],u[u.length-1]]}if(c.length>0){var s=i.map((function(t){return ot(t,e,r)}));if(!0===s[0])return[_toConsumableArray(t),c[0]];if(!0===s[1])return[_toConsumableArray(n),c[0]]}},wn=function clip_segment_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=V(n,t);if(!yn(e,i,t))return kn(e,t,n,r)},En=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function clip_line_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=bn(lt,e,t,n,r);switch(i.length){case 0:case 1:return;default:return gn(i)}},clip_line_in_convex_poly_exclusive:xn,clip_ray_in_convex_poly_inclusive:function clip_ray_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=bn(dt,e,t,n,r);if(0!==i.length){it(n,e);return gn(i)||[n,i[0]]}},clip_ray_in_convex_poly_exclusive:An,clip_segment_in_convex_poly_inclusive:function clip_segment_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return kn(e,t,n,r)},clip_segment_in_convex_poly_exclusive:wn}),Mn={preserve:{magnitude:function magnitude(){return I(this)},isEquivalent:function isEquivalent(){return Ie(this,me(arguments))},isParallel:function isParallel(){return K.apply(void 0,_toConsumableArray(i(this,me(arguments))))},dot:function dot(){return G.apply(void 0,_toConsumableArray(i(this,me(arguments))))},distanceTo:function distanceTo(){return $.apply(void 0,_toConsumableArray(i(this,me(arguments))))}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return q(this)},scale:function scale(){return T(this,arguments[0])},flip:function flip(){return H(this)},rotate90:function rotate90(){return Y(this)},rotate270:function rotate270(){return W(this)},cross:function cross(){return Z(r(3,this),r(3,me(arguments)))},transform:function transform(){return re(Ce(arguments),r(3,this))},add:function add(){return F(this,r(this.length,me(arguments)))},subtract:function subtract(){return V(this,r(this.length,me(arguments)))},rotateZ:function rotateZ(e,t){return re(Ce(m(e,t)),r(3,this))},lerp:function lerp(e,t){return R(this,r(this.length,me(e)),t)},midpoint:function midpoint(){return B.apply(void 0,_toConsumableArray(i(this,me(arguments))))},bisect:function bisect(){return xt(this,me(arguments))}}},On={};Object.keys(Mn.preserve).forEach((function(e){On[e]=Mn.preserve[e]})),Object.keys(Mn.vector).forEach((function(e){On[e]=function(){return v.vector.apply(v,_toConsumableArray(Mn.vector[e].apply(this,arguments)))}}));var jn={fromAngle:function fromAngle(e){return v.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return v.vector.fromAngle(e*w)}},Cn={vector:{P:Array.prototype,A:function VectorArgs(){var e=this;me(arguments).forEach((function(t){return e.push(t)}))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:On,S:jn}},Sn={};Sn.prototype=Object.create(Object.prototype),Sn.prototype.constructor=Sn,Sn.prototype.isParallel=function(){var e=i(this.vector,xe.apply(void 0,arguments).vector);return K.apply(void 0,_toConsumableArray(e))},Sn.prototype.isCollinear=function(){var e=xe(arguments);return Ke(e.origin,this.vector,this.origin)&&K.apply(void 0,_toConsumableArray(i(this.vector,e.vector)))},Sn.prototype.isDegenerate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return J(this.vector,e)},Sn.prototype.reflectionMatrix=function(){return v.matrix(_e(this.vector,this.origin))},Sn.prototype.nearestPoint=function(){var e=me(arguments);return v.vector(Ve(this.vector,this.origin,e,this.clip_function))},Sn.prototype.transform=function(){var e=this.dimension,t=ie(Ce(arguments),r(3,this.vector),r(3,this.origin));return this.constructor(r(e,t.vector),r(e,t.origin))},Sn.prototype.translate=function(){var e=F.apply(void 0,_toConsumableArray(i(this.origin,me(arguments))));return this.constructor(this.vector,e)},Sn.prototype.intersect=function(e){return pn(this,e)},Sn.prototype.bisect=function(){var e=xe(arguments);return At(this.vector,this.origin,e.vector,e.origin)},Object.defineProperty(Sn.prototype,"dimension",{get:function get(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}});var Pn={fromPoints:function fromPoints(){var e=ye(arguments);return this.constructor({vector:V(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=ye(arguments);return this.constructor({vector:Y(V(e[1],e[0])),origin:D(e[0],e[1])})}},Nn={line:{P:Sn.prototype,A:function A(){var e=xe.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-e/2)),n=this.vector.scale(e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}},S:Pn}},zn={ray:{P:Sn.prototype,A:function A(){var e=xe.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{flip:function flip(){return v.ray(H(this.vector),this.origin)},scale:function scale(e){return v.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return v.ray(this.vector.normalize(),this.origin)},clip_function:qe,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:Pn}},In={segment:{P:Sn.prototype,A:function A(){var e=be.apply(void 0,arguments);this.points=[v.vector(e[0]),v.vector(e[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function _(){return this.points[0]},1:function _(){return this.points[1]},length:function length(){return this.vector.magnitude()}},M:{clip_function:Te,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=Ce(n),c=this.points.map((function(e){return r(3,e)})).map((function(e){return re(o,e)})).map((function(t){return r(e,t)}));return v.segment(c)},translate:function translate(){var translate=get_vector(arguments),e=this.points.map((function(e){return add.apply(void 0,_toConsumableArray(resize_up(e,translate)))}));return v.segment(e)},midpoint:function midpoint(){return v.vector(D(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},Ln=function pointOnEllipse(e,t,n,r,i,o){var c=Math.cos(i),a=Math.sin(i),u=Math.cos(o),s=Math.sin(o);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},qn=function pathInfo(e,t,n,r,i,o,c){var a=o;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=Ln(e,t,n,r,i,a),l=Ln(e,t,n,r,i,a+u/2),v=Ln(e,t,n,r,i,a+u),d=u/2>Math.PI?1:0,p=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:v[0],y3:v[1],fa:d,fs:p}},Tn=function cln(e){return c(e,4)},Fn=function ellipticalArcTo(e,t,n,r,i,o,c){return"A".concat(Tn(e)," ").concat(Tn(t)," ").concat(Tn(n)," ").concat(Tn(r)," ").concat(Tn(i)," ").concat(Tn(o)," ").concat(Tn(c))},Vn={circle:{A:function CircleArgs(){var e=Me.apply(void 0,arguments);this.radius=e.radius,this.origin=v.vector.apply(v,_toConsumableArray(e.origin))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return v.vector(Be(this.radius,this.origin,me(arguments)))},intersect:function intersect(e){return pn(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=qn(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=Fn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),i=Fn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=Ot.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=Ot.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},Gn=function getFoci(e,t,n,r){var i=t>n,o=i?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(o),a=i?Math.cos(r):Math.sin(r),u=i?Math.sin(r):Math.cos(r);return[v.vector(e[0]+c*a,e[1]+c*u),v.vector(e[0]-c*a,e[1]-c*u)]},Bn={ellipse:{A:function A(){var e=s(arguments).filter((function(e){return!isNaN(e)})),t=r(5,e);this.rx=t[0],this.ry=t[1],this.origin=v.vector(t[2],t[3]),this.spin=t[4],this.foci=Gn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=qn(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=Fn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),i=Fn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return Ln(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},Dn=function makeClip(e){return void 0===e?void 0:v.segment(e)},Rn={area:function area(){return jt(this)},centroid:function centroid(){return v.vector(Ct(this))},enclosingRectangle:function enclosingRectangle(){return v.rect(St(this))},contains:function contains(){return ct(me(arguments),this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ct(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,i){return t[i]+n[i]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ct(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],i=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),o=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(o+e)*i,t[1]+Math.sin(o+e)*i]}));return v.polygon(n)},translate:function translate(){var e=me.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=Ce.apply(void 0,arguments),t=this.map((function(t){return re(e,r(3,t))}));return v.polygon(t)},nearest:function nearest(){var e=me.apply(void 0,arguments),t=Ge(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function overlaps(){var e=u(arguments);return ut(this,e)},split:function split(){var e=xe.apply(void 0,arguments),t=this.isConvex?qt:Lt;return t(this,e.vector,e.origin).map((function(e){return v.polygon(e)}))},intersectLine:function intersectLine(){var e=xe.apply(void 0,arguments);return rn(this,e.vector,e.origin)},intersectRay:function intersectRay(){var e=xe.apply(void 0,arguments);return on(this,e.vector,e.origin)},intersectSegment:function intersectSegment(){var e=be.apply(void 0,arguments);return cn(this,e[0],e[1])},clipLine:function clipLine(){var e=xe.apply(void 0,arguments),t=xn(this,e.vector,e.origin);return Dn(t)},clipRay:function clipRay(){var e=xe.apply(void 0,arguments),t=An(this,e.vector,e.origin);return Dn(t)},clipSegment:function clipSegment(){var e=be.apply(void 0,arguments),t=wn(this,e[0],e[1]);return Dn(t)},clip:function clip(e){switch(n(e)){case"segment":return this.clipSegment(e);case"ray":return this.clipRay(e);case"line":return this.clipLine(e);default:return}},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function intersect(e){return pn(this,e)}},Un={};Un.prototype=Object.create(Array.prototype),Un.prototype.constructor=Un,Object.keys(Rn).forEach((function(e){Un.prototype[e]=Rn[e]}));var Zn=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},Xn={rect:{P:Un.prototype,A:function A(){var e=we.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=v.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(Zn(this)))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return v.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function fromPoints(){return v.rect(St(ye(arguments)))}}}},$n={polygon:{P:Un.prototype,A:function A(){this.push.apply(this,_toConsumableArray(u(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return V(e[1],e[0])}))},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:{segments:function segments(){return this.sides},straightSkeleton:function straightSkeleton(){return Vt(this)}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(zt.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(Tt.apply(void 0,arguments))}}}},Hn=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},Yn={matrix:{P:Array.prototype,A:function A(){var e=this;Ce(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return v.matrix.apply(v,_toConsumableArray(Array.from(this)))},set:function set(){return Hn(this,Ce(arguments))},isIdentity:function isIdentity(){return ne(this)},multiply:function multiply(e){return Hn(this,oe(this,e))},determinant:function determinant(){return ce(this)},inverse:function inverse(){return Hn(this,ae(this))},translate:function translate(e,t,n){return Hn(this,oe(this,ue(e,t,n)))},rotateX:function rotateX(e){return Hn(this,oe(this,fe(e)))},rotateY:function rotateY(e){return Hn(this,oe(this,le(e)))},rotateZ:function rotateZ(e){return Hn(this,oe(this,ve(e)))},rotate:function rotate(e,t,n){var r=de(e,t,n);return Hn(this,oe(this,r))},scale:function scale(e){return Hn(this,oe(this,pe(e)))},reflectZ:function reflectZ(e,t){var n=_e(e,t);return Hn(this,oe(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v.vector(re(this,r(3,me(t))))},transformVector:function transformVector(e){return v.vector(re(this,r(3,me(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=xe(t);return v.line(ie(this,r.vector,r.origin))}},S:{}}},Wn=Object.assign({},Cn,Nn,zn,In,Vn,Bn,Xn,$n,Yn),Jn=function create(e,t){var n=Object.create(Wn[e].proto);return Wn[e].A.apply(n,t),n};Object.assign(v,{vector:function vector(){return Jn("vector",arguments)},circle:function circle(){return Jn("circle",arguments)},ellipse:function ellipse(){return Jn("ellipse",arguments)},rect:function rect(){return Jn("rect",arguments)},polygon:function polygon(){return Jn("polygon",arguments)},line:function line(){return Jn("line",arguments)},ray:function ray(){return Jn("ray",arguments)},segment:function segment(){return Jn("segment",arguments)},matrix:function matrix(){return Jn("matrix",arguments)},junction:function junction(){return Jn("junction",arguments)}}),Object.keys(Wn).forEach((function(e){var t={};t.prototype=null!=Wn[e].P?Object.create(Wn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,v[e].prototype=t.prototype,v[e].prototype.constructor=v[e],Object.keys(Wn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:Wn[e].G[n]})})),Object.keys(Wn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:Wn[e].M[n]})})),Object.keys(Wn[e].S).forEach((function(t){return Object.defineProperty(v[e],t,{value:Wn[e].S[t].bind(v[e].prototype)})})),Wn[e].proto=t.prototype}));var Kn=v;Kn.core=Object.assign(Object.create(null),O,Q,Le,Gt,Mt,b,ge,De,Qt,_n,Se,l,Jt,We,an,En,{intersect_line_seg_include:lt,intersect_line_seg_exclude:vt,intersect_ray_seg_include:dt,intersect_ray_seg_exclude:pt,intersect_seg_seg_include:_t,intersect_seg_seg_exclude:gt}),Kn.typeof=n,Kn.intersect=pn;var Qn=Object.create(null),er=1.1,tr="Rabbit Ear",nr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},rr=Object.freeze([].concat(nr.file).concat(nr.frame).concat(nr.graph).concat(nr.orders)),ir="vertices",or="edges",cr="faces",ar="vertices_coords",ur="edges_assignment",sr="edges_foldAngle",fr={vertices:"vertex",edges:"edge",faces:"face"},lr={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},vr=function edge_assignment_to_foldAngle(e){return lr[e]||0},dr=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},pr=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},_r=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},gr=function get_graph_keys_with_prefix(e,t){return _r(e,"".concat(t,"_"))},hr=function get_graph_keys_with_suffix(e,t){return pr(e,"_".concat(t))},mr=function transpose_graph_arrays(e,t){var n=gr(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),i=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return i.forEach((function(n,r){i[r][t]=e[t][r]}))})),i},yr=function transpose_graph_array_at_index(e,t,n){var r=gr(e,t);if(0!==r.length){var i={};return r.forEach((function(t){i[t]=e[t][n]})),i}},br=function fold_object_certainty(e){return"object"!==_typeof(e)||null===e?0:rr.filter((function(t){return e[t]})).length},xr=Object.freeze({__proto__:null,edges_assignment_degrees:lr,edges_assignment_names:{M:"mountain",m:"mountain",V:"valley",v:"valley",B:"boundary",b:"boundary",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},edge_assignment_to_foldAngle:vr,edge_foldAngle_to_assignment:dr,filter_keys_with_suffix:pr,filter_keys_with_prefix:_r,get_graph_keys_with_prefix:gr,get_graph_keys_with_suffix:hr,transpose_graph_arrays:mr,transpose_graph_array_at_index:yr,fold_object_certainty:br}),Ar=function implied_count(e,t,n){return Math.max(function max_num_in_array_in_arrays(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}(hr(e,t).map((function(t){return e[t]}))),e[n]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[n]):-1)+1};Ar.vertices=function(e){return Ar(e,"vertices")},Ar.edges=function(e){return Ar(e,"edges","edgeOrders")},Ar.faces=function(e){return Ar(e,"faces","faceOrders")};var kr=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,i=e.vertices_sectors,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],v=(l.indexOf(u)+l.length-1)%l.length,d=l[v],p="".concat(s," ").concat(d);if(c[p])return Object.assign(o,c),a.vertices.pop(),a;if(c[p]=!0,o[p])return;a.vertices.push(s),a.edges.push(p),a.angles.push(i[s][v]),u=s,s=d}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},wr=Object.freeze({__proto__:null,planar_vertex_walk:kr}),Er=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return Kn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-Kn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},Mr=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:Kn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},Or=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Er,sort_vertices_along_vector:Mr}),jr=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},Cr=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=zr({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},Sr=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=jr({edges_vertices:r}));var i=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?i:i.map((function(e,n){return Er({vertices_coords:t},e,n)}))},Pr=function make_vertices_faces(e){var t=e.faces_vertices,n=Array.from(Array(Ar.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Nr=function make_vertices_faces_sorted(e){var t=e.vertices_vertices,n=e.faces_vertices,r=Lr({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},zr=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},Ir=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},Lr=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},qr=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;i||(i=Dr({vertices_coords:t,edges_vertices:r}));var o=Ir({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=o["".concat(t," ").concat(e)],r=o["".concat(e," ").concat(t)];return void 0!==n?i[n]:void 0!==r?Kn.core.flip(i[r]):void 0}))}))},Tr=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;return qr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:i}).map((function(e){return 1===e.length?[Kn.core.TWO_PI]:Kn.core.counter_clockwise_sectors2(e)}))},Fr=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,i=e.edges_vertices,o=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=Yr({vertices_coords:n,edges_vertices:i,edges_foldAngle:o,edges_assignment:c,faces_vertices:a,faces_faces:u},t)),r||(r=Pr({faces_vertices:a}));var l=r.map((function(e){return e[0]})).map((function(e){return void 0===e?Kn.core.identity3x4:s[e]}));return n.map((function(e){return Kn.core.resize(3,e)})).map((function(e,t){return Kn.core.multiply_matrix3_vector3(l[t],e)}))},Vr=function make_edges_faces(e){var t=e.faces_edges,n=Array.from(Array(Ar.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Gr={M:-180,m:-180,V:180,v:180},Br=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return Gr[e]||0}))},Dr=function make_edges_vector(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Kn.core.subtract(e[1],e[0])}))},Rr=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=n.map((function(e){return e.map((function(e){return t[e]}))}))),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Ur=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,n=[-t,+t];return Rr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Zr=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,i=e.vertices_sectors,o=e.edges_vertices,c=e.edges_vector;n||(n=Sr({vertices_coords:t,edges_vertices:o,vertices_edges:r})),i||(i=Tr({vertices_coords:t,vertices_vertices:n,edges_vertices:o,edges_vector:c}));var a=zr({edges_vertices:o});return kr({vertices_vertices:n,vertices_sectors:i}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},Xr=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var i=e.length;e.forEach((function(e,o,c){var a=c[(o+1)%i];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},$r=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),i=[],o=r.indexOf(!1),c=o+1;c<r.length;c+=1)r[c]&&i.push(e[c]);for(var a=0;a<o;a+=1)r[a]&&i.push(e[a]);return i},Hr=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Xr({faces_vertices:t})),0===n.length)return[];var i=[[{face:r}]],o={};o[r]=!0;var c=function _loop(){var e=i[i.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){o[e.face]&&(r[t]=!0),o[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return $r(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),i[i.length]=c};do{c()}while(i[i.length-1].length>0);return i.length>0&&0===i[i.length-1].length&&i.pop(),i},Yr=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,i=e.edges_assignment,o=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=i?Br({edges_assignment:i}):Array(n.length).fill(0));var u=zr({edges_vertices:n}),s=o.map((function(){return Kn.core.identity3x4}));return Hr({faces_vertices:o,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,i=e.edge_vertices.map((function(e){return t[e]})),o=e.edge_vertices.join(" "),c=u[o],a=Kn.core.make_matrix3_rotate(r[c]*Math.PI/180,(n=Kn.core).subtract.apply(n,_toConsumableArray(Kn.core.resize_up(i[1],i[0]))),i[0]);s[e.face]=Kn.core.multiply_matrices3(s[e.parent],a)}))})),s},Wr=function make_faces_coloring_from_matrix(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},Jr=Object.freeze({__proto__:null,make_vertices_edges:jr,make_vertices_edges_sorted:Cr,make_vertices_vertices:Sr,make_vertices_faces:Pr,make_vertices_faces_sorted:Nr,make_vertices_to_edge_bidirectional:zr,make_vertices_to_edge:Ir,make_vertices_to_face:Lr,make_vertices_vertices_vector:qr,make_vertices_sectors:Tr,make_vertices_coords_folded:Fr,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),i=n[e[1]].filter((function(e){return e!==t}));return r.concat(i)}))},make_edges_faces:Vr,make_edges_foldAngle:Br,make_edges_assignment:function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_vector:Dr,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return Dr({vertices_coords:t,edges_vertices:n}).map((function(e){return Kn.core.magnitude(e)}))},make_edges_coords_min_max:Rr,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,n=[+t,-t];return Rr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Ur,make_planar_faces:Zr,make_faces_vertices:function make_faces_vertices(e){return Zr(e).map((function(e){return e.vertices}))},make_faces_edges:function make_faces_edges(e){return Zr(e).map((function(e){return e.edges}))},make_faces_faces:Xr,get_face_face_shared_vertices:$r,make_face_spanning_tree:Hr,make_faces_matrix:Yr,make_faces_center:function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Kn.core.centroid(e)}))},make_faces_coloring_from_matrix:Wr,make_faces_coloring:function make_faces_coloring(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[];return i[r]=!0,Hr({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){i[e.face]=t%2==0}))})),i}}),Kr=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=jr({edges_vertices:n}));for(var i=r.map((function(e){return"B"===e||"b"===e})),o=[],c=[],a=-1,u=0;u<i.length;u+=1)if(i[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};i[a]=!1,o.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return i[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];i[a]=!1,o.push(a)}return{vertices:c,edges:o}},Qr=Object.freeze({__proto__:null,get_boundary:Kr,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,i=e.edges_vertices;r||(r=Sr({vertices_coords:t,vertices_edges:n,edges_vertices:i}));var o=zr({edges_vertices:i}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var v=t[l],d=r[l],p=d.map((function(e){return t[e]})).map((function(e){return[e[0]-v[0],e[1]-v[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,h=d[p],m=o[l<h?"".concat(l," ").concat(h):"".concat(h," ").concat(l)];c.push(m);for(var b=l,k=h,w=0;w<1e4;){var E=r[k],M=E.indexOf(b),O=E[(M+1)%E.length],j=o[k<O?"".concat(k," ").concat(O):"".concat(O," ").concat(k)];if(j===c[0])return u;a.push(k),c.push(j),b=k,k=O,w+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),ei=function clip_line(e,t){var n=e.vertices_coords,r=e.vertices_edges,i=e.edges_vertices,o=e.edges_assignment,c=e.boundaries_vertices,a=Kn.typeof(t),u=Kn.core["clip_".concat(a,"_in_convex_poly_exclusive")];if(u){c||(c=Kr({vertices_edges:r,edges_vertices:i,edges_assignment:o}).vertices);var s=c.map((function(e){return n[e]}));return u.apply(void 0,[s].concat(_toConsumableArray(function prepare_clip_func_params(e,t){switch(t){case"line":case"ray":return[e.vector,e.origin];case"segment":return[e[0],e[1]];default:return[]}}(t,a))))}},ti=Object.freeze({__proto__:null,clip_line:ei}),ni=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=Kn.core.resize(n[0].length,t),i=n.map((function(e,t){return{d:Kn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return i?i.i:void 0}},ri=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var i=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return Kn.core.nearest_point_on_line(Kn.core.subtract(e[1],e[0]),e[0],t,Kn.core.segment_limiter)}));return Kn.core.smallest_comparison_search(t,i,Kn.core.distance)}},ii=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var i=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return Kn.core.point_in_poly(t,e.face)})).shift();return void 0===i?void 0:i.i}},oi=ii,ci=Object.freeze({__proto__:null,nearest_vertex:ni,nearest_edge:ri,face_containing_point:ii,nearest_face:oi}),ai=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON;return Ur(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},ui=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,o=Ur({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(o[a][1][0]<o[u][0][0]||o[u][1][0]<o[a][0][0])&&(o[a][1][1]<o[u][0][1]||o[u][1][1]<o[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},si=Object.freeze({__proto__:null,get_edges_vertices_span:ai,get_edges_edges_span:ui}),fi=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,i){r[n][i]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},li=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},vi=function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},di=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:fi,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},invert_map:li,invert_simple_map:vi}),pi=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},_i=function count(e,t){return pi.apply(void 0,_toConsumableArray(gr(e,t).map((function(t){return e[t]}))))};_i.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return pi(t,n,r)},_i.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return pi(t,n,r)},_i.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return pi(t,n,r)};var gi=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},hi=function remove_geometry_indices(e,t,n){var r,i,o,c=_i(e,t),a=gi(n),u=[];for(r=0,i=0,o=0;r<c;r+=1,i+=1){for(;r===a[o];)u[r]=void 0,r+=1,o+=1;r<c&&(u[r]=i)}return hr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,i){e[t][r][i]=u[n]}))}))})),a.reverse(),gr(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},mi=function populate(e){if("object"===_typeof(e)&&e.edges_vertices){if(e.vertices_edges=jr(e),e.vertices_vertices=Sr(e),e.vertices_edges=Cr(e),e.vertices_coords&&(e.edges_vector=Dr(e),e.vertices_sectors=Tr(e)),function set_edges_angles(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=vr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=dr(e.edges_foldAngle[r]);for(var i=e.edges_assignment.length;i<t;i+=1)e.edges_assignment[i]="U",e.edges_foldAngle[i]=0}(e),e.vertices_coords){var t=Zr(e);e.faces_vertices=t.map((function(e){return e.vertices})),e.faces_edges=t.map((function(e){return e.edges})),e.faces_angles=t.map((function(e){return e.angles}))}else e.faces_vertices=[],e.faces_edges=[];return e.vertices_faces=e.vertices_vertices?Nr(e):Pr(e),e.edges_faces=Vr(e),e.faces_faces=Xr(e),e.vertices_coords&&(e.faces_matrix=Yr(e)),e}},yi=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var i=t.map((function(t){return e.vertices_coords.map((function(e){return Kn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),o=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===i[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),i.map((function(e){return void 0===e?o++:e}))},bi=["vertices","edges","faces"],xi=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return Kn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},Ai=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},i=0;i<e.edges_vertices.length;i+=1)r["".concat(e.edges_vertices[i][0]," ").concat(e.edges_vertices[i][1])]=i,r["".concat(e.edges_vertices[i][1]," ").concat(e.edges_vertices[i][0])]=i;for(var o=0;o<t.edges_vertices.length;o+=1){var c=r["".concat(t.edges_vertices[o][0]," ").concat(t.edges_vertices[o][1])];void 0!==c&&(n[o]=c)}return n},ki=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(i,o){return i.forEach((function(i,c){e[t][o][c]=r[n][i]}))}))}))}))},wi=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kn.core.EPSILON,r={},i={},o={};bi.forEach((function(e){r[e]=gr(t,e),i[e]=hr(t,e)})),bi.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),o.vertices=xi(e,t,n),ki(t,i,["vertices"],o);var c=_i.edges(e);o.edges=Array.from(Array(_i.edges(t))).map((function(e,t){return c+t}));var a=Ai(e,t);Object.keys(a).forEach((function(e){o.edges[e]=a[e]}));var u=_i.faces(e);return o.faces=Array.from(Array(_i.faces(t))).map((function(e,t){return u+t})),ki(t,i,["edges","faces"],o),bi.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,i){var c=o[n][i];e[r][c]=t}))}))})),o},Ei=function apply_matrix_to_graph(e,t){return pr(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return Kn.core.resize(3,e)})).map((function(e){return Kn.core.multiply_matrix3_vector3(t,e)}))})),pr(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return Kn.core.multiply_matrices3(e,t)}))})),e},Mi={scale:function transform_scale(e,t){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var c=(n=Kn.core).get_vector.apply(n,i),a=Kn.core.resize(3,c),u=Kn.core.make_matrix3_scale(t,a);return Ei(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=(t=Kn.core).get_vector.apply(t,i),a=Kn.core.resize(3,c),u=(n=Kn.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return Ei(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,i=arguments.length,o=new Array(i>2?i-2:0),c=2;c<i;c++)o[c-2]=arguments[c];var a=(n=Kn.core).get_vector.apply(n,o),u=Kn.core.resize(3,a),s=(r=Kn.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return Ei(e,s)},transform:Ei},Oi=function subgraph(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(i){n[i]=Array.from(Array(_i[i](e))).map((function(e,t){return t})),r[i]=gi(t[i]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return hi(e,t,n[t])})),e},ji=function fn_and(e,t){return e&&t},Ci=function fn_cat(e,t){return e.concat(t)},Si=function fn_def(e){return void 0!==e},Pi=function fn_add(e,t){return e+t},Ni=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,i=t.length,o=Array(i).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},zi=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:Ni}),Ii=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},Li=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},i=0;i<t.length;i+=1){var o="".concat(t[i][0]," ").concat(t[i][1]),c="".concat(t[i][1]," ").concat(t[i][0]);void 0!==r[o]?n[i]=r[o]:(r[o]=i,r[c]=i)}return n},qi=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kn.core.EPSILON,r=e.length,i=0;i<r;i+=1)if(Math.abs(e[i]-t[i])>n)return!1;return!0},Ti=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,r=t.map((function(){return[]})),i=0;i<t.length-1;i+=1)for(var o=i+1;o<t.length;o+=1)r[i][o]=qi(t[i],t[o],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},v=0;v<t.length&&(l(v,v),s!==t.length);v+=1);return a.filter((function(e){return e.length}))},Fi=function remove_isolated_vertices(e){var t=Ni(e);return{map:hi(e,ir,t),remove:t}},Vi=function remove_circular_edges(e){var t=Ii(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),hr(e,or).forEach((function(t){return e[t].forEach((function(r,i){for(var o=r.length-1;o>=0;o-=1)!0===n[r[o]]&&e[t][i].splice(o,1)}))}))}return{map:hi(e,or,t),remove:t}},Gi=function remove_duplicate_edges(e){var t=Li(e),n=Object.keys(t),r=hi(e,or,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Bi=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,n=Ti(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=Kn.core).average.apply(t,_toConsumableArray(e))})),hr(e,ir).forEach((function(t){return e[t].forEach((function(n,i){return e[t][i].forEach((function(n,o){e[t][i][o]=r[n]}))}))})),gr(e,ir).filter((function(e){return e!==ar})).forEach((function(t){return delete e[t]}));var i=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:i}},Di=Object.freeze({__proto__:null,remove_isolated_vertices:Fi,remove_circular_edges:Vi,remove_duplicate_edges:Gi,remove_duplicate_vertices:Bi}),Ri=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var o=ai({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)o[c][a]&&(o[c][a]=Kn.core.point_on_segment_exclusive(t[a],r[c][0],r[c][1],i));return o.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Ui=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,i=e.edges_origin,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON;r||(r=Dr({vertices_coords:t,edges_vertices:n})),i||(i=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=ui({vertices_coords:t,edges_vertices:n},o),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=Kn.core.intersect_lines(r[u],i[u],r[s],i[s],Kn.core.exclude_s,Kn.core.exclude_s,o),c[s][u]=c[u][s]):c[u][s]=void 0;return c},Zi=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return Kn.core.subtract(e[1],e[0])})),i=n.map((function(e){return e[0]})),o=Ui({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:i},1e-6),c=Ri({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==o.reduce(Ci,[]).filter(Si).length||0!==c.reduce(Ci,[]).filter(Si).length){var a={vertices:e.vertices_coords.length};o.forEach((function(t){return t.filter(Si).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),o.forEach((function(e,t){e.forEach((function(e,n){e&&(o[t][n]=e[0])}))}));var u=o.map((function(e){return e.filter(Si)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=Mr({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(Ci,[]);return e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(Ci,[]),e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]||0}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},Xi=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],$i=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[ir,or,cr].map((function(t){return gr(e,t)})).reduce(Ci,[]).filter((function(e){return!Xi.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var i=Bi(e,t/2),o=Gi(e),c=Vi(e),a=Zi(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?i.map:fi(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?fi(o.map,c.map):fi(r.edges.map,o.map,c.map);break}var u=li(a.edges.backmap),s=fi(o.map,c.map,u);r.vertices.map=void 0===r.vertices.map?i.map:fi(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?s:fi(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},Hi=function clone(e){var t,n;if("object"!==_typeof(e))return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},Yi=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var i=Gi(e).map;return r.map((function(e){return i[e]}))},Wi=function split_edge(e,t,n){if(!(e.edges_vertices.length<t)){var r,i=e.edges_vertices[t];if(!n)n=(r=Kn.core).midpoint.apply(r,_toConsumableArray(i));var o=i.map((function(t){return e.vertices_coords[t]})).map((function(e){return Kn.core.distance(e,n)<Kn.core.EPSILON}));if(o[0])return{vertex:i[0],edges:{}};if(o[1])return{vertex:i[1],edges:{}};var c=e.vertices_coords.length;e.vertices_coords[c]=n;var a=[0,1].map((function(t){return t+e.edges_vertices.length}));(function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],i=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];return i.forEach((function(n,r){if([ur,sr].filter((function(n){return void 0!==e[n]&&void 0!==e[n][t]})).forEach((function(r){return n[r]=e[r][t]})),e.edges_faces&&void 0!==e.edges_faces[t]&&(n.edges_faces=_toConsumableArray(e.edges_faces[t])),e.edges_vector){var i=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_vector=Kn.core.subtract(i[1],i[0])}if(e.edges_length){var o,c=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_length=(o=Kn.core).distance2.apply(o,_toConsumableArray(c))}})),i})(e,t,c).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][a[n]]=t[r]}))})),function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,i){var o=i[(n+1)%i.length],c=r[e].indexOf(o);r[e][c]=t})))}(e,c,i),function update_vertices_edges(e,t,n,r,i){var o=e.vertices_edges;o&&(o[r]=_toConsumableArray(i),t.map((function(e){return o[e].indexOf(n)})).forEach((function(e,n){o[t[n]][e]=i[n]})))}(e,i,t,c,a);var u=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,i=e.edges_faces,o=e.faces_edges;if(e.faces_vertices,i&&i[t])return i[t];var c=r[t];if(void 0!==n){for(var a=[],u=0;u<n[c[0]].length;u+=1)for(var s=0;s<n[c[1]].length;s+=1)n[c[0]][u]===n[c[1]][s]&&a.push(n[c[0]][u]);return a}if(o){for(var l=[],v=0;v<o.length;v+=1)for(var d=0;d<o[v].length;d+=1)o[v][d]===t&&l.push(v);return l}}(e,t);u&&(function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))}(e,c,i),function update_faces_vertices(e,t,n,r){var i=e.faces_vertices;i&&t.map((function(e){return i[e]})).forEach((function(e){return e.map((function(e,t,n){var i=(t+1)%n.length;return e===r[0]&&n[i]===r[1]||e===r[1]&&n[i]===r[0]?i:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(t){return e.splice(t,0,n)}))}))}(e,u,c,i),function update_faces_edges(e,t,n,r,i){var o=e.edges_vertices,c=e.faces_edges;c&&t.map((function(e){return c[e]})).forEach((function(e){var t=e.indexOf(i),c=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length],u=[[c,i],[i,a]].map((function(e){var t=e.map((function(e){return o[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==o[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==o[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("something wrong with input graph's faces_edges construction")}));return t===e.length-1?(e.splice(t,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[t,1].concat(_toConsumableArray(s))),s}))}(e,u,c,a,t));var s=hi(e,or,[t]);return a.forEach((function(e,t){a[t]=s[a[t]]})),s.splice(-2),s[t]=a,{vertex:c,edges:{map:s,remove:t}}}},Ji=function split_convex_face(e,t,n,r){var i=function intersect_face_with_line(e,t,n,r){var i=e.vertices_coords,o=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=c[t].map((function(e){return i[e]})).map((function(e){return Kn.core.point_on_line(e,n,r)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).slice(0,2),s=u.map((function(e){return{vertex:c[t][e],face_vertex_index:e}}));if(s.length>1){var l=u[1]-u[0];if(1===(l<0?l+c[t].length:l))return;return{vertices:s,edges:[]}}var v=a[t].map((function(e){return o[e].map((function(e){return i[e]}))})).map((function(e){var t;return(t=Kn.core).intersect_line_seg_exclude.apply(t,[n,r].concat(_toConsumableArray(e)))})).map((function(e,n){return{coords:e,face_edge_index:n,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).slice(0,2);return s.length>0&&v.length>0?{vertices:s,edges:v}:v.length>1?{vertices:[],edges:v}:void 0}(e,t,n,r);if(void 0!==i){var o=i.vertices.map((function(e){return e.vertex})),c=[];i.edges.map((function(t,n,r){t.edge=c.length?c[0].edges.map[t.edge]:t.edge,c.push(Wi(e,t.edge,t.coords))})),o.push.apply(o,_toConsumableArray(c.map((function(e){return e.vertex}))));var a=e.edges_vertices.length,u=[0,1].map((function(t){return e.faces_vertices.length+t-1})),s=function make_edge(e,t,n){var r,i,o=e.vertices_coords,c=t.map((function(e){return o[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=Kn.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(i=Kn.core).subtract.apply(i,_toConsumableArray(c)),edges_faces:_toConsumableArray(n)}}(e,o,u);Object.keys(s).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][a]=s[t]})),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,i=e.edges_vertices,o=i[t][0],c=i[t][1];r[o]=Er({vertices_coords:n},r[o].concat(c),o),r[c]=Er({vertices_coords:n},r[c].concat(o),c)}(e,a);var l=function make_faces(e,t,n){var r=e.edges_vertices,i=e.faces_vertices,o=zr({edges_vertices:r}),c=n.map((function(e){return i[t].indexOf(e)}));return function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(i[t],c).map((function(e){return{faces_vertices:e,faces_edges:e.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return o[e]}))}}))}(e,t,o),v=hi(e,"faces",[t]);if(l.forEach((function(t,n){return Object.keys(t).filter((function(t){return void 0!==e[t]})).forEach((function(r){e[r][u[n]]=t[r]}))})),e.vertices_faces=Pr(e),e.edges_faces=Vr(e),e.faces_faces=Xr(e),2===c.length){var d=vi(c[0].edges.map);c[1].edges.remove=d[c[1].edges.remove]}return v[t]=u,{vertices:o,faces:{map:v,remove:t},edges:{map:fi.apply(void 0,_toConsumableArray(c.map((function(e){return e.edges.map})))),new:a,remove:c.map((function(e){return e.edges.remove}))}}}},Ki=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),i=r.filter((function(e){return t[e]})),o=r.filter((function(e){return!t[e]}));return o.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),i.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=o.length+t})),n},Qi=function get_face_sidedness(e,t,n,r){var i=[n[0]-t[0],n[1]-t[1]],o=e[0]*i[1]-e[1]*i[0];return r?o>0:o<0},eo=function make_face_center_fast(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},to=function prepare_graph_crease(e,t,n,r){var i=_i.faces(e),o=Array.from(Array(i));e["faces_re:layer"]||(e["faces_re:layer"]=Array(i).fill(0)),e["faces_re:preindex"]=o.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=Yr(e,r)),e.faces_coloring=Wr(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return Kn.core.invert_matrix3(e)})).map((function(e){return Kn.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=o.map((function(t,n){return eo(e,n)})),e["faces_re:sidedness"]=o.map((function(t,n){return Qi(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},no=function two_furthest_points(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],i=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<i[1]&&(i=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-i[1])>Math.abs(r[0]-n[0])?[i,t]:[n,r]},ro={M:"V",m:"V",V:"M",v:"M"},io=function opposingCrease(e){return ro[e]||e},oo=function flat_fold(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",o=io(i);if(null==r){var c=ii(e,n);r=void 0===c?0:c}t=Kn.core.resize(3,t),n=Kn.core.resize(3,n),to(e,t,n,r);var a=Hi(e);a.vertices_coords.forEach((function(e){return e.splice(2)}));var u=Array.from(Array(_i.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=a.faces_coloring[t],r=Ji(a,t,a["faces_re:creases"][t].vector,a["faces_re:creases"][t].origin);if(void 0!==r)return a.edges_assignment[r.edges.new]=n?i:o,a.edges_foldAngle[r.edges.new]=n?lr[i]||0:lr[o]||0,r.faces.map[r.faces.remove].forEach((function(t){a.faces_center[t]=eo(a,t),a["faces_re:sidedness"][t]=Qi(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,a.faces_center[t],e.faces_coloring[r.faces.remove]),a["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],a["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();a["faces_re:layer"]=Ki(a["faces_re:layer"],a["faces_re:sidedness"]);var s=void 0===u[0]?0:a["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return a["faces_re:sidedness"][e.new]})).shift().new,l=e.faces_matrix[0];"M"!==i&&"m"!==i&&"V"!==i&&"v"!==i||(l=void 0!==u[0]||e["faces_re:sidedness"][0]?Kn.core.multiply_matrices3(e.faces_matrix[0],Kn.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var v=Yr(a,s).map((function(e){return Kn.core.multiply_matrices3(l,e)}));a.faces_coloring=Wr({faces_matrix:v});var d=Kn.core.multiply_matrix3_line3(l,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),p=Kn.core.normalize(Kn.core.rotate270(d.vector)),h=u.map((function(t,n){return void 0===t?void 0:a.edges_vertices[t.edges.new].map((function(e){return a.vertices_coords[e]})).map((function(t){return Kn.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return a["re:construction"]=0===h.length?{type:"flip",direction:p}:{type:"fold",assignment:i,direction:p,edge:no(h)},a.faces_matrix=v,a["vertices_re:foldedCoords"]=Fr(a,s),a.faces_matrix=v,delete e["faces_re:creases"],delete a["faces_re:creases"],delete e["faces_re:sidedness"],delete a["faces_re:sidedness"],delete e["faces_re:preindex"],delete a["faces_re:preindex"],delete e.faces_coloring,delete a.faces_coloring,delete e.faces_center,delete a.faces_center,a},co=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(Vi(e),Gi(e)),"object"===_typeof(t)&&!0===t.vertices&&Fi(e),e},ao=Object.assign(Object.create(null),{assign:wi,add_vertices:yi,add_vertices_split_edges:function add_vertices_split_edges(e,t){var n=yi(e,t),r=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),i=t.map((function(e){return r.map((function(t){return Kn.core.point_on_segment_exclusive(e,t[0],t[1])})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),o=i.filter((function(e){return void 0!==e})),c=i.map((function(e,t){return{e:e,i:t}})).filter((function(e){return void 0!==e.e})).map((function(t){var r=yr(e,"edges",t.e);return[r,Hi(r)].map((function(r,i){return Object.assign(r,{edges_vertices:[e.edges_vertices[t.e][i],n[t.i]]})}))})).reduce((function(e,t){return e.concat(t)}),[]),a=_i.edges(e),u={new:{edges:[]}};return c.forEach((function(t,n){return Object.keys(t).forEach((function(r){void 0===e[r]&&(e[r]=[]),e[r][a+n]=t[r],u.new.edges[n]=a+n}))})),hi(e,"edges",o),n},add_edges:Yi,split_edge:Wi,split_face:Ji,flat_fold:oo,clean:co,get_circular_edges:Ii,get_duplicate_edges:Li,get_duplicate_vertices:Ti,get_collinear_vertices:Ri,count:_i,implied:Ar,fragment:$i,remove:hi,populate:mi,subgraph:Oi,explode_faces:function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}}},Jr,ti,Mi,Qr,wr,ci,xr,Or,si,di,Di,zi),uo=function best_fit_arrow(e,t){Kr(e).vertices;var n,r=ei(e,t),i=((n=Kn.core).midpoint.apply(n,_toConsumableArray(r)),{vector:Kn.core.rotate90(t.vector),origin:t.origin});return ei(e,i)},so=Object.freeze({__proto__:null,one_crease_arrow:function one_crease_arrow(e,t,n,r){return uo(e,t)}}),fo=function list_function_params(e,t,n){switch(e){case"1":case"2":case 1:case 2:return t;case"3":case 3:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin];case"4":case 4:return[n[0].vector,t[0]];case"5":case 5:return[n[0].vector,n[0].origin,t[0],t[1]];case"6":case 6:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin,t[0],t[1]];case"7":case 7:return[n[0].vector,n[0].origin,n[1].vector,t[0]]}return[]},lo=function arrayify(e,t){switch(e){case"1":case 1:case"2":case 2:case"4":case 4:case"7":case 7:return[t];case"3":case 3:case"5":case 5:case"6":case 6:return t}},vo=function axiom(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.points?n.points.map((function(e){return Kn.core.get_vector(e)})):void 0,i=n.lines?n.lines.map((function(e){return Kn.core.get_line(e)})):void 0,o=(t=Kn.core)["axiom".concat(e)].apply(t,_toConsumableArray(fo(e,r,i)));return lo(e,o)},po=[null,1,2,3,4,5,6,7];delete po[0],Object.keys(po).forEach((function(e){vo[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return vo.apply(void 0,[e].concat(n))}}));var _o=function line_line_for_arrows(e,t){return Kn.core.intersect_lines(e.vector,e.origin,t.vector,t.origin,Kn.core.include_l,Kn.core.include_l)},go=function reflect_point(e,t){var n=Kn.core.make_matrix2_reflect(e.vector,e.origin);return Kn.core.multiply_matrix2_vector2(n,t)},ho=function boundary_for_arrows(e){var t=e.vertices_coords;return Kn.core.convex_hull(t)},mo=function widest_perp(e,t,n){var r=ho(e);if(void 0===n){var i,o=Kn.core.clip_line_in_convex_poly_exclusive(r,t.vector,t.origin);n=(i=Kn.core).midpoint.apply(i,_toConsumableArray(o))}var c=Kn.core.rotate270(t.vector),a=Kn.core.clip_line_in_convex_poly_exclusive(r,c,n).map((function(e){return Kn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=Kn.core.scale(Kn.core.normalize(c),a);return Kn.segment(Kn.core.add(n,Kn.core.flip(u)),Kn.core.add(n,u))},yo=function between_2_segments(e,t,n){var r,i=t.map((function(e){return Kn.core.midpoint(e[0],e[1])})),o=(r=Kn.line).fromPoints.apply(r,_toConsumableArray(i)),c=Kn.intersect(n,o),a=Kn.line(n.vector.rotate90(),c);return Kn.segment(e.lines.map((function(e){return Kn.intersect(e,a)})))},bo=[null,function axiom_1_arrows(e,t){return vo(1,e).map((function(e){return[mo(t,e)]}))},function axiom_2_arrows(e){return[[Kn.segment(e.points)]]},function axiom_3_arrows(e,t){var n=ho(t),r=e.lines.map((function(e){return Kn.core.clip_line_in_convex_poly_exclusive(n,e.vector,e.origin)})),i=Kn.core.intersect_seg_seg_exclude(r[0][0],r[0][1],r[1][0],r[1][1]);return i?vo(3,e).map((function(t){return function between_2_intersecting_segments(e,t,n,r){var i=e.lines.map((function(e){return e.vector})),o=i.map(Kn.core.flip),c=i.concat(o).map((function(e){return Kn.ray(e,t)})),a=c.filter((function(e){return Kn.core.dot(e.vector,n.vector)>0&&Kn.core.cross2(e.vector,n.vector)>0})).shift(),u=c.filter((function(e){return Kn.core.dot(e.vector,n.vector)>0&&Kn.core.cross2(e.vector,n.vector)<0})).shift(),s=c.filter((function(e){return Kn.core.dot(e.vector,n.vector)<0&&Kn.core.cross2(e.vector,n.vector)>0})).shift(),l=c.filter((function(e){return Kn.core.dot(e.vector,n.vector)<0&&Kn.core.cross2(e.vector,n.vector)<0})).shift(),v=[a,u,s,l].map((function(e){return Kn.core.convex_poly_ray_exclusive(r,e.vector,e.origin).shift().shift()})),d=v.map((function(e){return Kn.core.distance(e,t)})),p=d[0]<d[1]?v[0]:v[1],h=d[0]<d[1]?Kn.core.add(u.origin,u.vector.normalize().scale(d[0])):Kn.core.add(a.origin,a.vector.normalize().scale(d[1])),m=d[2]<d[3]?v[2]:v[3],b=d[2]<d[3]?Kn.core.add(l.origin,l.vector.normalize().scale(d[2])):Kn.core.add(s.origin,s.vector.normalize().scale(d[3]));return[Kn.segment(p,h),Kn.segment(m,b)]}(e,i,t,n)})):[yo(e,r,vo(3,e).filter((function(e){return void 0!==e})).shift())]},function axiom_4_arrows(e,t){return vo(4,e).map((function(n){return[mo(t,n,_o(n,e.lines[0]))]}))},function axiom_5_arrows(e){return vo(5,e).map((function(t){return[Kn.segment(e.points[1],go(t,e.points[1]))]}))},function axiom_6_arrows(e){return vo(6,e).map((function(t){return e.points.map((function(e){return Kn.segment(e,go(t,e))}))}))},function axiom_7_arrows(e,t){return vo(7,e).map((function(n){return[Kn.segment(e.points[0],go(n,e.points[0])),mo(t,n,_o(n,e.lines[1]))]}))}];delete bo[0];var xo=function axiom_arrows(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.points?t.points.map((function(e){return Kn.core.get_vector(e)})):void 0,r=t.lines?t.lines.map((function(e){return Kn.core.get_line(e)})):void 0,i=arguments.length,o=new Array(i>2?i-2:0),c=2;c<i;c++)o[c-2]=arguments[c];return bo[e].apply(bo,[{points:n,lines:r}].concat(o))};Object.keys(bo).forEach((function(e){xo[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xo.apply(void 0,[e].concat(n))}}));var Ao=Object.assign(Object.create(null),so,{axiom_arrows:xo}),ko=function maekawa_assignments(e){var t=function get_unassigned_indices(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),i=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-i[t])}))},wo={V:1,v:1,M:-1,m:-1},Eo=function upOrDown(e,t){return t%2==0?wo[e]:-wo[e]},Mo=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},Oo=function get_sectors_layer(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kn.core.EPSILON,r=0,i=e.map((function(e,t){return t%2==0?e:-e})).map((function(e){return r+=e})),o=i.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+n})),c=i.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-n})),a=function test(t){var n=[];t.forEach((function(e,t){n[e]=t}));for(var r=t.length+(t.length===e.length?0:-1),a=function _loop(e){var r=(e+1)%t.length,a=Mo(t,n[e],n[r]),u=a.map((function(t){return i[e]<o[t]})).reduce(ji,!0),s=a.map((function(t){return i[e]>c[t]})).reduce(ji,!0);if(!u&&!s)return{v:!1}},u=0;u<r;u+=1){var s=a(u);if("object"===_typeof(s))return s.v}return!0},u=function final_test(e){var n=vi(e);return n[0]>n[n.length-1]?"M"===t[0]:"V"===t[0]},s=function recurse(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n=n.slice(0,i).concat([r],n.slice(i,n.length)),!a(n))return[];if(r>=e.length-1)return u(n)?[n]:[];var o=Eo(t[(r+1)%e.length],r),c=1===o?Array.from(Array(n.length-i)).map((function(e,t){return i+t+1})):Array.from(Array(i+1)).map((function(e,t){return t}));return c.map((function(e){return recurse(n,r+1,e)})).reduce((function(e,t){return e.concat(t)}),[]).map(vi)};return s()},jo=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var i=0;i<e.length;i+=1){if(t>n&&("V"===e[i]||"v"===e[i]))return i;if(n>t&&("M"===e[i]||"m"===e[i]))return i}},Co=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(Pi,0)}))},So=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){var t;return(t=Kn.core).counter_clockwise_angle_radians.apply(t,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return Co(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return Kn.core.is_counter_clockwise_between(t,e[n],e[(n+1)%e.length])?t:void 0}))},Po=Object.freeze({__proto__:null,alternating_sum:Co,alternating_sum_difference:function alternating_sum_difference(e){var t=e.reduce(Pi,0)/2;return Co(e).map((function(e){return e-t}))},kawasaki_solutions_radians:So,kawasaki_solutions:function kawasaki_solutions(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return So(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))}}),No=Object.assign(Object.create(null),{maekawa_assignments:ko,sectors_layer:Oo,layer_solver:function layer_solver(e,t){null==t&&(t=e.map((function(){return"U"})));var n=ko(t),r=n.map((function(t){return Oo(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},fold_angles4:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=jo(t);if(void 0!==r){var i=e[(r+1)%e.length],o=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(i)*Math.cos(o)+Math.sin(i)*Math.sin(o)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(i)*Math.sin(o)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},Po),zo=Object.create(null),Io=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},Lo=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},qo=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var i=r+1;i<e.length;i+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][i])return!1;return!0}})},To=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Fo={vertices:function setup_vertex(e,t){return Io.call(this,e,t),e},edges:function setup_edge(e,t){return Lo.call(this,e,t),e},faces:function setup_face(e,t){return qo.call(this,e,t),To.call(this,e,t),e}},Vo={};Vo.prototype=Object.create(Object.prototype),Vo.prototype.constructor=Vo;var Go=Object.assign({clean:co,populate:mi,fragment:$i,subgraph:Oi,assign:wi},Mi);Object.keys(Go).forEach((function(e){Vo.prototype[e]=function(){return Go[e].apply(Go,[this].concat(Array.prototype.slice.call(arguments)))}})),Vo.prototype.copy=function(){return Object.assign(Object.create(Vo.prototype),Hi(this))},Vo.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===_typeof(e)&&(!0!==n.append&&rr.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:er,file_creator:tr},Hi(e)))},Vo.prototype.clear=function(){var e=this;nr.graph.forEach((function(t){return delete e[t]})),nr.orders.forEach((function(t){return delete e[t]})),delete this.file_frames};var Bo=function shortenKeys(e,t,n){var r=this,i=Object.create(null);return Object.keys(e).forEach((function(t){i[t.substring(r.length+1)]=e[t]})),i},Do=function getComponent(e){return mr(this,e).map(Bo.bind(e)).map(Fo[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Vo.prototype,e,{get:function get(){return Do.call(this,e)}})})),Object.defineProperty(Vo.prototype,"junctions",{get:function get(){return qr(this).map((function(e){return Kn.junction.apply(Kn,_toConsumableArray(e))}))}}),Object.defineProperty(Vo.prototype,"boundary",{get:function get(){var e=this,t=Kr(this),n=Kn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}});var Ro={vertices:ni,edges:ri,faces:ii},Uo=function nearestElement(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=(t=Kn.core).get_vector.apply(t,r),c=Ro[e](this,o),a=yr(this,e,c);return Fo[e].call(this,a,c),a.index=c,a};Vo.prototype.nearest=function(){var e=arguments,t=this,n=Object.create(null);return["vertices","edges","faces"].forEach((function(r){return Object.defineProperty(n,fr[r],{get:function get(){return Uo.call.apply(Uo,[t,r].concat(_toConsumableArray(e)))}})})),n};var Zo=Vo.prototype,Xo={};Xo.prototype=Object.create(Zo),Xo.prototype.constructor=Xo;Xo.prototype.copy=function(){return Object.assign(Object.create(Xo.prototype),Hi(this))};var $o=function edges_array(e){var t=this;return e.mountain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-180;return e.forEach((function(e){t.edges_assignment[e]="M",t.edges_foldAngle[e]=n})),e},e.valley=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180;return e.forEach((function(e){t.edges_assignment[e]="V",t.edges_foldAngle[e]=n})),e},e.flat=function(){return e.forEach((function(e){t.edges_assignment[e]="F",t.edges_foldAngle[e]=0})),e},e};["line","ray","segment"].forEach((function(e){Xo.prototype[e]=function(){var t=Kn[e].apply(Kn,arguments);if(t){var n=ei(this,t);if(n){var r=yi(this,n),i=Yi(this,r),o=$i(this).edges.map;return mi(this),$o.call(this,i.map((function(e){return o[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){Xo.prototype[e]=function(){var t=this,n=Kn[e].apply(Kn,arguments);if(n){var r=n.segments(96).map((function(e){return Kn.segment(e)})).map((function(e){return ei(t,e)})).filter((function(e){return void 0!==e}));if(r){var i=[],o=[];r.forEach((function(e){var n=yi(t,e);i.push.apply(i,_toConsumableArray(n)),o.push.apply(o,_toConsumableArray(Yi(t,n)))}));var c=$i(this).edges.map;return mi(this),$o.call(this,o.map((function(e){return c[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}}));var Ho=Xo.prototype,Yo={};Yo.prototype=Object.create(Zo),Yo.prototype.constructor=Yo,Yo.prototype.flatFold=function(){var e=this,t=Kn.core.get_line(arguments),n=oo(this,t.vector,t.origin);return[ir,or,cr].map((function(t){return gr(e,t)})).reduce(Ci,[]).forEach((function(t){return delete e[t]})),Object.assign(this,n),this},Yo.prototype.copy=function(){return Object.assign(Object.create(Yo.prototype),Hi(this))},Yo.prototype.folded=function(){var e=Fr(this);return Object.assign(Object.create(Yo.prototype),Object.assign(Hi(this),{vertices_coords:e}))};var Wo=Yo.prototype,Jo=function make_polygon_vertices(e){return 4===e?[[0,0],[1,0],[1,1],[0,1]]:Kn.core.make_regular_polygon(e,.5/Math.sin(Math.PI/e))},Ko={},Qo=[null,null,null,"triangle","square","pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];[0,1,2].forEach((function(e){delete Qo[e]}));var ec=function create_init(e){return mi(e)};Qo.forEach((function(e,t){var n=Array.from(Array(t));Ko[e]=function(){return ec({vertices_coords:Jo(t),edges_vertices:n.map((function(e,t){return[t,(t+1)%n.length]})),edges_assignment:n.map((function(){return"B"}))})}})),Ko.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return ec({vertices_coords:Kn.core.make_regular_polygon(e,1),edges_vertices:Array.from(Array(e)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(e)).map((function(){return"B"}))})},Ko.kite=function(){return ec({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:["B","B","B","B","B","B","V","V","F"]})};var tc={axioms:{ar:[null,"   ","        ","        ","          ","         ","            ","          "],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una lnea entre dos puntos","dobla dos puntos juntos","dobla y une dos lneas","dobla una lnea sobre s misma, doblndola hacia un punto","dobla un punto hasta una lnea, doblndola a travs de otro punto","dobla un punto hacia una lnea y otro punto hacia otra lnea","dobla un punto hacia una lnea y otra lnea sobre s misma"],fr:[null,"crez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-mme  l'aide d'un pli qui passe par un point","rabattez un point sur une ligne  l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-mme"],hi:[null,"        ","         ","        ","                  ","                 ","                   ","                      "],jp:[null,"2","2","2","","","",""],ko:[null,"    ","   ","   ","      ","  ,    ","       ","       "],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto at uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto at uma linha e outro ponto at outra linha","dobre um ponto at uma linha e outra linha sobre si mesma"],ru:[null,"    ","   ","   ","   ,   ","   ,    ","         ","        "],tr:[null,"iki noktadan geen bir izgi boyunca katla","iki noktay birbirine katla","iki izgiyi birbirine katla","bir noktadan kvrarak kendi zerindeki bir izgi boyunca katla","baka bir noktadan kvrarak bir noktay bir izgiye katla","bir noktay bir izgiye ve baka bir noktay baka bir izgiye katla","bir noktay bir izgiye ve baka bir izgiyi kendi zerine katla"],vi:[null,"to mt np gp i qua hai im","to np gp bng cch gp mt im ny sang im khc","to np gp bng cch gp mt ng ln mt ng khc","to mt np gp i qua mt im v a mt ng ln trn chnh n","to mt np gp i qua im u tin v a im th hai ln ng thng","to mt np gp mang im u tin n ng u tin v im th hai cho ng th hai","to mt np gp mang li mt im cho mt ng v a mt ng th hai ln trn chnh n"],zh:[null,"","","","","","",""]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaa",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"",mountain:"",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",blintz:"",squash:"",flip:""}}},nc=function(){var n={};if(t){var r=require("xmldom"),i=r.DOMParser,o=r.XMLSerializer;n.DOMParser=i,n.XMLSerializer=o,n.document=(new i).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else e&&(n=window);return n}(),rc=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Kn.core.mag_squared(t)<Kn.core.EPSILON)throw"degenerate edge";for(var i=Kn.core.normalize(t),o=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return Kn.core.cross3(e,i)})).sort((function(e,t){return Kn.core.magnitude(t)-Kn.core.magnitude(e)})).shift(),c=[Kn.core.normalize(o)],a=1;a<4;a+=1)c.push(Kn.core.cross3(c[a-1],i));var u=c.map((function(e){return Kn.core.scale(e,n)})),s=[-r,r].map((function(e){return Kn.core.scale(i,e)})),l=0===r?e:e.map((function(e,t){return Kn.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return Kn.core.add(e,t)}))})).reduce(Ci,[])},ic=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=nc.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(Ci,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(Ci,[]),i=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(Ci,[]),o=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(Ci,[]).reduce(Ci,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(i,3)),c.setIndex(o),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,i=e.edges_coords,o=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=nc.THREE;i||(i=n.map((function(e){return e.map((function(e){return t[e]}))}))),o||(o=i.map((function(e){return Kn.core.subtract(e[1],e[0])}))),i=i.map((function(e){return e.map((function(e){return Kn.core.resize(3,e)}))})),o=o.map((function(e){return Kn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(Ci,[]).reduce(Ci,[]).reduce(Ci,[]),v=i.map((function(e,t){return rc(e,o[t],c,a)})).reduce(Ci,[]).reduce(Ci,[]),d=o.map((function(e){if(Kn.core.mag_squared(e)<Kn.core.EPSILON)throw"degenerate edge";var t=Kn.core.normalize(e),n=(Kn.core.scale(t,c),Kn.core.scale(Kn.core.normalize(Kn.core.cross3(e,[0,0,-1])),c)),r=Kn.core.scale(Kn.core.normalize(Kn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(Ci,[]).reduce(Ci,[]),p=i.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(Ci,[]),h=new u.BufferGeometry;return h.setAttribute("position",new u.Float32BufferAttribute(v,3)),h.setAttribute("normal",new u.Float32BufferAttribute(d,3)),h.setAttribute("color",new u.Float32BufferAttribute(l,3)),h.setIndex(p),h.computeVertexNormals(),h}}),oc=function reflect_point(e,t){var n=Kn.core.make_matrix2_reflect(e.vector,e.origin);return Kn.core.multiply_matrix2_vector2(n,t)},cc=function test_axiom1_2(e,t){return[e.points.map((function(e){return Kn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},ac=[null,cc,cc,function test_axiom3(e,t){return[!0,!0]},function test_axiom4(e,t){var n=Kn.core.intersect_lines(e.lines[0].vector,e.lines[0].origin,Kn.core.rotate90(e.lines[0].vector),e.points[0],Kn.core.include_l,Kn.core.include_l);return[[e.points[0],n].map((function(e){return Kn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},function test_axiom5(e,t){var n=Kn.core.axiom5(e.lines[0].vector,e.lines[0].origin,e.points[0],e.points[1]);if(0===n.length)return[];var r=e.points.map((function(e){return Kn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0);return n.map((function(t){return oc(t,e.points[1])})).map((function(e){return Kn.core.point_in_convex_poly_inclusive(e,t)})).map((function(e){return e&&r}))},function test_axiom6(e,t){return[!0,!0,!0]},function test_axiom7(e,t){var n=Kn.core.point_in_convex_poly_inclusive(e.points[0],t),r=Kn.core.axiom7(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.points[0]),i=oc(r,e.points[0]),o=Kn.core.point_in_convex_poly_inclusive(i,t),c=void 0!==Kn.core.convex_poly_line_inclusive(t,e.lines[1].vector,e.lines[1].origin);return[n&&o&&c]}];delete ac[0];var uc,sc=function test_axiom(e,t,n){var r="object"===_typeof(n)&&n.vertices_coords?Kr(n).vertices.map((function(e){return n.vertices_coords[e]})):n;return ac[e](t,r)};Object.keys(ac).forEach((function(e){sc[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sc.apply(void 0,[e].concat(n))}}));var fc={};["number","object","transform","class","style","function","string","undefined","boolean","path","svg","id","viewBox"].forEach((function(e){return fc[e]=e}));var lc=("undefined"==typeof window?"undefined":_typeof(window))!==fc.undefined&&_typeof(window.document)!==fc.undefined,vc=("undefined"==typeof process?"undefined":_typeof(process))!==fc.undefined&&null!=process.versions&&null!=process.versions.node,dc=("undefined"==typeof self?"undefined":_typeof(self))===fc.object&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,pc=Object.freeze({__proto__:null,isBrowser:lc,isNode:vc,isWebWorker:dc}),_c=function(){var e={};if(vc){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else lc&&(e=window);return e}(),gc="http://www.w3.org/2000/svg",hc={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},mc=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},yc=function arcPath(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==i)return"";var c=mc(r,n),a=mc(i,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],v=Math.atan2(s,l)>0?0:1,d=o?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return d+=["a ",n,n,0,v,1,u[0],u[1]].join(" "),o&&(d+=" Z"),d},bc=function arcArguments(e,t,n,r,i){return[yc(e,t,n,r,i,!1)]},xc={arc:{nodeName:"path",attributes:["d"],args:bc,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",bc.apply(void 0,n))}}}},Ac=function wedgeArguments(e,t,n,r,i){return[yc(e,t,n,r,i,!0)]},kc={wedge:{nodeName:"path",args:Ac,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",Ac.apply(void 0,n))}}}},wc=128,Ec=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-wc)/wc*2+1})).map((function(i){return[e+(i+1)*n*.5,t+Math.pow(i,2)*r]}))},Mc={parabola:{nodeName:"polyline",attributes:["points"],args:function parabolaPathString(e,t,n,r){return[Ec(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Oc=function regularPolygonArguments(e,t,n,r){var i=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return i.map((function(t,n){return t+r*e[n]}))}))},jc={regularPolygon:{nodeName:"polygon",attributes:["points"],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[Oc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Cc={roundRect:{nodeName:"path",attributes:["d"],args:function roundRectArguments(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;i>n/2&&(i=n/2),i>r/2&&(i=r/2);var o=n-2*i,c=r-2*i,a="A".concat(i," ").concat(i," 0 0 1");return["M".concat(e+(n-o)/2,",").concat(t),"h".concat(o),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-i,",").concat(t+r),"h".concat(-o),a,"".concat(e,",").concat(t+r-i),"v".concat(-c),a,"".concat(e+i,",").concat(t)].join(" ")}}},Sc=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===fc.function},Pc=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return Sc(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return Sc(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},Nc=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===fc.number})).concat(t.filter((function(e){return _typeof(e)===fc.object&&null!==e})).map((function(e){return _typeof(e.x)===fc.number?[e.x,e.y]:_typeof(e[0])===fc.number?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},zc=function add(e,t){return[e[0]+t[0],e[1]+t[1]]},Ic=function sub(e,t){return[e[0]-t[0],e[1]-t[1]]},Lc=function scale(e,t){return[e[0]*t,e[1]*t]},qc=function curveArguments(){var e=Nc.apply(void 0,_toConsumableArray(Pc.apply(void 0,arguments))),t=e.slice(0,4);if(!t.length)return[""];var n=e[4]||0,r=e[5]||.5,i=[t[0],t[1]],o=[t[2],t[3]],c=Ic(o,i),a=zc(i,Lc(c,.5)),u=[c[1],-c[0]],s=zc(a,Lc(u,n)),l=zc(i,Lc(Ic(s,i),r)),v=zc(o,Lc(Ic(s,o),r));return["M".concat(i[0],",").concat(i[1],"C").concat(l[0],",").concat(l[1]," ").concat(v[0],",").concat(v[1]," ").concat(o[0],",").concat(o[1])]},Tc={bend:function bend(e,t){return e.setAttribute("d",qc.apply(void 0,_toConsumableArray(function getEndpoints(e){var t=e.getAttribute("d");return null==t||""===t?[]:[t.slice(t.indexOf("M")+1,t.indexOf("C")).split(","),t.split(" ").pop().split(",")].map((function(e){return e.map((function(e){return parseFloat(e)}))}))}(e)).concat([t]))),e}},Fc={curve:{nodeName:"path",attributes:["d"],args:qc,methods:Tc}},Vc={};Object.assign(Vc,xc,kc,Mc,jc,Cc,Fc);var Gc=Object.keys(Vc),Bc=[hc.h,hc.p,hc.i],Dc=[hc.g,hc.v,hc.t,Gc],Rc={svg:[hc.s,hc.d].concat(Bc).concat(Dc),g:Dc,text:[hc.cT],linearGradient:[hc.cG],radialGradient:[hc.cG],defs:Bc,filter:[hc.cF],marker:Dc,symbol:Dc,clipPath:Dc,mask:Dc},Uc=Object.create(null);Object.keys(Rc).forEach((function(e){Uc[e]=Rc[e].reduce((function(e,t){return e.concat(t)}),[])}));var Zc=Object.freeze(Uc),Xc={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},$c=function viewBoxValue(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,a=e-c-i,u=t-c-i,s=n+2*c+2*i,l=r+2*c+2*i;return[a,u,s,l].join(" ")};function viewBox(){var e=Nc.apply(void 0,_toConsumableArray(Pc(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?$c.apply(void 0,_toConsumableArray(e)):void 0}var Hc=function cdata(e){return(new _c.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},Yc=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},Wc=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},Jc=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),Wc(e,t)},Kc={removeChildren:Yc,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(Xc.toKebab(n),t[n])}))}},Qc=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},ea=function parse(e){return(new _c.DOMParser).parseFromString(e,"text/xml")},ta=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return Qc(e.documentElement)},na=function sync(e){if(_typeof(e)===fc.string||e instanceof String)try{return ta(ea(e))}catch(e){return e}if(null!=e.childNodes)return e},ra=function Load(e){return function isFilename(e){return _typeof(e)===fc.string&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&lc&&_typeof(_c.fetch)===fc.function?function async(e){return new Promise((function(t,n){if(_typeof(e)===fc.string||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return ta(ea(e))})).then((function(e){return"svg"===e.nodeName?e:e.getElementsByTagName("svg")[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof _c.Document)return asyncDone(e)}))}(e):na(e)};var ia=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:fc.string,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=_c.document.createElementNS(gc,fc.style);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(_c.document.styleSheets)for(var t=0;t<_c.document.styleSheets.length;t+=1){var n=_c.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),i=0;i<r.length;i+=1){var o=r[i];"cssText"in o?e.push(o.cssText):e.push("".concat(o.selectorText," {\n").concat(o.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[o]+n[l],i=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(i=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],i=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],i||(o-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=i?n[l]:u[o++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\//)>-1?c=c+=i?n[l]:u[--o]+n[l]:n[l].search(/\/>/)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[o]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new _c.XMLSerializer).serializeToString(e));return t.download&&lc&&!vc&&function downloadInBrowser(e,t){var n=new _c.Blob([t],{type:"text/plain"}),r=_c.document.createElement("a");r.setAttribute("href",_c.URL.createObjectURL(n)),r.setAttribute("download",e),_c.document.body.appendChild(r),r.click(),_c.document.body.removeChild(r)}(t.filename,r),"svg"===t.output?e:r},oa=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=1===n.length&&"string"==typeof n[0]?n[0]:viewBox.apply(void 0,n);return i&&e.setAttribute(fc.viewBox,i),e},ca=function getViewBox(e){var t=e.getAttribute(fc.viewBox);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},aa=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var i=r.matrixTransform(e.getScreenCTM().inverse());return[i.x,i.y]},ua=Object.freeze({__proto__:null,setViewBox:oa,getViewBox:ca,convertToViewBox:aa}),sa=function loadSVG(e,t){var n=ra(t);if(null!=n)return _typeof(n.then)===fc.function?n.then((function(t){return Jc(e,t)})):Jc(e,n)},fa=function getFrame(e){var t=ca(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===fc.function){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},la="svg-background-rectangle",va=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(fc.style);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(fc.style),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(Hc(t)),n},da={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),Yc(e)},size:oa,setViewBox:oa,getViewBox:ca,padding:function setPadding(e,t){var n=ca(e);return void 0!==n&&oa.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(fc.class)===la})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(fa(e))))).setAttribute(fc.class,la),n.setAttribute("stroke","none"),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return fa(e)[2]},getHeight:function getHeight(e){return fa(e)[3]},stylesheet:function stylesheet(e,t){return va.call(this,e,t)},load:sa,save:ia},pa={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},_a={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},ga=Object.values(_a).reduce((function(e,t){return e.concat(t)}),[]),ha=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},ma=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return ha(e,n,t[r])})),e.hasOwnProperty("press"))||ha(e,"press",(n=pa.math).vector.apply(n,_toConsumableArray(t)))},ya=function TouchEvents(e){var t=[],n=[];Object.keys(_a).forEach((function(e){_a[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){ma(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),ma(e,t)}};Object.keys(_a).forEach((function(t){var i="on"+Xc.capitalized(t);Object.defineProperty(e,i,{set:function set(i){return null==i?function removeHandler(t){return _a[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):_a[t].forEach((function(o){var c=function handlerFunc(n){var o=null!=n.touches?n.touches[0]:n;if(void 0!==o){var c,a=aa(e,o.clientX,o.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return ha(n,e,a[t])})),!n.hasOwnProperty("position"))ha(n,"position",(c=pa.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}i(n)};e.addEventListener&&(n[o].push(c),e.addEventListener(o,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return ga.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},ba=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},xa=function Animation(e){var t,n,r={},i=0,o=function removeHandlers(){_c.cancelAnimationFrame&&_c.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,i=0};Object.defineProperty(e,"play",{set:function set(e){if(o(),null!=e){var c=ba();r[c]=function handlerFunc(o){t||(t=o,i=0),e({time:.001*(o-t),frame:i}),i+=1,r[c]&&(n=_c.requestAnimationFrame(r[c]))},_c.requestAnimationFrame&&(n=_c.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:o,enumerable:!0})},Aa=function distanceSq2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},ka=function distance2(e,t){return Math.sqrt(Aa(e,t))},wa=Object.freeze({__proto__:null,distanceSq2:Aa,distance2:ka}),Ea=[["cx","cy"],["x","y"]],Ma=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),Ea.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},i=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),o=function setPosition(){Nc.apply(void 0,_toConsumableArray(Pc.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),"function"==typeof t.delegate&&t.delegate.apply(t.pointsContainer,[i,t.pointsContainer])};return t.delegate=void 0,t.setPosition=o,t.onMouseMove=function(e){return n.selected?o(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(Aa(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),["svg","updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),i},Oa=function controls(e,t,n){var r,i,o=Array.from(Array(t)).map((function(){return Ma(e)})),c=function protocol(e){return"function"==typeof i?i.call(o,e,r,o):void 0};o.forEach((function(e){e.delegate=c,e.pointsContainer=o}));e.onPress=function mousePressedHandler(e){o.length>0&&(r=o.map((function(t,n){return{i:n,d:Aa(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,o[r].selected=!0)},e.onMove=function mouseMovedHandler(e){o.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){o.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(o,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(o,"selected",{get:function get(){return o[r]}}),Object.defineProperty(o,"add",{value:function value(t){o.push(Ma(e))}}),o.removeAll=function(){for(;o.length>0;)o.pop().remove()};var a={onChange:function onChange(e,t){if(i=e,!0===t){var n=o.length-1;e.call(o,o[n],n,o)}},position:function position(e){return o.forEach((function(t,n){return t.setPosition(e.call(o,t,n,o))}))},svg:function svg(e){return o.forEach((function(t,n){t.svg=e.call(o,t,n,o)}))}};return Object.keys(a).forEach((function(e){o[e]=function(){return"function"==typeof arguments[0]&&a[e].apply(a,arguments),o}})),o.parent=function(e){return null!=e&&null!=e.appendChild&&o.forEach((function(t){e.appendChild(t.svg)})),o},o},ja=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oa.call.apply(Oa,[e,e].concat(n))}},Ca=(new _c.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,Sa={svg:{args:function args(){return[viewBox(Nc.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:da,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===fc.string})).forEach((function(t){return sa(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof Ca})).filter((function(e){return _typeof(e.appendChild)===fc.function})).forEach((function(t){return t.appendChild(e)})),ya(e),xa(e),ja(e)}}},Pa=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map((function(e){return na(e)})).filter((function(e){return void 0!==e}));return i.filter((function(e){return e.tagName===fc.svg})).forEach((function(t){return Wc(e,t)})),i.filter((function(e){return e.tagName!==fc.svg})).forEach((function(t){return e.appendChild(t)})),e},Na={g:{init:Pa,methods:{load:Pa}}},za=Object.assign(Object.create(null),{svg:["viewBox"],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"],mask:["id"],symbol:["id"],clipPath:["id","clip-rule"],marker:["id","markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),Ia=function setRadius(e,t){return e.setAttribute(za.circle[2],t),e},La=function setOrigin(e,t,n){return _toConsumableArray(Nc.apply(void 0,_toConsumableArray(Pc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(za.circle[n],t)})),e},qa=function fromPoints(e,t,n,r){return[e,t,ka([e,t],[n,r])]},Ta={circle:{args:function args(e,t,n,r){var i=Nc.apply(void 0,_toConsumableArray(Pc(e,t,n,r)));switch(i.length){case 0:case 1:return[,,].concat(_toConsumableArray(i));case 2:case 3:return i;default:return qa.apply(void 0,_toConsumableArray(i))}},methods:{radius:Ia,setRadius:Ia,origin:La,setOrigin:La,center:La,setCenter:La,position:La,setPosition:La}}},Fa=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(za.ellipse[n],t)})),e},Va=function setCenter(e,t,n){return _toConsumableArray(Nc.apply(void 0,_toConsumableArray(Pc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(za.ellipse[n],t)})),e},Ga={ellipse:{args:function args(e,t,n,r){var i=Nc.apply(void 0,_toConsumableArray(Pc(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(i));default:return i}},methods:{radius:Fa,setRadius:Fa,origin:Va,setOrigin:Va,center:Va,setCenter:Va,position:Va,setPosition:Va}}},Ba=function Args(e,t,n,r){return Nc.apply(void 0,_toConsumableArray(Pc(e,t,n,r))).slice(0,4)},Da={line:{args:Ba,methods:{setPoints:function setPoints(e,t,n,r,i){return Ba(t,n,r,i).forEach((function(t,n){return e.setAttribute(za.line[n],t)})),e}}}},Ra=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,Ua=/-?[0-9]*\.?\d+/g,Za={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(Za).forEach((function(e){var t=Za[e];Za[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var Xa=function getD(e){var t=e.getAttribute("d");return null==t?"":t},$a=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.setAttribute("d","".concat(Xa(e)).concat(t).concat(Pc.apply(void 0,r).join(" "))),e},Ha=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=Ra.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(Ua);return e.en=Za[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(Xa(e))},Ya={addCommand:$a,appendCommand:$a,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:Ha,get:Ha,getD:function getD(e){return e.getAttribute("d")}};Object.keys(Za).forEach((function(e){Ya[Za[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return $a.apply(void 0,[t,e].concat(r))}}));var Wa={path:{methods:Ya}},Ja=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(za.rect[n],t)})),e},Ka=function setRectOrigin(e,t,n){return _toConsumableArray(Nc.apply(void 0,_toConsumableArray(Pc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(za.rect[n],t)})),e},Qa=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},eu={rect:{args:function args(e,t,n,r){var i=Nc.apply(void 0,_toConsumableArray(Pc(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:case 3:return Qa([,,].concat(_toConsumableArray(i)));default:return Qa(i)}},methods:{origin:Ka,setOrigin:Ka,center:Ka,setCenter:Ka,size:Ja,setSize:Ja}}},tu={style:{init:function init(e,t){e.textContent="",e.appendChild(Hc(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(Hc(t)),e}}}},nu={text:{args:function args(e,t,n){return Nc.apply(void 0,_toConsumableArray(Pc(e,t,n))).slice(0,2)},init:function init(e,t,n,r,i){var o=[t,n,r,i].filter((function(e){return _typeof(e)===fc.string})).shift();o&&e.appendChild(_c.document.createTextNode(o))}}},ru=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===fc.string||e instanceof String})).shift()||ba()},iu=function args(){return[ru.apply(void 0,arguments)]},ou={mask:{args:iu},clipPath:{args:iu},symbol:{args:iu},marker:{args:iu,methods:{size:oa,setViewBox:oa}}},cu=function getPoints(e){var t=e.getAttribute("points");return null==t?"":t},au=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},uu=function stringifyArgs(){return[au.apply(void 0,_toConsumableArray(Nc.apply(void 0,_toConsumableArray(Pc.apply(void 0,arguments)))))]},su=function setPoints$1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",uu.apply(void 0,n)[0]),e},fu=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",[cu(e),uu.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},lu=function Args$1(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===fc.string?[arguments.length<=0?void 0:arguments[0]]:uu.apply(void 0,arguments)},vu={polyline:{args:lu,methods:{setPoints:su,addPoint:fu}},polygon:{args:lu,methods:{setPoints:su,addPoint:fu}}},du=Object.assign({},Sa,Na,Ta,Ga,Da,Wa,eu,tu,nu,ou,vu),pu={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(hc).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===za[e]})).forEach((function(e){za[e]=[]})),[[["svg","defs","g"].concat(hc.v,hc.t),pu.presentation],[["filter"],pu.effects],[hc.cT.concat("text"),pu.text],[hc.cF,pu.effects],[hc.cG,pu.gradient]].forEach((function(e){return e[0].forEach((function(t){za[t]=za[t].concat(e[1])}))}));var _u=function getClassList(e){if(null==e)return[];var t=e.getAttribute(fc.class);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},gu={addClass:function addClass(e,t){var n=_u(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,fc.class,n.join(" "))},removeClass:function removeClass(e,t){var n=_u(e).filter((function(e){return e!==t}));e.setAttributeNS(null,fc.class,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,fc.class,t)},setId:function setId(e,t){e.setAttributeNS(null,fc.id,t)}},hu=function getAttr(e){var t=e.getAttribute(fc.transform);return null==t||""===t?void 0:t},mu={clearTransform:function clearTransform(e){return e.removeAttribute(fc.transform),e}};["translate","rotate","scale","matrix"].forEach((function(e){mu[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.setAttribute(fc.transform,[hu(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var yu={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){yu[Xc.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===fc.string)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(fc.id);return"url(#".concat(t,")")}return""}(n))}}));var bu={};(uc=hc.v).push.apply(uc,_toConsumableArray(Object.keys(Vc))),Object.keys(Vc).forEach((function(e){Vc[e].attributes=void 0===Vc[e].attributes?_toConsumableArray(pu.presentation):Vc[e].attributes.concat(pu.presentation)})),Object.assign(bu,du,Vc),Object.keys(hc).forEach((function(e){return hc[e].filter((function(e){return void 0===bu[e]})).forEach((function(e){bu[e]={}}))}));var xu=function passthrough(){return Array.from(arguments)};Object.keys(bu).forEach((function(e){bu[e].nodeName||(bu[e].nodeName=e),bu[e].init||(bu[e].init=xu),bu[e].args||(bu[e].args=xu),bu[e].methods||(bu[e].methods={}),bu[e].attributes||(bu[e].attributes=za[e]||[])}));var Au=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){bu[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};Au(Pc(hc.t,hc.v,hc.g,hc.s,hc.p,hc.i,hc.h,hc.d),gu),Au(Pc(hc.t,hc.v,hc.g,hc.s,hc.p,hc.i,hc.h,hc.d),Kc),Au(Pc(hc.v,hc.g,hc.s),mu),Au(Pc(hc.t,hc.v,hc.g),yu);var ku={svg:{version:"1.1",xmlns:gc},style:{type:"text/css"}},wu=function RequiredAttributes(e,t){ku[t]&&Object.keys(ku[t]).forEach((function(n){return e.setAttribute(n,ku[t][n])}))},Eu={},Mu=function constructor(e){for(var t,n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=_c.document.createElementNS(gc,bu[e].nodeName);return wu(c,e),(t=bu[e]).init.apply(t,[c].concat(i)),(n=bu[e]).args.apply(n,i).forEach((function(t,n){null!=bu[e].attributes[n]&&c.setAttribute(bu[e].attributes[n],t)})),bu[e].attributes.forEach((function(e){Object.defineProperty(c,Xc.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(bu[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=bu[e].methods[t]).call.apply(n,[Eu,c].concat(Array.prototype.slice.call(arguments)))}})})),Zc[e]&&Zc[e].forEach((function(e){Object.defineProperty(c,e,{value:function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t}})})),c};Eu.Constructor=Mu;var Ou={};Object.keys(hc).forEach((function(e){return hc[e].forEach((function(e){Ou[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Mu.apply(void 0,[e].concat(n))}}))}));var ju=function getFoldObject(e){return e.filter((function(e){return function possibleFoldObject(e){if("object"!==_typeof(e))return!1;var t=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(e).map((function(e){return t.includes(e)})).reduce((function(e,t){return e||t}),!1)}(e)})).shift()},Cu=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===fc.function})).forEach((function(t){return t.call(e,e)}))},Su=function SVG(){var e=arguments,t=Mu.apply(void 0,[fc.svg].concat(Array.prototype.slice.call(arguments)));return"loading"===_c.document.readyState?_c.document.addEventListener("DOMContentLoaded",(function(){return Cu.apply(void 0,[t].concat(_toConsumableArray(e)))})):Cu.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t};function vkXML$1(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[o]+n[l],i=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(i=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],i=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],i||(o-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=i?n[l]:u[o++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\//)>-1?c=c+=i?n[l]:u[--o]+n[l]:n[l].search(/\/>/)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[o]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}Object.assign(Su,Ou),Su.NS=gc,Su.linker=function Linker(e){var t=this;["segment","circle","ellipse","rect","polygon"].filter((function(t){return e[t]&&e[t].prototype})).forEach((function(n){e[n].prototype.svg=function(){return t.path(this.svgPath())}})),e.svg=t}.bind(Su),Su.use=function use(e){e.origami&&function bindRabbitEar(e,t){pa.math.vector=t.vector}(0,e),e.render_into_svg&&function bindFoldToSvg(e,t){var n=bu.svg.init;bu.svg.init=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=ju(i);if(c){var a=t.options.apply(t,i);t.render_into_svg(e,c,a)}return n.apply(void 0,[e].concat(i))}}(0,e)}.bind(Su),Su.core=Object.assign(Object.create(null),{load:ra,save:ia,coordinates:Nc,flatten:Pc,attributes:za,children:Zc,cdata:Hc,detect:pc},Xc,gu,Kc,wa,mu,ua);var Pu="vertices",Nu="edges",zu="faces",Iu="boundaries",Lu="boundary",qu="mountain",Tu="valley",Fu="mark",Vu="unassigned",Gu="front",Bu="back",Du="svg",Ru="class",Uu="index",Zu="object",Xu="string",$u="undefined",Hu="black",Yu="white",Wu="lightgray",Ju="stroke-width",Ku="vertices_coords",Qu="edges_vertices",es="faces_vertices",ts="faces_edges",ns="edges_assignment",rs="faces_re:layer",is=("undefined"==typeof window?"undefined":_typeof(window))!==$u&&_typeof(window.document)!==$u,os=("undefined"==typeof process?"undefined":_typeof(process))!==$u&&null!=process.versions&&null!=process.versions.node,cs=function(){var e={};if(os){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else is&&(e=window);return e}(),as="http://www.w3.org/2000/svg",us={SVG:{NS:as,g:function g(){return cs.document.createElementNS(as,"g")},defs:function defs(){return cs.document.createElementNS(as,"defs")},style:function style(){var e=cs.document.createElementNS(as,"style");return e.setAttributeNS(null,"type","text/css"),e},line:function line(e,t,n,r){var i=cs.document.createElementNS(as,"line");return i.setAttributeNS(null,"x1",e),i.setAttributeNS(null,"y1",t),i.setAttributeNS(null,"x2",n),i.setAttributeNS(null,"y2",r),i},circle:function circle(e,t,n){var r=cs.document.createElementNS(as,"circle");return r.setAttributeNS(null,"cx",e),r.setAttributeNS(null,"cy",t),r.setAttributeNS(null,"r",n),r},polygon:function polygon(e){var t=cs.document.createElementNS(as,"polygon"),n=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");return t.setAttributeNS(null,"points",n),t},path:function path(e){var t=cs.document.createElementNS(as,"path");return t.setAttributeNS(null,"d",e),t}}},ss=function recursive_freeze(e){return Object.freeze(e),void 0===e||Object.getOwnPropertyNames(e).filter((function(t){return null!==e[t]&&(_typeof(e[t])===Zu||"function"===_typeof(e[t]))&&!Object.isFrozen(e[t])})).forEach((function(t){return recursive_freeze(e[t])})),e},fs=function recursive_assign(e,t){return Object.keys(t).forEach((function(n){_typeof(t[n])===Zu&&null!==t[n]?(n in e||(e[n]={}),recursive_assign(e[n],t[n])):_typeof(e)!==Zu||n in e||(e[n]=t[n])})),e},ls=function get_object(e){if(null==e)return{};if(_typeof(e)===Zu&&null!==e)return e;if(_typeof(e)===Xu||e instanceof String)try{return JSON.parse(e)}catch(e){return{}}return{}},vs=function bounding_rect(e){if(null==e.vertices_coords||e.vertices_coords.length<=0)return[0,0,0,0];var t=e.vertices_coords[0].length,n=Array(t).fill(1/0),r=Array(t).fill(-1/0);return e.vertices_coords.forEach((function(e){return e.forEach((function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)}))})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?[0,0,0,0]:[n[0],n[1],r[0]-n[0],r[1]-n[1]]},ds="none",ps="500px",_s=function Options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return ss({input:Xu,output:Xu,padding:null,file_frame:null,stylesheet:null,shadows:null,boundaries:!0,faces:!0,edges:!0,vertices:!1,attributes:{svg:{width:ps,height:ps,stroke:Hu,fill:ds,"stroke-linejoin":"bevel","stroke-width":e/200},circle:{r:e/200},boundaries:{fill:Yu},faces:{stroke:ds,front:{fill:Wu},back:{fill:Yu},foldedForm:{stroke:Hu}},edges:{boundary:{},mountain:{stroke:"red"},valley:{stroke:"blue"},mark:{stroke:Wu},unassigned:{stroke:Wu}},vertices:{stroke:ds,fill:Hu}}})},gs=function make_options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=vs(e),r=Math.min(n[2],n[3]);return fs(t,_s(r)),t.shadows&&fs(t,{attributes:{faces:{front:{filter:"url(#shadow)"},back:{filter:"url(#shadow)"}}}}),t},hs=function boundaries_polygon(e){if(Ku in e==!1||Qu in e==!1||ns in e==!1)return[];var t=function get_boundary(e){if(null==e.edges_assignment)return{vertices:[],edges:[]};for(var t=e.edges_assignment.map((function(e){return"B"===e||"b"===e})),n=function make_vertices_edges(e){if(e.edges_vertices){var t=[];return e.edges_vertices.forEach((function(e,n){return e.forEach((function(e){void 0===t[e]&&(t[e]=[]),t[e].push(n)}))})),t}}(e),r=[],i=[],o=-1,c=0;c<t.length;c+=1)if(t[c]){o=c;break}if(-1===o)return{vertices:[],edges:[]};t[o]=!1,r.push(o),i.push(e.edges_vertices[o][0]);for(var a=e.edges_vertices[o][1];i[0]!==a;){if(i.push(a),void 0===(o=n[a].filter((function(e){return t[e]})).shift()))return{vertices:[],edges:[]};a=e.edges_vertices[o][0]===a?_slicedToArray(e.edges_vertices[o],2)[1]:_slicedToArray(e.edges_vertices[o],1)[0],t[o]=!1,r.push(o)}return{vertices:i,edges:r}}(e).vertices.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}));if(0===t.length)return[];var n=us.SVG.polygon(t);return n.setAttributeNS(null,Ru,Lu),[n]},ms=function vertices_circle(e,t){if(Ku in e==!1)return[];var n=e.vertices_coords.map((function(e){return us.SVG.circle(e[0],e[1],.01)}));return n.forEach((function(e,t){return e.setAttributeNS(null,Uu,t)})),n},ys={B:Lu,b:Lu,M:qu,m:qu,V:Tu,v:Tu,F:Fu,f:Fu,U:Vu,u:Vu},bs={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},xs=function edges_coords(e){return null==e.edges_vertices||null==e.vertices_coords?[]:e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))}))},As=function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])},ks=function edges_path_data(e){var t=xs(e).map((function(e){return As(e)})).join("");return""===t?void 0:t},ws=function edges_by_assignment_paths_data(e){if(null==e.edges_vertices||null==e.vertices_coords||null==e.edges_assignment)return[];var t=xs(e),n=function edges_indices_classes(e){var t={u:[],f:[],v:[],m:[],b:[]};return e.edges_assignment.map((function(e){return bs[e]})).forEach((function(e,n){return t[e].push(n)})),t}(e),r=Object.keys(n).map((function(e){return n[e].map((function(e){return t[e]}))})).map((function(e){return e.map((function(e){return As(e)})).join("")})),i={};return Object.keys(n).map((function(e,t){""!==r[t]&&(i[e]=r[t])})),i},Es=function edges_path(e){if(null==e.edges_assignment){var t=ks(e);return void 0===t?[]:[us.SVG.path(t)]}var n=ws(e);return Object.keys(n).map((function(e){var t=us.SVG.path(n[e]);return t.setAttributeNS(null,Ru,ys[e]),t}))},Ms={subtract:function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},cross2:function cross2(e,t){return e[0]*t[1]-e[1]*t[0]}},Os=function finalize_faces(e,t){var n=_typeof(e.frame_classes)===Zu&&null!==e.frame_classes&&!e.frame_classes.includes("creasePattern"),r=null!=e[rs]&&e[rs].length===e.faces_vertices.length,i=[[Gu],[Bu]].map((function(e){return n&&e.push("foldedForm"),e})).map((function(e){return e.join(" ")}));return function get_faces_winding(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return Ms.cross2(Ms.subtract(e[1],e[0]),Ms.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(e).map((function(e){return e<0?i[0]:i[1]})).forEach((function(e,n){return t[n].setAttributeNS(null,Ru,e)})),r?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e[rs]).map((function(e){return t[e]})):t},js=function faces_vertices_polygon(e){if(es in e==!1||Ku in e==!1)return[];var t=e.faces_vertices.map((function(t){return t.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return us.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,Uu,t)})),Os(e,t)},Cs=function faces_edges_polygon(e){if(ts in e==!1||Qu in e==!1||Ku in e==!1)return[];var t=e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return us.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,Uu,t)})),Os(e,t)},Ss={vertices:[],edges:[Vu,Fu,Tu,qu,Lu],faces:[Gu,Bu,"foldedForm"],boundaries:[]},Ps=function style_component(e,t,n){var r=t.attributes,i=Ss[n]||[];Array.from(e.childNodes).filter((function(e){return r[e.nodeName]})).forEach((function(e){return Object.keys(r[e.nodeName]).forEach((function(t){return e.setAttributeNS(null,t,r[e.nodeName][t])}))})),Object.keys(r[n]).filter((function(e){return!i.includes(e)})).forEach((function(t){return e.setAttributeNS(null,t,r[n][t])})),0!==i.length&&Array.from(e.childNodes).forEach((function(e){return Object.keys(r[n][e.getAttribute(Ru)]||{}).forEach((function(t){return e.setAttributeNS(null,t,r[n][e.getAttribute(Ru)][t])}))}))},Ns={vertices:ms,edges:Es,faces:function faces_draw_function(e){return null!=e.faces_vertices?js(e):Cs(e)},boundaries:hs},zs=function render_components(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.attributes||(t.attributes={}),[Iu,zu,Nu,Pu].filter((function(e){return!0===t[e]})).map((function(n){var r=us.SVG.g();return r.setAttributeNS(null,Ru,n),Ns[n](e,t).forEach((function(e){return r.appendChild(e)})),Ps(r,t,n),r})).filter((function(e){return e.childNodes.length>0}))},Is=cs.document,Ls=Object.freeze({blur:.005,opacity:.3,color:Hu}),qs="result",Ts="in",Fs="blur",Vs="offsetColor",Gs="offsetBlur",Bs="feMergeNode",Ds="200%",Rs=function make_defs(e,t){var n=vs(e),r=Math.min(n[2],n[3]),i=us.SVG.defs();if(null!=t.stylesheet){var o=us.SVG.style();i.appendChild(o);var c=t.attributes.svg[Ju]?t.attributes.svg[Ju]:r/200,a=(new cs.DOMParser).parseFromString("<xml></xml>","application/xml").createCDATASection("\n* { --".concat(Ju,": ").concat(c,"; }\n").concat(t.stylesheet));o.appendChild(a)}if(null!=t.shadows){var u=_typeof(t.shadows)===Zu&&null!==t.shadows?t.shadows:{blur:r/200};i.appendChild(function shadowFilter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ls,t="shadow";_typeof(e)===Zu&&null!==e||(e={}),Object.keys(Ls).filter((function(t){return!(t in e)})).forEach((function(t){e[t]=Ls[t]}));var n=Is.createElementNS(us.SVG.NS,"filter");n.setAttributeNS(null,"width",Ds),n.setAttributeNS(null,"height",Ds),n.setAttributeNS(null,"id",t);var r=Is.createElementNS(us.SVG.NS,"feGaussianBlur");r.setAttributeNS(null,Ts,"SourceAlpha"),r.setAttributeNS(null,"stdDeviation",e.blur),r.setAttributeNS(null,qs,Fs);var i=Is.createElementNS(us.SVG.NS,"feOffset");i.setAttributeNS(null,Ts,Fs),i.setAttributeNS(null,qs,Gs);var o=Is.createElementNS(us.SVG.NS,"feFlood");o.setAttributeNS(null,"flood-color",e.color),o.setAttributeNS(null,"flood-opacity",e.opacity),o.setAttributeNS(null,qs,Vs);var c=Is.createElementNS(us.SVG.NS,"feComposite");c.setAttributeNS(null,Ts,Vs),c.setAttributeNS(null,"in2",Gs),c.setAttributeNS(null,"operator",Ts),c.setAttributeNS(null,qs,Gs);var a=Is.createElementNS(us.SVG.NS,"feMerge"),u=Is.createElementNS(us.SVG.NS,Bs),s=Is.createElementNS(us.SVG.NS,Bs);return s.setAttributeNS(null,Ts,"SourceGraphic"),a.appendChild(u),a.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(c),n.appendChild(a),n}(u))}return null!=t.stylesheet||null!=t.shadows?i:void 0},Us=function makeViewBox(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,a=e-c-i,u=t-c-i,s=n+2*c+2*i,l=r+2*c+2*i;return[a,u,s,l].join(" ")},Zs=function make_svg_attributes(e,t){var n=vs(e),r=(Math.min(n[2],n[3]),{viewBox:Us.apply(void 0,_toConsumableArray(n).concat([t.padding]))}),i=function graph_classes(e){return[(null!=e.file_classes?e.file_classes:[]).join(" "),(null!=e.frame_classes?e.frame_classes:[]).join(" ")].filter((function(e){return""!==e})).join(" ")}(e);return""!==i&&(r.class=i),Object.assign(r,t.attributes.svg),r},Xs=function render_into_svg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};gs(t,n);var r=Rs(t,n);r&&e.appendChild(r),zs(t,n).forEach((function(t){return e.appendChild(t)}));var i=Zs(t,n);return Object.keys(i).forEach((function(t){return e.setAttributeNS(null,t,i[t])})),e},$s=function svg$1$1(){var e=cs.document.createElementNS(us.SVG.NS,Du);return e.setAttribute("version","1.1"),e.setAttribute("xmlns",us.SVG.NS),e},Hs=function FoldToSvg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ls(e);gs(n,t);var r=Xs($s(),n,t);if(t.output===Du)return r;var i=(new cs.XMLSerializer).serializeToString(r),o=vkXML$1(i);return o};Object.assign(Hs,{render_into_svg:Xs,render_components:zs,options:gs,boundaries_polygon:hs,vertices_circle:ms,edges_path_data:ks,edges_by_assignment_paths_data:ws,edges_path:Es,edges_line:function edges_line(e){var t=xs(e).map((function(e){return us.SVG.line(e[0][0],e[0][1],e[1][0],e[1][1])}));return t.forEach((function(e,t){return e.setAttributeNS(null,Uu,t)})),function make_edges_assignment_names(e){return null==e.edges_vertices||null==e.edges_assignment||e.edges_vertices.length!==e.edges_assignment.length?[]:e.edges_assignment.map((function(e){return ys[e]}))}(e).forEach((function(e,n){return t[n].setAttributeNS(null,Ru,e)})),t},faces_vertices_polygon:js,faces_edges_polygon:Cs,linker:function linker(e){}.bind(Hs),use:function use(e){e.NS&&(us.SVG=e)}});var Ys={graph:Zo,cp:Ho,origami:Wo},Ws={graph:function graph(){return{}},cp:Ko.square,origami:Ko.square};Object.keys(Ys).forEach((function(e){zo[e]=function(){var t=Array.from(arguments).filter((function(e){return br(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Object.assign.apply(Object,[Object.create(Ys[e]),t.length?{}:Ws[e]()].concat(_toConsumableArray(t),[{file_spec:er,file_creator:tr}]))},zo[e].prototype=Ys[e],zo[e].prototype.constructor=zo[e],Object.keys(Ko).forEach((function(t){zo[e][t]=function(){return zo[e](Ko[t].apply(Ko,arguments))}}))})),Object.assign(zo.graph,ao),vo.test=sc;var Js=Object.assign(Qn,zo,{math:Kn.core,axiom:vo,diagram:Ao,single:No,text:tc,webgl:ic});return Object.defineProperty(Js,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(Js)}),Object.keys(Kn).filter((function(e){return"core"!==e})).forEach((function(e){Js[e]=Kn[e]})),Su.use(Hs),Su.use(Js),Hs.use(Su),Js.use(Su),Js.use(Hs),Js}));
