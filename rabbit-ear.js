!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?n(Object(i),!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var c,u=e[Symbol.iterator]();!(r=(c=u.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a="undefined"!=typeof window&&void 0!==window.document,s="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,f=("object"===("undefined"==typeof self?"undefined":e(self))&&self.constructor&&self.constructor.name,function(t){switch(t.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return t.constructor.name}if("object"===e(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rect";if(null!=t.x||"number"==typeof t[0])return"vector";if(null!=t[0]&&t[0].length&&("number"==typeof t[0].x||"number"==typeof t[0][0]))return"segment";if(null!=t.vector&&null!=t.origin)return"line"}}),l=function(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},v=function(e,t){var n=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return l(n,e)}))},d=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return d(n)===Math.min(t,d(e))?e:n},h=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},g=function e(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return h(arguments[0])&&"string"!=typeof arguments[0]?e.apply(void 0,o(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return h(t)?o(e(t)):t}))}},m=function e(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return h(arguments[0])&&"string"!=typeof arguments[0]?e.apply(void 0,o(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return h(t)?o(e(t)):t})).reduce((function(e,t){return e.concat(t)}),[])}},_=Object.freeze({__proto__:null,resize:l,resize_up:v,resize_down:function(e,t){var n=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return l(n,e)}))},clean_number:p,semi_flatten_arrays:g,flatten_arrays:m}),y=Object.create(null),b=[1,0,0,1],x=b.concat(0,0),M=function(e){return e[0]*e[3]-e[1]*e[2]},A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},E=Object.freeze({__proto__:null,identity2x2:b,identity2x3:x,multiply_matrix2_vector2:function(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:M,invert_matrix2:function(e){var t=M(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return b.concat(e,t)},make_matrix2_scale:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:A,make_matrix2_reflect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),u=r*o+i*c,a=r*-c+i*o,s=i*o+-r*c,f=i*-c+-r*o,l=t[0]+u*-t[0]+-t[1]*s,v=t[1]+a*-t[0]+-t[1]*f;return[u,a,s,f,l,v]}}),O=180/Math.PI,k=Math.PI/180,w=2*Math.PI,j=1e-6,S=Object.freeze({__proto__:null,R2D:O,D2R:k,TWO_PI:w,EPSILON:j}),P=function(e){return e*e},N=function(e,t){return e+(t||0)},z=function(e){return void 0!==e},C=function(e){return Math.sqrt(e.map(P).reduce(N,0))},I=function(e){return e.map(P).reduce(N,0)},L=function(e){var t=C(e);return 0===t?e:e.map((function(e){return e/t}))},F=function(e,t){return e.map((function(e){return e*t}))},q=function(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},V=function(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},G=function(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(N,0)},B=function(e,t){return e.map((function(e,n){return(e+t[n])/2}))},T=function(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},D=function(e,t,n){var r=1-n;return e.map((function(e,i){return e*r+(t[i]||0)*n}))},U=function(e,t){return e[0]*t[1]-e[1]*t[0]},R=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},X=function(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},Z=function(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce((function(e,t){return e+t}),0))},Y=function(e){return e.map((function(e){return-e}))},$=function(e){return[-e[1],e[0]]},H=function(e){return[e[1],-e[0]]},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;return Math.abs(e.reduce(N,0))<t},W=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return 1-Math.abs(G(L(e),L(t)))<n},Q=function(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(N,0)}))},K=Object.freeze({__proto__:null,magnitude:C,mag_squared:I,normalize:L,scale:F,add:q,subtract:V,dot:G,midpoint:B,average:T,lerp:D,cross2:U,cross3:R,distance2:X,distance3:function(e,t){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},distance:Z,flip:Y,rotate90:$,rotate270:H,degenerate:J,parallel:W,alternating_sum:Q,alternating_deviation:function(e){var t=e.reduce(N,0)/2;return Q(e).map((function(e){return e-t}))}}),ee=Object.freeze([1,0,0,0,1,0,0,0,1]),te=Object.freeze(ee.concat(0,0,0)),ne=function(e){return te.map((function(t,n){return Math.abs(t-e[n])<j})).reduce((function(e,t){return e&&t}),!0)},re=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},ie=function(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},oe=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},ce=function(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},ue=function(e){var t=ce(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ee.concat(e,t,n)},se=function(e,t,n,r,i){var o=ee.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),u=Math.sin(e);return o[3*n+n]=c,o[3*n+r]=(i?1:-1)*u,o[3*r+n]=(i?-1:1)*u,o[3*r+r]=c,o},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,1,2,!0)},le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,0,2,!1)},ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return se(e,t,0,1,!0)},de=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=l(3,L(t)),o=[0,1,2].map((function(e){return n[e]||0})),c=i(r,3),u=c[0],a=c[1],s=c[2],f=Math.cos(e),v=Math.sin(e),d=Math.sqrt(r[1]*r[1]+r[2]*r[2]),p=Math.abs(d)<1e-6?0:a/d,h=Math.abs(d)<1e-6?1:s/d,g=ee.concat(-o[0],-o[1],-o[2]),m=ee.concat(o[0],o[1],o[2]),_=[1,0,0,0,h,p,0,-p,h,0,0,0],y=[1,0,0,0,h,-p,0,p,h,0,0,0],b=[d,0,u,0,1,0,-u,0,d,0,0,0],x=[d,0,-u,0,1,0,u,0,d,0,0,0],M=[f,v,0,-v,f,0,0,0,1,0,0,0];return oe(m,oe(y,oe(x,oe(M,oe(b,oe(_,g))))))},pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),u=r*o+i*c,a=r*-c+i*o,s=i*o+-r*c,f=i*-c+-r*o,l=t[0]+u*-t[0]+-t[1]*s,v=t[1]+a*-t[0]+-t[1]*f;return[u,a,0,s,f,0,0,0,1,l,v,0]},ge=Object.freeze({__proto__:null,identity3x3:ee,identity3x4:te,is_identity3x4:ne,multiply_matrix3_vector3:re,multiply_matrix3_line3:ie,multiply_matrices3:oe,determinant3:ce,invert_matrix3:ue,make_matrix3_translate:ae,make_matrix3_rotateX:fe,make_matrix3_rotateY:le,make_matrix3_rotateZ:ve,make_matrix3_rotate:de,make_matrix3_scale:pe,make_matrix3_reflectZ:he}),me=function(e,t){return{vector:e||[],origin:t||[]}},_e=function(){if(arguments[0]instanceof y.vector)return arguments[0];var t=m(arguments);return t.length>0&&"object"===e(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(e){return t[0][e]})).filter(z)),t.filter((function(e){return"number"==typeof e}))},ye=function(){return g(arguments).map((function(e){return _e(e)}))},be=function(){if(arguments[0]instanceof y.segment)return arguments[0];var e=g(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:ye(e)},xe=function(){var e=g(arguments);return 0===e.length?me([],[]):e[0]instanceof y.line||e[0]instanceof y.ray||e[0]instanceof y.segment?e[0]:e[0].constructor===Object?me(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?me(_e(e)):me.apply(void 0,o(e.map((function(e){return _e(e)}))))},Me=xe,Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},Ee=function(){if(arguments[0]instanceof y.rect)return arguments[0];var t=m(arguments);if(t.length>0&&"object"===e(t[0])&&null!==t[0]&&!isNaN(t[0].width))return Ae.apply(void 0,o(["x","y","width","height"].map((function(e){return t[0][e]})).filter(z)));var n=t.filter((function(e){return"number"==typeof e})),r=n.length<4?[,,].concat(o(n)):n;return Ae.apply(void 0,o(r))},Oe=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete Oe[2][e]}));var ke=function(e){return Oe[e<8?0:e<13?1:2]},we=function(){var e=m(arguments),t=o(te);return ke(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},je=Object.freeze({__proto__:null,get_vector:_e,get_vector_of_vectors:ye,get_segment:be,get_line:xe,get_ray:Me,rect_form:Ae,get_rect:Ee,get_matrix_3x4:we,get_matrix2:function(){var e=_e(arguments);return 6===e.length?e:e.length>6?[e[0],e[1],e[2],e[3],e[4],e[5]]:e.length<6?x.map((function(t,n){return e[n]||t})):void 0}}),Se=function(e,t){return e===t},Pe=function(e,t){return Math.abs(e-t)<j},Ne=function(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce((function(e,t){return e&&t}),!0)},ze=function(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),n=e.map((function(e){return l(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return n[0].map((function(e,r){return Math.abs(n[0][r]-n[t+1][r])<j})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)},Ce=Object.freeze({__proto__:null,equivalent_vec2:function(e,t){return Math.abs(e[0]-t[0])<j&&Math.abs(e[1]-t[1])<j},equivalent_numbers:function e(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?e.apply(void 0,o(arguments[0])):Ne(arguments,Pe))},equivalent_vectors:ze,equivalent:function(){var t=g.apply(void 0,arguments);if(t.length<1)return!1;var n=e(t[0]);if("undefined"===n)return!1;switch(n){case"number":return Ne(t,Pe);case"boolean":case"string":return Ne(t,Se);case"object":return t[0].constructor===Array?ze.apply(void 0,o(t)):Ne(t,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),Ie=function(e){return e<-j?0:e},Le=function(e){return e<-j?0:e>1.000001?1:e},Fe=function(e,t,n){for(var r,i=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),o=1/0,c=0;c<i.length;c+=1)i[c].d<o&&(r=c,o=i[c].d);return r},qe=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;t=l(e.length,t),n=l(e.length,n);var o=I(e),c=V(n,t),u=G(e,c),a=u/o,s=r(a,i);return q(t,F(e,s))},Ve=function(e,t){var n=e.map((function(e,t,n){return V(n[(t+1)%n.length],e)}));return e.map((function(e,r){return qe(n[r],e,t,Le)})).map((function(e,n){return{point:e,i:n,distance:Z(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},Ge=function(e,t,n){return q(t,F(L(V(n,t)),e))},Be=Object.freeze({__proto__:null,ray_limiter:Ie,segment_limiter:Le,smallest_comparison_search:Fe,nearest_point2:function(e,t){var n=Fe(e,t,X);return void 0===n?void 0:t[n]},nearest_point:function(e,t){var n=Fe(e,t,Z);return void 0===n?void 0:t[n]},nearest_point_on_line:qe,nearest_point_on_polygon:Ve,nearest_point_on_circle:Ge,nearest_point_on_ellipse:function(){return!1}}),Te=function(){return!0},De=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;return e>-t},Ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;return e>-t&&e<1+t},Re=function(){return!0},Xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;return e>t},Ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;return e>t&&e<1-t},Ye=function(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:j,u=U(e,n),a=-u;if(!(Math.abs(u)<c)){var s=U(V(r,t),n),f=U(V(t,r),e),l=s/u,v=f/a;return i(l,c/C(e))&&o(v,c/C(n))?q(t,F(e,l)):void 0}},$e=Object.freeze({__proto__:null,include_l:Te,include_r:De,include_s:Ue,exclude_l:Re,exclude_r:Xe,exclude_s:Ze,intersect_lines:Ye}),He=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j,o=V(e,n),c=I(t);if(Math.sqrt(c)<i)return!1;var u=Math.sqrt(c),a=U(o,t.map((function(e){return e/u}))),s=G(o,t)/c;return Math.abs(a)<i&&r(s,i/u)},Je=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return Math.abs(U(V(e,n),L(t)))<r},We=Object.freeze({__proto__:null,collinear:He,point_on_line:Je,point_on_ray_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return He(e,t,n,De,r)},point_on_ray_exclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return He(e,t,n,Xe,r)},point_on_segment_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return He(e,V(n,t),t,Ue,r)},point_on_segment_exclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return He(e,V(n,t),t,Ze,r)}}),Qe=function(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:j,u=U(e,n),a=-u;if(Math.abs(u)<c)return He(r,e,t,i,c)||He(r,Y(e),q(t,e),i,c)||He(t,n,r,o,c)||He(t,Y(n),q(r,n),o,c);var s=U(V(r,t),n),f=U(V(t,r),e),l=s/u,v=f/a;return i(l,c/C(e))&&o(v,c/C(n))},Ke=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(V(t,e),e,V(r,n),n,Ue,Ue,i)},et=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(V(t,e),e,V(r,n),n,Ze,Ze,i)},tt=Object.freeze({__proto__:null,overlap_lines:Qe,overlap_line_line_inclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,Te,Te,i)},overlap_line_ray_inclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,Te,De,i)},overlap_line_segment_inclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,V(r,n),n,Te,Ue,i)},overlap_ray_ray_inclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,De,De,i)},overlap_ray_segment_inclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,V(r,n),n,De,Ue,i)},overlap_segment_segment_inclusive:Ke,overlap_line_line_exclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,Re,Re,i)},overlap_line_ray_exclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,Re,Xe,i)},overlap_line_segment_exclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,V(r,n),n,Re,Ze,i)},overlap_ray_ray_exclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,n,r,Xe,Xe,i)},overlap_ray_segment_exclusive:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Qe(e,t,V(r,n),n,Xe,Ze,i)},overlap_segment_segment_exclusive:et}),nt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return U(L(V(t[1],t[0])),V(e,t[0]))>-n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},rt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return U(L(V(t[1],t[0])),V(e,t[0]))>n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},it=function(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++)t[r][1]>e[1]!=t[i][1]>e[1]&&e[0]<(t[i][0]-t[r][0])*(e[1]-t[r][1])/(t[i][1]-t[r][1])+t[r][0]&&(n=!n);return n},ot=function(e,t,n,r){for(var i=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),o=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),c=0;c<i.length;c+=1)for(var u=0;u<o.length;u+=1)if(n(i[c][0],i[c][1],o[u][0],o[u][1]))return!0;return!!r(t[0],e)||!!r(e[0],t)},ct=function(e,t){return ot(e,t,et,rt)},ut=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:nt,point_in_convex_poly_exclusive:rt,point_in_poly:it,overlap_convex_polygons_inclusive:function(e,t){return ot(e,t,Ke,nt)},overlap_convex_polygons_exclusive:ct,enclose_convex_polygons_inclusive:function(e,t){var n=e.map((function(e){return nt(e,t)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return nt(e,t)})).reduce((function(e,t){return e&&t}),!0);return!n&&r}}),at=function(e,t){return Math.abs(e[0]-t[0])<j&&Math.abs(e[1]-t[1])<j},st=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(e,t,V(r,n),n,Te,Ue,i)},ft=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(e,t,V(r,n),n,Re,Ze,i)},lt=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(e,t,V(r,n),n,De,Ue,i)},vt=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(e,t,V(r,n),n,Xe,Ze,i)},dt=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(V(t,e),e,V(r,n),n,Ue,Ue,i)},pt=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return Ye(V(t,e),e,V(r,n),n,Ze,Ze,i)},ht=function(e,t,n){for(;n<t;)n+=w;for(;e>t;)e-=w;for(;e<t;)e+=w;return e<n},gt=function(e,t){for(;e<0;)e+=w;for(;t<0;)t+=w;for(;e>w;)e-=w;for(;t>w;)t-=w;var n=t-e;return n>=0?n:w-(e-t)},mt=function(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],i=Math.atan2(r,n);return i<0&&(i+=w),i},_t=function(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],i=Math.atan2(r,n);return i<0&&(i+=w),i},yt=function(e,t){var n=Math.atan2(e[1],e[0])-mt(e,t)/2;return[Math.cos(n),Math.sin(n)]},bt=function(e,t){var n=Math.atan2(e[1],e[0])+_t(e,t)/2;return[Math.cos(n),Math.sin(n)]},xt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e,t){return t})).sort((function(e,n){return t[e]-t[n]}));return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},Mt=function(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return gt.apply(void 0,o(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return Q(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return ht(t,e[n],e[(n+1)%e.length])?t:void 0}))},At=function(e,t){var n=L(e),r=L(t);return G(n,r)<-.999999?[-n[1],n[0]]:L(q(n,r))},Et=function(e,t,n,r){var i=e[0]*n[1]-n[0]*e[1];if(Math.abs(i)<j){var o=[[e[0],e[1]],B(t,r)],c=[o,o];return delete c[e[0]*n[0]+e[1]*n[1]>0?1:0],c}var u=((r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]))/i,a=[t[0]+e[0]*u,t[1]+e[1]*u],s=[At(e,n)];return s[1]=$(s[0]),s.map((function(e){return{vector:e,origin:a}}))},Ot=Object.freeze({__proto__:null,is_counter_clockwise_between:ht,clockwise_angle_radians:function(e,t){for(;e<0;)e+=w;for(;t<0;)t+=w;for(;e>w;)e-=w;for(;t>w;)t-=w;var n=e-t;return n>=0?n:w-(t-e)},counter_clockwise_angle_radians:gt,clockwise_angle2:mt,counter_clockwise_angle2:_t,clockwise_bisect2:yt,counter_clockwise_bisect2:bt,counter_clockwise_radians_order:xt,counter_clockwise_vector_order:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xt.apply(void 0,o(t.map((function(e){return Math.atan2(e[1],e[0])}))))},interior_angles:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e,t,n){return _t(e,n[(t+1)%n.length])}))},kawasaki_solutions_radians:Mt,kawasaki_solutions:function(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return Mt(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))},bisect_vectors:At,bisect_lines2:Et}),kt=function(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=n[0]-e[0],c=n[1]-e[1],u=r*(e[0]+t[0])+i*(e[1]+t[1]),a=o*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-i*(n[0]-t[0]));if(Math.abs(s)<j){var f=Math.min(e[0],t[0],n[0]),l=Math.min(e[1],t[1],n[1]),v=.5*(Math.max(e[0],t[0],n[0])-f),d=.5*(Math.max(e[1],t[1],n[1])-l);return{origin:[f+v,l+d],radius:Math.sqrt(v*v+d*d)}}var p=[(c*u-i*a)/s,(r*a-o*u)/s],h=p[0]-e[0],g=p[1]-e[1];return{origin:p,radius:Math.sqrt(h*h+g*g)}},wt=function(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(N,0)},jt=function(e){var t=1/(6*wt(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],i=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*i,(e[1]+r[1])*i]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},St=function(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return Ae.apply(void 0,o(t).concat(o(r)))},Pt=function(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return w*(n/e)}))},Nt=function(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return p(e,14)}))}))},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(Pt(e),t)},Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=Pt(e).map((function(e){return e+n}));return Nt(r,t)},It=function(){return console.warn("split polygon not done")},Lt=function(e,t,n){var r=e.map((function(e,r){return{point:Je(e,t,n)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),i=e.map((function(e,r,i){return{point:ft(t,n,e,i[(r+1)%i.length]),at_index:r}})).filter((function(e){return null!=e.point}));if(2==i.length){var o=i.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(o[1].at_index+1).concat(e.slice(0,o[0].at_index+1));c.push(o[0].point),c.push(o[1].point);var u=e.slice(o[0].at_index+1,o[1].at_index+1);return u.push(o[1].point),u.push(o[0].point),[c,u]}if(1==i.length&&1==r.length){r[0].type="v",i[0].type="e";var a=r.concat(i).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(a[1].at_index+1).concat(e.slice(0,a[0].at_index+1));"e"===a[0].type&&s.push(a[0].point),s.push(a[1].point);var f=e.slice(a[0].at_index+1,a[1].at_index+1);return"e"===a[1].type&&f.push(a[1].point),f.push(a[0].point),[s,f]}if(2==r.length){var l=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(l[1].at_index).concat(e.slice(0,l[0].at_index+1)),e.slice(l[0].at_index,l[1].at_index+1)]}return[e.slice()]},Ft=function(t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,r=1e4,i=t.slice().sort((function(e,t){return Math.abs(e[1]-t[1])<n?e[0]-t[0]:e[1]-t[1]})),o=[];o.push(i[0]);var c=0,u=0,a=function(){u+=1;var e=o.length-1,t=i.filter((function(t){return!(Math.abs(t[0]-o[e][0])<n&&Math.abs(t[1]-o[e][1])<n)})).map((function(t){for(var n=Math.atan2(o[e][1]-t[1],o[e][0]-t[0]);n<c;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===t.length)return{v:void 0};var r=t[0];if(t=t.filter((function(e){return Math.abs(r.angle-e.angle)<n})).map((function(t){var n=Math.sqrt(Math.pow(o[e][0]-t.node[0],2)+Math.pow(o[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),o.filter((function(e){return e===t[0].node})).length>0)return{v:o};o.push(t[0].node),c=Math.atan2(o[e][1]-t[0].node[1],o[e][0]-t[0].node[0])};do{var s=a();if("object"===e(s))return s.v}while(u<r)},qt=function e(t,n,r){var i=t.map((function(e,t){return{vector:r[t],origin:e}})).map((function(e,t,n){return Ye(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,Xe,Xe)})),o=n.map((function(e,t){return qe(e.vector,e.origin,i[t],(function(e){return e}))}));if(3===t.length)return t.map((function(e){return{type:"skeleton",points:[e,i[0]]}})).concat([{type:"perpendicular",points:[o[0],i[0]]}]);var c=i.map((function(e,t){return Z(e,o[t])})),u=0;c.forEach((function(e,t){e<c[u]&&(u=t)}));var a=[{type:"skeleton",points:[t[u],i[u]]},{type:"skeleton",points:[t[(u+1)%t.length],i[u]]},{type:"perpendicular",points:[o[u],i[u]]}],s=yt(Y(n[(u+n.length-1)%n.length].vector),n[(u+1)%n.length].vector),f=u===t.length-1;return t.splice(u,2,i[u]),n.splice(u,1),r.splice(u,2,s),f&&(t.splice(0,1),r.splice(0,1),n.push(n.shift())),a.concat(e(t,n,r))},Vt=Object.freeze({__proto__:null,circumcircle:kt,signed_area:wt,centroid:jt,enclosing_rectangle:St,make_regular_polygon:zt,make_regular_polygon_side_aligned:Ct,make_regular_polygon_inradius:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ct(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ct(e,t/2/Math.sin(Math.PI/e))},split_polygon:It,split_convex_polygon:Lt,convex_hull:Ft,straight_skeleton:function(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:V(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[V(e[0],e[1]),V(e[2],e[1])]})).map((function(e){return yt.apply(void 0,o(e))}));return qt(e,t,n)}}),Gt=function(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},Bt=function(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=r*Math.cos(n)+i*Math.sin(n),c=i*Math.cos(n)-r*Math.sin(n);return[e[0]+o,e[1]+c]},Tt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,r=e.radius<t.radius?e.radius:t.radius,i=e.radius<t.radius?t.radius:e.radius,o=e.radius<t.radius?e.origin:t.origin,c=e.radius<t.radius?t.origin:e.origin,u=[o[0]-c[0],o[1]-c[1]],a=Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2));if(!(a<n)){var s=u.map((function(e,t){return e/a*i+c[t]}));if(Math.abs(i+r-a)<n||Math.abs(i-(r+a))<n)return[s];if(!(a+r<i||i+r<a)){var f=Gt((r*r-a*a-i*i)/(-2*a*i)),l=Bt(c,s,+f),v=Bt(c,s,-f);return[l,v]}}},Dt=function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:j,c=Math.pow(n[0],2)+Math.pow(n[1],2),u=Math.sqrt(c),a=0===u?n:n.map((function(e){return e/u})),s=[-a[1],a[0]],f=[r[0]-t[0],r[1]-t[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>e+o)){var v=Math.sqrt(Math.pow(e,2)-Math.pow(l,2)),d=function(e,n){return t[n]-s[n]*l+a[n]*e},p=Math.abs(e-Math.abs(l))<o?[v].map((function(e){return[e,e].map(d)})):[-v,v].map((function(e){return[e,e].map(d)})),h=p.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return p.filter((function(e,t){return i(h[t],o)}))}},Ut=function(){return!0},Rt=function(e,t){return e>-t},Xt=function(e,t){return e>-t&&e<1+t},Zt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return Dt(e.radius,e.origin,t.vector,t.origin,Ut,n)},Yt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return Dt(e.radius,e.origin,t.vector,t.origin,Rt,n)},$t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;return Dt(e.radius,e.origin,t.vector,t.origin,Xt,n)},Ht=Object.freeze({__proto__:null,circle_circle:Tt,intersect_circle_line:Dt,circle_line:Zt,circle_ray:Yt,circle_segment:$t}),Jt=function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},Wt=Object.freeze({__proto__:null,axiom1:function(e,t){return y.line(L(V.apply(void 0,o(v(t,e)))),e)},axiom2:function(e,t){return y.line(L(H(V.apply(void 0,o(v(t,e))))),B(e,t))},axiom3:function(e,t,n,r){return Et(e,t,n,r).map(y.line)},axiom4:function(e,t){return y.line(H(L(e)),t)},axiom5:function(e,t,n,r){return(Dt(Z(n,r),n,e,t,(function(){return!0}))||[]).map((function(e){return y.line(L(H(V.apply(void 0,o(v(e,r))))),B(r,e))}))},axiom7:function(e,t,n,r){var i=Ye(e,t,n,r,Te,Te);return void 0===i?void 0:y.line(L(H(V.apply(void 0,o(v(i,r))))),B(r,i))},axiom6:function(e,t,n,r,i,o){var c=i[0],u=i[1];if(Math.abs(e[0])>j)var a=e[1]/e[0],s=t[1]-a*t[0];else var f=t[0];var l=o[0],v=o[1];if(Math.abs(n[0])>j)var d=n[1]/n[0],p=r[1]-d*r[0];else var h=r[0];if(void 0!==a&&void 0!==d)var g=a*a+1,m=2*a*s,_=s*s-c*c-u*u,b=d*d+1,x=2*d*p,M=p*p-l*l-v*v,A=d*c+(s-u),E=c*(p-v)-l*(s-u),O=d-a,k=a*l+(p-v),w=a*c+(s-u);else if(void 0===a&&void 0===d)g=1,m=0,_=f*f-c*c-u*u,b=1,x=0,M=h*h-l*l-v*v,E=u*(h-l)-v*(f-c),O=0,k=h-l,w=A=f-c;else{if(void 0===a){var S=c;c=l,l=S;var P=u;u=v,v=P,a=d,d=void 0,s=p,p=void 0,h=f,f=void 0}g=a*a+1,m=2*a*s,_=s*s-c*c-u*u,b=1,x=0,M=h*h-l*l-v*v,A=c,E=(s-u)*(h-l)-c*v,O=1,k=-a*(h-l)-v,w=a*c+(s-u)}var N=function(e,t,n,r){if(Math.abs(e)<j){if(e=t,t=n,n=r,Math.abs(e)<j)return e=t,t=n,Math.abs(e)<j?[]:[-t/e];var i=t*t-4*e*n;return Math.abs(i)<j?[-t/(2*e)]:i>0?[(-t+Math.sqrt(i))/(2*e),(-t-Math.sqrt(i))/(2*e)]:[]}var o,c=(3*e*n-t*t)/(3*e*e),u=(2*t*t*t-9*e*t*n+27*e*e*r)/(27*e*e*e);if(Math.abs(c)<j)o=[Jt(-u)];else if(Math.abs(u)<j)o=[0].concat(c<0?[Math.sqrt(-c),-Math.sqrt(-c)]:[]);else{var a=u*u/4+c*c*c/27;if(Math.abs(a)<j)o=[-1.5*u/c,3*u/c];else if(a>0){var s=Jt(-u/2-Math.sqrt(a));o=[s-c/(3*s)]}else{var f=2*Math.sqrt(-c/3),l=Math.acos(3*u/c/f)/3,v=2*Math.PI/3;o=[f*Math.cos(l),f*Math.cos(l-v),f*Math.cos(l-2*v)]}}for(var d=0;d<o.length;d+=1)o[d]-=t/(3*e);return o}(b*O*w,(b*k+x*O)*w-(g*A*A+m*A*O+_*O*O),(x*k+M*O)*w-(2*g*A*E+m*(A*k+E*O)+2*_*O*k),M*k*w-(g*E*E+m*E*k+_*k*k)),z=[];if(null!=N&&N.length>0)for(var C=0;C<N.length;++C){if(void 0!==a&&void 0!==d)var I=N[C],L=d*I+p;else L=N[C],I=h;if(L!=v){var F=-1*(I-l)/(L-v),q=(L*L-v*v+I*I-l*l)/(2*(L-v));z.push(y.line.fromPoints([0,q],[1,F]))}else{var V=(I+l)/2;z.push(y.line.fromPoints([V,0],[0,1]))}}return z}}),Qt=function(e){for(var t=1;t<e.length;t+=1)if(!at(e[0],e[t]))return[e[0],e[t]]},Kt=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j,o=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter((function(e){return null!=e}));switch(o.length){case 0:return;case 1:return[o];default:return Qt(o)||[o[0]]}},en=function(e,t,n,r,i){var c,u=Kt(e,t,n,r,i);switch(e){case ft:c=st;break;case vt:c=lt;break;case pt:c=dt;break;case st:case lt:case dt:default:return u}var a=Kt(c,t,n,r,i);if(void 0!==a){var s=Qt(a);if(void 0===s)switch(e){case ft:return;case vt:return rt(r,t,i)?a:void 0;case pt:return rt(n,t,i)||rt(r,t,i)?a:void 0}return rt(B.apply(void 0,o(s)),t,i)?s:u}},tn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(ft,e,t,n,r)},nn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(vt,e,t,n,r)},rn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(pt,e,t,n,r)},on=Object.freeze({__proto__:null,convex_poly_line_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(st,e,t,n,r)},convex_poly_line_exclusive:tn,convex_poly_ray_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(lt,e,t,n,r)},convex_poly_ray_exclusive:nn,convex_poly_segment_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return en(dt,e,t,n,r)},convex_poly_segment_exclusive:rn}),cn=function(e,t){return tn(e,t.vector,t.origin)},un=function(e,t){return nn(e,t.vector,t.origin)},an=function(e,t){return rn(e,t[0],t[1])},sn=function(e,t,n,r,i){return Ye(e.vector,e.origin,t.vector,t.origin,n,r,i)},fn={polygon:{line:cn,ray:un,segment:an},circle:{circle:Tt,line:Zt,ray:Yt,segment:$t},line:{polygon:function(e,t){return cn(t,e)},circle:function(e,t){return Zt(t,e)},line:function(e,t,n){return sn(e,t,Re,Re,n)},ray:function(e,t,n){return sn(e,t,Re,Xe,n)},segment:function(e,t,n){return sn(e,t,Re,Ze,n)}},ray:{polygon:function(e,t){return un(t,e)},circle:function(e,t){return Yt(t,e)},line:function(e,t,n){return sn(t,e,Re,Xe,n)},ray:function(e,t,n){return sn(e,t,Xe,Xe,n)},segment:function(e,t,n){return sn(e,t,Xe,Ze,n)}},segment:{polygon:function(e,t){return an(t,e)},circle:function(e,t){return $t(t,e)},line:function(e,t,n){return sn(t,e,Re,Ze,n)},ray:function(e,t,n){return sn(t,e,Xe,Ze,n)},segment:function(e,t,n){return sn(e,t,Ze,Ze,n)}}},ln={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},vn=function(e,t){var n,r=ln[f(e)],i=ln[f(t)];return(n=fn[r])[i].apply(n,arguments)},dn=Object.assign(Object.create(null),tt,We,ut),pn=function(e){for(var t=1;t<e.length;t+=1)if(!at(e[0],e[t]))return[e[0],e[t]]},hn=function(e){for(var t=[],n=0;n<e.length;n+=1){for(var r=!1,i=0;i<t.length;i+=1)at(e[n],t[i])&&(r=!0);r||t.push(e[n])}return t},gn=function(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))},mn=function(e,t,n){var r=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return V.apply(void 0,o(e))}));return r.map((function(e,n){return W(e,t)?n:void 0})).filter(z).map((function(t){return Je(n,r[t],e[t])})).reduce((function(e,t){return e||t}),!1)},_n=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter(z)},yn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=(_n(ft,e,t,n,r),_n(st,e,t,n,r));if(void 0!==i){var c=pn(i);if(void 0!==c)return rt(B.apply(void 0,o(c)),e,r)?c:void 0}},bn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=(_n(vt,e,t,n,r),_n(lt,e,t,n,r));if(void 0!==i){var c=pn(i);return void 0===c?rt(n,e,r)?[n,i[0]]:void 0:rt(B.apply(void 0,o(c)),e,r)?c:void 0}},xn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=[t,n],c=i.map((function(t){return nt(t,e,r)}));if(!0===c[0]&&!0===c[1])return[o(t),o(n)];var u=_n(dt,e,t,n,r),a=hn(u);if(2===a.length)return a;if(a.length>2){var s=gn(a,V(n,t));return[s[0],s[s.length-1]]}if(u.length>0){var f=i.map((function(t){return rt(t,e,r)}));if(!0===f[0])return[o(t),u[0]];if(!0===f[1])return[o(n),u[0]]}},Mn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=V(n,t);if(!mn(e,i,t))return xn(e,t,n,r)},An=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=_n(st,e,t,n,r);switch(i.length){case 0:case 1:return;default:return pn(i)}},clip_line_in_convex_poly_exclusive:yn,clip_ray_in_convex_poly_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,i=_n(lt,e,t,n,r);if(0!==i.length){nt(n,e);return pn(i)||[n,i[0]]}},clip_ray_in_convex_poly_exclusive:bn,clip_segment_in_convex_poly_inclusive:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;return xn(e,t,n,r)},clip_segment_in_convex_poly_exclusive:Mn}),En={preserve:{magnitude:function(){return C(this)},isEquivalent:function(){return ze(this,_e(arguments))},isParallel:function(){return W.apply(void 0,o(v(this,_e(arguments))))},dot:function(){return G.apply(void 0,o(v(this,_e(arguments))))},distanceTo:function(){return Z.apply(void 0,o(v(this,_e(arguments))))}},vector:{copy:function(){return o(this)},normalize:function(){return L(this)},scale:function(){return F(this,arguments[0])},flip:function(){return Y(this)},rotate90:function(){return $(this)},rotate270:function(){return H(this)},cross:function(){return R(l(3,this),l(3,_e(arguments)))},transform:function(){return re(we(arguments),l(3,this))},add:function(){return q(this,l(this.length,_e(arguments)))},subtract:function(){return V(this,l(this.length,_e(arguments)))},rotateZ:function(e,t){return re(we(A(e,t)),l(3,this))},lerp:function(e,t){return D(this,l(this.length,_e(e)),t)},midpoint:function(){return B.apply(void 0,o(v(this,_e(arguments))))},bisect:function(){return bt(this,_e(arguments))}}},On={};Object.keys(En.preserve).forEach((function(e){On[e]=En.preserve[e]})),Object.keys(En.vector).forEach((function(e){On[e]=function(){return y.vector.apply(y,o(En.vector[e].apply(this,arguments)))}}));var kn={fromAngle:function(e){return y.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function(e){return y.vector.fromAngle(e*k)}},wn={vector:{P:Array.prototype,A:function(){var e=this;_e(arguments).forEach((function(t){return e.push(t)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:On,S:kn}},jn={};jn.prototype=Object.create(Object.prototype),jn.prototype.constructor=jn,jn.prototype.isParallel=function(){var e=v(this.vector,xe.apply(void 0,arguments).vector);return W.apply(void 0,o(e))},jn.prototype.isDegenerate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return J(this.vector,e)},jn.prototype.reflectionMatrix=function(){return y.matrix(he(this.vector,this.origin))},jn.prototype.nearestPoint=function(){var e=_e(arguments);return y.vector(qe(this.vector,this.origin,e,this.clip_function))},jn.prototype.transform=function(){var e=this.dimension,t=ie(we(arguments),l(3,this.vector),l(3,this.origin));return this.constructor(l(e,t.vector),l(e,t.origin))},jn.prototype.intersect=function(e){return vn(this,e)},jn.prototype.bisect=function(){var e=xe(arguments);return Et(this.vector,this.origin,e.vector,e.origin)},Object.defineProperty(jn.prototype,"dimension",{get:function(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}});var Sn={fromPoints:function(){var e=ye(arguments);return this.constructor({vector:V(e[1],e[0]),origin:e[0]})},perpendicularBisector:function(){var e=ye(arguments);return this.constructor({vector:$(V(e[1],e[0])),origin:T(e[0],e[1])})}},Pn={line:{P:jn.prototype,A:function(){var e=xe.apply(void 0,arguments);this.vector=y.vector(e.vector),this.origin=y.vector(l(this.vector.length,e.origin))},G:{length:function(){return 1/0}},M:{clip_function:function(e){return e},svgPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-e/2)),n=this.vector.scale(e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}},S:Sn}},Nn={ray:{P:jn.prototype,A:function(){var e=xe.apply(void 0,arguments);this.vector=y.vector(e.vector),this.origin=y.vector(l(this.vector.length,e.origin))},G:{length:function(){return 1/0}},M:{flip:function(){return y.ray(Y(this.vector),this.origin)},scale:function(e){return y.ray(this.vector.scale(e),this.origin)},normalize:function(){return y.ray(this.vector.normalize(),this.origin)},clip_function:Ie,svgPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:Sn}},zn={segment:{P:jn.prototype,A:function(){var e=be.apply(void 0,arguments);this.points=[y.vector(e[0]),y.vector(e[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:Le,transform:function(){for(var e=this.points[0].length,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=we(n),o=this.points.map((function(e){return l(3,e)})).map((function(e){return re(i,e)})).map((function(t){return l(e,t)}));return y.segment(o)},midpoint:function(){return y.vector(T(this.points[0],this.points[1]))},svgPath:function(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)}}}},Cn=function(e,t,n,r,i,o){var c=Math.cos(i),u=Math.sin(i),a=Math.cos(o),s=Math.sin(o);return[e+c*n*a+-u*r*s,t+u*n*a+c*r*s]},In=function(e,t,n,r,i,o,c){var u=o;if(u<0&&!isNaN(u))for(;u<0;)u+=2*Math.PI;var a=c>2*Math.PI?2*Math.PI:c,s=Cn(e,t,n,r,i,u),f=Cn(e,t,n,r,i,u+a/2),l=Cn(e,t,n,r,i,u+a),v=a/2>Math.PI?1:0,d=a/2>0?1:0;return{x1:s[0],y1:s[1],x2:f[0],y2:f[1],x3:l[0],y3:l[1],fa:v,fs:d}},Ln=function(e){return p(e,4)},Fn=function(e,t,n,r,i,o,c){return"A".concat(Ln(e)," ").concat(Ln(t)," ").concat(Ln(n)," ").concat(Ln(r)," ").concat(Ln(i)," ").concat(Ln(o)," ").concat(Ln(c))},qn={circle:{A:function(){var e=ye(arguments),t=m(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length)1===e[1].length?(this.radius=e[1][0],this.origin=y.vector.apply(y,o(e[0]))):1===e[0].length?(this.radius=e[0][0],this.origin=y.vector.apply(y,o(e[1]))):e[0].length>1&&e[1].length>1&&(this.radius=X.apply(void 0,o(e)),this.origin=y.vector.apply(y,o(e[0])));else switch(t.length){case 0:this.radius=1,this.origin=y.vector(0,0,0);break;case 1:this.radius=t[0],this.origin=y.vector(0,0,0);break;default:this.radius=t.pop(),this.origin=y.vector.apply(y,o(t))}},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},z:function(){return this.origin[2]}},M:{nearestPoint:function(){return y.vector(Ge(this.radius,this.origin,_e(arguments)))},intersect:function(e){return vn(this,e)},svgPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=In(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=Fn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),i=Fn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function(){return y.polygon(this.points(arguments[0]))},segments:function(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function(){if(3===arguments.length){var e=kt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function(){var e=kt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},Vn=function(e,t,n,r){var i=t>n,o=i?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(o),u=i?Math.cos(r):Math.sin(r),a=i?Math.sin(r):Math.cos(r);return[y.vector(e[0]+c*u,e[1]+c*a),y.vector(e[0]-c*u,e[1]-c*a)]},Gn={ellipse:{A:function(){var e=m(arguments).filter((function(e){return!isNaN(e)})),t=l(5,e);this.rx=t[0],this.ry=t[1],this.origin=y.vector(t[2],t[3]),this.spin=t[4],this.foci=Vn(this.origin,this.rx,this.ry,this.spin)},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{svgPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=In(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=Fn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),i=Fn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return Cn(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function(){return y.polygon(this.points(arguments[0]))},segments:function(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},Bn=function(e){return void 0===e?void 0:y.segment(e)},Tn={area:function(){return wt(this)},centroid:function(){return y.vector(jt(this))},enclosingRectangle:function(){return y.rect(St(this))},contains:function(){return it(_e(arguments),this)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,i){return t[i]+n[i]*e}))}));return this.constructor.fromPoints(n)},rotate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],i=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),o=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(o+e)*i,t[1]+Math.sin(o+e)*i]}));return y.polygon(n)},translate:function(){var e=_e.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function(){var e=we.apply(void 0,arguments),t=this.map((function(t){return re(e,l(3,t))}));return y.polygon(t)},nearest:function(){var e=_e.apply(void 0,arguments),t=Ve(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function(){var e=g(arguments);return ct(this,e)},split:function(){var e=xe.apply(void 0,arguments),t=this.isConvex?Lt:It;return t(this,e.vector,e.origin).map((function(e){return y.polygon(e)}))},intersectLine:function(){var e=xe.apply(void 0,arguments);return tn(this,e.vector,e.origin)},intersectRay:function(){var e=xe.apply(void 0,arguments);return nn(this,e.vector,e.origin)},intersectSegment:function(){var e=be.apply(void 0,arguments);return rn(this,e[0],e[1])},clipLine:function(){var e=xe.apply(void 0,arguments),t=yn(this,e.vector,e.origin);return Bn(t)},clipRay:function(){var e=xe.apply(void 0,arguments),t=bn(this,e.vector,e.origin);return Bn(t)},clipSegment:function(){var e=be.apply(void 0,arguments),t=Mn(this,e[0],e[1]);return Bn(t)},svgPath:function(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function(e){return vn(this,e)}},Dn={};Dn.prototype=Object.create(Array.prototype),Dn.prototype.constructor=Dn,Object.keys(Tn).forEach((function(e){Dn.prototype[e]=Tn[e]}));var Un=function(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},Rn={rect:{P:Dn.prototype,A:function(){var e=Ee.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=y.vector(e.x,e.y),this.push.apply(this,o(Un(this)))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},center:function(){return y.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function(){return this.width*this.height},segments:function(){return[[[(e=this).x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]];var e},svgPath:function(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function(){return y.rect(St(ye(arguments)))}}}},Xn={polygon:{P:Dn.prototype,A:function(){this.push.apply(this,o(g(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return V(e[1],e[0])}))},G:{isConvex:function(){return!0},points:function(){return this}},M:{segments:function(){return this.sides}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)},regularPolygon:function(){return this.constructor(zt.apply(void 0,arguments))},convexHull:function(){return this.constructor(Ft.apply(void 0,arguments))}}}},Zn=function(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},Yn={matrix:{P:Array.prototype,A:function(){var e=this;we(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function(){return y.matrix.apply(y,o(Array.from(this)))},set:function(){return Zn(this,we(arguments))},isIdentity:function(){return ne(this)},multiply:function(e){return Zn(this,oe(this,e))},determinant:function(){return ce(this)},inverse:function(){return Zn(this,ue(this))},translate:function(e,t,n){return Zn(this,oe(this,ae(e,t,n)))},rotateX:function(e){return Zn(this,oe(this,fe(e)))},rotateY:function(e){return Zn(this,oe(this,le(e)))},rotateZ:function(e){return Zn(this,oe(this,ve(e)))},rotate:function(e,t,n){var r=de(e,t,n);return Zn(this,oe(this,r))},scale:function(e){return Zn(this,oe(this,pe(e)))},reflectZ:function(e,t){var n=he(e,t);return Zn(this,oe(this,n))},transform:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y.vector(re(this,l(3,_e(t))))},transformVector:function(e){return y.vector(re(this,l(3,_e(e))))},transformLine:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=xe(t);return y.line(ie(this,r.vector,r.origin))}},S:{}}},$n=function(e){var t=[];return e.forEach((function(e,n){return t[e]=n})),t},Hn={junction:{A:function(){var e=ye(arguments).map((function(e){return y.vector(e)})),t=e.map((function(e){return Math.atan2(e[1],e[0])})),n=xt.apply(void 0,o(t));this.vectors=n.map((function(t){return e[t]})),this.radians=n.map((function(e){return t[e]})),this.order=$n(n)},G:{sectors:function(){return this.radians.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return gt(e[0],e[1])}))}},M:{alternatingAngleSum:function(){return Q(this.sectors)}},S:{fromRadians:function(){var e=_e(arguments);return this.constructor(e.map((function(e){return[Math.cos(e),Math.sin(e)]})))}}}},Jn=Object.assign({},wn,Pn,Nn,zn,qn,Gn,Rn,Xn,Yn,Hn),Wn=function(e,t){var n=Object.create(Jn[e].proto);return Jn[e].A.apply(n,t),n};Object.assign(y,{vector:function(){return Wn("vector",arguments)},circle:function(){return Wn("circle",arguments)},ellipse:function(){return Wn("ellipse",arguments)},rect:function(){return Wn("rect",arguments)},polygon:function(){return Wn("polygon",arguments)},line:function(){return Wn("line",arguments)},ray:function(){return Wn("ray",arguments)},segment:function(){return Wn("segment",arguments)},matrix:function(){return Wn("matrix",arguments)},junction:function(){return Wn("junction",arguments)}}),Object.keys(Jn).forEach((function(e){var t={};t.prototype=null!=Jn[e].P?Object.create(Jn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,y[e].prototype=t.prototype,y[e].prototype.constructor=y[e],Object.keys(Jn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:Jn[e].G[n]})})),Object.keys(Jn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:Jn[e].M[n]})})),Object.keys(Jn[e].S).forEach((function(t){return Object.defineProperty(y[e],t,{value:Jn[e].S[t].bind(y[e].prototype)})})),Jn[e].proto=t.prototype}));var Qn=y;Qn.core=Object.assign(Object.create(null),S,K,Ce,Vt,Ot,E,ge,Be,Wt,dn,je,_,Ht,$e,on,An,{intersect_line_seg_include:st,intersect_line_seg_exclude:ft,intersect_ray_seg_include:lt,intersect_ray_seg_exclude:vt,intersect_seg_seg_include:dt,intersect_seg_seg_exclude:pt}),Qn.typeof=f,Qn.intersect=vn;var Kn=Object.create(null),er=1.1,tr="Rabbit Ear",nr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},rr=Object.freeze([].concat(nr.file).concat(nr.frame).concat(nr.graph).concat(nr.orders)),ir="vertices",or="edges",cr="faces",ur="vertices_coords",ar="edges_assignment",sr="edges_foldAngle",fr={vertices:"vertex",edges:"edge",faces:"face"},lr={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},vr=function(e){return lr[e]||0},dr=function(e){return e>0?"V":e<0?"M":"U"},pr=function(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},hr=function(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},gr=function(e,t){return hr(e,"".concat(t,"_"))},mr=function(e,t){return pr(e,"_".concat(t))},_r=function(e,t){var n=gr(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,o(n.map((function(t){return e[t].length})))),i=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return i.forEach((function(n,r){i[r][t]=e[t][r]}))})),i},yr=function(e,t,n){var r=gr(e,t);if(0!==r.length){var i={};return r.forEach((function(t){i[t]=e[t][n]})),i}},br=function(t){return"object"!==e(t)||null===t?0:rr.filter((function(e){return t[e]})).length},xr=Object.freeze({__proto__:null,edges_assignment_degrees:lr,edges_assignment_names:{M:"mountain",m:"mountain",V:"valley",v:"valley",B:"boundary",b:"boundary",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},edge_assignment_to_foldAngle:vr,edge_foldAngle_to_assignment:dr,filter_keys_with_suffix:pr,filter_keys_with_prefix:hr,get_graph_keys_with_prefix:gr,get_graph_keys_with_suffix:mr,transpose_graph_arrays:_r,transpose_graph_array_at_index:yr,fold_object_certainty:br}),Mr=function(e,t,n){return Math.max((r=mr(e,t).map((function(t){return e[t]})),i=-1,r.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>i&&(i=e)}))}))})),i),e[n]?function(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[n]):-1)+1;var r,i};Mr.vertices=function(e){return Mr(e,"vertices")},Mr.edges=function(e){return Mr(e,"edges","edgeOrders")},Mr.faces=function(e){return Mr(e,"faces","faceOrders")};var Ar=function(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function(e,t,n){for(var r=e.vertices_vertices,i=e.vertices_sectors,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},u={vertices:[t],edges:[],angles:[]},a=t,s=n;;){var f=r[s],l=(f.indexOf(a)+f.length-1)%f.length,v=f[l],d="".concat(s," ").concat(v);if(c[d])return Object.assign(o,c),u.vertices.pop(),u;if(c[d]=!0,o[d])return;u.vertices.push(s),u.edges.push(d),u.angles.push(i[s][l]),a=s,s=v}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},Er=Object.freeze({__proto__:null,planar_vertex_walk:Ar}),Or=function(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return Qn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-Qn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},kr=function(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:Qn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},wr=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Or,sort_vertices_along_vector:kr}),jr=function(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},Sr=function(e){var t=e.edges_vertices,n=e.vertices_vertices,r=Cr({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},Pr=function(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=jr({edges_vertices:r}));var i=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?i:i.map((function(e,n){return Or({vertices_coords:t},e,n)}))},Nr=function(e){var t=e.faces_vertices,n=Array.from(Array(Mr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},zr=function(e){var t=e.vertices_vertices,n=e.faces_vertices,r=Lr({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},Cr=function(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},Ir=function(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},Lr=function(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},Fr=function(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;i||(i=Dr({vertices_coords:t,edges_vertices:r}));var o=Ir({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=o["".concat(t," ").concat(e)],r=o["".concat(e," ").concat(t)];return void 0!==n?i[n]:void 0!==r?Qn.core.flip(i[r]):void 0}))}))},qr=function(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;return Fr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:i}).map((function(e){var t;return 1===e.length?[Qn.core.TWO_PI]:(t=Qn.core).interior_angles.apply(t,o(e))}))},Vr=function(e,t){var n=e.vertices_coords,r=e.vertices_faces,i=e.edges_vertices,o=e.edges_foldAngle,c=e.edges_assignment,u=e.faces_vertices,a=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=Hr({vertices_coords:n,edges_vertices:i,edges_foldAngle:o,edges_assignment:c,faces_vertices:u,faces_faces:a},t)),r||(r=Nr({faces_vertices:u}));var f=r.map((function(e){return e[0]})).map((function(e){return void 0===e?Qn.core.identity3x4:s[e]}));return n.map((function(e){return Qn.core.resize(3,e)})).map((function(e,t){return Qn.core.multiply_matrix3_vector3(f[t],e)}))},Gr=function(e){var t=e.faces_edges,n=Array.from(Array(Mr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Br={M:-180,m:-180,V:180,v:180},Tr=function(e){return e.edges_assignment.map((function(e){return Br[e]||0}))},Dr=function(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.subtract(e[1],e[0])}))},Ur=function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=n.map((function(e){return e.map((function(e){return t[e]}))}))),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Rr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[-t,+t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Xr=function(e){var t=e.vertices_coords,n=e.vertices_vertices,i=e.vertices_edges,o=e.vertices_sectors,c=e.edges_vertices,u=e.edges_vector;n||(n=Pr({vertices_coords:t,edges_vertices:c,vertices_edges:i})),o||(o=qr({vertices_coords:t,vertices_vertices:n,edges_vertices:c,edges_vector:u}));var a=Cr({edges_vertices:c});return Ar({vertices_vertices:n,vertices_sectors:o}).map((function(e){return r(r({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},Zr=function(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var i=e.length;e.forEach((function(e,o,c){var u=c[(o+1)%i];if(u<e){var a=[u,e];e=a[0],u=a[1]}var s="".concat(e," ").concat(u);if(s in r){var f=r[s];n[t].push(f),n[f].push(t)}else r[s]=t}))})),n},Yr=function(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),i=[],o=r.indexOf(!1),c=o+1;c<r.length;c+=1)r[c]&&i.push(e[c]);for(var u=0;u<o;u+=1)r[u]&&i.push(e[u]);return i},$r=function(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Zr({faces_vertices:t})),0===n.length)return[];var i=[[{face:r}]],o={};o[r]=!0;var c=function(){var e=i[i.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){o[e.face]&&(r[t]=!0),o[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return Yr(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),i[i.length]=c};do{c()}while(i[i.length-1].length>0);return i.length>0&&0===i[i.length-1].length&&i.pop(),i},Hr=function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,i=e.edges_assignment,c=e.faces_vertices,u=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=i?Tr({edges_assignment:i}):Array(n.length).fill(0));var s=Cr({edges_vertices:n}),f=c.map((function(){return Qn.core.identity3x4}));return $r({faces_vertices:c,faces_faces:u},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,i=e.edge_vertices.map((function(e){return t[e]})),c=e.edge_vertices.join(" "),u=s[c],a=Qn.core.make_matrix3_rotate(r[u]*Math.PI/180,(n=Qn.core).subtract.apply(n,o(Qn.core.resize_up(i[1],i[0]))),i[0]);f[e.face]=Qn.core.multiply_matrices3(f[e.parent],a)}))})),f},Jr=function(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},Wr=Object.freeze({__proto__:null,make_vertices_edges:jr,make_vertices_edges_sorted:Sr,make_vertices_vertices:Pr,make_vertices_faces:Nr,make_vertices_faces_sorted:zr,make_vertices_to_edge_bidirectional:Cr,make_vertices_to_edge:Ir,make_vertices_to_face:Lr,make_vertices_vertices_vector:Fr,make_vertices_sectors:qr,make_vertices_coords_folded:Vr,make_edges_edges:function(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),i=n[e[1]].filter((function(e){return e!==t}));return r.concat(i)}))},make_edges_faces:Gr,make_edges_foldAngle:Tr,make_edges_assignment:function(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_vector:Dr,make_edges_length:function(e){var t=e.vertices_coords,n=e.edges_vertices;return Dr({vertices_coords:t,edges_vertices:n}).map((function(e){return Qn.core.magnitude(e)}))},make_edges_coords_min_max:Ur,make_edges_coords_min_max_exclusive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[+t,-t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Rr,make_planar_faces:Xr,make_faces_vertices:function(e){return Xr(e).map((function(e){return e.vertices}))},make_faces_edges:function(e){return Xr(e).map((function(e){return e.edges}))},make_faces_faces:Zr,get_face_face_shared_vertices:Yr,make_face_spanning_tree:$r,make_faces_matrix:Hr,make_faces_center:function(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.centroid(e)}))},make_faces_coloring_from_matrix:Jr,make_faces_coloring:function(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[];return i[r]=!0,$r({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){i[e.face]=t%2==0}))})),i}}),Qr=function(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=jr({edges_vertices:n}));for(var o=r.map((function(e){return"B"===e||"b"===e})),c=[],u=[],a=-1,s=0;s<o.length;s+=1)if(o[s]){a=s;break}if(-1===a)return{vertices:[],edges:[]};o[a]=!1,c.push(a),u.push(n[a][0]);for(var f=n[a][1];u[0]!==f;){if(u.push(f),void 0===(a=t[f].filter((function(e){return o[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===f)f=i(n[a],2)[1];else f=i(n[a],1)[0];o[a]=!1,c.push(a)}return{vertices:u,edges:c}},Kr=Object.freeze({__proto__:null,get_boundary:Qr,get_planar_boundary:function(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,i=e.edges_vertices;r||(r=Pr({vertices_coords:t,vertices_edges:n,edges_vertices:i}));var o=Cr({edges_vertices:i}),c=[],u=[],a={vertices:u,edges:c},s=-1/0,f=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],f=t)})),-1===f)return a;u.push(f);var l=t[f],v=r[f],d=v.map((function(e){return t[e]})).map((function(e){return[e[0]-l[0],e[1]-l[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,p=v[d],h=o[f<p?"".concat(f," ").concat(p):"".concat(p," ").concat(f)];c.push(h);for(var g=f,m=p,_=0;_<1e4;){var y=r[m],b=y.indexOf(g),x=y[(b+1)%y.length],M=o[m<x?"".concat(m," ").concat(x):"".concat(x," ").concat(m)];if(M===c[0])return a;u.push(m),c.push(M),g=m,m=x,_+=1}return console.warn("calculate boundary potentially entered infinite loop"),a}}),ei=function(e,t){var n=e.vertices_coords,r=e.vertices_edges,i=e.edges_vertices,c=e.edges_assignment,u=e.boundaries_vertices,a=Qn.typeof(t),s=Qn.core["clip_".concat(a,"_in_convex_poly_exclusive")];if(s){u||(u=Qr({vertices_edges:r,edges_vertices:i,edges_assignment:c}).vertices);var f=u.map((function(e){return n[e]}));return s.apply(void 0,[f].concat(o(function(e,t){switch(t){case"line":case"ray":return[e.vector,e.origin];case"segment":return[e[0],e[1]];default:return[]}}(t,a))))}},ti=Object.freeze({__proto__:null,clip_line:ei}),ni=function(e,t){var n=e.vertices_coords;if(n){var r=Qn.core.resize(n[0].length,t),i=n.map((function(e,t){return{d:Qn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return i?i.i:void 0}},ri=function(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var i=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return Qn.core.nearest_point_on_line(Qn.core.subtract(e[1],e[0]),e[0],t,Qn.core.segment_limiter)}));return Qn.core.smallest_comparison_search(t,i,Qn.core.distance)}},ii=function(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var i=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return Qn.core.point_in_poly(t,e.face)})).shift();return void 0===i?void 0:i.i}},oi=ii,ci=Object.freeze({__proto__:null,nearest_vertex:ni,nearest_edge:ri,face_containing_point:ii,nearest_face:oi}),ui=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;return Rr(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},ai=function(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,o=Rr({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=n.map((function(){return[]})),u=0;u<n.length-1;u+=1)for(var a=u+1;a<n.length;a+=1){var s=(o[u][1][0]<o[a][0][0]||o[a][1][0]<o[u][0][0])&&(o[u][1][1]<o[a][0][1]||o[a][1][1]<o[u][0][1]);c[u][a]=!s,c[a][u]=!s}for(var f=0;f<n.length;f+=1)c[f][f]=!0;return c},si=Object.freeze({__proto__:null,get_edges_vertices_span:ui,get_edges_edges_span:ai}),fi=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,i){r[n][i]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},li=function(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},vi=Object.freeze({__proto__:null,merge_simple_nextmaps:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:fi,merge_simple_backmaps:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},invert_map:li,invert_simple_map:function(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t}}),di=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(o(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},pi=function(e,t){return di.apply(void 0,o(gr(e,t).map((function(t){return e[t]}))))};pi.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return di(t,n,r)},pi.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return di(t,n,r)},pi.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return di(t,n,r)};var hi=function(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},gi=function(e,t,n){var r,i,o,c=pi(e,t),u=hi(n),a=[];for(r=0,i=0,o=0;r<c;r+=1,i+=1){for(;r===u[o];)a[r]=void 0,r+=1,o+=1;r<c&&(a[r]=i)}return mr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,i){e[t][r][i]=a[n]}))}))})),u.reverse(),gr(e,t).forEach((function(t){return u.forEach((function(n){return e[t].splice(n,1)}))})),a},mi=function(t){if("object"===e(t)&&t.edges_vertices){if(t.vertices_edges=jr(t),t.vertices_vertices=Pr(t),t.vertices_edges=Sr(t),t.vertices_coords&&(t.edges_vector=Dr(t),t.vertices_sectors=qr(t)),function(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=vr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=dr(e.edges_foldAngle[r]);for(var i=e.edges_assignment.length;i<t;i+=1)e.edges_assignment[i]="U",e.edges_foldAngle[i]=0}(t),t.vertices_coords){var n=Xr(t);t.faces_vertices=n.map((function(e){return e.vertices})),t.faces_edges=n.map((function(e){return e.edges})),t.faces_angles=n.map((function(e){return e.angles}))}else t.faces_vertices=[],t.faces_edges=[];return t.vertices_faces=t.vertices_vertices?zr(t):Nr(t),t.edges_faces=Gr(t),t.faces_faces=Zr(t),t.vertices_coords&&(t.faces_matrix=Hr(t)),t}},_i=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var i=t.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),c=e.vertices_coords.length,u=t.filter((function(e,t){return void 0===i[t]}));return(n=e.vertices_coords).push.apply(n,o(u)),i.map((function(e){return void 0===e?c++:e}))},yi=["vertices","edges","faces"],bi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},xi=function(e,t){for(var n={},r={},i=0;i<e.edges_vertices.length;i+=1)r["".concat(e.edges_vertices[i][0]," ").concat(e.edges_vertices[i][1])]=i,r["".concat(e.edges_vertices[i][1]," ").concat(e.edges_vertices[i][0])]=i;for(var o=0;o<t.edges_vertices.length;o+=1){var c=r["".concat(t.edges_vertices[o][0]," ").concat(t.edges_vertices[o][1])];void 0!==c&&(n[o]=c)}return n},Mi=function(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(i,o){return i.forEach((function(i,c){e[t][o][c]=r[n][i]}))}))}))}))},Ai=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r={},i={},o={};yi.forEach((function(e){r[e]=gr(t,e),i[e]=mr(t,e)})),yi.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),o.vertices=bi(e,t,n),Mi(t,i,["vertices"],o);var c=pi.edges(e);o.edges=Array.from(Array(pi.edges(t))).map((function(e,t){return c+t}));var u=xi(e,t);Object.keys(u).forEach((function(e){o.edges[e]=u[e]}));var a=pi.faces(e);return o.faces=Array.from(Array(pi.faces(t))).map((function(e,t){return a+t})),Mi(t,i,["edges","faces"],o),yi.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,i){var c=o[n][i];e[r][c]=t}))}))})),o},Ei=function(e,t){return pr(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.resize(3,e)})).map((function(e){return Qn.core.multiply_matrix3_vector3(t,e)}))})),pr(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.multiply_matrices3(e,t)}))})),e},Oi={scale:function(e,t){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var c=(n=Qn.core).get_vector.apply(n,i),u=Qn.core.resize(3,c),a=Qn.core.make_matrix3_scale(t,u);return Ei(e,a)},translate:function(e){for(var t,n,r=arguments.length,i=new Array(r>1?r-1:0),c=1;c<r;c++)i[c-1]=arguments[c];var u=(t=Qn.core).get_vector.apply(t,i),a=Qn.core.resize(3,u),s=(n=Qn.core).make_matrix3_translate.apply(n,o(a));return Ei(e,s)},rotateZ:function(e,t){for(var n,r,i=arguments.length,c=new Array(i>2?i-2:0),u=2;u<i;u++)c[u-2]=arguments[u];var a=(n=Qn.core).get_vector.apply(n,c),s=Qn.core.resize(3,a),f=(r=Qn.core).make_matrix3_rotateZ.apply(r,[t].concat(o(s)));return Ei(e,f)},transform:Ei},ki=function(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(i){n[i]=Array.from(Array(pi[i](e))).map((function(e,t){return t})),r[i]=hi(t[i]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return gi(e,t,n[t])})),e},wi=function(e,t){return e&&t},ji=function(e,t){return e.concat(t)},Si=function(e){return void 0!==e},Pi=function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,i=t.length,o=Array(i).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},Ni=Object.freeze({__proto__:null,get_edge_isolated_vertices:function(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:Pi}),zi=function(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},Ci=function(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},i=0;i<t.length;i+=1){var o="".concat(t[i][0]," ").concat(t[i][1]),c="".concat(t[i][1]," ").concat(t[i][0]);void 0!==r[o]?n[i]=r[o]:(r[o]=i,r[c]=i)}return n},Ii=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.length,i=0;i<r;i+=1)if(Math.abs(e[i]-t[i])>n)return!1;return!0},Li=function(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,r=t.map((function(){return[]})),i=0;i<t.length-1;i+=1)for(var o=i+1;o<t.length;o+=1)r[i][o]=Ii(t[i],t[o],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),u=[],a=Array(t.length).fill(!1),s=0,f=function e(n,r){if(!a[r]&&s!==t.length)for(a[r]=!0,s+=1,u[n]||(u[n]=[]),u[n].push(r);c[r].length>0;)e(n,c[r][0]),c[r].splice(0,1)},l=0;l<t.length&&(f(l,l),s!==t.length);l+=1);return u.filter((function(e){return e.length}))},Fi=function(e){var t=Pi(e);return{map:gi(e,ir,t),remove:t}},qi=function(e){var t=zi(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),mr(e,or).forEach((function(t){return e[t].forEach((function(r,i){for(var o=r.length-1;o>=0;o-=1)!0===n[r[o]]&&e[t][i].splice(o,1)}))}))}return{map:gi(e,or,t),remove:t}},Vi=function(e){var t=Ci(e),n=Object.keys(t),r=gi(e,or,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Gi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=Li(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=Qn.core).average.apply(t,o(e))})),mr(e,ir).forEach((function(t){return e[t].forEach((function(n,i){return e[t][i].forEach((function(n,o){e[t][i][o]=r[n]}))}))})),gr(e,ir).filter((function(e){return e!==ur})).forEach((function(t){return delete e[t]}));var i=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:i}},Bi=Object.freeze({__proto__:null,remove_isolated_vertices:Fi,remove_circular_edges:qi,remove_duplicate_edges:Vi,remove_duplicate_vertices:Gi}),Ti=function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var o=ui({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=0;c<r.length;c+=1)for(var u=0;u<t.length;u+=1)o[c][u]&&(o[c][u]=Qn.core.point_on_segment_exclusive(t[u],r[c][0],r[c][1],i));return o.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Di=function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,i=e.edges_origin,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=Dr({vertices_coords:t,edges_vertices:n})),i||(i=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),u=ai({vertices_coords:t,edges_vertices:n},o),a=0;a<r.length-1;a+=1)for(var s=a+1;s<r.length;s+=1)!0===u[a][s]?(c[a][s]=Qn.core.intersect_lines(r[a],i[a],r[s],i[s],Qn.core.exclude_s,Qn.core.exclude_s,o),c[s][a]=c[a][s]):c[a][s]=void 0;return c},Ui=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return Qn.core.subtract(e[1],e[0])})),i=n.map((function(e){return e[0]})),c=Di({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:i},1e-6),u=Ti({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==c.reduce(ji,[]).filter(Si).length||0!==u.reduce(ji,[]).filter(Si).length){var a={vertices:e.vertices_coords.length};c.forEach((function(t){return t.filter(Si).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(o(t)),t.splice(0,2),t.push(n)}))})),c.forEach((function(e,t){e.forEach((function(e,n){e&&(c[t][n]=e[0])}))}));var s=c.map((function(e){return e.filter(Si)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,o(s[t]).concat(o(u[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=kr({vertices_coords:e.vertices_coords},t,r[n])}));var f=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(ji,[]);return e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(ji,[]),e.edges_assignment&&(e.edges_assignment=f.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=f.map((function(t){return e.edges_foldAngle[t]||0}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:f}}}},Ri=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],Xi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[ir,or,cr].map((function(t){return gr(e,t)})).reduce(ji,[]).filter((function(e){return!Ri.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var i=Gi(e,t/2),o=Vi(e),c=qi(e),u=Ui(e,t);if(void 0===u){r.vertices.map=void 0===r.vertices.map?i.map:fi(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?fi(o.map,c.map):fi(r.edges.map,o.map,c.map);break}var a=li(u.edges.backmap),s=fi(o.map,c.map,a);r.vertices.map=void 0===r.vertices.map?i.map:fi(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?s:fi(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},Zi=function t(n){var r,i;if("object"!==e(n))return n;if(!n)return n;if("[object Array]"===Object.prototype.toString.apply(n)){for(r=[],i=0;i<n.length;i+=1)r[i]=t(n[i]);return r}for(i in r={},n)n.hasOwnProperty(i)&&(r[i]=t(n[i]));return r},Yi=function(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,o(t));var i=Vi(e).map;return r.map((function(e){return i[e]}))},$i=function(e,t,n){if(!(e.edges_vertices.length<t)){var r,i=e.edges_vertices[t];if(!n)n=(r=Qn.core).midpoint.apply(r,o(i));var c=i.map((function(t){return e.vertices_coords[t]})).map((function(e){return Qn.core.distance(e,n)<Qn.core.EPSILON}));if(c[0])return{vertex:i[0],edges:{}};if(c[1])return{vertex:i[1],edges:{}};var u=e.vertices_coords.length;e.vertices_coords[u]=n;var a=[0,1].map((function(t){return t+e.edges_vertices.length}));(function(e,t,n){var r=e.edges_vertices[t],i=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];return i.forEach((function(n,r){if([ar,sr].filter((function(n){return void 0!==e[n]&&void 0!==e[n][t]})).forEach((function(r){return n[r]=e[r][t]})),e.edges_faces&&void 0!==e.edges_faces[t]&&(n.edges_faces=o(e.edges_faces[t])),e.edges_vector){var i=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_vector=Qn.core.subtract(i[1],i[0])}if(e.edges_length){var c,u=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_length=(c=Qn.core).distance2.apply(c,o(u))}})),i})(e,t,u).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][a[n]]=t[r]}))})),function(e,t,n){var r=e.vertices_vertices;r&&(r[t]=o(n),n.forEach((function(e,n,i){var o=i[(n+1)%i.length],c=r[e].indexOf(o);r[e][c]=t})))}(e,u,i),function(e,t,n,r,i){var c=e.vertices_edges;c&&(c[r]=o(i),t.map((function(e){return c[e].indexOf(n)})).forEach((function(e,n){c[t[n]][e]=i[n]})))}(e,i,t,u,a);var s=function(e,t){var n=e.vertices_faces,r=e.edges_vertices,i=e.edges_faces,o=e.faces_edges;if(e.faces_vertices,i&&i[t])return i[t];var c=r[t];if(void 0!==n){for(var u=[],a=0;a<n[c[0]].length;a+=1)for(var s=0;s<n[c[1]].length;s+=1)n[c[0]][a]===n[c[1]][s]&&u.push(n[c[0]][a]);return u}if(o){for(var f=[],l=0;l<o.length;l+=1)for(var v=0;v<o[l].length;v+=1)o[l][v]===t&&f.push(l);return f}}(e,t);s&&(function(e,t,n){var r=e.vertices_faces;r&&(r[t]=o(n))}(e,u,i),function(e,t,n,r){var i=e.faces_vertices;i&&t.map((function(e){return i[e]})).forEach((function(e){return e.map((function(e,t,n){var i=(t+1)%n.length;return e===r[0]&&n[i]===r[1]||e===r[1]&&n[i]===r[0]?i:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(t){return e.splice(t,0,n)}))}))}(e,s,u,i),function(e,t,n,r,i){var c=e.edges_vertices,u=e.faces_edges;u&&t.map((function(e){return u[e]})).forEach((function(e){var t=e.indexOf(i),u=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length],s=[[u,i],[i,a]].map((function(e){var t=e.map((function(e){return c[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),f=[[s[0],n],[n,s[1]]].map((function(e){var t=e.map((function(e){return-1!==c[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==c[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("something wrong with input graph's faces_edges construction")}));return t===e.length-1?(e.splice(t,1,f[0]),e.unshift(f[1])):e.splice.apply(e,[t,1].concat(o(f))),f}))}(e,s,u,a,t));var f=gi(e,or,[t]);return a.forEach((function(e,t){a[t]=f[a[t]]})),f.splice(-2),f[t]=a,{vertex:u,edges:{map:f,remove:t}}}},Hi=function(e,t,n,r){var i=function(e,t,n,r){var i=e.vertices_coords,c=e.edges_vertices,u=e.faces_vertices,a=e.faces_edges,s=u[t].map((function(e){return i[e]})).map((function(e){return Qn.core.point_on_line(e,n,r)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).slice(0,2),f=s.map((function(e){return{vertex:u[t][e],face_vertex_index:e}}));if(f.length>1){var l=s[1]-s[0];if(1===(l<0?l+u[t].length:l))return;return{vertices:f,edges:[]}}var v=a[t].map((function(e){return c[e].map((function(e){return i[e]}))})).map((function(e){var t;return(t=Qn.core).intersect_line_seg_exclude.apply(t,[n,r].concat(o(e)))})).map((function(e,n){return{coords:e,face_edge_index:n,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).slice(0,2);return f.length>0&&v.length>0?{vertices:f,edges:v}:v.length>1?{vertices:[],edges:v}:void 0}(e,t,n,r);if(void 0!==i){var c=i.vertices.map((function(e){return e.vertex})),u=[];i.edges.map((function(t,n,r){t.edge=u.length?u[0].edges.map[t.edge]:t.edge,u.push($i(e,t.edge,t.coords))})),c.push.apply(c,o(u.map((function(e){return e.vertex}))));var a=e.edges_vertices.length,s=[0,1].map((function(t){return e.faces_vertices.length+t-1})),f=function(e,t,n){var r,i,c=e.vertices_coords,u=t.map((function(e){return c[e]})).reverse();return{edges_vertices:o(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=Qn.core).distance2.apply(r,o(u)),edges_vector:(i=Qn.core).subtract.apply(i,o(u)),edges_faces:o(n)}}(e,c,s);Object.keys(f).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][a]=f[t]})),function(e,t){var n=e.vertices_coords,r=e.vertices_vertices,i=e.edges_vertices,o=i[t][0],c=i[t][1];r[o]=Or({vertices_coords:n},r[o].concat(c),o),r[c]=Or({vertices_coords:n},r[c].concat(o),c)}(e,a);var l,v,d=function(e,t,n){var r=e.edges_vertices,i=e.faces_vertices,o=Cr({edges_vertices:r}),c=n.map((function(e){return i[t].indexOf(e)}));return function(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(i[t],c).map((function(e){return{faces_vertices:e,faces_edges:e.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return o[e]}))}}))}(e,t,c),p=gi(e,"faces",[t]);if(d.forEach((function(t,n){return Object.keys(t).filter((function(t){return void 0!==e[t]})).forEach((function(r){e[r][s[n]]=t[r]}))})),e.vertices_faces=Nr(e),e.edges_faces=Gr(e),e.faces_faces=Zr(e),2===u.length){var h=(l=u[0].edges.map,v=[],l.forEach((function(e,t){v[e]=t})),v);u[1].edges.remove=h[u[1].edges.remove]}return p[t]=s,{vertices:c,faces:{map:p,remove:t},edges:{map:fi.apply(void 0,o(u.map((function(e){return e.edges.map})))),new:a,remove:u.map((function(e){return e.edges.remove}))}}}},Ji=function(e,t){var n=[],r=e.map((function(e,t){return t})),i=r.filter((function(e){return t[e]})),o=r.filter((function(e){return!t[e]}));return o.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),i.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=o.length+t})),n},Wi=function(e,t,n,r){var i=[n[0]-t[0],n[1]-t[1]],o=e[0]*i[1]-e[1]*i[0];return r?o>0:o<0},Qi=function(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},Ki=function(e,t,n,r){var i=pi.faces(e),o=Array.from(Array(i));e["faces_re:layer"]||(e["faces_re:layer"]=Array(i).fill(0)),e["faces_re:preindex"]=o.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=Hr(e,r)),e.faces_coloring=Jr(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return Qn.core.invert_matrix3(e)})).map((function(e){return Qn.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=o.map((function(t,n){return Qi(e,n)})),e["faces_re:sidedness"]=o.map((function(t,n){return Wi(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},eo=function(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],i=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<i[1]&&(i=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-i[1])>Math.abs(r[0]-n[0])?[i,t]:[n,r]},to={M:"V",m:"V",V:"M",v:"M"},no=function(e){return to[e]||e},ro=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===e(n)&&!1===n.edges||(qi(t),Vi(t)),"object"===e(n)&&!0===n.vertices&&Fi(t),t},io=function(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},oo={V:1,v:1,M:-1,m:-1},co=function(e,t){return t%2==0?oo[e]:-oo[e]},uo=function(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},ao=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,i=0,o=t.map((function(e,t){return t%2==0?e:-e})).map((function(e){return i+=e})),c=o.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+r})),u=o.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-r})),a=function(n){var r=[];n.forEach((function(e,t){r[e]=t}));for(var i=n.length+(n.length===t.length?0:-1),a=function(e){var t=(e+1)%n.length,i=uo(n,r[e],r[t]),a=i.map((function(t){return o[e]<c[t]})).reduce(wi,!0),s=i.map((function(t){return o[e]>u[t]})).reduce(wi,!0);if(!a&&!s)return{v:!1}},s=0;s<i;s+=1){var f=a(s);if("object"===e(f))return f.v}return!0},s=function(e){var t=io(e);return t[0]>t[t.length-1]?"M"===n[0]:"V"===n[0]},f=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r=r.slice(0,o).concat([i],r.slice(o,r.length)),!a(r))return[];if(i>=t.length-1)return s(r)?[r]:[];var c=co(n[(i+1)%t.length],i),u=1===c?Array.from(Array(r.length-o)).map((function(e,t){return o+t+1})):Array.from(Array(o+1)).map((function(e,t){return t}));return u.map((function(t){return e(r,i+1,t)})).reduce((function(e,t){return e.concat(t)}),[]).map(io)};return f()},so=function(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var i=0;i<e.length;i+=1){if(t>n&&("V"===e[i]||"v"===e[i]))return i;if(n>t&&("M"===e[i]||"m"===e[i]))return i}},fo=Object.assign(Object.create(null),{assign:Ai,add_vertices:_i,add_vertices_split_edges:function(e,t){var n=_i(e,t),r=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),i=t.map((function(e){return r.map((function(t){return Qn.core.point_on_segment_exclusive(e,t[0],t[1])})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),o=i.filter((function(e){return void 0!==e})),c=i.map((function(e,t){return{e:e,i:t}})).filter((function(e){return void 0!==e.e})).map((function(t){var r=yr(e,"edges",t.e);return[r,Zi(r)].map((function(r,i){return Object.assign(r,{edges_vertices:[e.edges_vertices[t.e][i],n[t.i]]})}))})).reduce((function(e,t){return e.concat(t)}),[]),u=pi.edges(e),a={new:{edges:[]}};return c.forEach((function(t,n){return Object.keys(t).forEach((function(r){void 0===e[r]&&(e[r]=[]),e[r][u+n]=t[r],a.new.edges[n]=u+n}))})),gi(e,"edges",o),n},add_edges:Yi,split_edge:$i,split_face:Hi,flat_fold:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",o=no(i);if(null==r){var c=ii(e,n);r=void 0===c?0:c}t=Qn.core.resize(3,t),n=Qn.core.resize(3,n),Ki(e,t,n,r);var u=Zi(e);u.vertices_coords.forEach((function(e){return e.splice(2)}));var a=Array.from(Array(pi.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=u.faces_coloring[t],r=Hi(u,t,u["faces_re:creases"][t].vector,u["faces_re:creases"][t].origin);if(void 0!==r)return u.edges_assignment[r.edges.new]=n?i:o,u.edges_foldAngle[r.edges.new]=n?lr[i]||0:lr[o]||0,r.faces.map[r.faces.remove].forEach((function(t){u.faces_center[t]=Qi(u,t),u["faces_re:sidedness"][t]=Wi(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,u.faces_center[t],e.faces_coloring[r.faces.remove]),u["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],u["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();u["faces_re:layer"]=Ji(u["faces_re:layer"],u["faces_re:sidedness"]);var s=void 0===a[0]?0:u["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return u["faces_re:sidedness"][e.new]})).shift().new,f=e.faces_matrix[0];"M"!==i&&"m"!==i&&"V"!==i&&"v"!==i||(f=void 0!==a[0]||e["faces_re:sidedness"][0]?Qn.core.multiply_matrices3(e.faces_matrix[0],Qn.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var l=Hr(u,s).map((function(e){return Qn.core.multiply_matrices3(f,e)}));u.faces_coloring=Jr({faces_matrix:l});var v=Qn.core.multiply_matrix3_line3(f,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),d=Qn.core.normalize(Qn.core.rotate270(v.vector)),p=a.map((function(t,n){return void 0===t?void 0:u.edges_vertices[t.edges.new].map((function(e){return u.vertices_coords[e]})).map((function(t){return Qn.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return u["re:construction"]=0===p.length?{type:"flip",direction:d}:{type:"fold",assignment:i,direction:d,edge:eo(p)},u.faces_matrix=l,u["vertices_re:foldedCoords"]=Vr(u,s),u.faces_matrix=l,delete e["faces_re:creases"],delete u["faces_re:creases"],delete e["faces_re:sidedness"],delete u["faces_re:sidedness"],delete e["faces_re:preindex"],delete u["faces_re:preindex"],delete e.faces_coloring,delete u.faces_coloring,delete e.faces_center,delete u.faces_center,u},clean:ro,get_circular_edges:zi,get_duplicate_edges:Ci,get_duplicate_vertices:Li,get_collinear_vertices:Ti,count:pi,implied:Mr,fragment:Xi,remove:gi,populate:mi,subgraph:ki,explode_faces:function(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},layer_solver:ao,assignment_solver:function(e,t){null==t&&(t=e.map((function(){return"U"})));var n=function(e){var t=function(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),i=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-i[t])}))}(t),r=n.map((function(t){return ao(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},single_vertex_fold_angles:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=so(t);if(void 0!==r){var i=e[(r+1)%e.length],o=e[(r+2)%e.length],c=Math.PI*n,u=-Math.cos(i)*Math.cos(o)+Math.sin(i)*Math.sin(o)*Math.cos(Math.PI-c),a=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(i)*Math.sin(o)/(1-u),s=-Math.acos(a)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},Wr,ti,Oi,Kr,Er,ci,xr,wr,si,vi,Bi,Ni),lo=function(e,t){Qr(e).vertices;var n,r=ei(e,t),i=((n=Qn.core).midpoint.apply(n,o(r)),{vector:Qn.core.rotate90(t.vector),origin:t.origin});return ei(e,i)},vo=Object.freeze({__proto__:null,one_crease_arrow:function(e,t,n,r){return lo(e,t)}}),po=function(e,t){return Qn.core.intersect_lines(e.vector,e.origin,t.vector,t.origin,Qn.core.include_l,Qn.core.include_l)},ho=function(e,t){var n=Qn.core.intersect_lines(e.vector,e.origin,Qn.core.rotate270(e.vector),t,Qn.core.include_l,Qn.core.include_l),r=Qn.core.subtract(n,t);return Qn.core.add(midpoint,r)},go=function(e,t,n){var r=function(e){var t=e.vertices_coords;return Qn.core.convex_hull(t)}(e),i=Qn.core.rotate270(t.vector),o=Qn.core.clip_line_in_convex_poly_exclusive(r,i,n).map((function(e){return Qn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),c=Qn.core.scale(Qn.core.normalize(i),o);return[Qn.core.add(n,Qn.core.flip(c)),Qn.core.add(n,c)]},mo=[null,function(e,t,n){return[go(n,t,Qn.core.midpoint(e.points[0],e.points[1]))]},function(e){return[e.points]},function(e,t,n){var r,i=e.lines.map((function(e){return boundary.clipLine(e)})),c=(r=ear).intersect.apply(r,o(i));if(c){var u=e.lines.map((function(e){return e.vector})),a=u.map(Qn.core.flip),s=u.concat(a).map((function(e){return ear.ray(e,c)})),f=s.filter((function(e){return Qn.core.dot(e.vector,t.vector)>0&&Qn.core.cross2(e.vector,t.vector)>0})).shift(),l=s.filter((function(e){return Qn.core.dot(e.vector,t.vector)>0&&Qn.core.cross2(e.vector,t.vector)<0})).shift(),v=s.filter((function(e){return Qn.core.dot(e.vector,t.vector)<0&&Qn.core.cross2(e.vector,t.vector)>0})).shift(),d=s.filter((function(e){return Qn.core.dot(e.vector,t.vector)<0&&Qn.core.cross2(e.vector,t.vector)<0})).shift(),p=[f,l,v,d].map((function(e){return ear.intersect(boundary,e).shift().shift()})),h=p.map((function(e){return Qn.core.distance(e,c)}));h[0]<h[1]?(p[0],Qn.core.add(l.origin,l.vector.normalize().scale(h[0]))):(p[1],Qn.core.add(f.origin,f.vector.normalize().scale(h[1]))),h[2]<h[3]?(p[2],Qn.core.add(d.origin,d.vector.normalize().scale(h[2]))):(p[3],Qn.core.add(v.origin,v.vector.normalize().scale(h[3])))}else{var g,m=i.map((function(e){return Qn.core.midpoint(e[0],e[1])})),_=(g=ear.line).fromPoints.apply(g,o(m)),y=ear.intersect(t,_),b=ear.line(t.vector.rotate90(),y),x=e.lines.map((function(e){return ear.intersect(e,b)}));x[0],x[1]}},function(e,t,n){return[go(n,t,po(t,e.lines[0]))]},function(e,t){return[[e.points[1],ho(t,e.points[1])]]},function(e,t){return e.points.map((function(e){return[e,ho(t,e)]}))},function(e,t,n){return[[e.points[0],ho(fold_line,e.points[0])],go(n,t,po(t,e.lines[1]))]}];delete mo[0];var _o=Object.assign(Object.create(null),vo,{axiom_arrows:mo}),yo=Object.create(null),bo=function(e,t){var n=this;Object.defineProperty(e,"degree",{get:function(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},xo=function(e,t){var n=this;Object.defineProperty(e,"coords",{get:function(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Mo=function(e,t){var n=this;Object.defineProperty(e,"simple",{get:function(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var i=r+1;i<e.length;i+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][i])return!1;return!0}})},Ao=function(e,t){var n=this;Object.defineProperty(e,"coords",{get:function(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Eo={vertices:function(e,t){return bo.call(this,e,t),e},edges:function(e,t){return xo.call(this,e,t),e},faces:function(e,t){return Mo.call(this,e,t),Ao.call(this,e,t),e}},Oo={};Oo.prototype=Object.create(Object.prototype);var ko=Object.assign({clean:ro,populate:mi,fragment:Xi,subgraph:ki,assign:Ai},Oi);Object.keys(ko).forEach((function(e){Oo.prototype[e]=function(){return ko[e].apply(ko,[this].concat(Array.prototype.slice.call(arguments)))}})),Oo.prototype.copy=function(){return Object.assign(Object.create(Oo),Zi(this))},Oo.prototype.load=function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===e(t)&&(!0!==r.append&&rr.forEach((function(e){return delete n[e]})),Object.assign(this,{file_spec:er,file_creator:tr},Zi(t)))},Oo.prototype.clear=function(){var e=this;nr.graph.forEach((function(t){return delete e[t]})),nr.orders.forEach((function(t){return delete e[t]})),delete this.file_frames};var wo=function(e,t,n){var r=this,i=Object.create(null);return Object.keys(e).forEach((function(t){i[t.substring(r.length+1)]=e[t]})),i},jo=function(e){return _r(this,e).map(wo.bind(e)).map(Eo[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Oo.prototype,e,{get:function(){return jo.call(this,e)}})})),Object.defineProperty(Oo.prototype,"junctions",{get:function(){return Fr(this).map((function(e){return Qn.junction.apply(Qn,o(e))}))}}),Object.defineProperty(Oo.prototype,"boundary",{get:function(){var e=this,t=Qr(this),n=Qn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}});var So={vertices:ni,edges:ri,faces:ii},Po=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=(t=Qn.core).get_vector.apply(t,r),c=So[e](this,o),u=yr(this,e,c);return Eo[e].call(this,u,c),u.index=c,u};Oo.prototype.nearest=function(){var e=arguments,t=this,n=Object.create(null);return["vertices","edges","faces"].forEach((function(r){return Object.defineProperty(n,fr[r],{get:function(){return Po.call.apply(Po,[t,r].concat(o(e)))}})})),n};var No=Oo.prototype,zo={};zo.prototype=Object.create(No);["line","ray","segment"].forEach((function(e){zo.prototype[e]=function(){var t=Qn[e].apply(Qn,arguments);if(t){var n=ei(this,line);if(n){var r=_i(this,n);Yi(this,r);Xi(this),mi(this)}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){zo.prototype[e]=function(){var t=this,n=Qn[e].apply(Qn,arguments);if(n){var r=n.segments(96).map((function(e){return Qn.segment(e)})).map((function(e){return ei(t,e)})).filter((function(e){return void 0!==e}));r&&(r.forEach((function(e){var n=_i(t,e);Yi(t,n)})),Xi(this),mi(this))}}}));var Co={};Co.prototype=Object.create(No);["line","ray","segment"].forEach((function(e){Co.prototype[e]=function(){var t=Qn[e].apply(Qn,arguments);if(t){var n=ei(this,t);if(n){var r=_i(this,n),i=Yi(this,r),o=Xi(this).edges.map;return mi(this),i.map((function(e){return o[e]}))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){Co.prototype[e]=function(){var t=this,n=Qn[e].apply(Qn,arguments);if(n){var r=n.segments(96).map((function(e){return Qn.segment(e)})).map((function(e){return ei(t,e)})).filter((function(e){return void 0!==e}));if(r){var i=[],c=[];r.forEach((function(e){var n=_i(t,e);i.push.apply(i,o(n)),c.push.apply(c,o(Yi(t,n)))}));var u=Xi(this).edges.map;return mi(this),c.map((function(e){return u[e]}))}}}}));var Io=Co.prototype,Lo=function(e){return 4===e?[[0,0],[1,0],[1,1],[0,1]]:Qn.core.make_regular_polygon(e,.5/Math.sin(Math.PI/e))},Fo={},qo=[null,null,null,"triangle","square","pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];[0,1,2].forEach((function(e){delete qo[e]}));var Vo=function(e){return mi(e)};qo.forEach((function(e,t){var n=Array.from(Array(t));Fo[e]=function(){return Vo({vertices_coords:Lo(t),edges_vertices:n.map((function(e,t){return[t,(t+1)%n.length]})),edges_assignment:n.map((function(){return"B"}))})}})),Fo.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return Vo({vertices_coords:Qn.core.make_regular_polygon(e,1),edges_vertices:Array.from(Array(e)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(e)).map((function(){return"B"}))})},Fo.kite=function(){return Vo({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:["B","B","B","B","B","B","V","V","F"]})};var Go=[null,Qn.core.axiom1,Qn.core.axiom2,Qn.core.axiom3,Qn.core.axiom4,Qn.core.axiom5,Qn.core.axiom6,Qn.core.axiom7];delete Go[0];var Bo=function(e,t){return Go[e].apply(Go,o(function(e,t,n){switch(e){case"1":case"2":case 1:case 2:return t;case"3":case 3:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin];case"4":case 4:return[n[0].vector,t[0]];case"5":case 5:return[n[0].vector,n[0].origin,t[0],t[1]];case"6":case 6:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin,t[0],t[1]];case"7":case 7:return[n[0].vector,n[0].origin,n[1].vector,t[0]]}return[]}(e,t.points.map((function(e){return Qn.core.get_vector(e)})),t.lines.map((function(e){return Qn.core.get_line(e)})))))};Object.keys(Go).forEach((function(e){Bo[e]=Go[e]}));var To,Do={axioms:{ar:[null,"   ","        ","        ","          ","         ","            ","          "],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una lnea entre dos puntos","dobla dos puntos juntos","dobla y une dos lneas","dobla una lnea sobre s misma, doblndola hacia un punto","dobla un punto hasta una lnea, doblndola a travs de otro punto","dobla un punto hacia una lnea y otro punto hacia otra lnea","dobla un punto hacia una lnea y otra lnea sobre s misma"],fr:[null,"crez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-mme  l'aide d'un pli qui passe par un point","rabattez un point sur une ligne  l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-mme"],hi:[null,"        ","         ","        ","                  ","                 ","                   ","                      "],jp:[null,"2","2","2","","","",""],ko:[null,"    ","   ","   ","      ","  ,    ","       ","       "],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto at uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto at uma linha e outro ponto at outra linha","dobre um ponto at uma linha e outra linha sobre si mesma"],ru:[null,"    ","   ","   ","   ,   ","   ,    ","         ","        "],tr:[null,"iki noktadan geen bir izgi boyunca katla","iki noktay birbirine katla","iki izgiyi birbirine katla","bir noktadan kvrarak kendi zerindeki bir izgi boyunca katla","baka bir noktadan kvrarak bir noktay bir izgiye katla","bir noktay bir izgiye ve baka bir noktay baka bir izgiye katla","bir noktay bir izgiye ve baka bir izgiyi kendi zerine katla"],vi:[null,"to mt np gp i qua hai im","to np gp bng cch gp mt im ny sang im khc","to np gp bng cch gp mt ng ln mt ng khc","to mt np gp i qua mt im v a mt ng ln trn chnh n","to mt np gp i qua im u tin v a im th hai ln ng thng","to mt np gp mang im u tin n ng u tin v im th hai cho ng th hai","to mt np gp mang li mt im cho mt ng v a mt ng th hai ln trn chnh n"],zh:[null,"","","","","","",""]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaa",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"",mountain:"",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",blintz:"",squash:"",flip:""}}},Uo=function(){var e={};if(s){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else a&&(e=window);return e}(),Ro=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Qn.core.mag_squared(t)<Qn.core.EPSILON)throw"degenerate edge";for(var i=Qn.core.normalize(t),o=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return Qn.core.cross3(e,i)})).sort((function(e,t){return Qn.core.magnitude(t)-Qn.core.magnitude(e)})).shift(),c=[Qn.core.normalize(o)],u=1;u<4;u+=1)c.push(Qn.core.cross3(c[u-1],i));var a=c.map((function(e){return Qn.core.scale(e,n)})),s=[-r,r].map((function(e){return Qn.core.scale(i,e)})),f=0===r?e:e.map((function(e,t){return Qn.core.add(e,s[t])}));return f.map((function(e){return a.map((function(t){return Qn.core.add(e,t)}))})).reduce(ji,[])},Xo=Object.freeze({__proto__:null,make_faces_geometry:function(e){var t=Uo.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(ji,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(ji,[]),i=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(ji,[]),o=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(ji,[]).reduce(ji,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(i,3)),c.setIndex(o),c},make_edges_geometry:function(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,i=e.edges_coords,o=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Uo.THREE;i||(i=n.map((function(e){return e.map((function(e){return t[e]}))}))),o||(o=i.map((function(e){return Qn.core.subtract(e[1],e[0])}))),i=i.map((function(e){return e.map((function(e){return Qn.core.resize(3,e)}))})),o=o.map((function(e){return Qn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},f=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(ji,[]).reduce(ji,[]).reduce(ji,[]),l=i.map((function(e,t){return Ro(e,o[t],c,u)})).reduce(ji,[]).reduce(ji,[]),v=o.map((function(e){if(Qn.core.mag_squared(e)<Qn.core.EPSILON)throw"degenerate edge";var t=Qn.core.normalize(e),n=(Qn.core.scale(t,c),Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,-1])),c)),r=Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(ji,[]).reduce(ji,[]),d=i.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(ji,[]),p=new a.BufferGeometry;return p.setAttribute("position",new a.Float32BufferAttribute(l,3)),p.setAttribute("normal",new a.Float32BufferAttribute(v,3)),p.setAttribute("color",new a.Float32BufferAttribute(f,3)),p.setIndex(d),p.computeVertexNormals(),p}}),Zo={};["number","object","transform","class","style","function","string","undefined","boolean","path","svg","id","viewBox"].forEach((function(e){return Zo[e]=e}));var Yo=("undefined"==typeof window?"undefined":e(window))!==Zo.undefined&&e(window.document)!==Zo.undefined,$o=("undefined"==typeof process?"undefined":e(process))!==Zo.undefined&&null!=process.versions&&null!=process.versions.node,Ho=("undefined"==typeof self?"undefined":e(self))===Zo.object&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Jo=Object.freeze({__proto__:null,isBrowser:Yo,isNode:$o,isWebWorker:Ho}),Wo=function(){var e={};if($o){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Yo&&(e=window);return e}(),Qo="http://www.w3.org/2000/svg",Ko={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},ec=function(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},tc=function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==i)return"";var c=ec(r,n),u=ec(i,n),a=[u[0]-c[0],u[1]-c[1]],s=c[0]*u[1]-c[1]*u[0],f=c[0]*u[0]+c[1]*u[1],l=Math.atan2(s,f)>0?0:1,v=o?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return v+=["a ",n,n,0,l,1,a[0],a[1]].join(" "),o&&(v+=" Z"),v},nc=function(e,t,n,r,i){return[tc(e,t,n,r,i,!1)]},rc={arc:{nodeName:"path",attributes:["d"],args:nc,methods:{setArc:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",nc.apply(void 0,n))}}}},ic=function(e,t,n,r,i){return[tc(e,t,n,r,i,!0)]},oc={wedge:{nodeName:"path",args:ic,attributes:["d"],methods:{setArc:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",ic.apply(void 0,n))}}}},cc=128,uc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-cc)/cc*2+1})).map((function(i){return[e+(i+1)*n*.5,t+Math.pow(i,2)*r]}))},ac={parabola:{nodeName:"polyline",attributes:["points"],args:function(e,t,n,r){return[uc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},sc=function(e,t,n,r){var i=[e,t];return Array.from(Array(r)).map((function(e,t){return 2*Math.PI*t/r})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return i.map((function(t,r){return t+n*e[r]}))}))},fc={regularPolygon:{nodeName:"polygon",attributes:["points"],args:function(e,t,n,r){return[sc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},lc={roundRect:{nodeName:"path",attributes:["d"],args:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;i>n/2&&(i=n/2),i>r/2&&(i=r/2);var o=n-2*i,c=r-2*i,u="A".concat(i," ").concat(i," 0 0 1");return["M".concat(e+(n-o)/2,",").concat(t),"h".concat(o),u,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),u,"".concat(e+n-i,",").concat(t+r),"h".concat(-o),u,"".concat(e,",").concat(t+r-i),"v".concat(-c),u,"".concat(e+i,",").concat(t)].join(" ")}}},vc=function(t){return null!=t&&e(t[Symbol.iterator])===Zo.function},dc=function e(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return vc(arguments[0])&&"string"!=typeof arguments[0]?e.apply(void 0,o(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return vc(t)?o(e(t)):t})).reduce((function(e,t){return e.concat(t)}),[])}},pc=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter((function(t){return e(t)===Zo.number})).concat(n.filter((function(t){return e(t)===Zo.object&&null!==t})).map((function(t){return e(t.x)===Zo.number?[t.x,t.y]:e(t[0])===Zo.number?[t[0],t[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},hc=function(e,t){return[e[0]+t[0],e[1]+t[1]]},gc=function(e,t){return[e[0]-t[0],e[1]-t[1]]},mc=function(e,t){return[e[0]*t,e[1]*t]},_c=function(){var e=pc.apply(void 0,o(dc.apply(void 0,arguments))),t=e.slice(0,4);if(!t.length)return[""];var n=e[4]||0,r=e[5]||.5,i=[t[0],t[1]],c=[t[2],t[3]],u=gc(c,i),a=hc(i,mc(u,.5)),s=[u[1],-u[0]],f=hc(a,mc(s,n)),l=hc(i,mc(gc(f,i),r)),v=hc(c,mc(gc(f,c),r));return["M".concat(i[0],",").concat(i[1],"C").concat(l[0],",").concat(l[1]," ").concat(v[0],",").concat(v[1]," ").concat(c[0],",").concat(c[1])]},yc={bend:function(e,t){return e.setAttribute("d",_c.apply(void 0,o(function(e){var t=e.getAttribute("d");return null==t||""===t?[]:[t.slice(t.indexOf("M")+1,t.indexOf("C")).split(","),t.split(" ").pop().split(",")].map((function(e){return e.map((function(e){return parseFloat(e)}))}))}(e)).concat([t]))),e}},bc={curve:{nodeName:"path",attributes:["d"],args:_c,methods:yc}},xc={};Object.assign(xc,rc,oc,ac,fc,lc,bc);var Mc=Object.keys(xc),Ac=[Ko.h,Ko.p,Ko.i],Ec=[Ko.g,Ko.v,Ko.t,Mc],Oc={svg:[Ko.s,Ko.d].concat(Ac).concat(Ec),g:Ec,text:[Ko.cT],linearGradient:[Ko.cG],radialGradient:[Ko.cG],defs:Ac,filter:[Ko.cF],marker:Ec,symbol:Ec,clipPath:Ec,mask:Ec},kc=Object.create(null);Object.keys(Oc).forEach((function(e){kc[e]=Oc[e].reduce((function(e,t){return e.concat(t)}),[])}));var wc=Object.freeze(kc),jc={toCamel:function(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},Sc=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,u=e-c-i,a=t-c-i,s=n+2*c+2*i,f=r+2*c+2*i;return[u,a,s,f].join(" ")};function Pc(){var e=pc.apply(void 0,o(dc(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?Sc.apply(void 0,o(e)):void 0}var Nc=function(e){return(new Wo.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},zc=function(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},Cc=function(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},Ic=function(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),Cc(e,t)},Lc={removeChildren:zc,appendTo:function(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(jc.toKebab(n),t[n])}))}},Fc=function e(t){if(null===t)return t;for(var n=t.childNodes.length-1;n>=0;n-=1){var r=t.childNodes[n];3===r.nodeType&&r.data.match(/^\s*$/)&&t.removeChild(r),1===r.nodeType&&e(r)}return t},qc=function(e){return(new Wo.DOMParser).parseFromString(e,"text/xml")},Vc=function(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return Fc(e.documentElement)},Gc=function(t){if(e(t)===Zo.string||t instanceof String)try{return Vc(qc(t))}catch(e){return e}if(null!=t.childNodes)return t},Bc=function(t){return function(t){return e(t)===Zo.string&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(t)&&t.length<1e4}(t)&&Yo&&e(Wo.fetch)===Zo.function?function(t){return new Promise((function(n,r){if(e(t)===Zo.string||t instanceof String)fetch(t).then((function(e){return e.text()})).then((function(e){return Vc(qc(e))})).then((function(e){return"svg"===e.nodeName?e:e.getElementsByTagName("svg")[0]})).then((function(e){return null==e?r("valid XML found, but no SVG element"):n(e)})).catch((function(e){return r(e)}));else if(t instanceof Wo.Document)return asyncDone(t)}))}(t):Gc(t)};var Tc=function(e,t){if((t=Object.assign({download:!1,output:Zo.string,windowStyle:!1,filename:"image.svg"},t)).windowStyle){var n=Wo.document.createElementNS(Qo,Zo.style);n.setAttribute("type","text/css"),n.innerHTML=function(){var e=[];if(Wo.document.styleSheets)for(var t=0;t<Wo.document.styleSheets.length;t+=1){var n=Wo.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),i=0;i<r.length;i+=1){var o=r[i];"cssText"in o?e.push(o.cssText):e.push("".concat(o.selectorText," {\n").concat(o.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r,i,o,c,u=function(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",u=null!=t&&"string"==typeof t?t:"\t",a=["\n"],s=0;s<100;s+=1)a.push(a[s]+u);for(var f=0;f<r;f+=1)n[f].search(/<!/)>-1?(c+=a[o]+n[f],i=!0,(n[f].search(/-->/)>-1||n[f].search(/\]>/)>-1||n[f].search(/!DOCTYPE/)>-1)&&(i=!1)):n[f].search(/-->/)>-1||n[f].search(/\]>/)>-1?(c+=n[f],i=!1):/^<\w/.exec(n[f-1])&&/^<\/\w/.exec(n[f])&&/^<[\w:\-\.\,]+/.exec(n[f-1])==/^<\/[\w:\-\.\,]+/.exec(n[f])[0].replace("/","")?(c+=n[f],i||(o-=1)):n[f].search(/<\w/)>-1&&-1===n[f].search(/<\//)&&-1===n[f].search(/\/>/)?c=c+=i?n[f]:a[o++]+n[f]:n[f].search(/<\w/)>-1&&n[f].search(/<\//)>-1?c=c+=i?n[f]:a[o]+n[f]:n[f].search(/<\//)>-1?c=c+=i?n[f]:a[--o]+n[f]:n[f].search(/\/>/)>-1?c=c+=i?n[f]:a[o]+n[f]:n[f].search(/<\?/)>-1||n[f].search(/xmlns\:/)>-1||n[f].search(/xmlns\=/)>-1?c+=a[o]+n[f]:c+=n[f];return"\n"===c[0]?c.slice(1):c}((new Wo.XMLSerializer).serializeToString(e));return t.download&&Yo&&!$o&&(r=t.filename,i=u,o=new Wo.Blob([i],{type:"text/plain"}),(c=Wo.document.createElement("a")).setAttribute("href",Wo.URL.createObjectURL(o)),c.setAttribute("download",r),Wo.document.body.appendChild(c),c.click(),Wo.document.body.removeChild(c)),"svg"===t.output?e:u},Dc=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=1===n.length&&"string"==typeof n[0]?n[0]:Pc.apply(void 0,n);return i&&e.setAttribute(Zo.viewBox,i),e},Uc=function(e){var t=e.getAttribute(Zo.viewBox);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},Rc=function(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var i=r.matrixTransform(e.getScreenCTM().inverse());return[i.x,i.y]},Xc=Object.freeze({__proto__:null,setViewBox:Dc,getViewBox:Uc,convertToViewBox:Rc}),Zc=function(t,n){var r=Bc(n);if(null!=r)return e(r.then)===Zo.function?r.then((function(e){return Ic(t,e)})):Ic(t,r)},Yc=function(t){var n=Uc(t);if(void 0!==n)return n;if(e(t.getBoundingClientRect)===Zo.function){var r=t.getBoundingClientRect();return[r.x,r.y,r.width,r.height]}return[]},$c="svg-background-rectangle",Hc=function(e,t){var n=function(e){var t=e.getElementsByTagName(Zo.style);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(Zo.style),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(Nc(t)),n},Jc={clear:function(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),zc(e)},size:Dc,setViewBox:Dc,getViewBox:Uc,padding:function(e,t){var n=Uc(e);return void 0!==n&&Dc.apply(void 0,[e].concat(o([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(Zo.class)===$c})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(o(Yc(e))))).setAttribute(Zo.class,$c),n.setAttribute("stroke","none"),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function(e){return Yc(e)[2]},getHeight:function(e){return Yc(e)[3]},stylesheet:function(e,t){return Hc.call(this,e,t)},load:Zc,save:Tc},Wc={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},Qc=Object.values(Wc).reduce((function(e,t){return e.concat(t)}),[]),Kc=function(e,t,n){return Object.defineProperty(e,t,{get:function(){return n},enumerable:!0,configurable:!0})},eu=function(e){var t=[],n=[];Object.keys(Wc).forEach((function(e){Wc[e].forEach((function(e){n[e]=[]}))}));var r={press:function(){},release:function(){},move:function(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),["startX","startY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return Kc(e,n,t[r])}))}};Object.keys(Wc).forEach((function(t){var i="on"+jc.capitalized(t);Object.defineProperty(e,i,{set:function(i){return null==i?function(t){return Wc[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):Wc[t].forEach((function(o){var c=function(n){var o=null!=n.touches?n.touches[0]:n;if(void 0!==o){var c=Rc(e,o.clientX,o.clientY).map((function(e){return isNaN(e)?void 0:e}));["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return Kc(n,e,c[t])})),r[t](n,c)}i(n)};e.addEventListener&&(n[o].push(c),e.addEventListener(o,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function(){return function(e,t){return Qc.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},tu=function(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},nu=function(e){var t,n,r={},i=0,o=function(){Wo.cancelAnimationFrame&&Wo.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,i=0};Object.defineProperty(e,"play",{set:function(e){if(o(),null!=e){var c=tu();r[c]=function(o){t||(t=o,i=0),e({time:.001*(o-t),frame:i}),i+=1,r[c]&&(n=Wo.requestAnimationFrame(r[c]))},Wo.requestAnimationFrame&&(n=Wo.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:o,enumerable:!0})},ru=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},iu=function(e,t){return Math.sqrt(ru(e,t))},ou=Object.freeze({__proto__:null,distanceSq2:ru,distance2:iu}),cu=[["cx","cy"],["x","y"]],uu=function(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function(e){return e}},r=function(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),cu.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},i=new Proxy(t,{set:function(e,t,n){return e[t]=n,r(),!0}}),c=function(){pc.apply(void 0,o(dc.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),"function"==typeof t.delegate&&t.delegate.apply(t.pointsContainer,[i,t.pointsContainer])};return t.delegate=void 0,t.setPosition=c,t.onMouseMove=function(e){return n.selected?c(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(ru(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function(){return t[n]},set:function(e){t[n]=e}})})),["svg","updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function(){return n[e]},set:function(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function(){!function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),i},au=function(e,t,n){var r,i,o=Array.from(Array(t)).map((function(){return uu(e)})),c=function(e){return"function"==typeof i?i.call(o,e,r,o):void 0};o.forEach((function(e){e.delegate=c,e.pointsContainer=o}));e.onPress=function(e){o.length>0&&(r=o.map((function(t,n){return{i:n,d:ru(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,o[r].selected=!0)},e.onMove=function(e){o.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function(){o.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(o,"selectedIndex",{get:function(){return r}}),Object.defineProperty(o,"selected",{get:function(){return o[r]}}),Object.defineProperty(o,"add",{value:function(t){o.push(uu(e))}}),o.removeAll=function(){for(;o.length>0;)o.pop().remove()};var u={onChange:function(e,t){if(i=e,!0===t){var n=o.length-1;e.call(o,o[n],n,o)}},position:function(e){return o.forEach((function(t,n){return t.setPosition(e.call(o,o,n))}))},svg:function(e){return o.forEach((function(t,n){t.svg=e.call(o,o,n)}))}};return Object.keys(u).forEach((function(e){o[e]=function(){return"function"==typeof arguments[0]&&u[e].apply(u,arguments),o}})),o.parent=function(e){return null!=e&&null!=e.appendChild&&o.forEach((function(t){e.appendChild(t.svg)})),o},o},su=function(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return au.call.apply(au,[e,e].concat(n))}},fu=(new Wo.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,lu={svg:{args:function(){return[Pc(pc.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:Jc,init:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r.filter((function(t){return e(t)===Zo.string})).forEach((function(e){return Zc(t,e)})),r.filter((function(e){return null!=e})).filter((function(e){return e instanceof fu})).filter((function(t){return e(t.appendChild)===Zo.function})).forEach((function(e){return e.appendChild(t)})),eu(t),nu(t),su(t)}}},vu=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map((function(e){return Gc(e)})).filter((function(e){return void 0!==e}));return i.filter((function(e){return e.tagName===Zo.svg})).forEach((function(t){return Cc(e,t)})),i.filter((function(e){return e.tagName!==Zo.svg})).forEach((function(t){return e.appendChild(t)})),e},du={g:{init:vu,methods:{load:vu}}},pu=Object.assign(Object.create(null),{svg:["viewBox"],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"],mask:["id"],symbol:["id"],clipPath:["id","clip-rule"],marker:["id","markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),hu=function(e,t){return e.setAttribute(pu.circle[2],t),e},gu=function(e,t,n){return o(pc.apply(void 0,o(dc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(pu.circle[n],t)})),e},mu=function(e,t,n,r){return[e,t,iu([e,t],[n,r])]},_u={circle:{args:function(e,t,n,r){var i=pc.apply(void 0,o(dc(e,t,n,r)));switch(i.length){case 0:case 1:return[,,].concat(o(i));case 2:case 3:return i;default:return mu.apply(void 0,o(i))}},methods:{radius:hu,setRadius:hu,origin:gu,setOrigin:gu,center:gu,setCenter:gu,position:gu,setPosition:gu}}},yu=function(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(pu.ellipse[n],t)})),e},bu=function(e,t,n){return o(pc.apply(void 0,o(dc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(pu.ellipse[n],t)})),e},xu={ellipse:{args:function(e,t,n,r){var i=pc.apply(void 0,o(dc(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:return[,,].concat(o(i));default:return i}},methods:{radius:yu,setRadius:yu,origin:bu,setOrigin:bu,center:bu,setCenter:bu,position:bu,setPosition:bu}}},Mu=function(e,t,n,r){return pc.apply(void 0,o(dc(e,t,n,r))).slice(0,4)},Au={line:{args:Mu,methods:{setPoints:function(e,t,n,r,i){return Mu(t,n,r,i).forEach((function(t,n){return e.setAttribute(pu.line[n],t)})),e}}}},Eu=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,Ou=/-?[0-9]*\.?\d+/g,ku={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(ku).forEach((function(e){var t=ku[e];ku[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var wu=function(e){var t=e.getAttribute("d");return null==t?"":t},ju=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.setAttribute("d","".concat(wu(e)).concat(t).concat(dc.apply(void 0,r).join(" "))),e},Su=function(e){return function(e){for(var t,n=[];null!==(t=Eu.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(Ou);return e.en=ku[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(wu(e))},Pu={addCommand:ju,appendCommand:ju,clear:function(e){return e.removeAttribute("d"),e},getCommands:Su,get:Su,getD:function(e){return e.getAttribute("d")}};Object.keys(ku).forEach((function(e){Pu[ku[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ju.apply(void 0,[t,e].concat(r))}}));var Nu={path:{methods:Pu}},zu=function(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(pu.rect[n],t)})),e},Cu=function(e,t,n){return o(pc.apply(void 0,o(dc(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(pu.rect[n],t)})),e},Iu=function(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},Lu={rect:{args:function(e,t,n,r){var i=pc.apply(void 0,o(dc(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:case 3:return Iu([,,].concat(o(i)));default:return Iu(i)}},methods:{origin:Cu,setOrigin:Cu,center:Cu,setCenter:Cu,size:zu,setSize:zu}}},Fu={style:{init:function(e,t){e.textContent="",e.appendChild(Nc(t))},methods:{setTextContent:function(e,t){return e.textContent="",e.appendChild(Nc(t)),e}}}},qu={text:{args:function(e,t,n){return pc.apply(void 0,o(dc(e,t,n))).slice(0,2)},init:function(t,n,r,i,o){var c=[n,r,i,o].filter((function(t){return e(t)===Zo.string})).shift();c&&t.appendChild(Wo.document.createTextNode(c))}}},Vu=function(){return Array.from(arguments).filter((function(t){return e(t)===Zo.string||t instanceof String})).shift()||tu()},Gu=function(){return[Vu.apply(void 0,arguments)]},Bu={mask:{args:Gu},clipPath:{args:Gu},symbol:{args:Gu},marker:{args:Gu,methods:{size:Dc,setViewBox:Dc}}},Tu=function(e){var t=e.getAttribute("points");return null==t?"":t},Du=function(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},Uu=function(){return[Du.apply(void 0,o(pc.apply(void 0,o(dc.apply(void 0,arguments)))))]},Ru=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",Uu.apply(void 0,n)[0]),e},Xu=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",[Tu(e),Uu.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},Zu=function(){return 1===arguments.length&&e(arguments.length<=0?void 0:arguments[0])===Zo.string?[arguments.length<=0?void 0:arguments[0]]:Uu.apply(void 0,arguments)},Yu={polyline:{args:Zu,methods:{setPoints:Ru,addPoint:Xu}},polygon:{args:Zu,methods:{setPoints:Ru,addPoint:Xu}}},$u=Object.assign({},lu,du,_u,xu,Au,Nu,Lu,Fu,qu,Bu,Yu),Hu={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(Ko).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===pu[e]})).forEach((function(e){pu[e]=[]})),[[["svg","defs","g"].concat(Ko.v,Ko.t),Hu.presentation],[["filter"],Hu.effects],[Ko.cT.concat("text"),Hu.text],[Ko.cF,Hu.effects],[Ko.cG,Hu.gradient]].forEach((function(e){return e[0].forEach((function(t){pu[t]=pu[t].concat(e[1])}))}));var Ju=function(e){if(null==e)return[];var t=e.getAttribute(Zo.class);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},Wu={addClass:function(e,t){var n=Ju(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,Zo.class,n.join(" "))},removeClass:function(e,t){var n=Ju(e).filter((function(e){return e!==t}));e.setAttributeNS(null,Zo.class,n.join(" "))},setClass:function(e,t){e.setAttributeNS(null,Zo.class,t)},setId:function(e,t){e.setAttributeNS(null,Zo.id,t)}},Qu=function(e){var t=e.getAttribute(Zo.transform);return null==t||""===t?void 0:t},Ku={clearTransform:function(e){return e.removeAttribute(Zo.transform),e}};["translate","rotate","scale","matrix"].forEach((function(e){Ku[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.setAttribute(Zo.transform,[Qu(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var ea={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(t){ea[jc.toCamel(t)]=function(n,r){return n.setAttribute(t,function(t){if(null==t)return"";if(e(t)===Zo.string)return"url"===t.slice(0,3)?t:"url(#".concat(t,")");if(null!=t.getAttribute){var n=t.getAttribute(Zo.id);return"url(#".concat(n,")")}return""}(r))}}));var ta={};(To=Ko.v).push.apply(To,o(Object.keys(xc))),Object.keys(xc).forEach((function(e){xc[e].attributes=void 0===xc[e].attributes?o(Hu.presentation):xc[e].attributes.concat(Hu.presentation)})),Object.assign(ta,$u,xc),Object.keys(Ko).forEach((function(e){return Ko[e].filter((function(e){return void 0===ta[e]})).forEach((function(e){ta[e]={}}))}));var na=function(){return Array.from(arguments)};Object.keys(ta).forEach((function(e){ta[e].nodeName||(ta[e].nodeName=e),ta[e].init||(ta[e].init=na),ta[e].args||(ta[e].args=na),ta[e].methods||(ta[e].methods={}),ta[e].attributes||(ta[e].attributes=pu[e]||[])}));var ra=function(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){ta[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};ra(dc(Ko.t,Ko.v,Ko.g,Ko.s,Ko.p,Ko.i,Ko.h,Ko.d),Wu),ra(dc(Ko.t,Ko.v,Ko.g,Ko.s,Ko.p,Ko.i,Ko.h,Ko.d),Lc),ra(dc(Ko.v,Ko.g,Ko.s),Ku),ra(dc(Ko.t,Ko.v,Ko.g),ea);var ia={svg:{version:"1.1",xmlns:Qo},style:{type:"text/css"}},oa=function(e,t){ia[t]&&Object.keys(ia[t]).forEach((function(n){return e.setAttribute(n,ia[t][n])}))},ca={},ua=function e(t){for(var n,r,i=arguments.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=arguments[c];var u=Wo.document.createElementNS(Qo,ta[t].nodeName);return oa(u,t),(n=ta[t]).init.apply(n,[u].concat(o)),(r=ta[t]).args.apply(r,o).forEach((function(e,n){null!=ta[t].attributes[n]&&u.setAttribute(ta[t].attributes[n],e)})),ta[t].attributes.forEach((function(e){Object.defineProperty(u,jc.toCamel(e),{value:function(){return u.setAttribute.apply(u,[e].concat(Array.prototype.slice.call(arguments))),u}})})),Object.keys(ta[t].methods).forEach((function(e){return Object.defineProperty(u,e,{value:function(){var n;return(n=ta[t].methods[e]).call.apply(n,[ca,u].concat(Array.prototype.slice.call(arguments)))}})})),wc[t]&&wc[t].forEach((function(t){Object.defineProperty(u,t,{value:function(){var n=e.apply(void 0,[t].concat(Array.prototype.slice.call(arguments)));return u.appendChild(n),n}})})),u};ca.Constructor=ua;var aa={};Object.keys(Ko).forEach((function(e){return Ko[e].forEach((function(e){aa[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ua.apply(void 0,[e].concat(n))}}))}));var sa=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r.filter((function(t){return e(t)===Zo.function})).forEach((function(e){return e.call(t,t)}))},fa=function(){var e=arguments,t=ua.apply(void 0,[Zo.svg].concat(Array.prototype.slice.call(arguments)));return"loading"===Wo.document.readyState?Wo.document.addEventListener("DOMContentLoaded",(function(){return sa.apply(void 0,[t].concat(o(e)))})):sa.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t};Object.assign(fa,aa),fa.NS=Qo,fa.linker=function(e){var t=this;["segment","circle","ellipse","rect","polygon"].filter((function(t){return e[t]&&e[t].prototype})).forEach((function(n){e[n].prototype.svg=function(){return t.path(this.svgPath())}})),e.svg=t}.bind(fa),fa.core=Object.assign(Object.create(null),{load:Bc,save:Tc,coordinates:pc,flatten:dc,attributes:pu,children:wc,cdata:Nc,detect:Jo},jc,Wu,Lc,ou,Ku,Xc);var la=function(t){return t.filter((function(t){return function(t){if("object"!==e(t))return!1;var n=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(t).map((function(e){return n.includes(e)})).reduce((function(e,t){return e||t}),!1)}(t)})).shift()};function va(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",u=null!=t&&"string"==typeof t?t:"\t",a=["\n"],s=0;s<100;s+=1)a.push(a[s]+u);for(var f=0;f<r;f+=1)n[f].search(/<!/)>-1?(c+=a[o]+n[f],i=!0,(n[f].search(/-->/)>-1||n[f].search(/\]>/)>-1||n[f].search(/!DOCTYPE/)>-1)&&(i=!1)):n[f].search(/-->/)>-1||n[f].search(/\]>/)>-1?(c+=n[f],i=!1):/^<\w/.exec(n[f-1])&&/^<\/\w/.exec(n[f])&&/^<[\w:\-\.\,]+/.exec(n[f-1])==/^<\/[\w:\-\.\,]+/.exec(n[f])[0].replace("/","")?(c+=n[f],i||(o-=1)):n[f].search(/<\w/)>-1&&-1===n[f].search(/<\//)&&-1===n[f].search(/\/>/)?c=c+=i?n[f]:a[o++]+n[f]:n[f].search(/<\w/)>-1&&n[f].search(/<\//)>-1?c=c+=i?n[f]:a[o]+n[f]:n[f].search(/<\//)>-1?c=c+=i?n[f]:a[--o]+n[f]:n[f].search(/\/>/)>-1?c=c+=i?n[f]:a[o]+n[f]:n[f].search(/<\?/)>-1||n[f].search(/xmlns\:/)>-1||n[f].search(/xmlns\=/)>-1?c+=a[o]+n[f]:c+=n[f];return"\n"===c[0]?c.slice(1):c}fa.use=function(e){var t=ta.svg.init;ta.svg.init=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=la(i);if(c){var u=e.options.apply(e,i);e.render_into_svg(n,c,u)}return t.apply(void 0,[n].concat(i))}};var da="vertices",pa="edges",ha="faces",ga="boundaries",ma="boundary",_a="mountain",ya="valley",ba="mark",xa="unassigned",Ma="front",Aa="back",Ea="svg",Oa="class",ka="index",wa="object",ja="string",Sa="undefined",Pa="black",Na="white",za="lightgray",Ca="stroke-width",Ia="vertices_coords",La="edges_vertices",Fa="faces_vertices",qa="faces_edges",Va="edges_assignment",Ga="faces_re:layer",Ba=("undefined"==typeof window?"undefined":e(window))!==Sa&&e(window.document)!==Sa,Ta=("undefined"==typeof process?"undefined":e(process))!==Sa&&null!=process.versions&&null!=process.versions.node,Da=function(){var e={};if(Ta){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Ba&&(e=window);return e}(),Ua="http://www.w3.org/2000/svg",Ra={SVG:{NS:Ua,g:function(){return Da.document.createElementNS(Ua,"g")},defs:function(){return Da.document.createElementNS(Ua,"defs")},style:function(){var e=Da.document.createElementNS(Ua,"style");return e.setAttributeNS(null,"type","text/css"),e},line:function(e,t,n,r){var i=Da.document.createElementNS(Ua,"line");return i.setAttributeNS(null,"x1",e),i.setAttributeNS(null,"y1",t),i.setAttributeNS(null,"x2",n),i.setAttributeNS(null,"y2",r),i},circle:function(e,t,n){var r=Da.document.createElementNS(Ua,"circle");return r.setAttributeNS(null,"cx",e),r.setAttributeNS(null,"cy",t),r.setAttributeNS(null,"r",n),r},polygon:function(e){var t=Da.document.createElementNS(Ua,"polygon"),n=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");return t.setAttributeNS(null,"points",n),t},path:function(e){var t=Da.document.createElementNS(Ua,"path");return t.setAttributeNS(null,"d",e),t}}},Xa=function t(n){return Object.freeze(n),void 0===n||Object.getOwnPropertyNames(n).filter((function(t){return null!==n[t]&&(e(n[t])===wa||"function"===e(n[t]))&&!Object.isFrozen(n[t])})).forEach((function(e){return t(n[e])})),n},Za=function t(n,r){return Object.keys(r).forEach((function(i){e(r[i])===wa&&null!==r[i]?(i in n||(n[i]={}),t(n[i],r[i])):e(n)!==wa||i in n||(n[i]=r[i])})),n},Ya=function(t){if(null==t)return{};if(e(t)===wa&&null!==t)return t;if(e(t)===ja||t instanceof String)try{return JSON.parse(t)}catch(e){return{}}return{}},$a=function(e){if(null==e.vertices_coords||e.vertices_coords.length<=0)return[0,0,0,0];var t=e.vertices_coords[0].length,n=Array(t).fill(1/0),r=Array(t).fill(-1/0);return e.vertices_coords.forEach((function(e){return e.forEach((function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)}))})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?[0,0,0,0]:[n[0],n[1],r[0]-n[0],r[1]-n[1]]},Ha="none",Ja="500px",Wa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Xa({input:ja,output:ja,padding:null,file_frame:null,stylesheet:null,shadows:null,boundaries:!0,faces:!0,edges:!0,vertices:!1,attributes:{svg:{width:Ja,height:Ja,stroke:Pa,fill:Ha,"stroke-linejoin":"bevel","stroke-width":e/200},circle:{r:e/200},boundaries:{fill:Na},faces:{stroke:Ha,front:{fill:za},back:{fill:Na},foldedForm:{stroke:Pa}},edges:{boundary:{},mountain:{stroke:"red"},valley:{stroke:"blue"},mark:{stroke:za},unassigned:{stroke:za}},vertices:{stroke:Ha,fill:Pa}}})},Qa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$a(e),r=Math.min(n[2],n[3]);return Za(t,Wa(r)),t.shadows&&Za(t,{attributes:{faces:{front:{filter:"url(#shadow)"},back:{filter:"url(#shadow)"}}}}),t},Ka=function(e){if(Ia in e==!1||La in e==!1||Va in e==!1)return[];var t=function(e){if(null==e.edges_assignment)return{vertices:[],edges:[]};for(var t=e.edges_assignment.map((function(e){return"B"===e||"b"===e})),n=function(e){if(e.edges_vertices){var t=[];return e.edges_vertices.forEach((function(e,n){return e.forEach((function(e){void 0===t[e]&&(t[e]=[]),t[e].push(n)}))})),t}}(e),r=[],o=[],c=-1,u=0;u<t.length;u+=1)if(t[u]){c=u;break}if(-1===c)return{vertices:[],edges:[]};t[c]=!1,r.push(c),o.push(e.edges_vertices[c][0]);for(var a=e.edges_vertices[c][1];o[0]!==a;){if(o.push(a),void 0===(c=n[a].filter((function(e){return t[e]})).shift()))return{vertices:[],edges:[]};a=e.edges_vertices[c][0]===a?i(e.edges_vertices[c],2)[1]:i(e.edges_vertices[c],1)[0],t[c]=!1,r.push(c)}return{vertices:o,edges:r}}(e).vertices.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}));if(0===t.length)return[];var n=Ra.SVG.polygon(t);return n.setAttributeNS(null,Oa,ma),[n]},es=function(e,t){if(Ia in e==!1)return[];var n=e.vertices_coords.map((function(e){return Ra.SVG.circle(e[0],e[1],.01)}));return n.forEach((function(e,t){return e.setAttributeNS(null,ka,t)})),n},ts={B:ma,b:ma,M:_a,m:_a,V:ya,v:ya,F:ba,f:ba,U:xa,u:xa},ns={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},rs=function(e){return null==e.edges_vertices||null==e.vertices_coords?[]:e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))}))},is=function(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])},os=function(e){var t=rs(e).map((function(e){return is(e)})).join("");return""===t?void 0:t},cs=function(e){if(null==e.edges_vertices||null==e.vertices_coords||null==e.edges_assignment)return[];var t=rs(e),n=function(e){var t={u:[],f:[],v:[],m:[],b:[]};return e.edges_assignment.map((function(e){return ns[e]})).forEach((function(e,n){return t[e].push(n)})),t}(e),r=Object.keys(n).map((function(e){return n[e].map((function(e){return t[e]}))})).map((function(e){return e.map((function(e){return is(e)})).join("")})),i={};return Object.keys(n).map((function(e,t){""!==r[t]&&(i[e]=r[t])})),i},us=function(e){if(null==e.edges_assignment){var t=os(e);return void 0===t?[]:[Ra.SVG.path(t)]}var n=cs(e);return Object.keys(n).map((function(e){var t=Ra.SVG.path(n[e]);return t.setAttributeNS(null,Oa,ts[e]),t}))},as={subtract:function(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},cross2:function(e,t){return e[0]*t[1]-e[1]*t[0]}},ss=function(t,n){var r,i=e(t.frame_classes)===wa&&null!==t.frame_classes&&!t.frame_classes.includes("creasePattern"),o=null!=t[Ga]&&t[Ga].length===t.faces_vertices.length,c=[[Ma],[Aa]].map((function(e){return i&&e.push("foldedForm"),e})).map((function(e){return e.join(" ")}));return function(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return as.cross2(as.subtract(e[1],e[0]),as.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(t).map((function(e){return e<0?c[0]:c[1]})).forEach((function(e,t){return n[t].setAttributeNS(null,Oa,e)})),o?(r=t[Ga],r.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))).map((function(e){return n[e]})):n},fs=function(e){if(Fa in e==!1||Ia in e==!1)return[];var t=e.faces_vertices.map((function(t){return t.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return Ra.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,ka,t)})),ss(e,t)},ls=function(e){if(qa in e==!1||La in e==!1||Ia in e==!1)return[];var t=e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return Ra.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,ka,t)})),ss(e,t)},vs={vertices:[],edges:[xa,ba,ya,_a,ma],faces:[Ma,Aa,"foldedForm"],boundaries:[]},ds=function(e,t,n){var r=t.attributes,i=vs[n]||[];Array.from(e.childNodes).filter((function(e){return r[e.nodeName]})).forEach((function(e){return Object.keys(r[e.nodeName]).forEach((function(t){return e.setAttributeNS(null,t,r[e.nodeName][t])}))})),Object.keys(r[n]).filter((function(e){return!i.includes(e)})).forEach((function(t){return e.setAttributeNS(null,t,r[n][t])})),0!==i.length&&Array.from(e.childNodes).forEach((function(e){return Object.keys(r[n][e.getAttribute(Oa)]||{}).forEach((function(t){return e.setAttributeNS(null,t,r[n][e.getAttribute(Oa)][t])}))}))},ps={vertices:es,edges:us,faces:function(e){return null!=e.faces_vertices?fs(e):ls(e)},boundaries:Ka},hs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.attributes||(t.attributes={}),[ga,ha,pa,da].filter((function(e){return!0===t[e]})).map((function(n){var r=Ra.SVG.g();return r.setAttributeNS(null,Oa,n),ps[n](e,t).forEach((function(e){return r.appendChild(e)})),ds(r,t,n),r})).filter((function(e){return e.childNodes.length>0}))},gs=Da.document,ms=Object.freeze({blur:.005,opacity:.3,color:Pa}),_s="result",ys="in",bs="blur",xs="offsetColor",Ms="offsetBlur",As="feMergeNode",Es="200%",Os=function(t,n){var r=$a(t),i=Math.min(r[2],r[3]),o=Ra.SVG.defs();if(null!=n.stylesheet){var c=Ra.SVG.style();o.appendChild(c);var u=n.attributes.svg[Ca]?n.attributes.svg[Ca]:i/200,a=(new Da.DOMParser).parseFromString("<xml></xml>","application/xml").createCDATASection("\n* { --".concat(Ca,": ").concat(u,"; }\n").concat(n.stylesheet));c.appendChild(a)}if(null!=n.shadows){var s=e(n.shadows)===wa&&null!==n.shadows?n.shadows:{blur:i/200};o.appendChild(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ms,n="shadow";e(t)===wa&&null!==t||(t={}),Object.keys(ms).filter((function(e){return!(e in t)})).forEach((function(e){t[e]=ms[e]}));var r=gs.createElementNS(Ra.SVG.NS,"filter");r.setAttributeNS(null,"width",Es),r.setAttributeNS(null,"height",Es),r.setAttributeNS(null,"id",n);var i=gs.createElementNS(Ra.SVG.NS,"feGaussianBlur");i.setAttributeNS(null,ys,"SourceAlpha"),i.setAttributeNS(null,"stdDeviation",t.blur),i.setAttributeNS(null,_s,bs);var o=gs.createElementNS(Ra.SVG.NS,"feOffset");o.setAttributeNS(null,ys,bs),o.setAttributeNS(null,_s,Ms);var c=gs.createElementNS(Ra.SVG.NS,"feFlood");c.setAttributeNS(null,"flood-color",t.color),c.setAttributeNS(null,"flood-opacity",t.opacity),c.setAttributeNS(null,_s,xs);var u=gs.createElementNS(Ra.SVG.NS,"feComposite");u.setAttributeNS(null,ys,xs),u.setAttributeNS(null,"in2",Ms),u.setAttributeNS(null,"operator",ys),u.setAttributeNS(null,_s,Ms);var a=gs.createElementNS(Ra.SVG.NS,"feMerge"),s=gs.createElementNS(Ra.SVG.NS,As),f=gs.createElementNS(Ra.SVG.NS,As);return f.setAttributeNS(null,ys,"SourceGraphic"),a.appendChild(s),a.appendChild(f),r.appendChild(i),r.appendChild(o),r.appendChild(c),r.appendChild(u),r.appendChild(a),r}(s))}return null!=n.stylesheet||null!=n.shadows?o:void 0},ks=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,u=e-c-i,a=t-c-i,s=n+2*c+2*i,f=r+2*c+2*i;return[u,a,s,f].join(" ")},ws=function(e,t){var n=$a(e),r=(Math.min(n[2],n[3]),{viewBox:ks.apply(void 0,o(n).concat([t.padding]))}),i=function(e){return[(null!=e.file_classes?e.file_classes:[]).join(" "),(null!=e.frame_classes?e.frame_classes:[]).join(" ")].filter((function(e){return""!==e})).join(" ")}(e);return""!==i&&(r.class=i),Object.assign(r,t.attributes.svg),r},js=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Qa(t,n);var r=Os(t,n);r&&e.appendChild(r),hs(t,n).forEach((function(t){return e.appendChild(t)}));var i=ws(t,n);return Object.keys(i).forEach((function(t){return e.setAttributeNS(null,t,i[t])})),e},Ss=function(){var e=Da.document.createElementNS(Ra.SVG.NS,Ea);return e.setAttribute("version","1.1"),e.setAttribute("xmlns",Ra.SVG.NS),e},Ps=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ya(e);Qa(n,t);var r=js(Ss(),n,t);if(t.output===Ea)return r;var i=(new Da.XMLSerializer).serializeToString(r),o=va(i);return o};Object.assign(Ps,{render_into_svg:js,render_components:hs,options:Qa,boundaries_polygon:Ka,vertices_circle:es,edges_path_data:os,edges_by_assignment_paths_data:cs,edges_path:us,edges_line:function(e){var t=rs(e).map((function(e){return Ra.SVG.line(e[0][0],e[0][1],e[1][0],e[1][1])}));return t.forEach((function(e,t){return e.setAttributeNS(null,ka,t)})),function(e){return null==e.edges_vertices||null==e.edges_assignment||e.edges_vertices.length!==e.edges_assignment.length?[]:e.edges_assignment.map((function(e){return ts[e]}))}(e).forEach((function(e,n){return t[n].setAttributeNS(null,Oa,e)})),t},faces_vertices_polygon:fs,faces_edges_polygon:ls,linker:function(e){}.bind(Ps),use:function(e){e.NS&&(Ra.SVG=e)}});var Ns={graph:No,cp:Io};Object.keys(Ns).forEach((function(e){yo[e]=function(){return Object.assign.apply(Object,[Object.create(Ns[e])].concat(o(Array.from(arguments).filter((function(e){return br(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}))),[{file_spec:er,file_creator:tr}]))},yo[e].prototype=Ns[e],yo[e].prototype.constructor=yo[e],Object.keys(Fo).forEach((function(t){yo[e][t]=function(){return yo[e](Fo[t].apply(Fo,arguments))}}))})),Object.assign(yo.graph,fo);var zs=Object.assign(Kn,yo,{math:Qn.core,axiom:Bo,diagram:_o,text:Do,webgl:Xo});return Object.defineProperty(zs,"use",{enumerable:!1,value:function(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(zs)}),Object.keys(Qn).filter((function(e){return"core"!==e})).forEach((function(e){zs[e]=Qn[e]})),fa.use(Ps),Ps.use(fa),zs.use(fa),zs.use(Ps),zs}));
