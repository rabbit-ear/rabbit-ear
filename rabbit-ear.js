/* Rabbit Ear alpha 2 2020-12-30 (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var e="undefined"!=typeof window&&void 0!==window.document,t="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,n=("object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.constructor&&self.constructor.name,function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}}),r=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},o=function resize_up$1(e,t){var n=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return r(n,e)}))},i=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},c=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return i(n)===Math.min(t,i(e))?e:n},a=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},u=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},s=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},l=Object.freeze({__proto__:null,resize:r,resize_up:o,resize_down:function resize_down(e,t){var n=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return r(n,e)}))},clean_number:c,semi_flatten_arrays:u,flatten_arrays:s}),v=Object.create(null),d=[1,0,0,1],p=d.concat(0,0),h=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},m=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},b=Object.freeze({__proto__:null,identity2x2:d,identity2x3:p,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:h,invert_matrix2:function invert_matrix2(e){var t=h(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:m,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,v=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,v,d]}}),k=180/Math.PI,w=Math.PI/180,E=2*Math.PI,M=1e-6,O=Object.freeze({__proto__:null,R2D:k,D2R:w,TWO_PI:E,EPSILON:M}),j=function fn_square(e){return e*e},C=function fn_add(e,t){return e+(t||0)},S=function fn_not_undefined(e){return void 0!==e},P=function magnitude(e){return Math.sqrt(e.map(j).reduce(C,0))},N=function mag_squared(e){return e.map(j).reduce(C,0)},I=function normalize(e){var t=P(e);return 0===t?e:e.map((function(e){return e/t}))},L=function scale(e,t){return e.map((function(e){return e*t}))},q=function add$1(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},T=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},F=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(C,0)},V=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},G=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},B=function lerp(e,t,n){var r=1-n;return e.map((function(e,o){return e*r+(t[o]||0)*n}))},D=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},R=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},U=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},Z=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce((function(e,t){return e+t}),0))},X=function flip(e){return e.map((function(e){return-e}))},$=function rotate90(e){return[-e[1],e[0]]},H=function rotate270(e){return[e[1],-e[0]]},Y=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return Math.abs(e.reduce(C,0))<t},W=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return 1-Math.abs(F(I(e),I(t)))<n},J=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(C,0)}))},K=Object.freeze({__proto__:null,magnitude:P,mag_squared:N,normalize:I,scale:L,add:q,subtract:T,dot:F,midpoint:V,average:G,lerp:B,cross2:D,cross3:R,distance2:U,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},distance:Z,flip:X,rotate90:$,rotate270:H,degenerate:Y,parallel:W,alternating_sum:J,alternating_deviation:function alternating_deviation(e){var t=e.reduce(C,0)/2;return J(e).map((function(e){return e-t}))}}),Q=Object.freeze([1,0,0,0,1,0,0,0,1]),ee=Object.freeze(Q.concat(0,0,0)),te=function is_identity3x4(e){return ee.map((function(t,n){return Math.abs(t-e[n])<M})).reduce((function(e,t){return e&&t}),!0)},ne=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},re=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},oe=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},ie=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},ce=function invert_matrix3(e){var t=ie(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ae=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Q.concat(e,t,n)},ue=function single_axis_rotate(e,t,n,r,o){var i=Q.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return i[3*n+n]=c,i[3*n+r]=(o?1:-1)*a,i[3*r+n]=(o?-1:1)*a,i[3*r+r]=c,i},se=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,1,2,!0)},fe=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,2,!1)},le=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,1,!0)},ve=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],o=r(3,I(t)),i=[0,1,2].map((function(e){return n[e]||0})),c=_slicedToArray(o,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),v=Math.sin(e),d=Math.sqrt(o[1]*o[1]+o[2]*o[2]),p=Math.abs(d)<1e-6?0:u/d,h=Math.abs(d)<1e-6?1:s/d,m=Q.concat(-i[0],-i[1],-i[2]),b=Q.concat(i[0],i[1],i[2]),k=[1,0,0,0,h,p,0,-p,h,0,0,0],w=[1,0,0,0,h,-p,0,p,h,0,0,0],E=[d,0,a,0,1,0,-a,0,d,0,0,0],M=[d,0,-a,0,1,0,a,0,d,0,0,0],O=[l,v,0,-v,l,0,0,0,1,0,0,0];return oe(b,oe(w,oe(M,oe(O,oe(E,oe(k,m))))))},de=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},pe=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,v=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,v,d,0]},_e=Object.freeze({__proto__:null,identity3x3:Q,identity3x4:ee,is_identity3x4:te,multiply_matrix3_vector3:ne,multiply_matrix3_line3:re,multiply_matrices3:oe,determinant3:ie,invert_matrix3:ce,make_matrix3_translate:ae,make_matrix3_rotateX:se,make_matrix3_rotateY:fe,make_matrix3_rotateZ:le,make_matrix3_rotate:ve,make_matrix3_scale:de,make_matrix3_reflectZ:pe}),ge=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},he=function get_vector$1(){if(arguments[0]instanceof v.vector)return arguments[0];var e=s(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(S)),e.filter((function(e){return"number"==typeof e}))},me=function get_vector_of_vectors(){return u(arguments).map((function(e){return he(e)}))},ye=function get_segment(){if(arguments[0]instanceof v.segment)return arguments[0];var e=u(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:me(e)},be=function get_line(){var e=u(arguments);return 0===e.length?ge([],[]):e[0]instanceof v.line||e[0]instanceof v.ray||e[0]instanceof v.segment?e[0]:e[0].constructor===Object?ge(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?ge(he(e)):ge.apply(void 0,_toConsumableArray(e.map((function(e){return he(e)}))))},xe=be,Ae=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},ke=function get_rect(){if(arguments[0]instanceof v.rect)return arguments[0];var e=s(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return Ae.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(S)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return Ae.apply(void 0,_toConsumableArray(n))},we=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete we[2][e]}));var Ee=function matrix_map_3x4(e){return we[e<8?0:e<13?1:2]},Me=function get_matrix_3x4(){var e=s(arguments),t=_toConsumableArray(ee);return Ee(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Oe=Object.freeze({__proto__:null,get_vector:he,get_vector_of_vectors:me,get_segment:ye,get_line:be,get_ray:xe,get_rect_params:Ae,get_rect:ke,get_matrix_3x4:Me}),je=function fEqual(e,t){return e===t},Ce=function fEpsilonEqual(e,t){return Math.abs(e-t)<M},Se=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce((function(e,t){return e&&t}),!0)},Pe=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),n=e.map((function(e){return r(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return n[0].map((function(e,r){return Math.abs(n[0][r]-n[t+1][r])<M})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)},Ne=Object.freeze({__proto__:null,equivalent_vec2:function equivalent_vec2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):Se(arguments,Ce))},equivalent_vectors:Pe,equivalent:function equivalent(){var e=u.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return Se(e,Ce);case"boolean":case"string":return Se(e,je);case"object":return e[0].constructor===Array?Pe.apply(void 0,_toConsumableArray(e)):Se(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),ze=function ray_limiter(e){return e<-M?0:e},Ie=function segment_limiter(e){return e<-M?0:e>1.000001?1:e},Le=function smallest_comparison_search(e,t,n){for(var r,o=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),i=1/0,c=0;c<o.length;c+=1)o[c].d<i&&(r=c,i=o[c].d);return r},qe=function nearest_point_on_line(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;t=r(e.length,t),n=r(e.length,n);var c=N(e),a=T(n,t),u=F(e,a),s=u/c,l=o(s,i);return q(t,L(e,l))},Te=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return T(n[(t+1)%n.length],e)}));return e.map((function(e,r){return qe(n[r],e,t,Ie)})).map((function(e,n){return{point:e,i:n,distance:Z(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},Fe=function nearest_point_on_circle(e,t,n){return q(t,L(I(T(n,t)),e))},Ve=Object.freeze({__proto__:null,ray_limiter:ze,segment_limiter:Ie,smallest_comparison_search:Le,nearest_point2:function nearest_point2(e,t){var n=Le(e,t,U);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Le(e,t,Z);return void 0===n?void 0:t[n]},nearest_point_on_line:qe,nearest_point_on_polygon:Te,nearest_point_on_circle:Fe,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),Ge=function include_l(){return!0},Be=function include_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t},De=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t&&e<1+t},Re=function exclude_l(){return!0},Ue=function exclude_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t},Ze=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t&&e<1-t},Xe=function intersect_lines(e,t,n,r,o,i){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(!(Math.abs(D(I(e),I(n)))<c)){var s=D(T(r,t),n),l=D(T(t,r),e),v=s/a,d=l/u;return o(v,c/P(e))&&i(d,c/P(n))?q(t,L(e,v)):void 0}},$e=Object.freeze({__proto__:null,include_l:Ge,include_r:Be,include_s:De,exclude_l:Re,exclude_r:Ue,exclude_s:Ze,intersect_lines:Xe}),He=function collinear(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=T(e,n),c=N(t);if(Math.sqrt(c)<o)return!1;var a=Math.sqrt(c),u=D(i,t.map((function(e){return e/a}))),s=F(i,t)/c;return Math.abs(u)<o&&r(s,o/a)},Ye=function point_on_line(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Math.abs(D(T(e,n),I(t)))<r},We=Object.freeze({__proto__:null,collinear:He,point_on_line:Ye,point_on_ray_inclusive:function point_on_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return He(e,t,n,Be,r)},point_on_ray_exclusive:function point_on_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return He(e,t,n,Ue,r)},point_on_segment_inclusive:function point_on_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return He(e,T(n,t),t,De,r)},point_on_segment_exclusive:function point_on_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return He(e,T(n,t),t,Ze,r)}}),Je=function overlap_lines(e,t,n,r,o,i){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(Math.abs(a)<c)return He(r,e,t,o,c)||He(r,X(e),q(t,e),o,c)||He(t,n,r,i,c)||He(t,X(n),q(r,n),i,c);var s=D(T(r,t),n),l=D(T(t,r),e),v=s/a,d=l/u;return o(v,c/P(e))&&i(d,c/P(n))},Ke=function overlap_segment_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(T(t,e),e,T(r,n),n,De,De,o)},Qe=function overlap_segment_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(T(t,e),e,T(r,n),n,Ze,Ze,o)},et=Object.freeze({__proto__:null,overlap_lines:Je,overlap_line_line_inclusive:function overlap_line_line_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Ge,Ge,o)},overlap_line_ray_inclusive:function overlap_line_ray_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Ge,Be,o)},overlap_line_segment_inclusive:function overlap_line_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,T(r,n),n,Ge,De,o)},overlap_ray_ray_inclusive:function overlap_ray_ray_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Be,Be,o)},overlap_ray_segment_inclusive:function overlap_ray_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,T(r,n),n,Be,De,o)},overlap_segment_segment_inclusive:Ke,overlap_line_line_exclusive:function overlap_line_line_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Re,Re,o)},overlap_line_ray_exclusive:function overlap_line_ray_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Re,Ue,o)},overlap_line_segment_exclusive:function overlap_line_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,T(r,n),n,Re,Ze,o)},overlap_ray_ray_exclusive:function overlap_ray_ray_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,n,r,Ue,Ue,o)},overlap_ray_segment_exclusive:function overlap_ray_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Je(e,t,T(r,n),n,Ue,Ze,o)},overlap_segment_segment_exclusive:Qe}),tt=function point_in_convex_poly_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(I(T(t[1],t[0])),T(e,t[0]))>-n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},nt=function point_in_convex_poly_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(I(T(t[1],t[0])),T(e,t[0]))>n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},rt=function point_in_poly(e,t){for(var n=!1,r=0,o=t.length-1;r<t.length;o=r++)t[r][1]>e[1]!=t[o][1]>e[1]&&e[0]<(t[o][0]-t[r][0])*(e[1]-t[r][1])/(t[o][1]-t[r][1])+t[r][0]&&(n=!n);return n},ot=function overlap_convex_polygons(e,t,n,r,o){for(var i=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),c=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),a=0;a<i.length;a+=1)for(var u=0;u<c.length;u+=1)if(n(i[a][0],i[a][1],c[u][0],c[u][1],o))return!0;return!!r(t[0],e,o)||!!r(e[0],t,o)},it=function overlap_convex_polygons_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ot(e,t,Qe,nt,n)},ct=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:tt,point_in_convex_poly_exclusive:nt,point_in_poly:rt,overlap_convex_polygons_inclusive:function overlap_convex_polygons_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ot(e,t,Ke,tt,n)},overlap_convex_polygons_exclusive:it,enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return tt(e,t)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return tt(e,t)})).reduce((function(e,t){return e&&t}),!0);return!n&&r}}),at=function quick_equivalent_2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},ut=function intersect_line_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(e,t,T(r,n),n,Ge,De,o)},st=function intersect_line_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(e,t,T(r,n),n,Re,Ze,o)},ft=function intersect_ray_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(e,t,T(r,n),n,Be,De,o)},lt=function intersect_ray_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(e,t,T(r,n),n,Ue,Ze,o)},vt=function intersect_seg_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(T(t,e),e,T(r,n),n,De,De,o)},dt=function intersect_seg_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Xe(T(t,e),e,T(r,n),n,Ze,Ze,o)},pt=function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=E;for(;e>t;)e-=E;for(;e<t;)e+=E;return e<n},_t=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=t-e;return n>=0?n:E-(e-t)},gt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],o=Math.atan2(r,n);return o<0&&(o+=E),o},ht=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],o=Math.atan2(r,n);return o<0&&(o+=E),o},mt=function clockwise_bisect2(e,t){var n=Math.atan2(e[1],e[0])-gt(e,t)/2;return[Math.cos(n),Math.sin(n)]},yt=function counter_clockwise_bisect2(e,t){var n=Math.atan2(e[1],e[0])+ht(e,t)/2;return[Math.cos(n),Math.sin(n)]},bt=function bisect_lines2(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=D(e,n),c=F(e,n),a=i>-o?[yt(e,n)]:[mt(e,n)];a[1]=i>-o?$(a[0]):H(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/i,l=[e,n].map((function(e){return I(e)})),v=Math.abs(D.apply(void 0,_toConsumableArray(l)))<o,d=v?V(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],p=a.map((function(e){return{vector:e,origin:d}}));return v&&delete p[c>-o?1:0],p},xt=function counter_clockwise_radians_order(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e,t){return t})).sort((function(e,n){return t[e]-t[n]}));return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},At=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return _t.apply(void 0,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return J(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return pt(t,e[n],e[(n+1)%e.length])?t:void 0}))},kt=Object.freeze({__proto__:null,is_counter_clockwise_between:pt,clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=e-t;return n>=0?n:E-(t-e)},counter_clockwise_angle_radians:_t,clockwise_angle2:gt,counter_clockwise_angle2:ht,clockwise_bisect2:mt,counter_clockwise_bisect2:yt,bisect_lines2:bt,counter_clockwise_radians_order:xt,counter_clockwise_vector_order:function counter_clockwise_vector_order(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xt.apply(void 0,_toConsumableArray(t.map((function(e){return Math.atan2(e[1],e[0])}))))},interior_angles:function interior_angles(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e,t,n){return ht(e,n[(t+1)%n.length])}))},kawasaki_solutions_radians:At,kawasaki_solutions:function kawasaki_solutions(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return At(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))}}),wt=function circumcircle(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+o*(e[1]+t[1]),u=i*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-o*(n[0]-t[0]));if(Math.abs(s)<M){var l=Math.min(e[0],t[0],n[0]),v=Math.min(e[1],t[1],n[1]),d=.5*(Math.max(e[0],t[0],n[0])-l),p=.5*(Math.max(e[1],t[1],n[1])-v);return{origin:[l+d,v+p],radius:Math.sqrt(d*d+p*p)}}var h=[(c*a-o*u)/s,(r*u-i*a)/s],m=h[0]-e[0],b=h[1]-e[1];return{origin:h,radius:Math.sqrt(m*m+b*b)}},Et=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(C,0)},Mt=function centroid(e){var t=1/(6*Et(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],o=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*o,(e[1]+r[1])*o]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},Ot=function enclosing_rectangle(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return Ae.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(r)))},jt=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return E*(n/e)}))},Ct=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return c(e,14)}))}))},St=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ct(jt(e),t)},Pt=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=jt(e).map((function(e){return e+n}));return Ct(r,t)},Nt=function split_polygon(){return console.warn("split polygon not done")},zt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:Ye(e,t,n)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),o=e.map((function(e,r,o){return{point:st(t,n,e,o[(r+1)%o.length]),at_index:r}})).filter((function(e){return null!=e.point}));if(2==o.length){var i=o.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(i[1].at_index+1).concat(e.slice(0,i[0].at_index+1));c.push(i[0].point),c.push(i[1].point);var a=e.slice(i[0].at_index+1,i[1].at_index+1);return a.push(i[1].point),a.push(i[0].point),[c,a]}if(1==o.length&&1==r.length){r[0].type="v",o[0].type="e";var u=r.concat(o).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var v=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(v[1].at_index).concat(e.slice(0,v[0].at_index+1)),e.slice(v[0].at_index,v[1].at_index+1)]}return[e.slice()]},It=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),o=[];o.push(r[0]);var i=0,c=0,a=function _loop(){c+=1;var e=o.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-o[e][0])<t&&Math.abs(n[1]-o[e][1])<t)})).map((function(t){for(var n=Math.atan2(o[e][1]-t[1],o[e][0]-t[0]);n<i;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(o[e][0]-t.node[0],2)+Math.pow(o[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),o.filter((function(e){return e===n[0].node})).length>0)return{v:o};o.push(n[0].node),i=Math.atan2(o[e][1]-n[0].node[1],o[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},Lt=function recurseSkeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return Xe(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,Ue,Ue)})),o=t.map((function(e,t){return qe(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[o[0],r[0]]}]);var i=r.map((function(e,t){return Z(e,o[t])})),c=0;i.forEach((function(e,t){e<i[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[o[c],r[c]]}],u=mt(X(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurseSkeleton(e,t,n))},qt=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:T(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[T(e[0],e[1]),T(e[2],e[1])]})).map((function(e){return mt.apply(void 0,_toConsumableArray(e))}));return Lt(e,t,n)},Tt=Object.freeze({__proto__:null,circumcircle:wt,signed_area:Et,centroid:Mt,enclosing_rectangle:Ot,make_regular_polygon:St,make_regular_polygon_side_aligned:Pt,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return St(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Pt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return St(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Pt(e,t/2/Math.sin(Math.PI/e))},split_polygon:Nt,split_convex_polygon:zt,convex_hull:It,straight_skeleton:qt}),Ft=function acossafe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},Vt=function rotatePoint(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=r*Math.cos(n)+o*Math.sin(n),c=o*Math.cos(n)-r*Math.sin(n);return[e[0]+i,e[1]+c]},Gt=function circle_circle(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=e.radius<t.radius?e.radius:t.radius,o=e.radius<t.radius?t.radius:e.radius,i=e.radius<t.radius?e.origin:t.origin,c=e.radius<t.radius?t.origin:e.origin,a=[i[0]-c[0],i[1]-c[1]],u=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));if(!(u<n)){var s=a.map((function(e,t){return e/u*o+c[t]}));if(Math.abs(o+r-u)<n||Math.abs(o-(r+u))<n)return[s];if(!(u+r<o||o+r<u)){var l=Ft((r*r-u*u-o*o)/(-2*u*o)),v=Vt(c,s,+l),d=Vt(c,s,-l);return[v,d]}}},Bt=function intersect_circle_line(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:M,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=[-u[1],u[0]],l=[r[0]-t[0],r[1]-t[1]],v=l[0]*u[1]-u[0]*l[1];if(!(Math.abs(v)>e+i)){var d=Math.sqrt(Math.pow(e,2)-Math.pow(v,2)),p=function f(e,n){return t[n]-s[n]*v+u[n]*e},h=Math.abs(e-Math.abs(v))<i?[d].map((function(e){return[e,e].map(p)})):[-d,d].map((function(e){return[e,e].map(p)})),m=h.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return h.filter((function(e,t){return o(m[t],i)}))}},Dt=function line_func(){return!0},Rt=function ray_func(e,t){return e>-t},Ut=function segment_func(e,t){return e>-t&&e<1+t},Zt=function circle_line(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Bt(e.radius,e.origin,t.vector,t.origin,Dt,n)},Xt=function circle_ray(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Bt(e.radius,e.origin,t.vector,t.origin,Rt,n)},$t=function circle_segment(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Bt(e.radius,e.origin,t.vector,t.origin,Ut,n)},Ht=Object.freeze({__proto__:null,circle_circle:Gt,intersect_circle_line:Bt,circle_line:Zt,circle_ray:Xt,circle_segment:$t}),Yt=function cuberoot(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},Wt=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){return v.line(I(T.apply(void 0,_toConsumableArray(o(t,e)))),e)},axiom2:function axiom2(e,t){return v.line(I($(T.apply(void 0,_toConsumableArray(o(t,e))))),V(e,t))},axiom3:function axiom3(e,t,n,r){return bt(e,t,n,r).map(v.line)},axiom4:function axiom4(e,t){return v.line($(I(e)),t)},axiom5:function axiom5(e,t,n,r){return(Bt(Z(n,r),n,e,t,(function(){return!0}))||[]).map((function(e){return v.line(I($(T.apply(void 0,_toConsumableArray(o(e,r))))),V(r,e))}))},axiom7:function axiom7(e,t,n,r){var i=Xe(e,t,n,r,Ge,Ge);return void 0===i?void 0:v.line(I($(T.apply(void 0,_toConsumableArray(o(i,r))))),V(r,i))},axiom6:function axiom6(e,t,n,r,o,i){var c=o[0],a=o[1];if(Math.abs(e[0])>M)var u=e[1]/e[0],s=t[1]-u*t[0];else var l=t[0];var d=i[0],p=i[1];if(Math.abs(n[0])>M)var h=n[1]/n[0],m=r[1]-h*r[0];else var b=r[0];if(void 0!==u&&void 0!==h)var k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=h*h+1,j=2*h*m,C=m*m-d*d-p*p,S=h*c+(s-a),P=c*(m-p)-d*(s-a),N=h-u,I=u*d+(m-p),L=u*c+(s-a);else if(void 0===u&&void 0===h)k=1,w=0,E=l*l-c*c-a*a,O=1,j=0,C=b*b-d*d-p*p,P=a*(b-d)-p*(l-c),N=0,I=b-d,L=S=l-c;else{if(void 0===u){var q=c;c=d,d=q;var T=a;a=p,p=T,u=h,h=void 0,s=m,m=void 0,b=l,l=void 0}k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=1,j=0,C=b*b-d*d-p*p,S=c,P=(s-a)*(b-d)-c*p,N=1,I=-u*(b-d)-p,L=u*c+(s-a)}var F=function solveCubic(e,t,n,r){if(Math.abs(e)<M){if(e=t,t=n,n=r,Math.abs(e)<M)return e=t,t=n,Math.abs(e)<M?[]:[-t/e];var o=t*t-4*e*n;return Math.abs(o)<M?[-t/(2*e)]:o>0?[(-t+Math.sqrt(o))/(2*e),(-t-Math.sqrt(o))/(2*e)]:[]}var i,c=(3*e*n-t*t)/(3*e*e),a=(2*t*t*t-9*e*t*n+27*e*e*r)/(27*e*e*e);if(Math.abs(c)<M)i=[Yt(-a)];else if(Math.abs(a)<M)i=[0].concat(c<0?[Math.sqrt(-c),-Math.sqrt(-c)]:[]);else{var u=a*a/4+c*c*c/27;if(Math.abs(u)<M)i=[-1.5*a/c,3*a/c];else if(u>0){var s=Yt(-a/2-Math.sqrt(u));i=[s-c/(3*s)]}else{var l=2*Math.sqrt(-c/3),v=Math.acos(3*a/c/l)/3,d=2*Math.PI/3;i=[l*Math.cos(v),l*Math.cos(v-d),l*Math.cos(v-2*d)]}}for(var p=0;p<i.length;p+=1)i[p]-=t/(3*e);return i}(O*N*L,(O*I+j*N)*L-(k*S*S+w*S*N+E*N*N),(j*I+C*N)*L-(2*k*S*P+w*(S*I+P*N)+2*E*N*I),C*I*L-(k*P*P+w*P*I+E*I*I)),V=[];if(null!=F&&F.length>0)for(var G=0;G<F.length;++G){if(void 0!==u&&void 0!==h)var B=F[G],D=h*B+m;else D=F[G],B=b;if(D!=p){var R=-1*(B-d)/(D-p),U=(D*D-p*p+B*B-d*d)/(2*(D-p));V.push(v.line.fromPoints([0,U],[1,R]))}else{var Z=(B+d)/2;V.push(v.line.fromPoints([Z,0],[0,1]))}}return V}}),Jt=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!at(e[0],e[t]))return[e[0],e[t]]},Kt=function convex_poly_line_intersect(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],o)})).filter((function(e){return null!=e}));switch(i.length){case 0:return;case 1:return[i];default:return Jt(i)||[i[0]]}},Qt=function poly_include_exclude_func(e,t,n,r,o){var i,c=Kt(e,t,n,r,o);switch(e){case st:i=ut;break;case lt:i=ft;break;case dt:i=vt;break;case ut:case ft:case vt:default:return c}var a=Kt(i,t,n,r,o);if(void 0!==a){var u=Jt(a);if(void 0===u)switch(e){case st:return;case lt:return nt(r,t,o)?a:void 0;case dt:return nt(n,t,o)||nt(r,t,o)?a:void 0}return nt(V.apply(void 0,_toConsumableArray(u)),t,o)?u:c}},en=function convex_poly_line_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(st,e,t,n,r)},tn=function convex_poly_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(lt,e,t,n,r)},nn=function convex_poly_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(dt,e,t,n,r)},rn=Object.freeze({__proto__:null,convex_poly_line_inclusive:function convex_poly_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(ut,e,t,n,r)},convex_poly_line_exclusive:en,convex_poly_ray_inclusive:function convex_poly_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(ft,e,t,n,r)},convex_poly_ray_exclusive:tn,convex_poly_segment_inclusive:function convex_poly_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Qt(vt,e,t,n,r)},convex_poly_segment_exclusive:nn}),on=function convexPolyLine(e,t){return en(e,t.vector,t.origin)},cn=function convexPolyRay(e,t){return tn(e,t.vector,t.origin)},an=function convexPolySegment(e,t){return nn(e,t[0],t[1])},un=function lineFunc(e,t,n,r,o){return Xe(e.vector,e.origin,t.vector,t.origin,n,r,o)},sn={polygon:{line:on,ray:cn,segment:an},circle:{circle:Gt,line:Zt,ray:Xt,segment:$t},line:{polygon:function polygon(e,t){return on(t,e)},circle:function circle(e,t){return Zt(t,e)},line:function line(e,t,n){return un(e,t,Re,Re,n)},ray:function ray(e,t,n){return un(e,t,Re,Ue,n)},segment:function segment(e,t,n){return un(e,t,Re,Ze,n)}},ray:{polygon:function polygon(e,t){return cn(t,e)},circle:function circle(e,t){return Xt(t,e)},line:function line(e,t,n){return un(t,e,Re,Ue,n)},ray:function ray(e,t,n){return un(e,t,Ue,Ue,n)},segment:function segment(e,t,n){return un(e,t,Ue,Ze,n)}},segment:{polygon:function polygon(e,t){return an(t,e)},circle:function circle(e,t){return $t(t,e)},line:function line(e,t,n){return un(t,e,Re,Ze,n)},ray:function ray(e,t,n){return un(t,e,Ue,Ze,n)},segment:function segment(e,t,n){return un(e,t,Ze,Ze,n)}}},fn={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},ln=function intersect(e,t){var r,o=fn[n(e)],i=fn[n(t)];return(r=sn[o])[i].apply(r,arguments)},vn=Object.assign(Object.create(null),et,We,ct),dn=function get_unique_pair$1(e){for(var t=1;t<e.length;t+=1)if(!at(e[0],e[t]))return[e[0],e[t]]},pn=function get_unique_points(e){for(var t=[],n=0;n<e.length;n+=1){for(var r=!1,o=0;o<t.length;o+=1)at(e[n],t[o])&&(r=!0);r||t.push(e[n])}return t},_n=function sortPointsAlongVector(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))},gn=function collinear_check(e,t,n){var r=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return T.apply(void 0,_toConsumableArray(e))}));return r.map((function(e,n){return W(e,t)?n:void 0})).filter(S).map((function(t){return Ye(n,r[t],e[t])})).reduce((function(e,t){return e||t}),!1)},hn=function clip_intersections(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],o)})).filter(S)},mn=function clip_line_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=(hn(st,e,t,n,r),hn(ut,e,t,n,r));if(void 0!==o){var i=dn(o);if(void 0!==i)return nt(V.apply(void 0,_toConsumableArray(i)),e,r)?i:void 0}},yn=function clip_ray_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=(hn(lt,e,t,n,r),hn(ft,e,t,n,r));if(void 0!==o){var i=dn(o);return void 0===i?nt(n,e,r)?[n,o[0]]:void 0:nt(V.apply(void 0,_toConsumableArray(i)),e,r)?i:void 0}},bn=function clip_segment_func(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=[t,n],i=o.map((function(t){return tt(t,e,r)}));if(!0===i[0]&&!0===i[1])return[_toConsumableArray(t),_toConsumableArray(n)];var c=hn(vt,e,t,n,r),a=pn(c);if(2===a.length)return a;if(a.length>2){var u=_n(a,T(n,t));return[u[0],u[u.length-1]]}if(c.length>0){var s=o.map((function(t){return nt(t,e,r)}));if(!0===s[0])return[_toConsumableArray(t),c[0]];if(!0===s[1])return[_toConsumableArray(n),c[0]]}},xn=function clip_segment_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=T(n,t);if(!gn(e,o,t))return bn(e,t,n,r)},An=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function clip_line_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=hn(ut,e,t,n,r);switch(o.length){case 0:case 1:return;default:return dn(o)}},clip_line_in_convex_poly_exclusive:mn,clip_ray_in_convex_poly_inclusive:function clip_ray_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=hn(ft,e,t,n,r);if(0!==o.length){tt(n,e);return dn(o)||[n,o[0]]}},clip_ray_in_convex_poly_exclusive:yn,clip_segment_in_convex_poly_inclusive:function clip_segment_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return bn(e,t,n,r)},clip_segment_in_convex_poly_exclusive:xn}),kn={preserve:{magnitude:function magnitude(){return P(this)},isEquivalent:function isEquivalent(){return Pe(this,he(arguments))},isParallel:function isParallel(){return W.apply(void 0,_toConsumableArray(o(this,he(arguments))))},dot:function dot(){return F.apply(void 0,_toConsumableArray(o(this,he(arguments))))},distanceTo:function distanceTo(){return Z.apply(void 0,_toConsumableArray(o(this,he(arguments))))}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return I(this)},scale:function scale(){return L(this,arguments[0])},flip:function flip(){return X(this)},rotate90:function rotate90(){return $(this)},rotate270:function rotate270(){return H(this)},cross:function cross(){return R(r(3,this),r(3,he(arguments)))},transform:function transform(){return ne(Me(arguments),r(3,this))},add:function add(){return q(this,r(this.length,he(arguments)))},subtract:function subtract(){return T(this,r(this.length,he(arguments)))},rotateZ:function rotateZ(e,t){return ne(Me(m(e,t)),r(3,this))},lerp:function lerp(e,t){return B(this,r(this.length,he(e)),t)},midpoint:function midpoint(){return V.apply(void 0,_toConsumableArray(o(this,he(arguments))))},bisect:function bisect(){return yt(this,he(arguments))}}},wn={};Object.keys(kn.preserve).forEach((function(e){wn[e]=kn.preserve[e]})),Object.keys(kn.vector).forEach((function(e){wn[e]=function(){return v.vector.apply(v,_toConsumableArray(kn.vector[e].apply(this,arguments)))}}));var En={fromAngle:function fromAngle(e){return v.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return v.vector.fromAngle(e*w)}},Mn={vector:{P:Array.prototype,A:function VectorArgs(){var e=this;he(arguments).forEach((function(t){return e.push(t)}))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:wn,S:En}},On={};On.prototype=Object.create(Object.prototype),On.prototype.constructor=On,On.prototype.isParallel=function(){var e=o(this.vector,be.apply(void 0,arguments).vector);return W.apply(void 0,_toConsumableArray(e))},On.prototype.isDegenerate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return Y(this.vector,e)},On.prototype.reflectionMatrix=function(){return v.matrix(pe(this.vector,this.origin))},On.prototype.nearestPoint=function(){var e=he(arguments);return v.vector(qe(this.vector,this.origin,e,this.clip_function))},On.prototype.transform=function(){var e=this.dimension,t=re(Me(arguments),r(3,this.vector),r(3,this.origin));return this.constructor(r(e,t.vector),r(e,t.origin))},On.prototype.translate=function(){var e=q.apply(void 0,_toConsumableArray(o(this.origin,he(arguments))));return this.constructor(this.vector,e)},On.prototype.intersect=function(e){return ln(this,e)},On.prototype.bisect=function(){var e=be(arguments);return bt(this.vector,this.origin,e.vector,e.origin)},Object.defineProperty(On.prototype,"dimension",{get:function get(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}});var jn={fromPoints:function fromPoints(){var e=me(arguments);return this.constructor({vector:T(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=me(arguments);return this.constructor({vector:$(T(e[1],e[0])),origin:G(e[0],e[1])})}},Cn={line:{P:On.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-e/2)),n=this.vector.scale(e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}},S:jn}},Sn={ray:{P:On.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{flip:function flip(){return v.ray(X(this.vector),this.origin)},scale:function scale(e){return v.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return v.ray(this.vector.normalize(),this.origin)},clip_function:ze,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:jn}},Pn={segment:{P:On.prototype,A:function A(){var e=ye.apply(void 0,arguments);this.points=[v.vector(e[0]),v.vector(e[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function _(){return this.points[0]},1:function _(){return this.points[1]},length:function length(){return this.vector.magnitude()}},M:{clip_function:Ie,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=Me(n),c=this.points.map((function(e){return r(3,e)})).map((function(e){return ne(i,e)})).map((function(t){return r(e,t)}));return v.segment(c)},translate:function translate(){var translate=get_vector(arguments),e=this.points.map((function(e){return add.apply(void 0,_toConsumableArray(resize_up(e,translate)))}));return v.segment(e)},midpoint:function midpoint(){return v.vector(G(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},Nn=function pointOnEllipse(e,t,n,r,o,i){var c=Math.cos(o),a=Math.sin(o),u=Math.cos(i),s=Math.sin(i);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},zn=function pathInfo(e,t,n,r,o,i,c){var a=i;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=Nn(e,t,n,r,o,a),l=Nn(e,t,n,r,o,a+u/2),v=Nn(e,t,n,r,o,a+u),d=u/2>Math.PI?1:0,p=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:v[0],y3:v[1],fa:d,fs:p}},In=function cln(e){return c(e,4)},Ln=function ellipticalArcTo(e,t,n,r,o,i,c){return"A".concat(In(e)," ").concat(In(t)," ").concat(In(n)," ").concat(In(r)," ").concat(In(o)," ").concat(In(i)," ").concat(In(c))},qn={circle:{A:function CircleArgs(){var e=me(arguments),t=s(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length)1===e[1].length?(this.radius=e[1][0],this.origin=v.vector.apply(v,_toConsumableArray(e[0]))):1===e[0].length?(this.radius=e[0][0],this.origin=v.vector.apply(v,_toConsumableArray(e[1]))):e[0].length>1&&e[1].length>1&&(this.radius=U.apply(void 0,_toConsumableArray(e)),this.origin=v.vector.apply(v,_toConsumableArray(e[0])));else switch(t.length){case 0:this.radius=1,this.origin=v.vector(0,0,0);break;case 1:this.radius=t[0],this.origin=v.vector(0,0,0);break;default:this.radius=t.pop(),this.origin=v.vector.apply(v,_toConsumableArray(t))}},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return v.vector(Fe(this.radius,this.origin,he(arguments)))},intersect:function intersect(e){return ln(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=zn(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=Ln(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),o=Ln(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=wt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=wt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},Tn=function getFoci(e,t,n,r){var o=t>n,i=o?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(i),a=o?Math.cos(r):Math.sin(r),u=o?Math.sin(r):Math.cos(r);return[v.vector(e[0]+c*a,e[1]+c*u),v.vector(e[0]-c*a,e[1]-c*u)]},Fn={ellipse:{A:function A(){var e=s(arguments).filter((function(e){return!isNaN(e)})),t=r(5,e);this.rx=t[0],this.ry=t[1],this.origin=v.vector(t[2],t[3]),this.spin=t[4],this.foci=Tn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=zn(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=Ln(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),o=Ln(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return Nn(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},Vn=function makeClip(e){return void 0===e?void 0:v.segment(e)},Gn={area:function area(){return Et(this)},centroid:function centroid(){return v.vector(Mt(this))},enclosingRectangle:function enclosingRectangle(){return v.rect(Ot(this))},contains:function contains(){return rt(he(arguments),this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,o){return t[o]+n[o]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],o=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),i=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(i+e)*o,t[1]+Math.sin(i+e)*o]}));return v.polygon(n)},translate:function translate(){var e=he.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=Me.apply(void 0,arguments),t=this.map((function(t){return ne(e,r(3,t))}));return v.polygon(t)},nearest:function nearest(){var e=he.apply(void 0,arguments),t=Te(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function overlaps(){var e=u(arguments);return it(this,e)},split:function split(){var e=be.apply(void 0,arguments),t=this.isConvex?zt:Nt;return t(this,e.vector,e.origin).map((function(e){return v.polygon(e)}))},intersectLine:function intersectLine(){var e=be.apply(void 0,arguments);return en(this,e.vector,e.origin)},intersectRay:function intersectRay(){var e=be.apply(void 0,arguments);return tn(this,e.vector,e.origin)},intersectSegment:function intersectSegment(){var e=ye.apply(void 0,arguments);return nn(this,e[0],e[1])},clipLine:function clipLine(){var e=be.apply(void 0,arguments),t=mn(this,e.vector,e.origin);return Vn(t)},clipRay:function clipRay(){var e=be.apply(void 0,arguments),t=yn(this,e.vector,e.origin);return Vn(t)},clipSegment:function clipSegment(){var e=ye.apply(void 0,arguments),t=xn(this,e[0],e[1]);return Vn(t)},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function intersect(e){return ln(this,e)}},Bn={};Bn.prototype=Object.create(Array.prototype),Bn.prototype.constructor=Bn,Object.keys(Gn).forEach((function(e){Bn.prototype[e]=Gn[e]}));var Dn=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},Rn={rect:{P:Bn.prototype,A:function A(){var e=ke.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=v.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(Dn(this)))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return v.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function fromPoints(){return v.rect(Ot(me(arguments)))}}}},Un={polygon:{P:Bn.prototype,A:function A(){this.push.apply(this,_toConsumableArray(u(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return T(e[1],e[0])}))},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:{segments:function segments(){return this.sides},straightSkeleton:function straightSkeleton(){return qt(this)}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(St.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(It.apply(void 0,arguments))}}}},Zn=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},Xn={matrix:{P:Array.prototype,A:function A(){var e=this;Me(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return v.matrix.apply(v,_toConsumableArray(Array.from(this)))},set:function set(){return Zn(this,Me(arguments))},isIdentity:function isIdentity(){return te(this)},multiply:function multiply(e){return Zn(this,oe(this,e))},determinant:function determinant(){return ie(this)},inverse:function inverse(){return Zn(this,ce(this))},translate:function translate(e,t,n){return Zn(this,oe(this,ae(e,t,n)))},rotateX:function rotateX(e){return Zn(this,oe(this,se(e)))},rotateY:function rotateY(e){return Zn(this,oe(this,fe(e)))},rotateZ:function rotateZ(e){return Zn(this,oe(this,le(e)))},rotate:function rotate(e,t,n){var r=ve(e,t,n);return Zn(this,oe(this,r))},scale:function scale(e){return Zn(this,oe(this,de(e)))},reflectZ:function reflectZ(e,t){var n=pe(e,t);return Zn(this,oe(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v.vector(ne(this,r(3,he(t))))},transformVector:function transformVector(e){return v.vector(ne(this,r(3,he(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=be(t);return v.line(re(this,r.vector,r.origin))}},S:{}}},$n=function invert_order_array(e){var t=[];return e.forEach((function(e,n){return t[e]=n})),t},Hn={junction:{A:function A(){var e=me(arguments).map((function(e){return v.vector(e)})),t=e.map((function(e){return Math.atan2(e[1],e[0])})),n=xt.apply(void 0,_toConsumableArray(t));this.vectors=n.map((function(t){return e[t]})),this.radians=n.map((function(e){return t[e]})),this.order=$n(n)},G:{sectors:function sectors(){return this.radians.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return _t(e[0],e[1])}))}},M:{alternatingAngleSum:function alternatingAngleSum(){return J(this.sectors)}},S:{fromRadians:function fromRadians(){var e=he(arguments);return this.constructor(e.map((function(e){return[Math.cos(e),Math.sin(e)]})))}}}},Yn=Object.assign({},Mn,Cn,Sn,Pn,qn,Fn,Rn,Un,Xn,Hn),Wn=function create(e,t){var n=Object.create(Yn[e].proto);return Yn[e].A.apply(n,t),n};Object.assign(v,{vector:function vector(){return Wn("vector",arguments)},circle:function circle(){return Wn("circle",arguments)},ellipse:function ellipse(){return Wn("ellipse",arguments)},rect:function rect(){return Wn("rect",arguments)},polygon:function polygon(){return Wn("polygon",arguments)},line:function line(){return Wn("line",arguments)},ray:function ray(){return Wn("ray",arguments)},segment:function segment(){return Wn("segment",arguments)},matrix:function matrix(){return Wn("matrix",arguments)},junction:function junction(){return Wn("junction",arguments)}}),Object.keys(Yn).forEach((function(e){var t={};t.prototype=null!=Yn[e].P?Object.create(Yn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,v[e].prototype=t.prototype,v[e].prototype.constructor=v[e],Object.keys(Yn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:Yn[e].G[n]})})),Object.keys(Yn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:Yn[e].M[n]})})),Object.keys(Yn[e].S).forEach((function(t){return Object.defineProperty(v[e],t,{value:Yn[e].S[t].bind(v[e].prototype)})})),Yn[e].proto=t.prototype}));var Jn=v;Jn.core=Object.assign(Object.create(null),O,K,Ne,Tt,kt,b,_e,Ve,Wt,vn,Oe,l,Ht,$e,rn,An,{intersect_line_seg_include:ut,intersect_line_seg_exclude:st,intersect_ray_seg_include:ft,intersect_ray_seg_exclude:lt,intersect_seg_seg_include:vt,intersect_seg_seg_exclude:dt}),Jn.typeof=n,Jn.intersect=ln;var Kn=Object.create(null),Qn=1.1,er="Rabbit Ear",tr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},nr=Object.freeze([].concat(tr.file).concat(tr.frame).concat(tr.graph).concat(tr.orders)),rr="vertices",or="edges",ir="faces",cr="vertices_coords",ar="edges_assignment",ur="edges_foldAngle",sr={vertices:"vertex",edges:"edge",faces:"face"},fr={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},lr=function edge_assignment_to_foldAngle(e){return fr[e]||0},vr=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},dr=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},pr=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},_r=function get_graph_keys_with_prefix(e,t){return pr(e,"".concat(t,"_"))},gr=function get_graph_keys_with_suffix(e,t){return dr(e,"_".concat(t))},hr=function transpose_graph_arrays(e,t){var n=_r(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),o=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return o.forEach((function(n,r){o[r][t]=e[t][r]}))})),o},mr=function transpose_graph_array_at_index(e,t,n){var r=_r(e,t);if(0!==r.length){var o={};return r.forEach((function(t){o[t]=e[t][n]})),o}},yr=function fold_object_certainty(e){return"object"!==_typeof(e)||null===e?0:nr.filter((function(t){return e[t]})).length},br=Object.freeze({__proto__:null,edges_assignment_degrees:fr,edges_assignment_names:{M:"mountain",m:"mountain",V:"valley",v:"valley",B:"boundary",b:"boundary",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},edge_assignment_to_foldAngle:lr,edge_foldAngle_to_assignment:vr,filter_keys_with_suffix:dr,filter_keys_with_prefix:pr,get_graph_keys_with_prefix:_r,get_graph_keys_with_suffix:gr,transpose_graph_arrays:hr,transpose_graph_array_at_index:mr,fold_object_certainty:yr}),xr=function implied_count(e,t,n){return Math.max(function max_num_in_array_in_arrays(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}(gr(e,t).map((function(t){return e[t]}))),e[n]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[n]):-1)+1};xr.vertices=function(e){return xr(e,"vertices")},xr.edges=function(e){return xr(e,"edges","edgeOrders")},xr.faces=function(e){return xr(e,"faces","faceOrders")};var Ar=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,o=e.vertices_sectors,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],v=(l.indexOf(u)+l.length-1)%l.length,d=l[v],p="".concat(s," ").concat(d);if(c[p])return Object.assign(i,c),a.vertices.pop(),a;if(c[p]=!0,i[p])return;a.vertices.push(s),a.edges.push(p),a.angles.push(o[s][v]),u=s,s=d}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},kr=Object.freeze({__proto__:null,planar_vertex_walk:Ar}),wr=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return Jn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-Jn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},Er=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:Jn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},Mr=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:wr,sort_vertices_along_vector:Er}),Or=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},jr=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=Nr({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},Cr=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=Or({edges_vertices:r}));var o=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?o:o.map((function(e,n){return wr({vertices_coords:t},e,n)}))},Sr=function make_vertices_faces(e){var t=e.faces_vertices,n=Array.from(Array(xr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Pr=function make_vertices_faces_sorted(e){var t=e.vertices_vertices,n=e.faces_vertices,r=Ir({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},Nr=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},zr=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},Ir=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},Lr=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;o||(o=Br({vertices_coords:t,edges_vertices:r}));var i=zr({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=i["".concat(t," ").concat(e)],r=i["".concat(e," ").concat(t)];return void 0!==n?o[n]:void 0!==r?Jn.core.flip(o[r]):void 0}))}))},qr=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;return Lr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:o}).map((function(e){var t;return 1===e.length?[Jn.core.TWO_PI]:(t=Jn.core).interior_angles.apply(t,_toConsumableArray(e))}))},Tr=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,o=e.edges_vertices,i=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=Hr({vertices_coords:n,edges_vertices:o,edges_foldAngle:i,edges_assignment:c,faces_vertices:a,faces_faces:u},t)),r||(r=Sr({faces_vertices:a}));var l=r.map((function(e){return e[0]})).map((function(e){return void 0===e?Jn.core.identity3x4:s[e]}));return n.map((function(e){return Jn.core.resize(3,e)})).map((function(e,t){return Jn.core.multiply_matrix3_vector3(l[t],e)}))},Fr=function make_edges_faces(e){var t=e.faces_edges,n=Array.from(Array(xr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Vr={M:-180,m:-180,V:180,v:180},Gr=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return Vr[e]||0}))},Br=function make_edges_vector(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Jn.core.subtract(e[1],e[0])}))},Dr=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=n.map((function(e){return e.map((function(e){return t[e]}))}))),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Rr=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,n=[-t,+t];return Dr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Ur=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,o=e.vertices_sectors,i=e.edges_vertices,c=e.edges_vector;n||(n=Cr({vertices_coords:t,edges_vertices:i,vertices_edges:r})),o||(o=qr({vertices_coords:t,vertices_vertices:n,edges_vertices:i,edges_vector:c}));var a=Nr({edges_vertices:i});return Ar({vertices_vertices:n,vertices_sectors:o}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},Zr=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var o=e.length;e.forEach((function(e,i,c){var a=c[(i+1)%o];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},Xr=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),o=[],i=r.indexOf(!1),c=i+1;c<r.length;c+=1)r[c]&&o.push(e[c]);for(var a=0;a<i;a+=1)r[a]&&o.push(e[a]);return o},$r=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Zr({faces_vertices:t})),0===n.length)return[];var o=[[{face:r}]],i={};i[r]=!0;var c=function _loop(){var e=o[o.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){i[e.face]&&(r[t]=!0),i[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return Xr(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),o[o.length]=c};do{c()}while(o[o.length-1].length>0);return o.length>0&&0===o[o.length-1].length&&o.pop(),o},Hr=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=o?Gr({edges_assignment:o}):Array(n.length).fill(0));var u=Nr({edges_vertices:n}),s=i.map((function(){return Jn.core.identity3x4}));return $r({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,o=e.edge_vertices.map((function(e){return t[e]})),i=e.edge_vertices.join(" "),c=u[i],a=Jn.core.make_matrix3_rotate(r[c]*Math.PI/180,(n=Jn.core).subtract.apply(n,_toConsumableArray(Jn.core.resize_up(o[1],o[0]))),o[0]);s[e.face]=Jn.core.multiply_matrices3(s[e.parent],a)}))})),s},Yr=function make_faces_coloring_from_matrix(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},Wr=Object.freeze({__proto__:null,make_vertices_edges:Or,make_vertices_edges_sorted:jr,make_vertices_vertices:Cr,make_vertices_faces:Sr,make_vertices_faces_sorted:Pr,make_vertices_to_edge_bidirectional:Nr,make_vertices_to_edge:zr,make_vertices_to_face:Ir,make_vertices_vertices_vector:Lr,make_vertices_sectors:qr,make_vertices_coords_folded:Tr,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),o=n[e[1]].filter((function(e){return e!==t}));return r.concat(o)}))},make_edges_faces:Fr,make_edges_foldAngle:Gr,make_edges_assignment:function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_vector:Br,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return Br({vertices_coords:t,edges_vertices:n}).map((function(e){return Jn.core.magnitude(e)}))},make_edges_coords_min_max:Dr,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,n=[+t,-t];return Dr(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Rr,make_planar_faces:Ur,make_faces_vertices:function make_faces_vertices(e){return Ur(e).map((function(e){return e.vertices}))},make_faces_edges:function make_faces_edges(e){return Ur(e).map((function(e){return e.edges}))},make_faces_faces:Zr,get_face_face_shared_vertices:Xr,make_face_spanning_tree:$r,make_faces_matrix:Hr,make_faces_center:function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Jn.core.centroid(e)}))},make_faces_coloring_from_matrix:Yr,make_faces_coloring:function make_faces_coloring(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=[];return o[r]=!0,$r({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){o[e.face]=t%2==0}))})),o}}),Jr=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=Or({edges_vertices:n}));for(var o=r.map((function(e){return"B"===e||"b"===e})),i=[],c=[],a=-1,u=0;u<o.length;u+=1)if(o[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};o[a]=!1,i.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return o[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];o[a]=!1,i.push(a)}return{vertices:c,edges:i}},Kr=Object.freeze({__proto__:null,get_boundary:Jr,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,o=e.edges_vertices;r||(r=Cr({vertices_coords:t,vertices_edges:n,edges_vertices:o}));var i=Nr({edges_vertices:o}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var v=t[l],d=r[l],p=d.map((function(e){return t[e]})).map((function(e){return[e[0]-v[0],e[1]-v[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,h=d[p],m=i[l<h?"".concat(l," ").concat(h):"".concat(h," ").concat(l)];c.push(m);for(var b=l,k=h,w=0;w<1e4;){var E=r[k],M=E.indexOf(b),O=E[(M+1)%E.length],j=i[k<O?"".concat(k," ").concat(O):"".concat(O," ").concat(k)];if(j===c[0])return u;a.push(k),c.push(j),b=k,k=O,w+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),Qr=function clip_line(e,t){var n=e.vertices_coords,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_assignment,c=e.boundaries_vertices,a=Jn.typeof(t),u=Jn.core["clip_".concat(a,"_in_convex_poly_exclusive")];if(u){c||(c=Jr({vertices_edges:r,edges_vertices:o,edges_assignment:i}).vertices);var s=c.map((function(e){return n[e]}));return u.apply(void 0,[s].concat(_toConsumableArray(function prepare_clip_func_params(e,t){switch(t){case"line":case"ray":return[e.vector,e.origin];case"segment":return[e[0],e[1]];default:return[]}}(t,a))))}},eo=Object.freeze({__proto__:null,clip_line:Qr}),to=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=Jn.core.resize(n[0].length,t),o=n.map((function(e,t){return{d:Jn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return o?o.i:void 0}},no=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var o=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return Jn.core.nearest_point_on_line(Jn.core.subtract(e[1],e[0]),e[0],t,Jn.core.segment_limiter)}));return Jn.core.smallest_comparison_search(t,o,Jn.core.distance)}},ro=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var o=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return Jn.core.point_in_poly(t,e.face)})).shift();return void 0===o?void 0:o.i}},oo=ro,io=Object.freeze({__proto__:null,nearest_vertex:to,nearest_edge:no,face_containing_point:ro,nearest_face:oo}),co=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON;return Rr(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},ao=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,i=Rr({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(i[a][1][0]<i[u][0][0]||i[u][1][0]<i[a][0][0])&&(i[a][1][1]<i[u][0][1]||i[u][1][1]<i[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},uo=Object.freeze({__proto__:null,get_edges_vertices_span:co,get_edges_edges_span:ao}),so=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,o){r[n][o]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},fo=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},lo=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:so,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},invert_map:fo,invert_simple_map:function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t}}),vo=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},po=function count(e,t){return vo.apply(void 0,_toConsumableArray(_r(e,t).map((function(t){return e[t]}))))};po.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return vo(t,n,r)},po.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return vo(t,n,r)},po.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return vo(t,n,r)};var _o=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},go=function remove_geometry_indices(e,t,n){var r,o,i,c=po(e,t),a=_o(n),u=[];for(r=0,o=0,i=0;r<c;r+=1,o+=1){for(;r===a[i];)u[r]=void 0,r+=1,i+=1;r<c&&(u[r]=o)}return gr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,o){e[t][r][o]=u[n]}))}))})),a.reverse(),_r(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},ho=function populate(e){if("object"===_typeof(e)&&e.edges_vertices){if(e.vertices_edges=Or(e),e.vertices_vertices=Cr(e),e.vertices_edges=jr(e),e.vertices_coords&&(e.edges_vector=Br(e),e.vertices_sectors=qr(e)),function set_edges_angles(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=lr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=vr(e.edges_foldAngle[r]);for(var o=e.edges_assignment.length;o<t;o+=1)e.edges_assignment[o]="U",e.edges_foldAngle[o]=0}(e),e.vertices_coords){var t=Ur(e);e.faces_vertices=t.map((function(e){return e.vertices})),e.faces_edges=t.map((function(e){return e.edges})),e.faces_angles=t.map((function(e){return e.angles}))}else e.faces_vertices=[],e.faces_edges=[];return e.vertices_faces=e.vertices_vertices?Pr(e):Sr(e),e.edges_faces=Fr(e),e.faces_faces=Zr(e),e.vertices_coords&&(e.faces_matrix=Hr(e)),e}},mo=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var o=t.map((function(t){return e.vertices_coords.map((function(e){return Jn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===o[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),o.map((function(e){return void 0===e?i++:e}))},yo=["vertices","edges","faces"],bo=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return Jn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},xo=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},o=0;o<e.edges_vertices.length;o+=1)r["".concat(e.edges_vertices[o][0]," ").concat(e.edges_vertices[o][1])]=o,r["".concat(e.edges_vertices[o][1]," ").concat(e.edges_vertices[o][0])]=o;for(var i=0;i<t.edges_vertices.length;i+=1){var c=r["".concat(t.edges_vertices[i][0]," ").concat(t.edges_vertices[i][1])];void 0!==c&&(n[i]=c)}return n},Ao=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(o,i){return o.forEach((function(o,c){e[t][i][c]=r[n][o]}))}))}))}))},ko=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.core.EPSILON,r={},o={},i={};yo.forEach((function(e){r[e]=_r(t,e),o[e]=gr(t,e)})),yo.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),i.vertices=bo(e,t,n),Ao(t,o,["vertices"],i);var c=po.edges(e);i.edges=Array.from(Array(po.edges(t))).map((function(e,t){return c+t}));var a=xo(e,t);Object.keys(a).forEach((function(e){i.edges[e]=a[e]}));var u=po.faces(e);return i.faces=Array.from(Array(po.faces(t))).map((function(e,t){return u+t})),Ao(t,o,["edges","faces"],i),yo.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,o){var c=i[n][o];e[r][c]=t}))}))})),i},wo=function apply_matrix_to_graph(e,t){return dr(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return Jn.core.resize(3,e)})).map((function(e){return Jn.core.multiply_matrix3_vector3(t,e)}))})),dr(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return Jn.core.multiply_matrices3(e,t)}))})),e},Eo={scale:function transform_scale(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var c=(n=Jn.core).get_vector.apply(n,o),a=Jn.core.resize(3,c),u=Jn.core.make_matrix3_scale(t,a);return wo(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=(t=Jn.core).get_vector.apply(t,o),a=Jn.core.resize(3,c),u=(n=Jn.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return wo(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];var a=(n=Jn.core).get_vector.apply(n,i),u=Jn.core.resize(3,a),s=(r=Jn.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return wo(e,s)},transform:wo},Mo=function subgraph(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(o){n[o]=Array.from(Array(po[o](e))).map((function(e,t){return t})),r[o]=_o(t[o]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return go(e,t,n[t])})),e},Oo=function fn_and(e,t){return e&&t},jo=function fn_cat(e,t){return e.concat(t)},Co=function fn_def(e){return void 0!==e},So=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,o=t.length,i=Array(o).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},Po=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:So}),No=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},zo=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},o=0;o<t.length;o+=1){var i="".concat(t[o][0]," ").concat(t[o][1]),c="".concat(t[o][1]," ").concat(t[o][0]);void 0!==r[i]?n[o]=r[i]:(r[i]=o,r[c]=o)}return n},Io=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.core.EPSILON,r=e.length,o=0;o<r;o+=1)if(Math.abs(e[o]-t[o])>n)return!1;return!0},Lo=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,r=t.map((function(){return[]})),o=0;o<t.length-1;o+=1)for(var i=o+1;i<t.length;i+=1)r[o][i]=Io(t[o],t[i],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},v=0;v<t.length&&(l(v,v),s!==t.length);v+=1);return a.filter((function(e){return e.length}))},qo=function remove_isolated_vertices(e){var t=So(e);return{map:go(e,rr,t),remove:t}},To=function remove_circular_edges(e){var t=No(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),gr(e,or).forEach((function(t){return e[t].forEach((function(r,o){for(var i=r.length-1;i>=0;i-=1)!0===n[r[i]]&&e[t][o].splice(i,1)}))}))}return{map:go(e,or,t),remove:t}},Fo=function remove_duplicate_edges(e){var t=zo(e),n=Object.keys(t),r=go(e,or,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Vo=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,n=Lo(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=Jn.core).average.apply(t,_toConsumableArray(e))})),gr(e,rr).forEach((function(t){return e[t].forEach((function(n,o){return e[t][o].forEach((function(n,i){e[t][o][i]=r[n]}))}))})),_r(e,rr).filter((function(e){return e!==cr})).forEach((function(t){return delete e[t]}));var o=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:o}},Go=Object.freeze({__proto__:null,remove_isolated_vertices:qo,remove_circular_edges:To,remove_duplicate_edges:Fo,remove_duplicate_vertices:Vo}),Bo=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var i=co({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)i[c][a]&&(i[c][a]=Jn.core.point_on_segment_exclusive(t[a],r[c][0],r[c][1],o));return i.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Do=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,o=e.edges_origin,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON;r||(r=Br({vertices_coords:t,edges_vertices:n})),o||(o=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=ao({vertices_coords:t,edges_vertices:n},i),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=Jn.core.intersect_lines(r[u],o[u],r[s],o[s],Jn.core.exclude_s,Jn.core.exclude_s,i),c[s][u]=c[u][s]):c[u][s]=void 0;return c},Ro=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return Jn.core.subtract(e[1],e[0])})),o=n.map((function(e){return e[0]})),i=Do({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:o},1e-6),c=Bo({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==i.reduce(jo,[]).filter(Co).length||0!==c.reduce(jo,[]).filter(Co).length){var a={vertices:e.vertices_coords.length};i.forEach((function(t){return t.filter(Co).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),i.forEach((function(e,t){e.forEach((function(e,n){e&&(i[t][n]=e[0])}))}));var u=i.map((function(e){return e.filter(Co)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=Er({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(jo,[]);return e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(jo,[]),e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]||0}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},Uo=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],Zo=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[rr,or,ir].map((function(t){return _r(e,t)})).reduce(jo,[]).filter((function(e){return!Uo.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var o=Vo(e,t/2),i=Fo(e),c=To(e),a=Ro(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?o.map:so(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?so(i.map,c.map):so(r.edges.map,i.map,c.map);break}var u=fo(a.edges.backmap),s=so(i.map,c.map,u);r.vertices.map=void 0===r.vertices.map?o.map:so(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?s:so(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},Xo=function clone(e){var t,n;if("object"!==_typeof(e))return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},$o=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var o=Fo(e).map;return r.map((function(e){return o[e]}))},Ho=function split_edge(e,t,n){if(!(e.edges_vertices.length<t)){var r,o=e.edges_vertices[t];if(!n)n=(r=Jn.core).midpoint.apply(r,_toConsumableArray(o));var i=o.map((function(t){return e.vertices_coords[t]})).map((function(e){return Jn.core.distance(e,n)<Jn.core.EPSILON}));if(i[0])return{vertex:o[0],edges:{}};if(i[1])return{vertex:o[1],edges:{}};var c=e.vertices_coords.length;e.vertices_coords[c]=n;var a=[0,1].map((function(t){return t+e.edges_vertices.length}));(function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],o=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];return o.forEach((function(n,r){if([ar,ur].filter((function(n){return void 0!==e[n]&&void 0!==e[n][t]})).forEach((function(r){return n[r]=e[r][t]})),e.edges_faces&&void 0!==e.edges_faces[t]&&(n.edges_faces=_toConsumableArray(e.edges_faces[t])),e.edges_vector){var o=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_vector=Jn.core.subtract(o[1],o[0])}if(e.edges_length){var i,c=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_length=(i=Jn.core).distance2.apply(i,_toConsumableArray(c))}})),o})(e,t,c).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][a[n]]=t[r]}))})),function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,o){var i=o[(n+1)%o.length],c=r[e].indexOf(i);r[e][c]=t})))}(e,c,o),function update_vertices_edges(e,t,n,r,o){var i=e.vertices_edges;i&&(i[r]=_toConsumableArray(o),t.map((function(e){return i[e].indexOf(n)})).forEach((function(e,n){i[t[n]][e]=o[n]})))}(e,o,t,c,a);var u=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,o=e.edges_faces,i=e.faces_edges;if(e.faces_vertices,o&&o[t])return o[t];var c=r[t];if(void 0!==n){for(var a=[],u=0;u<n[c[0]].length;u+=1)for(var s=0;s<n[c[1]].length;s+=1)n[c[0]][u]===n[c[1]][s]&&a.push(n[c[0]][u]);return a}if(i){for(var l=[],v=0;v<i.length;v+=1)for(var d=0;d<i[v].length;d+=1)i[v][d]===t&&l.push(v);return l}}(e,t);u&&(function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))}(e,c,o),function update_faces_vertices(e,t,n,r){var o=e.faces_vertices;o&&t.map((function(e){return o[e]})).forEach((function(e){return e.map((function(e,t,n){var o=(t+1)%n.length;return e===r[0]&&n[o]===r[1]||e===r[1]&&n[o]===r[0]?o:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(t){return e.splice(t,0,n)}))}))}(e,u,c,o),function update_faces_edges(e,t,n,r,o){var i=e.edges_vertices,c=e.faces_edges;c&&t.map((function(e){return c[e]})).forEach((function(e){var t=e.indexOf(o),c=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length],u=[[c,o],[o,a]].map((function(e){var t=e.map((function(e){return i[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==i[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==i[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("something wrong with input graph's faces_edges construction")}));return t===e.length-1?(e.splice(t,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[t,1].concat(_toConsumableArray(s))),s}))}(e,u,c,a,t));var s=go(e,or,[t]);return a.forEach((function(e,t){a[t]=s[a[t]]})),s.splice(-2),s[t]=a,{vertex:c,edges:{map:s,remove:t}}}},Yo=function split_convex_face(e,t,n,r){var o=function intersect_face_with_line(e,t,n,r){var o=e.vertices_coords,i=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=c[t].map((function(e){return o[e]})).map((function(e){return Jn.core.point_on_line(e,n,r)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).slice(0,2),s=u.map((function(e){return{vertex:c[t][e],face_vertex_index:e}}));if(s.length>1){var l=u[1]-u[0];if(1===(l<0?l+c[t].length:l))return;return{vertices:s,edges:[]}}var v=a[t].map((function(e){return i[e].map((function(e){return o[e]}))})).map((function(e){var t;return(t=Jn.core).intersect_line_seg_exclude.apply(t,[n,r].concat(_toConsumableArray(e)))})).map((function(e,n){return{coords:e,face_edge_index:n,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).slice(0,2);return s.length>0&&v.length>0?{vertices:s,edges:v}:v.length>1?{vertices:[],edges:v}:void 0}(e,t,n,r);if(void 0!==o){var i=o.vertices.map((function(e){return e.vertex})),c=[];o.edges.map((function(t,n,r){t.edge=c.length?c[0].edges.map[t.edge]:t.edge,c.push(Ho(e,t.edge,t.coords))})),i.push.apply(i,_toConsumableArray(c.map((function(e){return e.vertex}))));var a=e.edges_vertices.length,u=[0,1].map((function(t){return e.faces_vertices.length+t-1})),s=function make_edge(e,t,n){var r,o,i=e.vertices_coords,c=t.map((function(e){return i[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=Jn.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(o=Jn.core).subtract.apply(o,_toConsumableArray(c)),edges_faces:_toConsumableArray(n)}}(e,i,u);Object.keys(s).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][a]=s[t]})),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,o=e.edges_vertices,i=o[t][0],c=o[t][1];r[i]=wr({vertices_coords:n},r[i].concat(c),i),r[c]=wr({vertices_coords:n},r[c].concat(i),c)}(e,a);var l=function make_faces(e,t,n){var r=e.edges_vertices,o=e.faces_vertices,i=Nr({edges_vertices:r}),c=n.map((function(e){return o[t].indexOf(e)}));return function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(o[t],c).map((function(e){return{faces_vertices:e,faces_edges:e.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return i[e]}))}}))}(e,t,i),v=go(e,"faces",[t]);if(l.forEach((function(t,n){return Object.keys(t).filter((function(t){return void 0!==e[t]})).forEach((function(r){e[r][u[n]]=t[r]}))})),e.vertices_faces=Sr(e),e.edges_faces=Fr(e),e.faces_faces=Zr(e),2===c.length){var d=function invert_array(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t}(c[0].edges.map);c[1].edges.remove=d[c[1].edges.remove]}return v[t]=u,{vertices:i,faces:{map:v,remove:t},edges:{map:so.apply(void 0,_toConsumableArray(c.map((function(e){return e.edges.map})))),new:a,remove:c.map((function(e){return e.edges.remove}))}}}},Wo=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),o=r.filter((function(e){return t[e]})),i=r.filter((function(e){return!t[e]}));return i.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),o.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=i.length+t})),n},Jo=function get_face_sidedness(e,t,n,r){var o=[n[0]-t[0],n[1]-t[1]],i=e[0]*o[1]-e[1]*o[0];return r?i>0:i<0},Ko=function make_face_center_fast(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},Qo=function prepare_graph_crease(e,t,n,r){var o=po.faces(e),i=Array.from(Array(o));e["faces_re:layer"]||(e["faces_re:layer"]=Array(o).fill(0)),e["faces_re:preindex"]=i.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=Hr(e,r)),e.faces_coloring=Yr(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return Jn.core.invert_matrix3(e)})).map((function(e){return Jn.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=i.map((function(t,n){return Ko(e,n)})),e["faces_re:sidedness"]=i.map((function(t,n){return Jo(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},ei=function two_furthest_points(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],o=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<o[1]&&(o=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-o[1])>Math.abs(r[0]-n[0])?[o,t]:[n,r]},ti={M:"V",m:"V",V:"M",v:"M"},ni=function opposingCrease(e){return ti[e]||e},ri=function flat_fold(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",i=ni(o);if(null==r){var c=ro(e,n);r=void 0===c?0:c}t=Jn.core.resize(3,t),n=Jn.core.resize(3,n),Qo(e,t,n,r);var a=Xo(e);a.vertices_coords.forEach((function(e){return e.splice(2)}));var u=Array.from(Array(po.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=a.faces_coloring[t],r=Yo(a,t,a["faces_re:creases"][t].vector,a["faces_re:creases"][t].origin);if(void 0!==r)return a.edges_assignment[r.edges.new]=n?o:i,a.edges_foldAngle[r.edges.new]=n?fr[o]||0:fr[i]||0,r.faces.map[r.faces.remove].forEach((function(t){a.faces_center[t]=Ko(a,t),a["faces_re:sidedness"][t]=Jo(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,a.faces_center[t],e.faces_coloring[r.faces.remove]),a["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],a["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();a["faces_re:layer"]=Wo(a["faces_re:layer"],a["faces_re:sidedness"]);var s=void 0===u[0]?0:a["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return a["faces_re:sidedness"][e.new]})).shift().new,l=e.faces_matrix[0];"M"!==o&&"m"!==o&&"V"!==o&&"v"!==o||(l=void 0!==u[0]||e["faces_re:sidedness"][0]?Jn.core.multiply_matrices3(e.faces_matrix[0],Jn.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var v=Hr(a,s).map((function(e){return Jn.core.multiply_matrices3(l,e)}));a.faces_coloring=Yr({faces_matrix:v});var d=Jn.core.multiply_matrix3_line3(l,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),p=Jn.core.normalize(Jn.core.rotate270(d.vector)),h=u.map((function(t,n){return void 0===t?void 0:a.edges_vertices[t.edges.new].map((function(e){return a.vertices_coords[e]})).map((function(t){return Jn.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return a["re:construction"]=0===h.length?{type:"flip",direction:p}:{type:"fold",assignment:o,direction:p,edge:ei(h)},a.faces_matrix=v,a["vertices_re:foldedCoords"]=Tr(a,s),a.faces_matrix=v,delete e["faces_re:creases"],delete a["faces_re:creases"],delete e["faces_re:sidedness"],delete a["faces_re:sidedness"],delete e["faces_re:preindex"],delete a["faces_re:preindex"],delete e.faces_coloring,delete a.faces_coloring,delete e.faces_center,delete a.faces_center,a},oi=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(To(e),Fo(e)),"object"===_typeof(t)&&!0===t.vertices&&qo(e),e},ii=function invert_array(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},ci={V:1,v:1,M:-1,m:-1},ai=function upOrDown(e,t){return t%2==0?ci[e]:-ci[e]},ui=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},si=function get_sectors_layer(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.core.EPSILON,r=0,o=e.map((function(e,t){return t%2==0?e:-e})).map((function(e){return r+=e})),i=o.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+n})),c=o.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-n})),a=function test(t){var n=[];t.forEach((function(e,t){n[e]=t}));for(var r=t.length+(t.length===e.length?0:-1),a=function _loop(e){var r=(e+1)%t.length,a=ui(t,n[e],n[r]),u=a.map((function(t){return o[e]<i[t]})).reduce(Oo,!0),s=a.map((function(t){return o[e]>c[t]})).reduce(Oo,!0);if(!u&&!s)return{v:!1}},u=0;u<r;u+=1){var s=a(u);if("object"===_typeof(s))return s.v}return!0},u=function final_test(e){var n=ii(e);return n[0]>n[n.length-1]?"M"===t[0]:"V"===t[0]},s=function recurse(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n=n.slice(0,o).concat([r],n.slice(o,n.length)),!a(n))return[];if(r>=e.length-1)return u(n)?[n]:[];var i=ai(t[(r+1)%e.length],r),c=1===i?Array.from(Array(n.length-o)).map((function(e,t){return o+t+1})):Array.from(Array(o+1)).map((function(e,t){return t}));return c.map((function(e){return recurse(n,r+1,e)})).reduce((function(e,t){return e.concat(t)}),[]).map(ii)};return s()},fi=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var o=0;o<e.length;o+=1){if(t>n&&("V"===e[o]||"v"===e[o]))return o;if(n>t&&("M"===e[o]||"m"===e[o]))return o}},li=Object.assign(Object.create(null),{assign:ko,add_vertices:mo,add_vertices_split_edges:function add_vertices_split_edges(e,t){var n=mo(e,t),r=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),o=t.map((function(e){return r.map((function(t){return Jn.core.point_on_segment_exclusive(e,t[0],t[1])})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=o.filter((function(e){return void 0!==e})),c=o.map((function(e,t){return{e:e,i:t}})).filter((function(e){return void 0!==e.e})).map((function(t){var r=mr(e,"edges",t.e);return[r,Xo(r)].map((function(r,o){return Object.assign(r,{edges_vertices:[e.edges_vertices[t.e][o],n[t.i]]})}))})).reduce((function(e,t){return e.concat(t)}),[]),a=po.edges(e),u={new:{edges:[]}};return c.forEach((function(t,n){return Object.keys(t).forEach((function(r){void 0===e[r]&&(e[r]=[]),e[r][a+n]=t[r],u.new.edges[n]=a+n}))})),go(e,"edges",i),n},add_edges:$o,split_edge:Ho,split_face:Yo,flat_fold:ri,clean:oi,get_circular_edges:No,get_duplicate_edges:zo,get_duplicate_vertices:Lo,get_collinear_vertices:Bo,count:po,implied:xr,fragment:Zo,remove:go,populate:ho,subgraph:Mo,explode_faces:function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},layer_solver:si,assignment_solver:function assignment_solver(e,t){null==t&&(t=e.map((function(){return"U"})));var n=function all_possible_assignments(e){var t=function get_unassigneds(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),o=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-o[t])}))}(t),r=n.map((function(t){return si(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},single_vertex_fold_angles:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=fi(t);if(void 0!==r){var o=e[(r+1)%e.length],i=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(o)*Math.cos(i)+Math.sin(o)*Math.sin(i)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(o)*Math.sin(i)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},Wr,eo,Eo,Kr,kr,io,br,Mr,uo,lo,Go,Po),vi=function best_fit_arrow(e,t){Jr(e).vertices;var n,r=Qr(e,t),o=((n=Jn.core).midpoint.apply(n,_toConsumableArray(r)),{vector:Jn.core.rotate90(t.vector),origin:t.origin});return Qr(e,o)},di=Object.freeze({__proto__:null,one_crease_arrow:function one_crease_arrow(e,t,n,r){return vi(e,t)}}),pi=function line_line_for_arrows(e,t){return Jn.core.intersect_lines(e.vector,e.origin,t.vector,t.origin,Jn.core.include_l,Jn.core.include_l)},_i=function reflect_point(e,t){var n=Jn.core.intersect_lines(e.vector,e.origin,Jn.core.rotate270(e.vector),t,Jn.core.include_l,Jn.core.include_l),r=Jn.core.subtract(n,t);return Jn.core.add(n,r)},gi=function boundary_for_arrows(e){var t=e.vertices_coords;return Jn.core.convex_hull(t)},hi=function widest_perp(e,t,n){var r=gi(e);if(void 0===n){var o,i=Jn.core.clip_line_in_convex_poly_exclusive(r,t.vector,t.origin);n=(o=Jn.core).midpoint.apply(o,_toConsumableArray(i))}var c=Jn.core.rotate270(t.vector),a=Jn.core.clip_line_in_convex_poly_exclusive(r,c,n).map((function(e){return Jn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=Jn.core.scale(Jn.core.normalize(c),a);return[Jn.core.add(n,Jn.core.flip(u)),Jn.core.add(n,u)]},mi=[null,function axiom_1_arrows(e,t,n){return[hi(n,t)]},function axiom_2_arrows(e){return[e.points]},function axiom_3_arrows(e,t,n){var r,o,i,c,a=gi(n),u=e.lines.map((function(e){return Jn.core.clip_line_in_convex_poly_exclusive(a,e.vector,e.origin)})),s=Jn.core.intersect_seg_seg_exclude(u[0][0],u[0][1],u[1][0],u[1][1]);if(s){var l=e.lines.map((function(e){return e.vector})),v=l.map(Jn.core.flip),d=l.concat(v).map((function(e){return Jn.ray(e,s)})),p=d.filter((function(e){return Jn.core.dot(e.vector,t.vector)>0&&Jn.core.cross2(e.vector,t.vector)>0})).shift(),h=d.filter((function(e){return Jn.core.dot(e.vector,t.vector)>0&&Jn.core.cross2(e.vector,t.vector)<0})).shift(),m=d.filter((function(e){return Jn.core.dot(e.vector,t.vector)<0&&Jn.core.cross2(e.vector,t.vector)>0})).shift(),b=d.filter((function(e){return Jn.core.dot(e.vector,t.vector)<0&&Jn.core.cross2(e.vector,t.vector)<0})).shift(),k=[p,h,m,b].map((function(e){return Jn.core.convex_poly_ray_exclusive(a,e.vector,e.origin).shift().shift()})),w=k.map((function(e){return Jn.core.distance(e,s)}));w[0]<w[1]?(r=k[0],o=Jn.core.add(h.origin,h.vector.normalize().scale(w[0]))):(r=k[1],o=Jn.core.add(p.origin,p.vector.normalize().scale(w[1]))),w[2]<w[3]?(i=k[2],c=Jn.core.add(b.origin,b.vector.normalize().scale(w[2]))):(i=k[3],c=Jn.core.add(m.origin,m.vector.normalize().scale(w[3])))}else{var E,M=u.map((function(e){return Jn.core.midpoint(e[0],e[1])})),O=(E=Jn.line).fromPoints.apply(E,_toConsumableArray(M)),j=Jn.intersect(t,O),C=Jn.line(t.vector.rotate90(),j),S=e.lines.map((function(e){return Jn.intersect(e,C)}));r=S[0],o=S[1]}return void 0===i?[[r,o]]:[[r,o],[i,c]]},function axiom_4_arrows(e,t,n){return[hi(n,t,pi(t,e.lines[0]))]},function axiom_5_arrows(e,t){return[[e.points[1],_i(t,e.points[1])]]},function axiom_6_arrows(e,t){return e.points.map((function(e){return[e,_i(t,e)]}))},function axiom_7_arrows(e,t,n){return[[e.points[0],_i(t,e.points[0])],hi(n,t,pi(t,e.lines[1]))]}];delete mi[0];var yi=Object.assign(Object.create(null),di,{axiom_arrows:mi}),bi=Object.create(null),xi=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},Ai=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},ki=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var o=r+1;o<e.length;o+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][o])return!1;return!0}})},wi=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Ei={vertices:function setup_vertex(e,t){return xi.call(this,e,t),e},edges:function setup_edge(e,t){return Ai.call(this,e,t),e},faces:function setup_face(e,t){return ki.call(this,e,t),wi.call(this,e,t),e}},Mi={};Mi.prototype=Object.create(Object.prototype),Mi.prototype.constructor=Mi;var Oi=Object.assign({clean:oi,populate:ho,fragment:Zo,subgraph:Mo,assign:ko},Eo);Object.keys(Oi).forEach((function(e){Mi.prototype[e]=function(){return Oi[e].apply(Oi,[this].concat(Array.prototype.slice.call(arguments)))}})),Mi.prototype.copy=function(){return Object.assign(Object.create(Mi.prototype),Xo(this))},Mi.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===_typeof(e)&&(!0!==n.append&&nr.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:Qn,file_creator:er},Xo(e)))},Mi.prototype.clear=function(){var e=this;tr.graph.forEach((function(t){return delete e[t]})),tr.orders.forEach((function(t){return delete e[t]})),delete this.file_frames};var ji=function shortenKeys(e,t,n){var r=this,o=Object.create(null);return Object.keys(e).forEach((function(t){o[t.substring(r.length+1)]=e[t]})),o},Ci=function getComponent(e){return hr(this,e).map(ji.bind(e)).map(Ei[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Mi.prototype,e,{get:function get(){return Ci.call(this,e)}})})),Object.defineProperty(Mi.prototype,"junctions",{get:function get(){return Lr(this).map((function(e){return Jn.junction.apply(Jn,_toConsumableArray(e))}))}}),Object.defineProperty(Mi.prototype,"boundary",{get:function get(){var e=this,t=Jr(this),n=Jn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}});var Si={vertices:to,edges:no,faces:ro},Pi=function nearestElement(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=(t=Jn.core).get_vector.apply(t,r),c=Si[e](this,i),a=mr(this,e,c);return Ei[e].call(this,a,c),a.index=c,a};Mi.prototype.nearest=function(){var e=arguments,t=this,n=Object.create(null);return["vertices","edges","faces"].forEach((function(r){return Object.defineProperty(n,sr[r],{get:function get(){return Pi.call.apply(Pi,[t,r].concat(_toConsumableArray(e)))}})})),n};var Ni=Mi.prototype,zi={};zi.prototype=Object.create(Ni),zi.prototype.constructor=zi;zi.prototype.copy=function(){return Object.assign(Object.create(zi.prototype),Xo(this))},["line","ray","segment"].forEach((function(e){zi.prototype[e]=function(){var t=Jn[e].apply(Jn,arguments);if(t){var n=Qr(this,t);if(n){var r=mo(this,n),o=$o(this,r),i=Zo(this).edges.map;return ho(this),o.map((function(e){return i[e]}))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){zi.prototype[e]=function(){var t=this,n=Jn[e].apply(Jn,arguments);if(n){var r=n.segments(96).map((function(e){return Jn.segment(e)})).map((function(e){return Qr(t,e)})).filter((function(e){return void 0!==e}));if(r){var o=[],i=[];r.forEach((function(e){var n=mo(t,e);o.push.apply(o,_toConsumableArray(n)),i.push.apply(i,_toConsumableArray($o(t,n)))}));var c=Zo(this).edges.map;return ho(this),i.map((function(e){return c[e]}))}}}}));var Ii=zi.prototype,Li={};Li.prototype=Object.create(Ni),Li.prototype.constructor=Li,Li.prototype.flatFold=function(){var e=this,t=Jn.core.get_line(arguments),n=ri(this,t.vector,t.origin);return[rr,or,ir].map((function(t){return _r(e,t)})).reduce(jo,[]).forEach((function(t){return delete e[t]})),Object.assign(this,n),this},Li.prototype.copy=function(){return Object.assign(Object.create(Li.prototype),Xo(this))},Li.prototype.folded=function(){var e=Tr(this);return Object.assign(Object.create(Li.prototype),Object.assign(Xo(this),{vertices_coords:e}))};var qi=Li.prototype,Ti=function make_polygon_vertices(e){return 4===e?[[0,0],[1,0],[1,1],[0,1]]:Jn.core.make_regular_polygon(e,.5/Math.sin(Math.PI/e))},Fi={},Vi=[null,null,null,"triangle","square","pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];[0,1,2].forEach((function(e){delete Vi[e]}));var Gi=function create_init(e){return ho(e)};Vi.forEach((function(e,t){var n=Array.from(Array(t));Fi[e]=function(){return Gi({vertices_coords:Ti(t),edges_vertices:n.map((function(e,t){return[t,(t+1)%n.length]})),edges_assignment:n.map((function(){return"B"}))})}})),Fi.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return Gi({vertices_coords:Jn.core.make_regular_polygon(e,1),edges_vertices:Array.from(Array(e)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(e)).map((function(){return"B"}))})},Fi.kite=function(){return Gi({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:["B","B","B","B","B","B","V","V","F"]})};var Bi=[null,Jn.core.axiom1,Jn.core.axiom2,Jn.core.axiom3,Jn.core.axiom4,Jn.core.axiom5,Jn.core.axiom6,Jn.core.axiom7];delete Bi[0];var Di=function axiom(e,t){return Bi[e].apply(Bi,_toConsumableArray(function sort_axiom_params(e,t,n){switch(e){case"1":case"2":case 1:case 2:return t;case"3":case 3:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin];case"4":case 4:return[n[0].vector,t[0]];case"5":case 5:return[n[0].vector,n[0].origin,t[0],t[1]];case"6":case 6:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin,t[0],t[1]];case"7":case 7:return[n[0].vector,n[0].origin,n[1].vector,t[0]]}return[]}(e,t.points.map((function(e){return Jn.core.get_vector(e)})),t.lines.map((function(e){return Jn.core.get_line(e)})))))};Object.keys(Bi).forEach((function(e){Di[e]=Bi[e]}));var Ri,Ui={axioms:{ar:[null,"   ","        ","        ","          ","         ","            ","          "],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una lnea entre dos puntos","dobla dos puntos juntos","dobla y une dos lneas","dobla una lnea sobre s misma, doblndola hacia un punto","dobla un punto hasta una lnea, doblndola a travs de otro punto","dobla un punto hacia una lnea y otro punto hacia otra lnea","dobla un punto hacia una lnea y otra lnea sobre s misma"],fr:[null,"crez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-mme  l'aide d'un pli qui passe par un point","rabattez un point sur une ligne  l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-mme"],hi:[null,"        ","         ","        ","                  ","                 ","                   ","                      "],jp:[null,"2","2","2","","","",""],ko:[null,"    ","   ","   ","      ","  ,    ","       ","       "],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto at uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto at uma linha e outro ponto at outra linha","dobre um ponto at uma linha e outra linha sobre si mesma"],ru:[null,"    ","   ","   ","   ,   ","   ,    ","         ","        "],tr:[null,"iki noktadan geen bir izgi boyunca katla","iki noktay birbirine katla","iki izgiyi birbirine katla","bir noktadan kvrarak kendi zerindeki bir izgi boyunca katla","baka bir noktadan kvrarak bir noktay bir izgiye katla","bir noktay bir izgiye ve baka bir noktay baka bir izgiye katla","bir noktay bir izgiye ve baka bir izgiyi kendi zerine katla"],vi:[null,"to mt np gp i qua hai im","to np gp bng cch gp mt im ny sang im khc","to np gp bng cch gp mt ng ln mt ng khc","to mt np gp i qua mt im v a mt ng ln trn chnh n","to mt np gp i qua im u tin v a im th hai ln ng thng","to mt np gp mang im u tin n ng u tin v im th hai cho ng th hai","to mt np gp mang li mt im cho mt ng v a mt ng th hai ln trn chnh n"],zh:[null,"","","","","","",""]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaa",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"",mountain:"",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",blintz:"",squash:"",flip:""}}},Zi=function(){var n={};if(t){var r=require("xmldom"),o=r.DOMParser,i=r.XMLSerializer;n.DOMParser=o,n.XMLSerializer=i,n.document=(new o).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else e&&(n=window);return n}(),Xi=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Jn.core.mag_squared(t)<Jn.core.EPSILON)throw"degenerate edge";for(var o=Jn.core.normalize(t),i=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return Jn.core.cross3(e,o)})).sort((function(e,t){return Jn.core.magnitude(t)-Jn.core.magnitude(e)})).shift(),c=[Jn.core.normalize(i)],a=1;a<4;a+=1)c.push(Jn.core.cross3(c[a-1],o));var u=c.map((function(e){return Jn.core.scale(e,n)})),s=[-r,r].map((function(e){return Jn.core.scale(o,e)})),l=0===r?e:e.map((function(e,t){return Jn.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return Jn.core.add(e,t)}))})).reduce(jo,[])},$i=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=Zi.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(jo,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(jo,[]),o=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(jo,[]),i=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(jo,[]).reduce(jo,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(o,3)),c.setIndex(i),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,o=e.edges_coords,i=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=Zi.THREE;o||(o=n.map((function(e){return e.map((function(e){return t[e]}))}))),i||(i=o.map((function(e){return Jn.core.subtract(e[1],e[0])}))),o=o.map((function(e){return e.map((function(e){return Jn.core.resize(3,e)}))})),i=i.map((function(e){return Jn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(jo,[]).reduce(jo,[]).reduce(jo,[]),v=o.map((function(e,t){return Xi(e,i[t],c,a)})).reduce(jo,[]).reduce(jo,[]),d=i.map((function(e){if(Jn.core.mag_squared(e)<Jn.core.EPSILON)throw"degenerate edge";var t=Jn.core.normalize(e),n=(Jn.core.scale(t,c),Jn.core.scale(Jn.core.normalize(Jn.core.cross3(e,[0,0,-1])),c)),r=Jn.core.scale(Jn.core.normalize(Jn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(jo,[]).reduce(jo,[]),p=o.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(jo,[]),h=new u.BufferGeometry;return h.setAttribute("position",new u.Float32BufferAttribute(v,3)),h.setAttribute("normal",new u.Float32BufferAttribute(d,3)),h.setAttribute("color",new u.Float32BufferAttribute(l,3)),h.setIndex(p),h.computeVertexNormals(),h}}),Hi={};["number","object","transform","class","style","function","string","undefined","boolean","path","svg","id","viewBox"].forEach((function(e){return Hi[e]=e}));var Yi=("undefined"==typeof window?"undefined":_typeof(window))!==Hi.undefined&&_typeof(window.document)!==Hi.undefined,Wi=("undefined"==typeof process?"undefined":_typeof(process))!==Hi.undefined&&null!=process.versions&&null!=process.versions.node,Ji=("undefined"==typeof self?"undefined":_typeof(self))===Hi.object&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Ki=Object.freeze({__proto__:null,isBrowser:Yi,isNode:Wi,isWebWorker:Ji}),Qi=function(){var e={};if(Wi){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Yi&&(e=window);return e}(),ec="http://www.w3.org/2000/svg",tc={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},nc=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},rc=function arcPath(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==o)return"";var c=nc(r,n),a=nc(o,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],v=Math.atan2(s,l)>0?0:1,d=i?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return d+=["a ",n,n,0,v,1,u[0],u[1]].join(" "),i&&(d+=" Z"),d},oc=function arcArguments(e,t,n,r,o){return[rc(e,t,n,r,o,!1)]},ic={arc:{nodeName:"path",attributes:["d"],args:oc,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",oc.apply(void 0,n))}}}},cc=function wedgeArguments(e,t,n,r,o){return[rc(e,t,n,r,o,!0)]},ac={wedge:{nodeName:"path",args:cc,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",cc.apply(void 0,n))}}}},uc=128,sc=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-uc)/uc*2+1})).map((function(o){return[e+(o+1)*n*.5,t+Math.pow(o,2)*r]}))},fc={parabola:{nodeName:"polyline",attributes:["points"],args:function parabolaPathString(e,t,n,r){return[sc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},lc=function regularPolygonArguments(e,t,n,r){var o=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return o.map((function(t,n){return t+r*e[n]}))}))},vc={regularPolygon:{nodeName:"polygon",attributes:["points"],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[lc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},dc={roundRect:{nodeName:"path",attributes:["d"],args:function roundRectArguments(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o>n/2&&(o=n/2),o>r/2&&(o=r/2);var i=n-2*o,c=r-2*o,a="A".concat(o," ").concat(o," 0 0 1");return["M".concat(e+(n-i)/2,",").concat(t),"h".concat(i),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-o,",").concat(t+r),"h".concat(-i),a,"".concat(e,",").concat(t+r-o),"v".concat(-c),a,"".concat(e+o,",").concat(t)].join(" ")}}},pc=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===Hi.function},_c=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return pc(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return pc(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},gc=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===Hi.number})).concat(t.filter((function(e){return _typeof(e)===Hi.object&&null!==e})).map((function(e){return _typeof(e.x)===Hi.number?[e.x,e.y]:_typeof(e[0])===Hi.number?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},hc=function add(e,t){return[e[0]+t[0],e[1]+t[1]]},mc=function sub(e,t){return[e[0]-t[0],e[1]-t[1]]},yc=function scale(e,t){return[e[0]*t,e[1]*t]},bc=function curveArguments(){var e=gc.apply(void 0,_toConsumableArray(_c.apply(void 0,arguments))),t=e.slice(0,4);if(!t.length)return[""];var n=e[4]||0,r=e[5]||.5,o=[t[0],t[1]],i=[t[2],t[3]],c=mc(i,o),a=hc(o,yc(c,.5)),u=[c[1],-c[0]],s=hc(a,yc(u,n)),l=hc(o,yc(mc(s,o),r)),v=hc(i,yc(mc(s,i),r));return["M".concat(o[0],",").concat(o[1],"C").concat(l[0],",").concat(l[1]," ").concat(v[0],",").concat(v[1]," ").concat(i[0],",").concat(i[1])]},xc={bend:function bend(e,t){return e.setAttribute("d",bc.apply(void 0,_toConsumableArray(function getEndpoints(e){var t=e.getAttribute("d");return null==t||""===t?[]:[t.slice(t.indexOf("M")+1,t.indexOf("C")).split(","),t.split(" ").pop().split(",")].map((function(e){return e.map((function(e){return parseFloat(e)}))}))}(e)).concat([t]))),e}},Ac={curve:{nodeName:"path",attributes:["d"],args:bc,methods:xc}},kc={};Object.assign(kc,ic,ac,fc,vc,dc,Ac);var wc=Object.keys(kc),Ec=[tc.h,tc.p,tc.i],Mc=[tc.g,tc.v,tc.t,wc],Oc={svg:[tc.s,tc.d].concat(Ec).concat(Mc),g:Mc,text:[tc.cT],linearGradient:[tc.cG],radialGradient:[tc.cG],defs:Ec,filter:[tc.cF],marker:Mc,symbol:Mc,clipPath:Mc,mask:Mc},jc=Object.create(null);Object.keys(Oc).forEach((function(e){jc[e]=Oc[e].reduce((function(e,t){return e.concat(t)}),[])}));var Cc=Object.freeze(jc),Sc={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},Pc=function viewBoxValue(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=1,c=n/i-n,a=e-c-o,u=t-c-o,s=n+2*c+2*o,l=r+2*c+2*o;return[a,u,s,l].join(" ")};function viewBox(){var e=gc.apply(void 0,_toConsumableArray(_c(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?Pc.apply(void 0,_toConsumableArray(e)):void 0}var Nc=function cdata(e){return(new Qi.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},zc=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},Ic=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},Lc=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),Ic(e,t)},qc={removeChildren:zc,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(Sc.toKebab(n),t[n])}))}},Tc=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},Fc=function parse(e){return(new Qi.DOMParser).parseFromString(e,"text/xml")},Vc=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return Tc(e.documentElement)},Gc=function sync(e){if(_typeof(e)===Hi.string||e instanceof String)try{return Vc(Fc(e))}catch(e){return e}if(null!=e.childNodes)return e},Bc=function Load(e){return function isFilename(e){return _typeof(e)===Hi.string&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&Yi&&_typeof(Qi.fetch)===Hi.function?function async(e){return new Promise((function(t,n){if(_typeof(e)===Hi.string||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return Vc(Fc(e))})).then((function(e){return"svg"===e.nodeName?e:e.getElementsByTagName("svg")[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof Qi.Document)return asyncDone(e)}))}(e):Gc(e)};var Dc=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:Hi.string,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=Qi.document.createElementNS(ec,Hi.style);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(Qi.document.styleSheets)for(var t=0;t<Qi.document.styleSheets.length;t+=1){var n=Qi.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),o=0;o<r.length;o+=1){var i=r[o];"cssText"in i?e.push(i.cssText):e.push("".concat(i.selectorText," {\n").concat(i.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,o=!1,i=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[i]+n[l],o=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(o=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],o=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],o||(i-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=o?n[l]:u[i++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\//)>-1?c=c+=o?n[l]:u[--i]+n[l]:n[l].search(/\/>/)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[i]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new Qi.XMLSerializer).serializeToString(e));return t.download&&Yi&&!Wi&&function downloadInBrowser(e,t){var n=new Qi.Blob([t],{type:"text/plain"}),r=Qi.document.createElement("a");r.setAttribute("href",Qi.URL.createObjectURL(n)),r.setAttribute("download",e),Qi.document.body.appendChild(r),r.click(),Qi.document.body.removeChild(r)}(t.filename,r),"svg"===t.output?e:r},Rc=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=1===n.length&&"string"==typeof n[0]?n[0]:viewBox.apply(void 0,n);return o&&e.setAttribute(Hi.viewBox,o),e},Uc=function getViewBox(e){var t=e.getAttribute(Hi.viewBox);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},Zc=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var o=r.matrixTransform(e.getScreenCTM().inverse());return[o.x,o.y]},Xc=Object.freeze({__proto__:null,setViewBox:Rc,getViewBox:Uc,convertToViewBox:Zc}),$c=function loadSVG(e,t){var n=Bc(t);if(null!=n)return _typeof(n.then)===Hi.function?n.then((function(t){return Lc(e,t)})):Lc(e,n)},Hc=function getFrame(e){var t=Uc(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===Hi.function){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},Yc="svg-background-rectangle",Wc=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(Hi.style);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(Hi.style),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(Nc(t)),n},Jc={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),zc(e)},size:Rc,setViewBox:Rc,getViewBox:Uc,padding:function setPadding(e,t){var n=Uc(e);return void 0!==n&&Rc.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(Hi.class)===Yc})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(Hc(e))))).setAttribute(Hi.class,Yc),n.setAttribute("stroke","none"),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return Hc(e)[2]},getHeight:function getHeight(e){return Hc(e)[3]},stylesheet:function stylesheet(e,t){return Wc.call(this,e,t)},load:$c,save:Dc},Kc={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},Qc={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},ea=Object.values(Qc).reduce((function(e,t){return e.concat(t)}),[]),ta=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},na=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return ta(e,n,t[r])})),e.hasOwnProperty("press"))||ta(e,"press",(n=Kc.math).vector.apply(n,_toConsumableArray(t)))},ra=function TouchEvents(e){var t=[],n=[];Object.keys(Qc).forEach((function(e){Qc[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){na(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),na(e,t)}};Object.keys(Qc).forEach((function(t){var o="on"+Sc.capitalized(t);Object.defineProperty(e,o,{set:function set(o){return null==o?function removeHandler(t){return Qc[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):Qc[t].forEach((function(i){var c=function handlerFunc(n){var i=null!=n.touches?n.touches[0]:n;if(void 0!==i){var c,a=Zc(e,i.clientX,i.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return ta(n,e,a[t])})),!n.hasOwnProperty("position"))ta(n,"position",(c=Kc.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}o(n)};e.addEventListener&&(n[i].push(c),e.addEventListener(i,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return ea.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},oa=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},ia=function Animation(e){var t,n,r={},o=0,i=function removeHandlers(){Qi.cancelAnimationFrame&&Qi.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,o=0};Object.defineProperty(e,"play",{set:function set(e){if(i(),null!=e){var c=oa();r[c]=function handlerFunc(i){t||(t=i,o=0),e({time:.001*(i-t),frame:o}),o+=1,r[c]&&(n=Qi.requestAnimationFrame(r[c]))},Qi.requestAnimationFrame&&(n=Qi.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:i,enumerable:!0})},ca=function distanceSq2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},aa=function distance2(e,t){return Math.sqrt(ca(e,t))},ua=Object.freeze({__proto__:null,distanceSq2:ca,distance2:aa}),sa=[["cx","cy"],["x","y"]],fa=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),sa.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},o=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),i=function setPosition(){gc.apply(void 0,_toConsumableArray(_c.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),"function"==typeof t.delegate&&t.delegate.apply(t.pointsContainer,[o,t.pointsContainer])};return t.delegate=void 0,t.setPosition=i,t.onMouseMove=function(e){return n.selected?i(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(ca(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),["svg","updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),o},la=function controls(e,t,n){var r,o,i=Array.from(Array(t)).map((function(){return fa(e)})),c=function protocol(e){return"function"==typeof o?o.call(i,e,r,i):void 0};i.forEach((function(e){e.delegate=c,e.pointsContainer=i}));e.onPress=function mousePressedHandler(e){i.length>0&&(r=i.map((function(t,n){return{i:n,d:ca(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,i[r].selected=!0)},e.onMove=function mouseMovedHandler(e){i.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){i.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(i,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(i,"selected",{get:function get(){return i[r]}}),Object.defineProperty(i,"add",{value:function value(t){i.push(fa(e))}}),i.removeAll=function(){for(;i.length>0;)i.pop().remove()};var a={onChange:function onChange(e,t){if(o=e,!0===t){var n=i.length-1;e.call(i,i[n],n,i)}},position:function position(e){return i.forEach((function(t,n){return t.setPosition(e.call(i,t,n,i))}))},svg:function svg(e){return i.forEach((function(t,n){t.svg=e.call(i,t,n,i)}))}};return Object.keys(a).forEach((function(e){i[e]=function(){return"function"==typeof arguments[0]&&a[e].apply(a,arguments),i}})),i.parent=function(e){return null!=e&&null!=e.appendChild&&i.forEach((function(t){e.appendChild(t.svg)})),i},i},va=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return la.call.apply(la,[e,e].concat(n))}},da=(new Qi.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,pa={svg:{args:function args(){return[viewBox(gc.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:Jc,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Hi.string})).forEach((function(t){return $c(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof da})).filter((function(e){return _typeof(e.appendChild)===Hi.function})).forEach((function(t){return t.appendChild(e)})),ra(e),ia(e),va(e)}}},_a=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n.map((function(e){return Gc(e)})).filter((function(e){return void 0!==e}));return o.filter((function(e){return e.tagName===Hi.svg})).forEach((function(t){return Ic(e,t)})),o.filter((function(e){return e.tagName!==Hi.svg})).forEach((function(t){return e.appendChild(t)})),e},ga={g:{init:_a,methods:{load:_a}}},ha=Object.assign(Object.create(null),{svg:["viewBox"],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"],mask:["id"],symbol:["id"],clipPath:["id","clip-rule"],marker:["id","markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),ma=function setRadius(e,t){return e.setAttribute(ha.circle[2],t),e},ya=function setOrigin(e,t,n){return _toConsumableArray(gc.apply(void 0,_toConsumableArray(_c(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(ha.circle[n],t)})),e},ba=function fromPoints(e,t,n,r){return[e,t,aa([e,t],[n,r])]},xa={circle:{args:function args(e,t,n,r){var o=gc.apply(void 0,_toConsumableArray(_c(e,t,n,r)));switch(o.length){case 0:case 1:return[,,].concat(_toConsumableArray(o));case 2:case 3:return o;default:return ba.apply(void 0,_toConsumableArray(o))}},methods:{radius:ma,setRadius:ma,origin:ya,setOrigin:ya,center:ya,setCenter:ya,position:ya,setPosition:ya}}},Aa=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(ha.ellipse[n],t)})),e},ka=function setCenter(e,t,n){return _toConsumableArray(gc.apply(void 0,_toConsumableArray(_c(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(ha.ellipse[n],t)})),e},wa={ellipse:{args:function args(e,t,n,r){var o=gc.apply(void 0,_toConsumableArray(_c(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(o));default:return o}},methods:{radius:Aa,setRadius:Aa,origin:ka,setOrigin:ka,center:ka,setCenter:ka,position:ka,setPosition:ka}}},Ea=function Args(e,t,n,r){return gc.apply(void 0,_toConsumableArray(_c(e,t,n,r))).slice(0,4)},Ma={line:{args:Ea,methods:{setPoints:function setPoints(e,t,n,r,o){return Ea(t,n,r,o).forEach((function(t,n){return e.setAttribute(ha.line[n],t)})),e}}}},Oa=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,ja=/-?[0-9]*\.?\d+/g,Ca={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(Ca).forEach((function(e){var t=Ca[e];Ca[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var Sa=function getD(e){var t=e.getAttribute("d");return null==t?"":t},Pa=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.setAttribute("d","".concat(Sa(e)).concat(t).concat(_c.apply(void 0,r).join(" "))),e},Na=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=Oa.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(ja);return e.en=Ca[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(Sa(e))},za={addCommand:Pa,appendCommand:Pa,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:Na,get:Na,getD:function getD(e){return e.getAttribute("d")}};Object.keys(Ca).forEach((function(e){za[Ca[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return Pa.apply(void 0,[t,e].concat(r))}}));var Ia={path:{methods:za}},La=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(ha.rect[n],t)})),e},qa=function setRectOrigin(e,t,n){return _toConsumableArray(gc.apply(void 0,_toConsumableArray(_c(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(ha.rect[n],t)})),e},Ta=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},Fa={rect:{args:function args(e,t,n,r){var o=gc.apply(void 0,_toConsumableArray(_c(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:case 3:return Ta([,,].concat(_toConsumableArray(o)));default:return Ta(o)}},methods:{origin:qa,setOrigin:qa,center:qa,setCenter:qa,size:La,setSize:La}}},Va={style:{init:function init(e,t){e.textContent="",e.appendChild(Nc(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(Nc(t)),e}}}},Ga={text:{args:function args(e,t,n){return gc.apply(void 0,_toConsumableArray(_c(e,t,n))).slice(0,2)},init:function init(e,t,n,r,o){var i=[t,n,r,o].filter((function(e){return _typeof(e)===Hi.string})).shift();i&&e.appendChild(Qi.document.createTextNode(i))}}},Ba=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===Hi.string||e instanceof String})).shift()||oa()},Da=function args(){return[Ba.apply(void 0,arguments)]},Ra={mask:{args:Da},clipPath:{args:Da},symbol:{args:Da},marker:{args:Da,methods:{size:Rc,setViewBox:Rc}}},Ua=function getPoints(e){var t=e.getAttribute("points");return null==t?"":t},Za=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},Xa=function stringifyArgs(){return[Za.apply(void 0,_toConsumableArray(gc.apply(void 0,_toConsumableArray(_c.apply(void 0,arguments)))))]},$a=function setPoints$1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",Xa.apply(void 0,n)[0]),e},Ha=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",[Ua(e),Xa.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},Ya=function Args$1(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===Hi.string?[arguments.length<=0?void 0:arguments[0]]:Xa.apply(void 0,arguments)},Wa={polyline:{args:Ya,methods:{setPoints:$a,addPoint:Ha}},polygon:{args:Ya,methods:{setPoints:$a,addPoint:Ha}}},Ja=Object.assign({},pa,ga,xa,wa,Ma,Ia,Fa,Va,Ga,Ra,Wa),Ka={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(tc).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===ha[e]})).forEach((function(e){ha[e]=[]})),[[["svg","defs","g"].concat(tc.v,tc.t),Ka.presentation],[["filter"],Ka.effects],[tc.cT.concat("text"),Ka.text],[tc.cF,Ka.effects],[tc.cG,Ka.gradient]].forEach((function(e){return e[0].forEach((function(t){ha[t]=ha[t].concat(e[1])}))}));var Qa=function getClassList(e){if(null==e)return[];var t=e.getAttribute(Hi.class);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},eu={addClass:function addClass(e,t){var n=Qa(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,Hi.class,n.join(" "))},removeClass:function removeClass(e,t){var n=Qa(e).filter((function(e){return e!==t}));e.setAttributeNS(null,Hi.class,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,Hi.class,t)},setId:function setId(e,t){e.setAttributeNS(null,Hi.id,t)}},tu=function getAttr(e){var t=e.getAttribute(Hi.transform);return null==t||""===t?void 0:t},nu={clearTransform:function clearTransform(e){return e.removeAttribute(Hi.transform),e}};["translate","rotate","scale","matrix"].forEach((function(e){nu[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.setAttribute(Hi.transform,[tu(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var ru={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){ru[Sc.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===Hi.string)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(Hi.id);return"url(#".concat(t,")")}return""}(n))}}));var ou={};(Ri=tc.v).push.apply(Ri,_toConsumableArray(Object.keys(kc))),Object.keys(kc).forEach((function(e){kc[e].attributes=void 0===kc[e].attributes?_toConsumableArray(Ka.presentation):kc[e].attributes.concat(Ka.presentation)})),Object.assign(ou,Ja,kc),Object.keys(tc).forEach((function(e){return tc[e].filter((function(e){return void 0===ou[e]})).forEach((function(e){ou[e]={}}))}));var iu=function passthrough(){return Array.from(arguments)};Object.keys(ou).forEach((function(e){ou[e].nodeName||(ou[e].nodeName=e),ou[e].init||(ou[e].init=iu),ou[e].args||(ou[e].args=iu),ou[e].methods||(ou[e].methods={}),ou[e].attributes||(ou[e].attributes=ha[e]||[])}));var cu=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){ou[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};cu(_c(tc.t,tc.v,tc.g,tc.s,tc.p,tc.i,tc.h,tc.d),eu),cu(_c(tc.t,tc.v,tc.g,tc.s,tc.p,tc.i,tc.h,tc.d),qc),cu(_c(tc.v,tc.g,tc.s),nu),cu(_c(tc.t,tc.v,tc.g),ru);var au={svg:{version:"1.1",xmlns:ec},style:{type:"text/css"}},uu=function RequiredAttributes(e,t){au[t]&&Object.keys(au[t]).forEach((function(n){return e.setAttribute(n,au[t][n])}))},su={},fu=function constructor(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=Qi.document.createElementNS(ec,ou[e].nodeName);return uu(c,e),(t=ou[e]).init.apply(t,[c].concat(o)),(n=ou[e]).args.apply(n,o).forEach((function(t,n){null!=ou[e].attributes[n]&&c.setAttribute(ou[e].attributes[n],t)})),ou[e].attributes.forEach((function(e){Object.defineProperty(c,Sc.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(ou[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=ou[e].methods[t]).call.apply(n,[su,c].concat(Array.prototype.slice.call(arguments)))}})})),Cc[e]&&Cc[e].forEach((function(e){Object.defineProperty(c,e,{value:function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t}})})),c};su.Constructor=fu;var lu={};Object.keys(tc).forEach((function(e){return tc[e].forEach((function(e){lu[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return fu.apply(void 0,[e].concat(n))}}))}));var vu=function getFoldObject(e){return e.filter((function(e){return function possibleFoldObject(e){if("object"!==_typeof(e))return!1;var t=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(e).map((function(e){return t.includes(e)})).reduce((function(e,t){return e||t}),!1)}(e)})).shift()},du=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Hi.function})).forEach((function(t){return t.call(e,e)}))},pu=function SVG(){var e=arguments,t=fu.apply(void 0,[Hi.svg].concat(Array.prototype.slice.call(arguments)));return"loading"===Qi.document.readyState?Qi.document.addEventListener("DOMContentLoaded",(function(){return du.apply(void 0,[t].concat(_toConsumableArray(e)))})):du.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t};function vkXML$1(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,o=!1,i=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[i]+n[l],o=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(o=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],o=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],o||(i-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=o?n[l]:u[i++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\//)>-1?c=c+=o?n[l]:u[--i]+n[l]:n[l].search(/\/>/)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[i]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}Object.assign(pu,lu),pu.NS=ec,pu.linker=function Linker(e){var t=this;["segment","circle","ellipse","rect","polygon"].filter((function(t){return e[t]&&e[t].prototype})).forEach((function(n){e[n].prototype.svg=function(){return t.path(this.svgPath())}})),e.svg=t}.bind(pu),pu.use=function use(e){e.origami&&function bindRabbitEar(e,t){Kc.math.vector=t.vector}(0,e),e.render_into_svg&&function bindFoldToSvg(e,t){var n=ou.svg.init;ou.svg.init=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=vu(o);if(c){var a=t.options.apply(t,o);t.render_into_svg(e,c,a)}return n.apply(void 0,[e].concat(o))}}(0,e)}.bind(pu),pu.core=Object.assign(Object.create(null),{load:Bc,save:Dc,coordinates:gc,flatten:_c,attributes:ha,children:Cc,cdata:Nc,detect:Ki},Sc,eu,qc,ua,nu,Xc);var _u="vertices",gu="edges",hu="faces",mu="boundaries",yu="boundary",bu="mountain",xu="valley",Au="mark",ku="unassigned",wu="front",Eu="back",Mu="svg",Ou="class",ju="index",Cu="object",Su="string",Pu="undefined",Nu="black",zu="white",Iu="lightgray",Lu="stroke-width",qu="vertices_coords",Tu="edges_vertices",Fu="faces_vertices",Vu="faces_edges",Gu="edges_assignment",Bu="faces_re:layer",Du=("undefined"==typeof window?"undefined":_typeof(window))!==Pu&&_typeof(window.document)!==Pu,Ru=("undefined"==typeof process?"undefined":_typeof(process))!==Pu&&null!=process.versions&&null!=process.versions.node,Uu=function(){var e={};if(Ru){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Du&&(e=window);return e}(),Zu="http://www.w3.org/2000/svg",Xu={SVG:{NS:Zu,g:function g(){return Uu.document.createElementNS(Zu,"g")},defs:function defs(){return Uu.document.createElementNS(Zu,"defs")},style:function style(){var e=Uu.document.createElementNS(Zu,"style");return e.setAttributeNS(null,"type","text/css"),e},line:function line(e,t,n,r){var o=Uu.document.createElementNS(Zu,"line");return o.setAttributeNS(null,"x1",e),o.setAttributeNS(null,"y1",t),o.setAttributeNS(null,"x2",n),o.setAttributeNS(null,"y2",r),o},circle:function circle(e,t,n){var r=Uu.document.createElementNS(Zu,"circle");return r.setAttributeNS(null,"cx",e),r.setAttributeNS(null,"cy",t),r.setAttributeNS(null,"r",n),r},polygon:function polygon(e){var t=Uu.document.createElementNS(Zu,"polygon"),n=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");return t.setAttributeNS(null,"points",n),t},path:function path(e){var t=Uu.document.createElementNS(Zu,"path");return t.setAttributeNS(null,"d",e),t}}},$u=function recursive_freeze(e){return Object.freeze(e),void 0===e||Object.getOwnPropertyNames(e).filter((function(t){return null!==e[t]&&(_typeof(e[t])===Cu||"function"===_typeof(e[t]))&&!Object.isFrozen(e[t])})).forEach((function(t){return recursive_freeze(e[t])})),e},Hu=function recursive_assign(e,t){return Object.keys(t).forEach((function(n){_typeof(t[n])===Cu&&null!==t[n]?(n in e||(e[n]={}),recursive_assign(e[n],t[n])):_typeof(e)!==Cu||n in e||(e[n]=t[n])})),e},Yu=function get_object(e){if(null==e)return{};if(_typeof(e)===Cu&&null!==e)return e;if(_typeof(e)===Su||e instanceof String)try{return JSON.parse(e)}catch(e){return{}}return{}},Wu=function bounding_rect(e){if(null==e.vertices_coords||e.vertices_coords.length<=0)return[0,0,0,0];var t=e.vertices_coords[0].length,n=Array(t).fill(1/0),r=Array(t).fill(-1/0);return e.vertices_coords.forEach((function(e){return e.forEach((function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)}))})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?[0,0,0,0]:[n[0],n[1],r[0]-n[0],r[1]-n[1]]},Ju="none",Ku="500px",Qu=function Options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return $u({input:Su,output:Su,padding:null,file_frame:null,stylesheet:null,shadows:null,boundaries:!0,faces:!0,edges:!0,vertices:!1,attributes:{svg:{width:Ku,height:Ku,stroke:Nu,fill:Ju,"stroke-linejoin":"bevel","stroke-width":e/200},circle:{r:e/200},boundaries:{fill:zu},faces:{stroke:Ju,front:{fill:Iu},back:{fill:zu},foldedForm:{stroke:Nu}},edges:{boundary:{},mountain:{stroke:"red"},valley:{stroke:"blue"},mark:{stroke:Iu},unassigned:{stroke:Iu}},vertices:{stroke:Ju,fill:Nu}}})},es=function make_options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Wu(e),r=Math.min(n[2],n[3]);return Hu(t,Qu(r)),t.shadows&&Hu(t,{attributes:{faces:{front:{filter:"url(#shadow)"},back:{filter:"url(#shadow)"}}}}),t},ts=function boundaries_polygon(e){if(qu in e==!1||Tu in e==!1||Gu in e==!1)return[];var t=function get_boundary(e){if(null==e.edges_assignment)return{vertices:[],edges:[]};for(var t=e.edges_assignment.map((function(e){return"B"===e||"b"===e})),n=function make_vertices_edges(e){if(e.edges_vertices){var t=[];return e.edges_vertices.forEach((function(e,n){return e.forEach((function(e){void 0===t[e]&&(t[e]=[]),t[e].push(n)}))})),t}}(e),r=[],o=[],i=-1,c=0;c<t.length;c+=1)if(t[c]){i=c;break}if(-1===i)return{vertices:[],edges:[]};t[i]=!1,r.push(i),o.push(e.edges_vertices[i][0]);for(var a=e.edges_vertices[i][1];o[0]!==a;){if(o.push(a),void 0===(i=n[a].filter((function(e){return t[e]})).shift()))return{vertices:[],edges:[]};a=e.edges_vertices[i][0]===a?_slicedToArray(e.edges_vertices[i],2)[1]:_slicedToArray(e.edges_vertices[i],1)[0],t[i]=!1,r.push(i)}return{vertices:o,edges:r}}(e).vertices.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}));if(0===t.length)return[];var n=Xu.SVG.polygon(t);return n.setAttributeNS(null,Ou,yu),[n]},ns=function vertices_circle(e,t){if(qu in e==!1)return[];var n=e.vertices_coords.map((function(e){return Xu.SVG.circle(e[0],e[1],.01)}));return n.forEach((function(e,t){return e.setAttributeNS(null,ju,t)})),n},rs={B:yu,b:yu,M:bu,m:bu,V:xu,v:xu,F:Au,f:Au,U:ku,u:ku},os={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},is=function edges_coords(e){return null==e.edges_vertices||null==e.vertices_coords?[]:e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))}))},cs=function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])},as=function edges_path_data(e){var t=is(e).map((function(e){return cs(e)})).join("");return""===t?void 0:t},us=function edges_by_assignment_paths_data(e){if(null==e.edges_vertices||null==e.vertices_coords||null==e.edges_assignment)return[];var t=is(e),n=function edges_indices_classes(e){var t={u:[],f:[],v:[],m:[],b:[]};return e.edges_assignment.map((function(e){return os[e]})).forEach((function(e,n){return t[e].push(n)})),t}(e),r=Object.keys(n).map((function(e){return n[e].map((function(e){return t[e]}))})).map((function(e){return e.map((function(e){return cs(e)})).join("")})),o={};return Object.keys(n).map((function(e,t){""!==r[t]&&(o[e]=r[t])})),o},ss=function edges_path(e){if(null==e.edges_assignment){var t=as(e);return void 0===t?[]:[Xu.SVG.path(t)]}var n=us(e);return Object.keys(n).map((function(e){var t=Xu.SVG.path(n[e]);return t.setAttributeNS(null,Ou,rs[e]),t}))},fs={subtract:function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},cross2:function cross2(e,t){return e[0]*t[1]-e[1]*t[0]}},ls=function finalize_faces(e,t){var n=_typeof(e.frame_classes)===Cu&&null!==e.frame_classes&&!e.frame_classes.includes("creasePattern"),r=null!=e[Bu]&&e[Bu].length===e.faces_vertices.length,o=[[wu],[Eu]].map((function(e){return n&&e.push("foldedForm"),e})).map((function(e){return e.join(" ")}));return function get_faces_winding(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return fs.cross2(fs.subtract(e[1],e[0]),fs.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(e).map((function(e){return e<0?o[0]:o[1]})).forEach((function(e,n){return t[n].setAttributeNS(null,Ou,e)})),r?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e[Bu]).map((function(e){return t[e]})):t},vs=function faces_vertices_polygon(e){if(Fu in e==!1||qu in e==!1)return[];var t=e.faces_vertices.map((function(t){return t.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return Xu.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,ju,t)})),ls(e,t)},ds=function faces_edges_polygon(e){if(Vu in e==!1||Tu in e==!1||qu in e==!1)return[];var t=e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return Xu.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,ju,t)})),ls(e,t)},ps={vertices:[],edges:[ku,Au,xu,bu,yu],faces:[wu,Eu,"foldedForm"],boundaries:[]},_s=function style_component(e,t,n){var r=t.attributes,o=ps[n]||[];Array.from(e.childNodes).filter((function(e){return r[e.nodeName]})).forEach((function(e){return Object.keys(r[e.nodeName]).forEach((function(t){return e.setAttributeNS(null,t,r[e.nodeName][t])}))})),Object.keys(r[n]).filter((function(e){return!o.includes(e)})).forEach((function(t){return e.setAttributeNS(null,t,r[n][t])})),0!==o.length&&Array.from(e.childNodes).forEach((function(e){return Object.keys(r[n][e.getAttribute(Ou)]||{}).forEach((function(t){return e.setAttributeNS(null,t,r[n][e.getAttribute(Ou)][t])}))}))},gs={vertices:ns,edges:ss,faces:function faces_draw_function(e){return null!=e.faces_vertices?vs(e):ds(e)},boundaries:ts},hs=function render_components(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.attributes||(t.attributes={}),[mu,hu,gu,_u].filter((function(e){return!0===t[e]})).map((function(n){var r=Xu.SVG.g();return r.setAttributeNS(null,Ou,n),gs[n](e,t).forEach((function(e){return r.appendChild(e)})),_s(r,t,n),r})).filter((function(e){return e.childNodes.length>0}))},ms=Uu.document,ys=Object.freeze({blur:.005,opacity:.3,color:Nu}),bs="result",xs="in",As="blur",ks="offsetColor",ws="offsetBlur",Es="feMergeNode",Ms="200%",Os=function make_defs(e,t){var n=Wu(e),r=Math.min(n[2],n[3]),o=Xu.SVG.defs();if(null!=t.stylesheet){var i=Xu.SVG.style();o.appendChild(i);var c=t.attributes.svg[Lu]?t.attributes.svg[Lu]:r/200,a=(new Uu.DOMParser).parseFromString("<xml></xml>","application/xml").createCDATASection("\n* { --".concat(Lu,": ").concat(c,"; }\n").concat(t.stylesheet));i.appendChild(a)}if(null!=t.shadows){var u=_typeof(t.shadows)===Cu&&null!==t.shadows?t.shadows:{blur:r/200};o.appendChild(function shadowFilter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ys,t="shadow";_typeof(e)===Cu&&null!==e||(e={}),Object.keys(ys).filter((function(t){return!(t in e)})).forEach((function(t){e[t]=ys[t]}));var n=ms.createElementNS(Xu.SVG.NS,"filter");n.setAttributeNS(null,"width",Ms),n.setAttributeNS(null,"height",Ms),n.setAttributeNS(null,"id",t);var r=ms.createElementNS(Xu.SVG.NS,"feGaussianBlur");r.setAttributeNS(null,xs,"SourceAlpha"),r.setAttributeNS(null,"stdDeviation",e.blur),r.setAttributeNS(null,bs,As);var o=ms.createElementNS(Xu.SVG.NS,"feOffset");o.setAttributeNS(null,xs,As),o.setAttributeNS(null,bs,ws);var i=ms.createElementNS(Xu.SVG.NS,"feFlood");i.setAttributeNS(null,"flood-color",e.color),i.setAttributeNS(null,"flood-opacity",e.opacity),i.setAttributeNS(null,bs,ks);var c=ms.createElementNS(Xu.SVG.NS,"feComposite");c.setAttributeNS(null,xs,ks),c.setAttributeNS(null,"in2",ws),c.setAttributeNS(null,"operator",xs),c.setAttributeNS(null,bs,ws);var a=ms.createElementNS(Xu.SVG.NS,"feMerge"),u=ms.createElementNS(Xu.SVG.NS,Es),s=ms.createElementNS(Xu.SVG.NS,Es);return s.setAttributeNS(null,xs,"SourceGraphic"),a.appendChild(u),a.appendChild(s),n.appendChild(r),n.appendChild(o),n.appendChild(i),n.appendChild(c),n.appendChild(a),n}(u))}return null!=t.stylesheet||null!=t.shadows?o:void 0},js=function makeViewBox(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=1,c=n/i-n,a=e-c-o,u=t-c-o,s=n+2*c+2*o,l=r+2*c+2*o;return[a,u,s,l].join(" ")},Cs=function make_svg_attributes(e,t){var n=Wu(e),r=(Math.min(n[2],n[3]),{viewBox:js.apply(void 0,_toConsumableArray(n).concat([t.padding]))}),o=function graph_classes(e){return[(null!=e.file_classes?e.file_classes:[]).join(" "),(null!=e.frame_classes?e.frame_classes:[]).join(" ")].filter((function(e){return""!==e})).join(" ")}(e);return""!==o&&(r.class=o),Object.assign(r,t.attributes.svg),r},Ss=function render_into_svg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};es(t,n);var r=Os(t,n);r&&e.appendChild(r),hs(t,n).forEach((function(t){return e.appendChild(t)}));var o=Cs(t,n);return Object.keys(o).forEach((function(t){return e.setAttributeNS(null,t,o[t])})),e},Ps=function svg$1$1(){var e=Uu.document.createElementNS(Xu.SVG.NS,Mu);return e.setAttribute("version","1.1"),e.setAttribute("xmlns",Xu.SVG.NS),e},Ns=function FoldToSvg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Yu(e);es(n,t);var r=Ss(Ps(),n,t);if(t.output===Mu)return r;var o=(new Uu.XMLSerializer).serializeToString(r),i=vkXML$1(o);return i};Object.assign(Ns,{render_into_svg:Ss,render_components:hs,options:es,boundaries_polygon:ts,vertices_circle:ns,edges_path_data:as,edges_by_assignment_paths_data:us,edges_path:ss,edges_line:function edges_line(e){var t=is(e).map((function(e){return Xu.SVG.line(e[0][0],e[0][1],e[1][0],e[1][1])}));return t.forEach((function(e,t){return e.setAttributeNS(null,ju,t)})),function make_edges_assignment_names(e){return null==e.edges_vertices||null==e.edges_assignment||e.edges_vertices.length!==e.edges_assignment.length?[]:e.edges_assignment.map((function(e){return rs[e]}))}(e).forEach((function(e,n){return t[n].setAttributeNS(null,Ou,e)})),t},faces_vertices_polygon:vs,faces_edges_polygon:ds,linker:function linker(e){}.bind(Ns),use:function use(e){e.NS&&(Xu.SVG=e)}});var zs={graph:Ni,cp:Ii,origami:qi},Is={graph:{},cp:Fi.square(),origami:Fi.square()};Object.keys(zs).forEach((function(e){bi[e]=function(){var t=Array.from(arguments).filter((function(e){return yr(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Object.assign.apply(Object,[Object.create(zs[e]),t.length?{}:Is[e]].concat(_toConsumableArray(t),[{file_spec:Qn,file_creator:er}]))},bi[e].prototype=zs[e],bi[e].prototype.constructor=bi[e],Object.keys(Fi).forEach((function(t){bi[e][t]=function(){return bi[e](Fi[t].apply(Fi,arguments))}}))})),Object.assign(bi.graph,li);var Ls=Object.assign(Kn,bi,{math:Jn.core,axiom:Di,diagram:yi,text:Ui,webgl:$i});return Object.defineProperty(Ls,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(Ls)}),Object.keys(Jn).filter((function(e){return"core"!==e})).forEach((function(e){Ls[e]=Jn[e]})),pu.use(Ns),pu.use(Ls),Ns.use(pu),Ls.use(pu),Ls.use(Ns),Ls}));
