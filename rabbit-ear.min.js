/* Rabbit Ear 0.9.2 alpha 2022-01-28 (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";var e=Object.create(null);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var t=function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}},n=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},r=function resize_up(e,t){var r=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return n(r,e)}))},o=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},i=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return o(n)===Math.min(t,o(e))?e:n},c=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},a=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return c(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},u=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return c(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},s=Object.freeze({__proto__:null,resize:n,resize_up:r,resize_down:function resize_down(e,t){var r=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return n(r,e)}))},clean_number:i,semi_flatten_arrays:a,flatten_arrays:u}),l=1e-6,_=180/Math.PI,d=Math.PI/180,p=2*Math.PI,v=Object.freeze({__proto__:null,EPSILON:l,R2D:_,D2R:d,TWO_PI:p}),g=function fn_true(){return!0},m=function fn_square(e){return e*e},h=function fn_add(e,t){return e+(t||0)},b=function fn_not_undefined(e){return void 0!==e},k=function fn_and(e,t){return e&&t},w=function fn_vec2_angle(e){return Math.atan2(e[1],e[0])},E=function fn_to_vec2(e){return[Math.cos(e),Math.sin(e)]},O=function fn_equal(e,t){return e===t},C=function fn_epsilon_equal(e,t){return Math.abs(e-t)<l},j=function include(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>-t},M=function exclude(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>t},P=g,S=g,N=j,I=M,L=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>-t&&e<1+t},q=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e>t&&e<1-t},T=function ray_limiter(e){return e<-l?0:e},F=function segment_limiter(e){return e<-l?0:e>1.000001?1:e},B=Object.freeze({__proto__:null,fn_true:g,fn_square:m,fn_add:h,fn_not_undefined:b,fn_and:k,fn_cat:function fn_cat(e,t){return e.concat(t)},fn_vec2_angle:w,fn_to_vec2:E,fn_equal:O,fn_epsilon_equal:C,include:j,exclude:M,include_l:P,exclude_l:S,include_r:N,exclude_r:I,include_s:L,exclude_s:q,line_limiter:function line_limiter(e){return e},ray_limiter:T,segment_limiter:F}),V=Object.create(null),G=[1,0,0,1],D=G.concat(0,0),R=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},U=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},Z=Object.freeze({__proto__:null,identity2x2:G,identity2x3:D,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:R,invert_matrix2:function invert_matrix2(e){var t=R(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return G.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:U,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,_=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,_,d]}}),H=function magnitude(e){return Math.sqrt(e.map(m).reduce(h,0))},J=function magnitude2(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},$=function mag_squared(e){return e.map(m).reduce(h,0)},W=function normalize(e){var t=H(e);return 0===t?e:e.map((function(e){return e/t}))},X=function scale(e,t){return e.map((function(e){return e*t}))},Y=function scale2(e,t){return[e[0]*t,e[1]*t]},K=function add(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},Q=function add2(e,t){return[e[0]+t[0],e[1]+t[1]]},ee=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},te=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(h,0)},ne=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},re=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},oe=function lerp(e,t,n){var r=1-n;return e.map((function(e,o){return e*r+(t[o]||0)*n}))},ie=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},ce=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},ae=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce(h,0))},ue=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},se=function flip(e){return e.map((function(e){return-e}))},fe=function rotate90(e){return[-e[1],e[0]]},le=function rotate270(e){return[e[1],-e[0]]},_e=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return e.map((function(e){return Math.abs(e)})).reduce(h,0)<t},de=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return 1-Math.abs(te(W(e),W(t)))<n},pe=Object.freeze({__proto__:null,magnitude:H,magnitude2:J,mag_squared:$,normalize:W,normalize2:function normalize2(e){var t=J(e);return 0===t?e:[e[0]/t,e[1]/t]},scale:X,scale2:Y,add:K,add2:Q,subtract:ee,subtract2:function subtract2(e,t){return[e[0]-t[0],e[1]-t[1]]},dot:te,dot2:function dot2(e,t){return e[0]*t[0]+e[1]*t[1]},midpoint:ne,midpoint2:function midpoint2(e,t){return Y(Q(e,t),.5)},average:re,lerp:oe,cross2:ie,cross3:ce,distance:ae,distance2:ue,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},flip:se,rotate90:fe,rotate270:le,degenerate:_e,parallel:de,parallel2:function parallel2(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return Math.abs(ie(e,t))<n}}),ve=Object.freeze([1,0,0,0,1,0,0,0,1]),ge=Object.freeze(ve.concat(0,0,0)),me=function is_identity3x4(e){return ge.map((function(t,n){return Math.abs(t-e[n])<l})).reduce((function(e,t){return e&&t}),!0)},he=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},ye=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},be=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},Ae=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},xe=function invert_matrix3(e){var t=Ae(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ke=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ve.concat(e,t,n)},we=function single_axis_rotate(e,t,n,r,o){var i=ve.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return i[3*n+n]=c,i[3*n+r]=(o?1:-1)*a,i[3*r+n]=(o?-1:1)*a,i[3*r+r]=c,i},Ee=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,1,2,!0)},Oe=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,0,2,!1)},Ce=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return we(e,t,0,1,!0)},je=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],o=[0,1,2].map((function(e){return r[e]||0})),i=n(3,W(t)),c=_slicedToArray(i,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),_=Math.sin(e),d=1-l,p=ve.concat(-o[0],-o[1],-o[2]),v=ve.concat(o[0],o[1],o[2]);return be(v,be([d*a*a+l,d*u*a+s*_,d*s*a-u*_,d*a*u-s*_,d*u*u+l,d*s*u+a*_,d*a*s+u*_,d*u*s-a*_,d*s*s+l,0,0,0],p))},Me=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},Pe=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,_=t[0]+a*-t[0]+-t[1]*s,d=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,_,d,0]},Se=Object.freeze({__proto__:null,identity3x3:ve,identity3x4:ge,is_identity3x4:me,multiply_matrix3_vector3:he,multiply_matrix3_line3:ye,multiply_matrices3:be,determinant3:Ae,invert_matrix3:xe,make_matrix3_translate:ke,make_matrix3_rotateX:Ee,make_matrix3_rotateY:Oe,make_matrix3_rotateZ:Ce,make_matrix3_rotate:je,make_matrix3_scale:Me,make_matrix3_reflectZ:Pe}),ze=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},Ne=function get_vector(){if(arguments[0]instanceof V.vector)return arguments[0];var e=u(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(b)),e.filter((function(e){return"number"==typeof e}))},Ie=function get_vector_of_vectors(){return a(arguments).map((function(e){return Ne(e)}))},Le=function get_segment(){if(arguments[0]instanceof V.segment)return arguments[0];var e=a(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:e.map((function(e){return Ne(e)}))},qe=function get_line(){var e=a(arguments);return 0===e.length?ze([],[]):e[0]instanceof V.line||e[0]instanceof V.ray||e[0]instanceof V.segment?e[0]:e[0].constructor===Object&&void 0!==e[0].vector?ze(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?ze(Ne(e)):ze.apply(void 0,_toConsumableArray(e.map((function(e){return Ne(e)}))))},Te=qe,Fe=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},Be=function get_rect(){if(arguments[0]instanceof V.rect)return arguments[0];var e=u(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return Fe.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(b)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return Fe.apply(void 0,_toConsumableArray(n))},Ve=function get_circle_params(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{radius:e,origin:[].concat(n)}},Ge=function get_circle(){if(arguments[0]instanceof V.circle)return arguments[0];var e=Ie(arguments),t=u(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length){if(1===e[1].length)return Ve.apply(void 0,[e[1][0]].concat(_toConsumableArray(e[0])));if(1===e[0].length)return Ve.apply(void 0,[e[0][0]].concat(_toConsumableArray(e[1])));if(e[0].length>1&&e[1].length>1)return Ve.apply(void 0,[ue.apply(void 0,_toConsumableArray(e))].concat(_toConsumableArray(e[0])))}else switch(t.length){case 0:return Ve(1,0,0,0);case 1:return Ve(t[0],0,0,0);default:return Ve.apply(void 0,[t.pop()].concat(_toConsumableArray(t)))}return Ve(1,0,0,0)},De=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete De[2][e]}));var Re=function matrix_map_3x4(e){return De[e<8?0:e<13?1:2]},Ue=function get_matrix_3x4(){var e=u(arguments),t=_toConsumableArray(ge);return Re(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Ze=Object.freeze({__proto__:null,get_vector:Ne,get_vector_of_vectors:Ie,get_segment:Le,get_line:qe,get_ray:Te,get_rect_params:Fe,get_rect:Be,get_circle:Ge,get_matrix_3x4:Ue}),He=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce(k,!0)},Je=function equivalent_vector2(e,t){return[0,1].map((function(n){return C(e[n],t[n])})).reduce(k,!0)},$e=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),r=e.map((function(e){return n(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return r[0].map((function(e,n){return Math.abs(r[0][n]-r[t+1][n])<l})).reduce(k,!0)})).reduce(k,!0)},We=Object.freeze({__proto__:null,equivalent_vector2:Je,equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):He(arguments,C))},equivalent_vectors:$e,equivalent:function equivalent(){var e=a.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return He(e,C);case"boolean":case"string":return He(e,O);case"object":return e[0].constructor===Array?$e.apply(void 0,_toConsumableArray(e)):He(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),Xe=Object.freeze({__proto__:null,sort_points_along_vector2:function sort_points_along_vector2(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))}}),Ye=function smallest_comparison_search(e,t,n){for(var r,o=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),i=1/0,c=0;c<o.length;c+=1)o[c].d<i&&(r=c,i=o[c].d);return r},Ke=function nearest_point_on_line(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;t=n(e.length,t),r=n(e.length,r);var c=$(e),a=ee(r,t),u=te(e,a),s=u/c,_=o(s,i);return K(t,X(e,_))},Qe=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return ee(n[(t+1)%n.length],e)}));return e.map((function(e,r){return Ke(n[r],e,t,F)})).map((function(e,n){return{point:e,i:n,distance:ae(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},et=function nearest_point_on_circle(e,t,n){return K(t,X(W(ee(n,t)),e))},tt=Object.freeze({__proto__:null,smallest_comparison_search:Ye,nearest_point2:function nearest_point2(e,t){var n=Ye(e,t,ue);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Ye(e,t,ae);return void 0===n?void 0:t[n]},nearest_point_on_line:Ke,nearest_point_on_polygon:Qe,nearest_point_on_circle:et,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),nt=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=p;for(;t<0;)t+=p;for(;e>p;)e-=p;for(;t>p;)t-=p;var n=t-e;return n>=0?n:p-(e-t)},rt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],o=Math.atan2(r,n);return o<0&&(o+=p),o},ot=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],o=Math.atan2(r,n);return o<0&&(o+=p),o},it=function clockwise_bisect2(e,t){return E(w(e)-rt(e,t)/2)},ct=function counter_clockwise_bisect2(e,t){return E(w(e)+ot(e,t)/2)},at=function bisect_lines2(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=ie(e,n),c=te(e,n),a=i>-o?[ct(e,n)]:[it(e,n)];a[1]=i>-o?fe(a[0]):le(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/i,_=[e,n].map((function(e){return W(e)})),d=Math.abs(ie.apply(void 0,_toConsumableArray(_)))<o,p=d?ne(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],v=a.map((function(e){return{vector:e,origin:p}}));return d&&delete v[c>-o?1:0],v},ut=function counter_clockwise_order_radians(){var e=u(arguments),t=e.map((function(e,t){return t})).sort((function(t,n){return e[t]-e[n]}));return t.slice(t.indexOf(0),t.length).concat(t.slice(0,t.indexOf(0)))},st=function counter_clockwise_sectors_radians(){var e=u(arguments),t=ut(e).map((function(t){return e[t]}));return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return nt(e[0],e[1])}))},ft=function counter_clockwise_subsect_radians(e,t,n){var r=nt(t,n)/e;return Array.from(Array(e-1)).map((function(e,n){return t+r*(n+1)}))},lt=Object.freeze({__proto__:null,is_counter_clockwise_between:function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=p;for(;e>t;)e-=p;for(;e<t;)e+=p;return e<n},clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=p;for(;t<0;)t+=p;for(;e>p;)e-=p;for(;t>p;)t-=p;var n=e-t;return n>=0?n:p-(t-e)},counter_clockwise_angle_radians:nt,clockwise_angle2:rt,counter_clockwise_angle2:ot,clockwise_bisect2:it,counter_clockwise_bisect2:ct,bisect_lines2:at,counter_clockwise_order_radians:ut,counter_clockwise_order2:function counter_clockwise_order2(){return ut(Ie(arguments).map(w))},counter_clockwise_sectors_radians:st,counter_clockwise_sectors2:function counter_clockwise_sectors2(){return st(Ie(arguments).map(w))},counter_clockwise_subsect_radians:ft,counter_clockwise_subsect2:function counter_clockwise_subsect2(e,t,n){var r=Math.atan2(t[1],t[0]),o=Math.atan2(n[1],n[0]);return ft(e,r,o).map(E)}}),_t=function overlap_line_point(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=ee(n,t),c=$(e),a=Math.sqrt(c);if(a<o)return!1;var u=ie(i,e.map((function(e){return e/a}))),s=te(i,e)/c;return Math.abs(u)<o&&r(s,o/a)},dt=function intersect_line_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:P,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:l,a=ie(W(e),W(n));if(!(Math.abs(a)<c)){var u=ie(e,n),s=-u,_=[r[0]-t[0],r[1]-t[1]],d=[-_[0],-_[1]],p=ie(_,n)/u,v=ie(d,e)/s;return o(p,c/H(e))&&i(v,c/H(n))?K(t,X(e,p)):void 0}},pt=function circumcircle(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+o*(e[1]+t[1]),u=i*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-o*(n[0]-t[0]));if(Math.abs(s)<l){var _=Math.min(e[0],t[0],n[0]),d=Math.min(e[1],t[1],n[1]),p=.5*(Math.max(e[0],t[0],n[0])-_),v=.5*(Math.max(e[1],t[1],n[1])-d);return{origin:[_+p,d+v],radius:Math.sqrt(p*p+v*v)}}var g=[(c*a-o*u)/s,(r*u-i*a)/s],m=g[0]-e[0],h=g[1]-e[1];return{origin:g,radius:Math.sqrt(m*m+h*h)}},vt=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(h,0)},gt=function centroid(e){var t=1/(6*vt(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],o=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*o,(e[1]+r[1])*o]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},mt=function enclosing_box(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return[t,r]},ht=function enclosing_rectangle(e){var t=mt(e);return Fe(t[0][0],t[0][1],t[1][0],t[1][1])},yt=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return p*(n/e)}))},bt=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return i(e,14)}))}))},At=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return bt(yt(e),t)},xt=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=yt(e).map((function(e){return e+n}));return bt(r,t)},kt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:_t(t,n,e,P)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),o=e.map((function(e,r,o){return{point:dt(t,n,ee(e,o[(r+1)%o.length]),o[(r+1)%o.length],S,q),at_index:r}})).filter((function(e){return null!=e.point}));if(2==o.length){var i=o.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(i[1].at_index+1).concat(e.slice(0,i[0].at_index+1));c.push(i[0].point),c.push(i[1].point);var a=e.slice(i[0].at_index+1,i[1].at_index+1);return a.push(i[1].point),a.push(i[0].point),[c,a]}if(1==o.length&&1==r.length){r[0].type="v",o[0].type="e";var u=r.concat(o).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var _=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(_[1].at_index).concat(e.slice(0,_[0].at_index+1)),e.slice(_[0].at_index,_[1].at_index+1)]}return[e.slice()]},wt=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),o=[];o.push(r[0]);var i=0,c=0,a=function _loop(){c+=1;var e=o.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-o[e][0])<t&&Math.abs(n[1]-o[e][1])<t)})).map((function(t){for(var n=Math.atan2(o[e][1]-t[1],o[e][0]-t[0]);n<i;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(o[e][0]-t.node[0],2)+Math.pow(o[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),o.filter((function(e){return e===n[0].node})).length>0)return{v:o};o.push(n[0].node),i=Math.atan2(o[e][1]-n[0].node[1],o[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},Et=function recurse_skeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return dt(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,I,I)})),o=t.map((function(e,t){return Ke(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[o[0],r[0]]}]);var i=r.map((function(e,t){return ae(e,o[t])})),c=0;i.forEach((function(e,t){e<i[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[o[c],r[c]]}],u=it(se(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurse_skeleton(e,t,n))},Ot=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:ee(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[ee(e[0],e[1]),ee(e[2],e[1])]})).map((function(e){return it.apply(void 0,_toConsumableArray(e))}));return Et(_toConsumableArray(e),t,n)},Ct=Object.freeze({__proto__:null,circumcircle:pt,signed_area:vt,centroid:gt,enclosing_box:mt,enclosing_rectangle:ht,make_regular_polygon:At,make_regular_polygon_side_aligned:xt,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return At(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return At(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(e,t/2/Math.sin(Math.PI/e))},make_polygon_non_collinear:function make_polygon_non_collinear(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,n=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ee(e[1],e[0])})),r=n.map((function(e,t,n){return[e,n[(t+n.length-1)%n.length]]})).map((function(e){return!de(e[1],e[0],t)}));return e.filter((function(e,t){return r[t]}))},split_convex_polygon:kt,convex_hull:wt,straight_skeleton:Ot}),jt=function vector_origin_to_ud(e){var t=e.vector,n=e.origin,r=H(t),o=fe(t),i=te(n,o)/r;return{u:X(o,1/r),d:i}},Mt=function ud_to_vector_origin(e){var t=e.u,n=e.d;return{vector:le(t),origin:X(t,n)}},Pt=Object.freeze({__proto__:null,vector_origin_to_ud:jt,ud_to_vector_origin:Mt}),St=function acos_safe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},zt=function rotate_vector2(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=r*Math.cos(n)+o*Math.sin(n),c=o*Math.cos(n)-r*Math.sin(n);return[e[0]+i,e[1]+c]},Nt=function intersect_circle_circle(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l,i=e<n?e:n,c=e<n?n:e,a=e<n?t:r,u=e<n?r:t,s=[a[0]-u[0],a[1]-u[1]],_=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2));if(!(_<o)){var d=s.map((function(e,t){return e/_*c+u[t]}));if(Math.abs(c+i-_)<o||Math.abs(c-(i+_))<o)return[d];if(!(_+i<c||c+i<_)){var p=St((i*i-_*_-c*c)/(-2*_*c)),v=zt(u,d,+p),g=zt(u,d,-p);return[v,g]}}},It=function intersect_circle_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=fe(u),_=ee(r,t),d=ie(_,u);if(!(Math.abs(d)>e+i)){var p=Math.sqrt(Math.pow(e,2)-Math.pow(d,2)),v=function f(e,n){return t[n]-s[n]*d+u[n]*e},g=Math.abs(e-Math.abs(d))<i?[p].map((function(e){return[e,e].map(v)})):[-p,p].map((function(e){return[e,e].map(v)})),m=g.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return g.filter((function(e,t){return o(m[t],i)}))}},Lt=function overlap_convex_polygon_point(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l;return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ie(W(ee(e[1],e[0])),ee(t,e[0]))})).map((function(e){return n(e,r)})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},qt=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!Je(e[0],e[t]))return[e[0],e[t]]},Tt=function intersect_convex_polygon_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return dt(ee(e[1],e[0]),e[0],t,n,r,o,i)})).filter((function(e){return void 0!==e}));switch(c.length){case 0:return;case 1:return[c];default:return qt(c)||[c[0]]}},Ft=function intersect_convex_polygon_line(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,a=Tt(e,t,n,o,i,c);switch(i){case I:r=N;break;case q:r=L;break;default:return a}var u=Tt(e,t,n,L,r,c);if(void 0!==u){var s=qt(u);if(void 0===s)switch(i){case S:return;case I:return Lt(e,n,M,c)?u:void 0;case q:return Lt(e,K(n,t),M,c)||Lt(e,n,M,c)?u:void 0}return Lt(e,ne.apply(void 0,_toConsumableArray(s)),M,c)?s:a}},Bt=function intersect_polygon_polygon(e,t){var n,r,o,i,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,a=function inside(e){return(r[0]-n[0])*(e[1]-n[1])>(r[1]-n[1])*(e[0]-n[0])+c},u=function intersection(){var e=[n[0]-r[0],n[1]-r[1]],t=[o[0]-i[0],o[1]-i[1]],c=n[0]*r[1]-n[1]*r[0],a=o[0]*i[1]-o[1]*i[0],u=1/(e[0]*t[1]-e[1]*t[0]);return[(c*t[0]-a*e[0])*u,(c*t[1]-a*e[1])*u]},s=e;for(var _ in n=t[t.length-1],t){r=t[_];var d=s;for(var p in s=[],o=d[d.length-1],d)a(i=d[p])?(a(o)||s.push(u()),s.push(i)):a(o)&&s.push(u()),o=i;n=r}return 0===s.length?void 0:s},Vt={polygon:function polygon(e){return[e]},rect:function rect(e){return[e]},circle:function circle(e){return[e.radius,e.origin]},line:function line(e){return[e.vector,e.origin]},ray:function ray(e){return[e.vector,e.origin]},segment:function segment(e){return[e.vector,e.origin]}},Gt={polygon:{polygon:Bt,line:function line(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))},ray:function ray(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))},segment:function segment(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[L,r,o]))}},circle:{circle:function circle(e,t,n,r,o){return Nt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[o]))},line:function line(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))},ray:function ray(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))},segment:function segment(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[r,o]))}},line:{polygon:function polygon(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},ray:function ray(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}},ray:{polygon:function polygon(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}},segment:{polygon:function polygon(e,t,n,r,o){return Ft.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[L,n,o]))},circle:function circle(e,t,n,r,o){return It.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[n,o]))},line:function line(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},segment:function segment(e,t,n,r,o){return dt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))}}},Dt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},Rt={polygon:M,rect:M,circle:M,line:S,ray:I,segment:q},Ut=function intersect(e,n,r){var o=t(e),i=t(n),c=Dt[o],a=Dt[i],u=Vt[o](e),s=Vt[i](n),l=e.domain_function||Rt[o],_=n.domain_function||Rt[i];return Gt[c][a](u,s,l,_,r)},Zt=function convex_polygons_overlap(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,r=0;r<2;r++)for(var o=0===r?e:t,i=0===r?t:e,c=function _loop2(e){var t=o[e],r=fe(ee(o[(e+1)%o.length],o[e])),c=i.map((function(e){return ee(e,t)})).map((function(e){return te(r,e)})),a=o[(e+2)%o.length],u=te(r,ee(a,t))>0;if(c.map((function(e){return u?e<n:e>-n})).reduce((function(e,t){return e&&t}),!0))return{v:!1}},a=0;a<o.length;a++){var u=c(a);if("object"===_typeof(u))return u.v}return!0},Ht=function overlap_circle_point(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;return r(e-ue(t,n),o)},Jt=function overlap_line_line(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:S,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:l,a=ie(e,n),u=-a,s=[r[0]-t[0],r[1]-t[1]];if(Math.abs(a)<c){if(Math.abs(ie(s,e))>c)return!1;var _=s,d=K(_,n),p=te(e,e),v=te(_,e)/p,g=te(d,e)/p,m=v<g?v:g,h=v<g?g:v,b=m>1-c,k=h<c;return!b&&!k}var w=[-s[0],-s[1]],E=ie(s,n)/a,O=ie(w,e)/u;return o(E,c/H(e))&&i(O,c/H(n))},$t={polygon:function polygon(e){return[e]},rect:function rect(e){return[e]},circle:function circle(e){return[e.radius,e.origin]},line:function line(e){return[e.vector,e.origin]},ray:function ray(e){return[e.vector,e.origin]},segment:function segment(e){return[e.vector,e.origin]},vector:function vector(e){return[e]}},Wt={polygon:{polygon:function polygon(e,t,n,r,o){return Zt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[o]))},vector:function vector(e,t,n,r,o){return Lt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},circle:{vector:function vector(e,t,n,r,o){return Ht.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[M,o]))}},line:{line:function line(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},ray:function ray(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},ray:{line:function line(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},segment:function segment(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},segment:{line:function line(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},ray:function ray(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,n,o]))},segment:function segment(e,t,n,r,o){return Jt.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,r,o]))},vector:function vector(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[n,o]))}},vector:{polygon:function polygon(e,t,n,r,o){return Lt.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},circle:function circle(e,t,n,r,o){return Ht.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[M,o]))},line:function line(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},ray:function ray(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},segment:function segment(e,t,n,r,o){return _t.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(e),[r,o]))},vector:function vector(e,t,n,r,o){return Je.apply(void 0,_toConsumableArray(e).concat(_toConsumableArray(t),[o]))}}},Xt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment",vector:"vector"},Yt={polygon:M,rect:M,circle:M,line:S,ray:I,segment:q,vector:S},Kt=function overlap(e,n,r){var o=t(e),i=t(n),c=Xt[o],a=Xt[i],u=$t[o](e),s=$t[i](n),l=e.domain_function||Yt[o],_=n.domain_function||Yt[i];return Wt[c][a](u,s,l,_,r)},Qt=function line_point_from_parameter(e,t,n){return K(t,X(e,n))},en=function get_intersect_parameters(e,t,n,r,o){return e.map((function(e,t,n){return[ee(n[(t+1)%n.length],e),e]})).map((function(e){return function line_line_parameter(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:L,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=ie(W(e),W(n));if(!(Math.abs(c)<i)){var a=ie(e,n),u=-a,s=ee(r,t),_=se(s),d=ie(s,n)/a;return o(ie(_,e)/u,i/H(n))?d:void 0}}(t,n,e[0],e[1],r,o)})).filter(b).sort((function(e,t){return e-t}))},tn=function get_min_max(e,t,n){for(var r=0,o=e.length-1;r<o&&!t(e[r+1]-e[r],n);)r++;for(;o>r&&!t(e[o]-e[o-1],n);)o--;if(!(r>=o))return[e[r],e[o]]},nn=function clip_line_in_convex_polygon(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l,c=en(e,t,n,L,i);if(!(c.length<2)){var a=2*i/H(t),u=tn(c,r,a);if(void 0!==u){var s=u.map((function(e,t){return o(e)?e:e<.5?0:1}));if(!(Math.abs(s[0]-s[1])<2*i/H(t))){var _=Qt(t,n,(s[0]+s[1])/2);return Lt(e,_,r,i)?s.map((function(e){return Qt(t,n,e)})):void 0}}}},rn={preserve:{magnitude:function magnitude(){return H(this)},isEquivalent:function isEquivalent(){return $e(this,Ne(arguments))},isParallel:function isParallel(){return de.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},isCollinear:function isCollinear(e){return Kt(this,e)},dot:function dot(){return te.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},distanceTo:function distanceTo(){return ae.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},overlap:function overlap(e){return Kt(this,e)}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return W(this)},scale:function scale(){return X(this,arguments[0])},flip:function flip(){return se(this)},rotate90:function rotate90(){return fe(this)},rotate270:function rotate270(){return le(this)},cross:function cross(){return ce(n(3,this),n(3,Ne(arguments)))},transform:function transform(){return he(Ue(arguments),n(3,this))},add:function add(){return K(this,n(this.length,Ne(arguments)))},subtract:function subtract(){return ee(this,n(this.length,Ne(arguments)))},rotateZ:function rotateZ(e,t){return he(Ue(U(e,t)),n(3,this))},lerp:function lerp(e,t){return oe(this,n(this.length,Ne(e)),t)},midpoint:function midpoint(){return ne.apply(void 0,_toConsumableArray(r(this,Ne(arguments))))},bisect:function bisect(){return ct(this,Ne(arguments))}}},on={};Object.keys(rn.preserve).forEach((function(e){on[e]=rn.preserve[e]})),Object.keys(rn.vector).forEach((function(e){on[e]=function(){return V.vector.apply(V,_toConsumableArray(rn.vector[e].apply(this,arguments)))}}));var cn={fromAngle:function fromAngle(e){return V.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return V.vector.fromAngle(e*d)}},an={vector:{P:Array.prototype,A:function VectorArgs(){this.push.apply(this,_toConsumableArray(Ne(arguments)))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:on,S:cn}},un={fromPoints:function fromPoints(){var e=Ie(arguments);return this.constructor({vector:ee(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=Ie(arguments);return this.constructor({vector:fe(ee(e[1],e[0])),origin:re(e[0],e[1])})}},sn={isParallel:function isParallel(){var e=r(this.vector,qe(arguments).vector);return de.apply(void 0,_toConsumableArray(e))},isCollinear:function isCollinear(){var e=qe(arguments);return _t(this.vector,this.origin,e.origin)&&de.apply(void 0,_toConsumableArray(r(this.vector,e.vector)))},isDegenerate:function isDegenerate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;return _e(this.vector,e)},reflectionMatrix:function reflectionMatrix(){return V.matrix(Pe(this.vector,this.origin))},nearestPoint:function nearestPoint(){var e=Ne(arguments);return V.vector(Ke(this.vector,this.origin,e,this.clip_function))},transform:function transform(){var e=this.dimension,t=ye(Ue(arguments),n(3,this.vector),n(3,this.origin));return this.constructor(n(e,t.vector),n(e,t.origin))},translate:function translate(){var e=K.apply(void 0,_toConsumableArray(r(this.origin,Ne(arguments))));return this.constructor(this.vector,e)},intersect:function intersect(){return Ut.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},overlap:function overlap(){return Kt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},bisect:function bisect(e,t){var n=this,r=qe(e);return at(this.vector,this.origin,r.vector,r.origin,t).map((function(e){return n.constructor(e)}))}},fn={line:{P:Object.prototype,A:function A(){var e=qe.apply(void 0,arguments);this.vector=V.vector(e.vector),this.origin=V.vector(n(this.vector.length,e.origin));var t=jt({vector:this.vector,origin:this.origin});this.u=t.u,this.d=t.d,Object.defineProperty(this,"domain_function",{writable:!0,value:P})},G:{dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},sn,{inclusive:function inclusive(){return this.domain_function=P,this},exclusive:function exclusive(){return this.domain_function=S,this},clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=K(this.origin,X(this.vector,-e/2)),n=X(this.vector,e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}}),S:Object.assign({ud:function ud(){return this.constructor(Mt(arguments[0]))}},un)}},ln={ray:{P:Object.prototype,A:function A(){var e=qe.apply(void 0,arguments);this.vector=V.vector(e.vector),this.origin=V.vector(n(this.vector.length,e.origin)),Object.defineProperty(this,"domain_function",{writable:!0,value:N})},G:{dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},sn,{inclusive:function inclusive(){return this.domain_function=N,this},exclusive:function exclusive(){return this.domain_function=I,this},flip:function flip(){return V.ray(se(this.vector),this.origin)},scale:function scale(e){return V.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return V.ray(this.vector.normalize(),this.origin)},clip_function:T,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}}),S:un}},_n={segment:{P:Array.prototype,A:function A(){var e=Le.apply(void 0,arguments);this.push.apply(this,_toConsumableArray([e[0],e[1]].map((function(e){return V.vector(e)})))),this.vector=V.vector(ee(this[1],this[0])),this.origin=this[0],Object.defineProperty(this,"domain_function",{writable:!0,value:L})},G:{points:function points(){return this},magnitude:function magnitude(){return H(this.vector)},dimension:function dimension(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}},M:Object.assign({},sn,{inclusive:function inclusive(){return this.domain_function=L,this},exclusive:function exclusive(){return this.domain_function=q,this},clip_function:F,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=Ue(r),c=this.points.map((function(e){return n(3,e)})).map((function(e){return he(i,e)})).map((function(t){return n(e,t)}));return V.segment(c)},translate:function translate(){var translate=Ne(arguments),e=this.points.map((function(e){return K.apply(void 0,_toConsumableArray(r(e,translate)))}));return V.segment(e)},midpoint:function midpoint(){return V.vector(re(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}}),S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},dn=function pointOnEllipse(e,t,n,r,o,i){var c=Math.cos(o),a=Math.sin(o),u=Math.cos(i),s=Math.sin(i);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},pn=function pathInfo(e,t,n,r,o,i,c){var a=i;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=dn(e,t,n,r,o,a),l=dn(e,t,n,r,o,a+u/2),_=dn(e,t,n,r,o,a+u),d=u/2>Math.PI?1:0,p=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:_[0],y3:_[1],fa:d,fs:p}},vn=function cln(e){return i(e,4)},gn=function ellipticalArcTo(e,t,n,r,o,i,c){return"A".concat(vn(e)," ").concat(vn(t)," ").concat(vn(n)," ").concat(vn(r)," ").concat(vn(o)," ").concat(vn(i)," ").concat(vn(c))},mn={circle:{A:function CircleArgs(){var e=Ge.apply(void 0,arguments);this.radius=e.radius,this.origin=V.vector.apply(V,_toConsumableArray(e.origin))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return V.vector(et(this.radius,this.origin,Ne(arguments)))},intersect:function intersect(e){return Ut(this,e)},overlap:function overlap(e){return Kt(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=pn(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=gn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),o=gn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return V.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=pt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=pt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},hn=function getFoci(e,t,n,r){var o=t>n,i=o?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(i),a=o?Math.cos(r):Math.sin(r),u=o?Math.sin(r):Math.cos(r);return[V.vector(e[0]+c*a,e[1]+c*u),V.vector(e[0]-c*a,e[1]-c*u)]},yn={ellipse:{A:function A(){var e=u(arguments).filter((function(e){return!isNaN(e)})),t=n(5,e);this.rx=t[0],this.ry=t[1],this.origin=V.vector(t[2],t[3]),this.spin=t[4],this.foci=hn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=pn(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=gn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),o=gn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return dn(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return V.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},bn={area:function area(){return vt(this)},centroid:function centroid(){return V.vector(gt(this))},enclosingRectangle:function enclosingRectangle(){return V.rect(ht(this))},straightSkeleton:function straightSkeleton(){return Ot(this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,o){return t[o]+n[o]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],o=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),i=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(i+e)*o,t[1]+Math.sin(i+e)*o]}));return V.polygon(n)},translate:function translate(){var e=Ne.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=Ue.apply(void 0,arguments),t=this.map((function(t){return he(e,n(3,t))}));return V.polygon(t)},nearest:function nearest(){var e=Ne.apply(void 0,arguments),t=Qe(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},split:function split(){var e=qe.apply(void 0,arguments),t=kt;return t(this,e.vector,e.origin).map((function(e){return V.polygon(e)}))},overlap:function overlap(){return Kt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},intersect:function intersect(){return Ut.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},clip:function clip(e,t){var n=e.domain_function?e.domain_function:P,r=nn(this,e.vector,e.origin,this.domain_function,n,t);return r?V.segment(r):void 0},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")}},An=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},xn={rect:{P:Array.prototype,A:function A(){var e=Be.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=V.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(An(this))),Object.defineProperty(this,"domain_function",{writable:!0,value:j})},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return V.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:Object.assign({},bn,{inclusive:function inclusive(){return this.domain_function=j,this},exclusive:function exclusive(){return this.domain_function=M,this},area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}}),S:{fromPoints:function fromPoints(){return V.rect(ht(Ie(arguments)))}}}},kn={polygon:{P:Array.prototype,A:function A(){this.push.apply(this,_toConsumableArray(a(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return ee(e[1],e[0])})),Object.defineProperty(this,"domain_function",{writable:!0,value:j})},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:Object.assign({},bn,{inclusive:function inclusive(){return this.domain_function=j,this},exclusive:function exclusive(){return this.domain_function=M,this},segments:function segments(){return this.sides}}),S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(At.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(wt.apply(void 0,arguments))}}}},wn=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},En={matrix:{P:Array.prototype,A:function A(){var e=this;Ue(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return V.matrix.apply(V,_toConsumableArray(Array.from(this)))},set:function set(){return wn(this,Ue(arguments))},isIdentity:function isIdentity(){return me(this)},multiply:function multiply(e){return wn(this,be(this,e))},determinant:function determinant(){return Ae(this)},inverse:function inverse(){return wn(this,xe(this))},translate:function translate(e,t,n){return wn(this,be(this,ke(e,t,n)))},rotateX:function rotateX(e){return wn(this,be(this,Ee(e)))},rotateY:function rotateY(e){return wn(this,be(this,Oe(e)))},rotateZ:function rotateZ(e){return wn(this,be(this,Ce(e)))},rotate:function rotate(e,t,n){var r=je(e,t,n);return wn(this,be(this,r))},scale:function scale(e){return wn(this,be(this,Me(e)))},reflectZ:function reflectZ(e,t){var n=Pe(e,t);return wn(this,be(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return V.vector(he(this,n(3,Ne(t))))},transformVector:function transformVector(e){return V.vector(he(this,n(3,Ne(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=qe(t);return V.line(ye(this,r.vector,r.origin))}},S:{}}},On=Object.assign({},an,fn,ln,_n,mn,yn,xn,kn,En),Cn=function create(e,t){var n=Object.create(On[e].proto);return On[e].A.apply(n,t),n};Object.assign(V,{vector:function vector(){return Cn("vector",arguments)},circle:function circle(){return Cn("circle",arguments)},ellipse:function ellipse(){return Cn("ellipse",arguments)},rect:function rect(){return Cn("rect",arguments)},polygon:function polygon(){return Cn("polygon",arguments)},line:function line(){return Cn("line",arguments)},ray:function ray(){return Cn("ray",arguments)},segment:function segment(){return Cn("segment",arguments)},matrix:function matrix(){return Cn("matrix",arguments)}}),Object.keys(On).forEach((function(e){var t={};t.prototype=null!=On[e].P?Object.create(On[e].P):Object.create(Object.prototype),t.prototype.constructor=t,V[e].prototype=t.prototype,V[e].prototype.constructor=V[e],Object.keys(On[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:On[e].G[n]})})),Object.keys(On[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:On[e].M[n]})})),Object.keys(On[e].S).forEach((function(t){return Object.defineProperty(V[e],t,{value:On[e].S[t].bind(V[e].prototype)})})),On[e].proto=t.prototype}));var jn=V;jn.core=Object.assign(Object.create(null),v,s,Ze,B,pe,We,Xe,Ct,lt,Z,Se,tt,Pt,{enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return Lt(t,e,j)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return Lt(t,e,j)})).reduce((function(e,t){return e&&t}),!0);return!n&&r},intersect_convex_polygon_line:Ft,intersect_polygon_polygon:Bt,intersect_circle_circle:Nt,intersect_circle_line:It,intersect_line_line:dt,overlap_convex_polygons:Zt,overlap_convex_polygon_point:Lt,overlap_line_line:Jt,overlap_line_point:_t,clip_line_in_convex_polygon:nn}),jn.typeof=t,jn.intersect=Ut,jn.overlap=Kt;var Mn=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},Pn=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Sn=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var o=r+1;o<e.length;o+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][o])return!1;return!0}})},zn=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Nn={vertices:function setup_vertex(e,t){return Mn.call(this,e,t),e},edges:function setup_edge(e,t){return Pn.call(this,e,t),e},faces:function setup_face(e,t){return Sn.call(this,e,t),zn.call(this,e,t),e}},In="undefined",Ln="boolean",qn="number",Tn="object",Fn="class",Bn="index",Vn="vertices",Gn="edges",Dn="faces",Rn="boundaries",Un="vertices_coords",Zn="edges_vertices",Hn="faces_edges",Jn="edges_assignment",$n="edges_foldAngle",Wn="boundary",Xn="front",Yn="back",Kn="foldedForm",Qn="black",er="white",tr="none",nr="stroke-width",rr=1.1,or="Rabbit Ear",ir={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},cr=Object.freeze([].concat(ir.file).concat(ir.frame).concat(ir.graph).concat(ir.orders)),ar=Object.freeze(["edges_vector","vertices_sectors","faces_sectors","faces_matrix"]),ur=Array.from("MmVvBbFfUu"),sr={vertices:"vertex",edges:"edge",faces:"face"},fr={b:"boundary",m:"mountain",v:"valley",f:"mark",u:"unassigned"};ur.forEach((function(e){fr[e.toUpperCase()]=fr[e]}));var lr={};ur.forEach((function(e){lr[e]=e.toLowerCase()}));var _r={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},dr=function edge_assignment_to_foldAngle(e){return _r[e]||0},pr=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},vr=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},gr=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},mr=function get_graph_keys_with_prefix(e,t){return gr(e,"".concat(t,"_"))},hr=function get_graph_keys_with_suffix(e,t){return vr(e,"_".concat(t))},yr=function transpose_graph_arrays(e,t){var n=mr(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),o=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return o.forEach((function(n,r){o[r][t]=e[t][r]}))})),o},br=function fold_object_certainty(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length?0:[].concat(cr,ar).filter((function(t){return e[t]})).length/Object.keys(e).length},Ar=Object.freeze({__proto__:null,singularize:sr,edges_assignment_names:fr,edges_assignment_to_lowercase:lr,edges_assignment_degrees:_r,edge_assignment_to_foldAngle:dr,edge_foldAngle_to_assignment:pr,filter_keys_with_suffix:vr,filter_keys_with_prefix:gr,get_graph_keys_with_prefix:mr,get_graph_keys_with_suffix:hr,transpose_graph_arrays:yr,transpose_graph_array_at_index:function transpose_graph_array_at_index(e,t,n){var r=mr(e,t);if(0!==r.length){var o={};return r.forEach((function(t){o[t]=e[t][n]})),o}},fold_object_certainty:br}),xr=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},kr=function count(e,t){return xr.apply(void 0,_toConsumableArray(mr(e,t).map((function(t){return e[t]}))))};kr.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return xr(t,n,r)},kr.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return xr(t,n,r)},kr.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return xr(t,n,r)};var wr=function fn_and(e,t){return e&&t},Er=function fn_cat(e,t){return e.concat(t)},Or=function fn_def(e){return void 0!==e},Cr=function fn_add(e,t){return e+t},jr=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},Mr=function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]},Pr=function get_longest_array(e){if(1===e.length)return e[0];for(var t=e.map((function(e){return e.length})),n=0,r=0;r<e.length;r++)t[r]>t[n]&&(n=r);return e[n]},Sr=function remove_single_instances(e){var t={};return e.forEach((function(e){void 0===t[e]&&(t[e]=0),t[e]++})),e.filter((function(e){return t[e]>1}))},zr=function boolean_matrix_to_indexed_array(e){return e.map((function(e){return e.map((function(e,t){return!0===e?t:void 0})).filter(Or)}))},Nr=function boolean_matrix_to_unique_index_pairs(e){for(var t=[],n=0;n<e.length-1;n++)for(var r=n+1;r<e.length;r++)e[n][r]&&t.push([n,r]);return t},Ir=function circular_array_valid_ranges(e){var t=e.map((function(e){return void 0!==e}));if(t.reduce((function(e,t){return e&&t}),!0))return[[0,e.length-1]];var n=t.map((function(e,t,n){return e&&!n[(t-1+n.length)%n.length]})),r=n.reduce((function(e,t){return e+(t?1:0)}),0),o=Array(r),i=Array(r).fill(0),c=t[0]&&t[e.length-1]?0:r-1;return t.forEach((function(e,r){c=(c+(n[r]?1:0))%i.length,i[c]+=t[r]?1:0,n[r]&&(o[c]=r)})),o.map((function(t,n){return[t,(t+i[n]-1)%e.length]}))},Lr=Object.freeze({__proto__:null,unique_sorted_integers:jr,split_circular_array:Mr,get_longest_array:Pr,remove_single_instances:Sr,boolean_matrix_to_indexed_array:zr,boolean_matrix_to_unique_index_pairs:Nr,make_unique_sets_from_self_relational_arrays:function make_unique_sets_from_self_relational_arrays(e){for(var t=[],n=function recurse(n,r){return void 0!==t[n]?0:(t[n]=r,e[n].forEach((function(e){return recurse(e,r)})),1)},r=0,o=0;r<e.length;r++)r in e&&(o+=n(r,o));return t},make_triangle_pairs:function make_triangle_pairs(e){for(var t=Array(e.length*(e.length-1)/2),n=0,r=0;r<e.length-1;r++)for(var o=r+1;o<e.length;o++,n++)t[n]=[e[r],e[o]];return t},circular_array_valid_ranges:Ir}),qr=function remove_geometry_indices(e,t,n){var r,o,i,c=kr(e,t),a=jr(n),u=[];for(r=0,o=0,i=0;r<c;r+=1,o+=1){for(;r===a[i];)u[r]=void 0,r+=1,i+=1;r<c&&(u[r]=o)}return hr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,o){e[t][r][o]=u[n]}))}))})),a.reverse(),mr(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},Tr=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,o=t.length,i=Array(o).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},Fr=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:Tr}),Br=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},Vr=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},o=0;o<t.length;o+=1){var i="".concat(t[o][0]," ").concat(t[o][1]),c="".concat(t[o][1]," ").concat(t[o][0]);void 0!==r[i]?n[o]=r[i]:(r[i]=o,r[c]=o)}return n},Gr=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.core.EPSILON,r=e.length,o=0;o<r;o+=1)if(Math.abs(e[o]-t[o])>n)return!1;return!0},Dr=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,r=t.map((function(){return[]})),o=0;o<t.length-1;o+=1)for(var i=o+1;i<t.length;i+=1)r[o][i]=Gr(t[o],t[i],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},_=0;_<t.length&&(l(_,_),s!==t.length);_+=1);return a.filter((function(e){return e.length}))},Rr=function remove_isolated_vertices(e){var t=Tr(e);return{map:qr(e,Vn,t),remove:t}},Ur=function remove_circular_edges(e){var t=Br(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),hr(e,Gn).forEach((function(t){return e[t].forEach((function(r,o){for(var i=r.length-1;i>=0;i-=1)!0===n[r[i]]&&e[t][o].splice(i,1)}))}))}return{map:qr(e,Gn,t),remove:t}},Zr=function remove_duplicate_edges(e){var t=Vr(e),n=Object.keys(t),r=qr(e,Gn,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Hr=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,n=Dr(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=jn.core).average.apply(t,_toConsumableArray(e))})),hr(e,Vn).forEach((function(t){return e[t].forEach((function(n,o){return e[t][o].forEach((function(n,i){e[t][o][i]=r[n]}))}))})),mr(e,Vn).filter((function(e){return e!==Un})).forEach((function(t){return delete e[t]}));var o=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:o}},Jr=Object.freeze({__proto__:null,remove_isolated_vertices:Rr,remove_circular_edges:Ur,remove_duplicate_edges:Zr,remove_duplicate_vertices:Hr}),$r=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(Ur(e),Zr(e)),"object"===_typeof(t)&&!0===t.vertices&&Rr(e),e},Wr={edges:"edgeOrders",faces:"faceOrders"},Xr=function implied_count(e,t){return Math.max(function array_in_array_max_number(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}(hr(e,t).map((function(t){return e[t]}))),e[Wr[t]]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[Wr[t]]):-1)+1};Xr.vertices=function(e){return Xr(e,Vn)},Xr.edges=function(e){return Xr(e,Gn)},Xr.faces=function(e){return Xr(e,Dn)};var Yr=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,o=e.vertices_sectors,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],_=(l.indexOf(u)+l.length-1)%l.length,d=l[_],p="".concat(s," ").concat(d);if(c[p])return Object.assign(i,c),a.vertices.pop(),a;if(c[p]=!0,i[p])return;a.vertices.push(s),a.edges.push(p),a.angles.push(o[s][_]),u=s,s=d}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},Kr=Object.freeze({__proto__:null,planar_vertex_walk:Yr}),Qr=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return jn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-jn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},eo=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:jn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},to=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Qr,sort_vertices_along_vector:eo}),no=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},ro=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=ao({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},oo=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=no({edges_vertices:r}));var o=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?o:o.map((function(e,n){return Qr({vertices_coords:t},e,n)}))},io=function make_vertices_faces_simple(e){var t=e.faces_vertices,n=Array.from(Array(Xr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},co=function make_vertices_faces(e){var t=e.vertices_vertices,n=e.faces_vertices;if(!t)return io({faces_vertices:n});var r=so({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]}))}))},ao=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},uo=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},so=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},fo=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;o||(o=yo({vertices_coords:t,edges_vertices:r}));var i=uo({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=i["".concat(t," ").concat(e)],r=i["".concat(e," ").concat(t)];return void 0!==n?o[n]:void 0!==r?jn.core.flip(o[r]):void 0}))}))},lo=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;return fo({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:o}).map((function(e){return 1===e.length?[jn.core.TWO_PI]:jn.core.counter_clockwise_sectors2(e)}))},_o=function make_edges_faces_simple(e){var t=e.faces_edges,n=Array.from(Array(Xr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},po=function make_edges_faces(e){var t=e.edges_vertices,n=e.faces_edges;if(!t)return _o({faces_edges:n});var r=t.map((function(e){return[]}));return n.forEach((function(e,t){var n=[];e.forEach((function(e){n[e]=t})),n.forEach((function(e,t){return r[t].push(e)}))})),r},vo={M:-180,m:-180,V:180,v:180},go=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return vo[e]||0}))},mo=function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},ho=function make_edges_coords(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))}))},yo=function make_edges_vector(e){var t=e.vertices_coords,n=e.edges_vertices;return ho({vertices_coords:t,edges_vertices:n}).map((function(e){return jn.core.subtract(e[1],e[0])}))},bo=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=ho({vertices_coords:t,edges_vertices:n})),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Ao=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,n=[-t,+t];return bo(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},xo=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,o=e.vertices_sectors,i=e.edges_vertices,c=e.edges_vector;n||(n=oo({vertices_coords:t,edges_vertices:i,vertices_edges:r})),o||(o=lo({vertices_coords:t,vertices_vertices:n,edges_vertices:i,edges_vector:c}));var a=ao({edges_vertices:i});return Yr({vertices_vertices:n,vertices_sectors:o}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},ko=function make_faces_vertices_from_edges(e){return e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]===r[0]||e[0]===r[1]?e[1]:e[0]}))}))},wo=function make_faces_edges_from_vertices(e){var t=ao(e);return e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]].join(" ")}))})).map((function(e){return e.map((function(e){return t[e]}))}))},Eo=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var o=e.length;e.forEach((function(e,i,c){var a=c[(i+1)%o];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},Oo=function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return jn.core.centroid(e)}))},Co=function make_faces_center_quick(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(t){return t/e.length}))}))},jo=Object.freeze({__proto__:null,make_vertices_edges:no,make_vertices_edges_sorted:ro,make_vertices_vertices:oo,make_vertices_faces_simple:io,make_vertices_faces:co,make_vertices_to_edge_bidirectional:ao,make_vertices_to_edge:uo,make_vertices_to_face:so,make_vertices_vertices_vector:fo,make_vertices_sectors:lo,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),o=n[e[1]].filter((function(e){return e!==t}));return r.concat(o)}))},make_edges_faces_simple:_o,make_edges_faces:po,make_edges_foldAngle:go,make_edges_assignment:mo,make_edges_coords:ho,make_edges_vector:yo,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return yo({vertices_coords:t,edges_vertices:n}).map((function(e){return jn.core.magnitude(e)}))},make_edges_coords_min_max:bo,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,n=[+t,-t];return bo(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Ao,make_planar_faces:xo,make_planar_faces_vertices:function make_planar_faces_vertices(e){return xo(e).map((function(e){return e.vertices}))},make_planar_faces_edges:function make_planar_faces_edges(e){return xo(e).map((function(e){return e.edges}))},make_faces_vertices_from_edges:ko,make_faces_edges_from_vertices:wo,make_faces_faces:Eo,make_faces_center:Oo,make_faces_center_quick:Co}),Mo=function populate(e,t){return"object"!==_typeof(e)?e:e.edges_vertices?(e.vertices_edges=no(e),e.vertices_vertices=oo(e),e.vertices_edges=ro(e),function build_assignments_if_needed(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=dr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=pr(e.edges_foldAngle[r]);for(var o=e.edges_assignment.length;o<t;o+=1)e.edges_assignment[o]="U",e.edges_foldAngle[o]=0}(e),function build_faces_if_needed(e,t){if(void 0!==t||e.faces_vertices||e.faces_edges||(t=!0),t&&e.vertices_coords){var n=xo(e);return e.faces_vertices=n.map((function(e){return e.vertices})),void(e.faces_edges=n.map((function(e){return e.edges})))}e.faces_vertices&&e.faces_edges||(e.faces_vertices&&!e.faces_edges?e.faces_edges=wo(e):e.faces_edges&&!e.faces_vertices?e.faces_vertices=ko(e):(e.faces_vertices=[],e.faces_edges=[]))}(e,t),e.vertices_faces=co(e),e.edges_faces=po(e),e.faces_faces=Eo(e),e):e},Po=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON;return Ao(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},So=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,i=Ao({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(i[a][1][0]<i[u][0][0]||i[u][1][0]<i[a][0][0])&&(i[a][1][1]<i[u][0][1]||i[u][1][1]<i[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},zo=Object.freeze({__proto__:null,get_edges_vertices_span:Po,get_edges_edges_span:So}),No=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var i=Po({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)i[c][a]&&(i[c][a]=jn.core.overlap_line_point(jn.core.subtract(r[c][1],r[c][0]),r[c][0],t[a],jn.core.exclude_s,o));return i.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Io=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,o=e.edges_origin,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON;r||(r=yo({vertices_coords:t,edges_vertices:n})),o||(o=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=So({vertices_coords:t,edges_vertices:n},i),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=jn.core.intersect_line_line(r[u],o[u],r[s],o[s],jn.core.exclude_s,jn.core.exclude_s,i),c[s][u]=c[u][s]):c[u][s]=void 0;return c},Lo=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,o){r[n][o]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},qo=function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){_typeof(e)===qn?n[t]=r[e]:n[t]=e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},To=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&(_typeof(e)===qn&&(void 0!==t[e]?_typeof(t[e])===qn?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},Fo=function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},Bo=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:Lo,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:qo,invert_map:To,invert_simple_map:Fo}),Vo=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return jn.core.subtract(e[1],e[0])})),o=n.map((function(e){return e[0]})),i=Io({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:o},1e-6),c=No({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==i.reduce(Er,[]).filter(Or).length||0!==c.reduce(Er,[]).filter(Or).length){var a={vertices:e.vertices_coords.length};i.forEach((function(t){return t.filter(Or).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),i.forEach((function(e,t){e.forEach((function(e,n){e&&(i[t][n]=e[0])}))}));var u=i.map((function(e){return e.filter(Or)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=eo({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(Er,[]);if(e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(Er,[]),e.edges_assignment&&e.edges_foldAngle&&e.edges_foldAngle.length>e.edges_assignment.length)for(var l=e.edges_assignment.length;l<e.edges_foldAngle.length;l+=1)e.edges_assignment[l]=pr(e.edges_foldAngle[l]);return e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]})).map((function(t,n){return void 0===t?dr(e.edges_assignment[n]):t}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},Go=[Un,Zn,Jn,$n],Do=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[Vn,Gn,Dn].map((function(t){return mr(e,t)})).reduce(Er,[]).filter((function(e){return!Go.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var o=Hr(e,t/2),i=Zr(e),c=Ur(e),a=Vo(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?o.map:Lo(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?Lo(i.map,c.map):Lo(r.edges.map,i.map,c.map);break}var u=To(a.edges.backmap),s=Lo(i.map,c.map,u);r.vertices.map=void 0===r.vertices.map?o.map:Lo(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?s:Lo(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},Ro=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var o=t.map((function(t){return e.vertices_coords.map((function(e){return jn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===o[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),o.map((function(e){return void 0===e?i++:e}))},Uo=[Vn,Gn,Dn],Zo=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return jn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},Ho=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},o=0;o<e.edges_vertices.length;o+=1)r["".concat(e.edges_vertices[o][0]," ").concat(e.edges_vertices[o][1])]=o,r["".concat(e.edges_vertices[o][1]," ").concat(e.edges_vertices[o][0])]=o;for(var i=0;i<t.edges_vertices.length;i+=1){var c=r["".concat(t.edges_vertices[i][0]," ").concat(t.edges_vertices[i][1])];void 0!==c&&(n[i]=c)}return n},Jo=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(o,i){return o.forEach((function(o,c){e[t][i][c]=r[n][o]}))}))}))}))},$o=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.core.EPSILON,r={},o={},i={};Uo.forEach((function(e){r[e]=mr(t,e),o[e]=hr(t,e)})),Uo.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),i.vertices=Zo(e,t,n),Jo(t,o,[Vn],i);var c=kr.edges(e);i.edges=Array.from(Array(kr.edges(t))).map((function(e,t){return c+t}));var a=Ho(e,t);Object.keys(a).forEach((function(e){i.edges[e]=a[e]}));var u=kr.faces(e);return i.faces=Array.from(Array(kr.faces(t))).map((function(e,t){return u+t})),Jo(t,o,[Gn,Dn],i),Uo.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,o){var c=i[n][o];e[r][c]=t}))}))})),i},Wo=function subgraph(e,t){var n={},r={};return[Dn,Gn,Vn].forEach((function(o){n[o]=Array.from(Array(kr[o](e))).map((function(e,t){return t})),r[o]=jr(t[o]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return qr(e,t,n[t])})),e},Xo=function get_boundary_vertices(e){var t=e.edges_vertices,n=e.edges_assignment,r={};return t.forEach((function(e,t){("B"===n[t]||"b"===n[t])&&(r[e[0]]=!0,r[e[1]]=!0)})),Object.keys(r).map((function(e){return parseInt(e)}))},Yo=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=no({edges_vertices:n}));for(var o=r.map((function(e){return"B"===e||"b"===e})),i=[],c=[],a=-1,u=0;u<o.length;u+=1)if(o[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};o[a]=!1,i.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return o[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];o[a]=!1,i.push(a)}return{vertices:c,edges:i}},Ko=Object.freeze({__proto__:null,get_boundary_vertices:Xo,get_boundary:Yo,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,o=e.edges_vertices;r||(r=oo({vertices_coords:t,vertices_edges:n,edges_vertices:o}));var i=ao({edges_vertices:o}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var _=t[l],d=r[l],p=d.map((function(e){return t[e]})).map((function(e){return[e[0]-_[0],e[1]-_[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,v=d[p],g=i[l<v?"".concat(l," ").concat(v):"".concat(v," ").concat(l)];c.push(g);for(var m=l,h=v,b=0;b<1e4;){var k=r[h],w=k.indexOf(m),E=k[(w+1)%k.length],O=i[h<E?"".concat(h," ").concat(E):"".concat(E," ").concat(h)];if(O===c[0])return u;a.push(h),c.push(O),m=h,h=E,b+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),Qo=function apply_matrix_to_graph(e,t){return vr(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return jn.core.resize(3,e)})).map((function(e){return jn.core.multiply_matrix3_vector3(t,e)}))})),vr(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return jn.core.multiply_matrices3(e,t)}))})),e},ei={scale:function transform_scale(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var c=(n=jn.core).get_vector.apply(n,o),a=jn.core.resize(3,c),u=jn.core.make_matrix3_scale(t,a);return Qo(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=(t=jn.core).get_vector.apply(t,o),a=jn.core.resize(3,c),u=(n=jn.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return Qo(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];var a=(n=jn.core).get_vector.apply(n,i),u=jn.core.resize(3,a),s=(r=jn.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return Qo(e,s)},transform:Qo},ti=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),o=[],i=r.indexOf(!1),c=i+1;c<r.length;c+=1)r[c]&&o.push(e[c]);for(var a=0;a<i;a+=1)r[a]&&o.push(e[a]);return o},ni=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Eo({faces_vertices:t})),0===n.length)return[];var o=[[{face:r}]],i={};i[r]=!0;var c=function _loop(){var e=o[o.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){i[e.face]&&(r[t]=!0),i[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return ti(t[e.face],t[e.parent])})).forEach((function(e,t){var n=e.slice(0,2);c[t].edge_vertices=n})),o[o.length]=c};do{c()}while(o[o.length-1].length>0);return o.length>0&&0===o[o.length-1].length&&o.pop(),o},ri=Object.freeze({__proto__:null,get_face_face_shared_vertices:ti,make_face_spanning_tree:ni}),oi={M:!0,m:!0,V:!0,v:!0,U:!0,u:!0,F:!1,f:!1,B:!1,b:!1},ii=function make_edges_is_flat_folded(e){var t=e.edges_vertices,n=e.edges_foldAngle,r=e.edges_assignment;return void 0===r?void 0===n?t.map((function(e){return!0})):n.map((function(e){return e<0||e>0})):r.map((function(e){return oi[e]}))},ci=function multiply_vertices_faces_matrix2(e,t){var n=e.vertices_coords,r=e.vertices_faces,o=e.faces_vertices;r||(r=co({faces_vertices:o}));var i=r.map((function(e){return e.filter((function(e){return null!=e})).shift()})).map((function(e){return void 0===e?jn.core.identity2x3:t[e]}));return n.map((function(e,t){return jn.core.multiply_matrix2_vector2(i[t],e)}))},ai={U:!0,u:!0},ui=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!o&&r&&(o=mo({edges_foldAngle:r})),r||(r=o?go({edges_assignment:o}):Array(n.length).fill(0));var u=ao({edges_vertices:n}),s=i.map((function(){return jn.core.identity3x4}));return ni({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,i=e.edge_vertices.map((function(e){return t[e]})),c=e.edge_vertices.join(" "),a=u[c],l=ai[o[a]]?Math.PI:r[a]*Math.PI/180,_=jn.core.make_matrix3_rotate(l,(n=jn.core).subtract.apply(n,_toConsumableArray(jn.core.resize_up(i[1],i[0]))),i[0]);s[e.face]=jn.core.multiply_matrices3(s[e.parent],_)}))})),s},si=function make_faces_matrix2(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=o?go({edges_assignment:o}):Array(n.length).fill(0));var u=ii({edges_vertices:n,edges_foldAngle:r,edges_assignment:o}),s=ao({edges_vertices:n}),l=i.map((function(){return jn.core.identity2x3}));return ni({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n=e.edge_vertices.map((function(e){return t[e]})),r=e.edge_vertices.join(" "),o=s[r],i=jn.core.subtract2(n[1],n[0]),c=n[0],a=u[o]?jn.core.make_matrix2_reflect(i,c):jn.core.identity2x3;l[e.face]=jn.core.multiply_matrices2(l[e.parent],a)}))})),l},fi=Object.freeze({__proto__:null,make_edges_is_flat_folded:ii,multiply_vertices_faces_matrix2:ci,make_faces_matrix:ui,make_faces_matrix2:si}),li=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,o=e.edges_vertices,i=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s=ui({vertices_coords:n,edges_vertices:o,edges_foldAngle:i,edges_assignment:c,faces_vertices:a,faces_faces:u},t),r||(r=co({faces_vertices:a}));var l=r.map((function(e){return e.filter((function(e){return null!=e})).shift()})).map((function(e){return void 0===e?jn.core.identity3x4:s[e]}));return n.map((function(e){return jn.core.resize(3,e)})).map((function(e,t){return jn.core.multiply_matrix3_vector3(l[t],e)}))},_i=function make_vertices_coords_flat_folded(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=ii({edges_vertices:n,edges_foldAngle:r,edges_assignment:o}),s=[];i[a].forEach((function(e){s[e]=_toConsumableArray(t[e])}));var l=[];l[a]=!1;var _=ao({edges_vertices:n});return ni({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e,r){return e.forEach((function(e){var r=e.edge_vertices.join(" "),o=_[r],c=n[o].map((function(e){return s[e]}));if(void 0!==c[0]&&void 0!==c[1]){var a=n[o].map((function(e){return t[e]})),d=a[0],p=jn.core.normalize2(jn.core.subtract2(a[1],a[0])),v=jn.core.rotate90(p);l[e.face]=u[o]?!l[e.parent]:l[e.parent];var g=jn.core.normalize2(jn.core.subtract2(c[1],c[0])),m=c[0],h=l[e.face]?jn.core.rotate270(g):jn.core.rotate90(g);i[e.face].filter((function(e){return void 0===s[e]})).forEach((function(e){var n=t[e],r=jn.core.subtract2(n,d),o=jn.core.dot(r,v),i=jn.core.dot(r,p),c=jn.core.scale2(g,i),a=jn.core.scale2(h,o),u=jn.core.add2(jn.core.add2(m,c),a);s[e]=u}))}}))})),s},di=Object.freeze({__proto__:null,make_vertices_coords_folded:li,make_vertices_coords_flat_folded:_i}),pi=function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},vi=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=jn.core.resize(n[0].length,t),o=n.map((function(e,t){return{d:jn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return o?o.i:void 0}},gi=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var o=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return jn.core.nearest_point_on_line(jn.core.subtract(e[1],e[0]),e[0],t,jn.core.segment_limiter)}));return jn.core.smallest_comparison_search(t,o,jn.core.distance)}},mi=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var o=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return jn.core.overlap_convex_polygon_point(e.face,t)})).shift();return void 0===o?void 0:o.i}},hi=mi,yi=Object.freeze({__proto__:null,nearest_vertex:vi,nearest_edge:gi,face_containing_point:mi,nearest_face:hi}),bi=function clone(e){var t,n;if(_typeof(e)!==Tn)return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},Ai=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,o=e.edges_faces,i=e.faces_edges,c=e.faces_vertices;if(o&&o[t])return o[t];var a=r[t];if(void 0!==n){for(var u=[],s=0;s<n[a[0]].length;s+=1)for(var l=0;l<n[a[1]].length;l+=1)if(n[a[0]][s]===n[a[1]][l]){if(void 0===n[a[0]][s])continue;u.push(n[a[0]][s])}return u}if(i){for(var _=[],d=0;d<i.length;d+=1)for(var p=0;p<i[d].length;p+=1)i[d][p]===t&&_.push(d);return _}c&&console.warn("todo: find_adjacent_faces_to_edge")},xi=function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],o=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];if(o.forEach((function(n,r){return[Jn,$n].filter((function(n){return e[n]&&void 0!==e[n][t]})).forEach((function(r){n[r]=e[r][t]}))})),e.vertices_coords&&(e.edges_length||e.edges_vector)){var i=o.map((function(t){return t.edges_vertices.map((function(t){return e.vertices_coords[t]}))}));e.edges_vector&&o.forEach((function(e,t){e.edges_vector=jn.core.subtract(i[t][1],i[t][0])})),e.edges_length&&o.forEach((function(e,t){var n;e.edges_length=(n=jn.core).distance2.apply(n,_toConsumableArray(i[t]))}))}return o},ki=function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,o){var i=o[(n+1)%o.length],c=r[e].indexOf(i);r[e][c]=t})))},wi=function update_vertices_edges(e,t,n,r,o){var i=e.vertices_edges;i&&(i[n]=_toConsumableArray(o),r.map((function(e){return i[e].indexOf(t)})).forEach((function(e,t){i[r[t]][e]=o[t]})))},Ei=function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))},Oi=function update_edges_faces(e,t,n){var r=e.edges_faces;r&&t.forEach((function(e){return r[e]=_toConsumableArray(n)}))},Ci=function update_faces_vertices(e,t,n,r){var o=e.faces_vertices;o&&r.map((function(e){return o[e]})).forEach((function(e){return e.map((function(e,t,r){var o=(t+1)%r.length;return e===n[0]&&r[o]===n[1]||e===n[1]&&r[o]===n[0]?o:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(n){return e.splice(n,0,t)}))}))},ji=function update_faces_edges(e,t,n,r,o){var i=e.edges_vertices,c=e.faces_edges;c&&o.map((function(e){return c[e]})).forEach((function(e){var o=e.indexOf(t),c=e[(o+e.length-1)%e.length],a=e[(o+1)%e.length],u=[[c,t],[t,a]].map((function(e){var t=e.map((function(e){return i[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==i[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==i[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("split_edge() bad faces_edges")}));return o===e.length-1?(e.splice(o,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[o,1].concat(_toConsumableArray(s))),s}))},Mi=function split_edge(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jn.core.EPSILON;if(e.edges_vertices.length<t)return{};var o,i=e.edges_vertices[t];n||(n=(o=jn.core).midpoint.apply(o,_toConsumableArray(i)));var c=i.map((function(t){return e.vertices_coords[t]})).map((function(e){return jn.core.distance(e,n)<r}));if(c[0])return{vertex:i[0],edges:{}};if(c[1])return{vertex:i[1],edges:{}};var a=e.vertices_coords.length;e.vertices_coords[a]=n;var u=[0,1].map((function(t){return t+e.edges_vertices.length}));xi(e,t,a).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][u[n]]=t[r]}))})),ki(e,a,i),wi(e,t,a,i,u);var s=Ai(e,t);s&&(Ei(e,a,s),Oi(e,u,s),Ci(e,a,i,s),ji(e,t,a,u,s));var l=qr(e,Gn,[t]);return u.forEach((function(e,t){u[t]=l[u[t]]})),l.splice(-2),l[t]=u,{vertex:a,edges:{map:l,new:u,remove:t}}},Pi=function rebuild_edge(e,t,n){var r=e.edges_vertices.length,o=function make_edge(e,t,n){var r,o,i=e.vertices_coords,c=t.map((function(e){return i[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=jn.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(o=jn.core).subtract.apply(o,_toConsumableArray(c)),edges_faces:[n,n]}}(e,n,t);return Object.keys(o).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][r]=o[t]})),r},Si=function build_faces(e,t,n){var r=[0,1].map((function(t){return e.faces_vertices.length+t}));return function make_faces(e,t,n){var r=e.edges_vertices,o=e.faces_vertices,i=e.faces_edges;e.faces_faces;var c=n.map((function(e){return o[t].indexOf(e)})),a=Mr(o[t],c).map((function(e){return{faces_vertices:e}}));if(i){var u=ao({edges_vertices:r});a.map((function(e){return e.faces_vertices.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return u[e]}))})).forEach((function(e,t){a[t].faces_edges=e}))}return a}(e,t,n).forEach((function(t,n){return Object.keys(t).forEach((function(o){e[o][r[n]]=t[o]}))})),r},zi=function intersect_convex_face_line(e,t,n,r){var o=e.vertices_coords,i=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jn.core.EPSILON,s=c[t].map((function(e){return o[e]})).map((function(e){return jn.core.overlap_line_point(n,r,e,(function(){return!0}),u)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})),l=s.map((function(e){return c[t][e]})),_=s.concat(s.map((function(e){return e+c[t].length}))).map((function(e,t,n){return n[t+1]-e==1})).reduce((function(e,t){return e||t}),!1);if(!_){if(l.length>1)return{vertices:l,edges:[]};var d=a[t].map((function(e){return i[e].map((function(e){return o[e]}))})).map((function(e){return jn.core.intersect_line_line(n,r,jn.core.subtract(e[1],e[0]),e[0],jn.core.include_l,jn.core.exclude_s,u)})).map((function(e,n){return{coords:e,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).filter((function(e){return!l.map((function(t){return i[e.edge].includes(t)})).reduce((function(e,t){return e||t}),!1)}));return d.length+l.length===2?{vertices:l,edges:d}:void 0}},Ni=function split_convex_face(e,t,n,r,o){var i=zi(e,t,n,r,o);if(void 0!==i){var c=function split_at_intersections(e,t){var n,r,o=t.vertices,i=t.edges.map((function(t){var r=Mi(e,n?n[t.edge]:t.edge,t.coords);return n=n?Lo(n,r.edges.map):r.edges.map,r}));return o.push.apply(o,_toConsumableArray(i.map((function(e){return e.vertex})))),i.forEach((function(e){e.edges.remove=r?r[e.edges.remove]:e.edges.remove;var t=Fo(e.edges.map);r=r?qo(r,t):t})),{vertices:o,edges:{map:n,remove:i.map((function(e){return e.edges.remove}))}}}(e,i);c.edges.new=Pi(e,t,c.vertices),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,o=e.edges_vertices,i=o[t][0],c=o[t][1];r[i]=Qr({vertices_coords:n},r[i].concat(c),i),r[c]=Qr({vertices_coords:n},r[c].concat(i),c)}(e,c.edges.new),function update_vertices_edges(e,t){var n=e.edges_vertices,r=e.vertices_edges,o=e.vertices_vertices;if(r&&o){var i=n[t];i.map((function(e){return o[e]})).map((function(e,t){return e.indexOf(i[(t+1)%i.length])})).forEach((function(e,n){return r[i[n]].splice(e,0,t)}))}}(e,c.edges.new);var a=Si(e,t,c.vertices);!function update_vertices_faces(e,t,n){var r={};n.forEach((function(t,n){return e.faces_vertices[t].forEach((function(e){r[e]||(r[e]=[]),r[e].push(t)}))})),e.faces_vertices[t].forEach((function(n){var o,i=e.vertices_faces[n].indexOf(t),c=r[n];-1!==i&&c?(o=e.vertices_faces[n]).splice.apply(o,[i,1].concat(_toConsumableArray(c))):console.warn("update_vertices_faces not supposed to be here")}))}(e,t,a),function update_edges_faces(e,t,n,r){var o={};r.forEach((function(t,n){return e.faces_edges[t].forEach((function(e){o[e]||(o[e]=[]),o[e].push(t)}))})),[].concat(_toConsumableArray(e.faces_edges[t]),[n]).forEach((function(n){for(var r,i=o[n],c=[],a=0;a<e.edges_faces[n].length;a++)e.edges_faces[n][a]===t&&c.push(a);if(0!==c.length&&i){c.reverse().forEach((function(t){return e.edges_faces[n].splice(t,1)}));var u=c[c.length-1];(r=e.edges_faces[n]).splice.apply(r,[u,0].concat(_toConsumableArray(i)))}else console.warn("update_edges_faces not supposed to be here",u,i,JSON.parse(JSON.stringify(e.edges_faces[n])))}))}(e,t,c.edges.new,a),function update_faces_faces(e,t,n){var r=e.faces_vertices,o=e.faces_faces,i=o[t],c=n.map((function(e){return r[e]})),a=i.map((function(e,t){for(var o=r[e],i=[0,0],a=0;a<c.length;a++){for(var u=0,s=0;s<o.length;s++)-1!==c[a].indexOf(o[s])&&u++;i[a]=u}return i[0]>=2?n[0]:i[1]>=2?n[1]:void 0}));n.forEach((function(e,t,r){o[e]=[r[(t+1)%n.length]]})),i.forEach((function(e,n){for(var r=0;r<o[e].length;r++)o[e][r]===t&&(o[e][r]=a[n],o[a[n]].push(e))}))}(e,t,a);var u=qr(e,Dn,[t]);return a.forEach((function(e,t){a[t]=u[a[t]]})),u.splice(-2),u[t]=a,c.faces={map:u,new:a,remove:t},c}},Ii={};Ii.prototype=Object.create(Object.prototype),Ii.prototype.constructor=Ii;var Li=Object.assign({clean:$r,populate:Mo,fragment:Do,subgraph:Wo,assign:$o},ei);Object.keys(Li).forEach((function(e){Ii.prototype[e]=function(){return Li[e].apply(Li,[this].concat(Array.prototype.slice.call(arguments)))}}));var qi={addVertices:Ro,splitEdge:Mi,faceSpanningTree:ni,explodeFaces:pi};Object.keys(qi).forEach((function(e){Ii.prototype[e]=function(){return qi[e].apply(qi,[this].concat(Array.prototype.slice.call(arguments)))}})),Ii.prototype.splitFace=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=(t=jn.core).get_line.apply(t,r);return Ni(this,e,i.vector,i.origin)},Ii.prototype.copy=function(){return Object.assign(Object.create(this.__proto__),bi(this))},Ii.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_typeof(e)===Tn&&(!0!==n.append&&cr.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:rr,file_creator:or},bi(e)))},Ii.prototype.clear=function(){var e=this;ir.graph.forEach((function(t){return delete e[t]})),ir.orders.forEach((function(t){return delete e[t]})),delete this.file_frames},Ii.prototype.unitize=function(){if(this.vertices_coords){var e=jn.core.enclosing_box(this.vertices_coords),t=e[1].map((function(e){return 1/e})),n=e[0];return this.vertices_coords=this.vertices_coords.map((function(e){return jn.core.subtract(e,n)})).map((function(e){return e.map((function(e,n){return e*t[n]}))})),this}},Ii.prototype.folded=function(){var e=this.faces_matrix2?ci(this,this.faces_matrix2):li.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)));return Object.assign(Object.create(this.__proto__),Object.assign(bi(this),{vertices_coords:e,frame_classes:[Kn]}))},Ii.prototype.flatFolded=function(){var e=this.faces_matrix2?ci(this,this.faces_matrix2):_i.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)));return Object.assign(Object.create(this.__proto__),Object.assign(bi(this),{vertices_coords:e,frame_classes:[Kn]}))};var Ti=function shortenKeys(e,t,n){var r=this,o=Object.create(null);return Object.keys(e).forEach((function(t){o[t.substring(r.length+1)]=e[t]})),o},Fi=function getComponent(e){return yr(this,e).map(Ti.bind(e)).map(Nn[e].bind(this))};[Vn,Gn,Dn].forEach((function(e){return Object.defineProperty(Ii.prototype,e,{get:function get(){return Fi.call(this,e)}})})),Object.defineProperty(Ii.prototype,Wn,{get:function get(){var e=this,t=Yo(this),n=jn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),Object.assign(n,t)}});var Bi={vertices:vi,edges:gi,faces:mi};Ii.prototype.nearest=function(){var e=this,t=jn.core.get_vector(arguments),n=Object.create(null),r={};return[Vn,Gn,Dn].forEach((function(o){Object.defineProperty(n,sr[o],{get:function get(){return void 0!==r[o]||(r[o]=Bi[o](e,t)),r[o]}}),gr(e,o).forEach((function(t){return Object.defineProperty(n,t,{get:function get(){return e[t][n[sr[o]]]}})}))})),n};var Vi=Ii.prototype,Gi=function clip(e,t){var n=e.vertices_coords,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_assignment,c=e.boundaries_vertices;return c||(c=Yo({vertices_edges:r,edges_vertices:o,edges_assignment:i}).vertices),jn.polygon(c.map((function(e){return n[e]}))).clip(t)},Di=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var o=Zr(e).map;return r.map((function(e){return o[e]}))},Ri={};Ri.prototype=Object.create(Vi),Ri.prototype.constructor=Ri;var Ui=function edges_array(e){var t=this;return e.mountain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-180;return e.forEach((function(e){t.edges_assignment[e]="M",t.edges_foldAngle[e]=n})),e},e.valley=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180;return e.forEach((function(e){t.edges_assignment[e]="V",t.edges_foldAngle[e]=n})),e},e.flat=function(){return e.forEach((function(e){t.edges_assignment[e]="F",t.edges_foldAngle[e]=0})),e},e};["line","ray","segment"].forEach((function(e){Ri.prototype[e]=function(){var t=jn[e].apply(jn,arguments);if(t){var n=Gi(this,t);if(n){var r=Ro(this,n),o=Di(this,r),i=Do(this).edges.map;return Mo(this),Ui.call(this,o.map((function(e){return i[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){Ri.prototype[e]=function(){var t=this,n=jn[e].apply(jn,arguments);if(n){var r=n.segments(96).map((function(e){return jn.segment(e)})).map((function(e){return Gi(t,e)})).filter((function(e){return void 0!==e}));if(r){var o=[],i=[];r.forEach((function(e){var n=Ro(t,e);o.push.apply(o,_toConsumableArray(n)),i.push.apply(i,_toConsumableArray(Di(t,n)))}));var c=Do(this).edges.map;return Mo(this),Ui.call(this,i.map((function(e){return c[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}}));var Zi=Ri.prototype,Hi=function make_faces_winding_from_matrix2(e){return e.map((function(e){return e[0]*e[3]-e[1]*e[2]})).map((function(e){return e>=0}))},Ji=function make_faces_winding(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]})).map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return(e[1][0]-e[0][0])*(e[1][1]+e[0][1])})).reduce((function(e,t){return e+t}),0)})).map((function(e){return e<0}))},$i=Object.freeze({__proto__:null,make_faces_winding_from_matrix:function make_faces_winding_from_matrix(e){return e.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},make_faces_winding_from_matrix2:Hi,make_faces_winding:Ji}),Wi=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),o=r.filter((function(e){return t[e]})),i=r.filter((function(e){return!t[e]}));return i.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),o.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=i.length+t})),n},Xi=function make_face_side(e,t,n,r){var o=jn.core.subtract2(n,t),i=jn.core.cross2(e,o);return r?i<0:i>0},Yi=function make_face_center(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},Ki={M:"V",m:"V",V:"M",v:"M"},Qi=function get_opposite_assignment(e){return Ki[e]||e},ec=function face_snapshot(e,t){return{center:e.faces_center[t],matrix:e.faces_matrix2[t],winding:e.faces_winding[t],crease:e.faces_crease[t],side:e.faces_side[t],layer:e.faces_layer[t]}},tc=function flat_fold(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"V",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jn.core.EPSILON,i=Qi(r);Mo(e),e.faces_layer||(e.faces_layer=Array(e.faces_vertices.length).fill(0)),e.faces_center=e.faces_vertices.map((function(t,n){return Yi(e,n)})),e.faces_matrix2||(e.faces_matrix2=si(e,0)),e.faces_winding=Hi(e.faces_matrix2),e.faces_crease=e.faces_matrix2.map(jn.core.invert_matrix2).map((function(e){return jn.core.multiply_matrix2_line2(e,t,n)})),e.faces_side=e.faces_vertices.map((function(t,n){return Xi(e.faces_crease[n].vector,e.faces_crease[n].origin,e.faces_center[n],e.faces_winding[n])}));var c=ec(e,0),a=e.faces_vertices.map((function(e,t){return t})).reverse().map((function(t){var n=ec(e,t),c=Ni(e,t,n.crease.vector,n.crease.origin,o);if(void 0!==c)return e.edges_assignment[c.edges.new]=n.winding?r:i,e.edges_foldAngle[c.edges.new]=dr(e.edges_assignment[c.edges.new]),c.faces.map[c.faces.remove].forEach((function(t){e.faces_center[t]=Yi(e,t),e.faces_side[t]=Xi(n.crease.vector,n.crease.origin,e.faces_center[t],n.winding),e.faces_layer[t]=n.layer})),c})).filter((function(e){return void 0!==e})),u=Lo.apply(void 0,_toConsumableArray(a.map((function(e){return e.faces.map})))),s=Lo.apply(void 0,_toConsumableArray(a.map((function(e){return e.edges.map})).filter((function(e){return void 0!==e})))),l=a.map((function(e){return e.faces.remove})).reverse();e.faces_layer=Wi(e.faces_layer,e.faces_side);var _=u&&2===u[0].length,d=_?u[0].filter((function(t){return e.faces_side[t]})).shift():0,p=c.matrix;return r!==i&&(p=_||e.faces_side[0]?jn.core.multiply_matrices2(c.matrix,jn.core.make_matrix2_reflect(c.crease.vector,c.crease.origin)):c.matrix),e.faces_matrix2=si(e,d).map((function(e){return jn.core.multiply_matrices2(p,e)})),delete e.faces_center,delete e.faces_winding,delete e.faces_crease,delete e.faces_side,{faces:{map:u,remove:l},edges:{map:s}}},nc={};nc.prototype=Object.create(Vi),nc.prototype.constructor=nc,nc.prototype.flatFold=function(){var e=jn.core.get_line(arguments);return tc(this,e.vector,e.origin),this};var rc=nc.prototype,oc=function is_folded_form(e){return e.frame_classes&&e.frame_classes.includes("foldedForm")||e.file_classes&&e.file_classes.includes("foldedForm")},ic=Object.freeze({__proto__:null,is_folded_form:oc}),cc=function make_folded_strip_tacos(e,t,n){var r=e.map((function(e){return e?(e[0]+e[1])/2:void 0})),o=[];return e.forEach((function(i,c){if(i&&(t||c!==e.length-1)){var a=i[1],u=a-2*n,s=a+2*n,l=[c,(c+1)%e.length],_=l.map((function(e){return r[e]})).map((function(e){return e>a})),d=1*(!_[0]&&!_[1])+2*(_[0]&&_[1]),p=o.filter((function(e){return e.min<a&&e.max>a})).shift(),v={faces:l,taco_type:d};p?p.pairs.push(v):o.push({min:u,max:s,pairs:[v]})}})),o.map((function(e){return e.pairs})).filter((function(e){return e.length>1})).map((function(e){return{both:e.filter((function(e){return 0===e.taco_type})).map((function(e){return e.faces})),left:e.filter((function(e){return 1===e.taco_type})).map((function(e){return e.faces})),right:e.filter((function(e){return 2===e.taco_type})).map((function(e){return e.faces}))}}))},ac=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},uc=function validate_taco_tortilla_strip(e,t){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jn.core.EPSILON,o=To(t),i=e.map((function(e){return e?e[1]:void 0})),c=e.map((function(e){return e?Math.min.apply(Math,_toConsumableArray(e)):void 0})).map((function(e){return e+r})),a=e.map((function(e){return e?Math.max.apply(Math,_toConsumableArray(e)):void 0})).map((function(e){return e-r})),u=o.length+(n?0:-1),s=function _loop(e){var n=(e+1)%o.length;if(o[e]===o[n])return"continue";var r=ac(t,o[e],o[n]).reduce(Er,[]),u=r.map((function(t){return i[e]<c[t]})).reduce(wr,!0),s=r.map((function(t){return i[e]>a[t]})).reduce(wr,!0);return u||s?void 0:{v:!1}},l=0;l<u;l+=1){var _=s(l);if("continue"!==_&&"object"===_typeof(_))return _.v}return!0},sc=function validate_taco_taco_face_pairs(e){for(var t=Sr(e),n={},r=0,o=0;o<t.length;o++)if(void 0===n[t[o]])r++,n[t[o]]=r;else if(void 0!==n[t[o]]){if(n[t[o]]!==r)return!1;r--,n[t[o]]=void 0}return!0},fc=function build_layers(e,t){return e.map((function(e){return t[e]})).filter(Or)},lc=function validate_layer_solver(e,t,n,r,o){var i=jn.core.flatten_arrays(t);if(!uc(e,t,r,o))return!1;for(var c=0;c<n.length;c++){var a=fc(i,n[c]);if(!sc(a))return!1}return!0},_c={V:!0,v:!0,M:!0,m:!0},dc=function assignments_to_faces_flip(e){var t=0,n=e.slice(1);return[!1].concat(n.map((function(e){return _c[e]?++t:t})).map((function(e){return e%2==1})))},pc={V:1,v:1,M:-1,m:-1},vc=function assignments_to_faces_vertical(e){var t=0;return e.slice(1).concat([e[0]]).map((function(e){var n=function upOrDown(e,t){return t%2==0?pc[e]||0:-(pc[e]||0)}(e,t);return t+=void 0===pc[e]?0:1,n}))},gc=function fold_strip_with_assignments(e,t){var n=dc(t).map((function(t,n){return e[n]*(t?-1:1)})),r=e.map((function(){}));r[0]=[0,n[0]];for(var o=1;o<e.length&&("B"!==t[o]&&"b"!==t[o]);o++){var i=r[(o-1+e.length)%e.length][1];r[o]=[i,i+n[o]]}return r},mc=Object.freeze({__proto__:null,assignments_to_faces_flip:dc,assignments_to_faces_vertical:vc,fold_strip_with_assignments:gc}),hc={B:!0,b:!0},yc=function single_vertex_solver(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.core.EPSILON,r=gc(e,t),o=vc(t),i=t.map((function(e){return!hc[e]})).reduce((function(e,t){return e&&t}),!0);if(i){var c=r[0][0],a=r[r.length-1][1];if(Math.abs(c-a)>n)return[]}var u=cc(r,i,n).map((function(e){return[e.left,e.right].map(To).filter((function(e){return e.length>1}))})).reduce((function(e,t){return e.concat(t)}),[]),s=function recurse(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0],c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=c+1,l=o[c],_=c>=e.length-1,d=i&&_;if(!lc(r,t,u,d,n))return[];if(d){var p=To(t),v=p[0],g=p[c];if(l>0&&g>v)return[];if(l<0&&g<v)return[]}if(_)return[t];if(0===l)return t[a]=[s].concat(t[a]),recurse(t,s,a);var m=1===l?Array.from(Array(t.length-a)).map((function(e,t){return a+t+1})):Array.from(Array(a+1)).map((function(e,t){return t})),h=m.map((function(e){return bi(t)}));return h.forEach((function(e,t){return e.splice(m[t],0,s)})),h.map((function(e,t){return recurse(e,s,m[t])})).reduce((function(e,t){return e.concat(t)}),[])};return s().map(To)},bc=function make_vertex_faces_layer(e,t,n){var r=e.vertices_faces,o=e.vertices_sectors,i=e.vertices_edges,c=e.edges_assignment,a=r[t],u=Pr(Ir(a));if(void 0!==u){for(;u[1]<u[0];)u[1]+=a.length;var s=Array.from(Array(u[1]-u[0]+1)).map((function(e,t){return(u[0]+t)%a.length})),l=s.map((function(e){return o[t][e]})),_=s.map((function(e){return i[t][e]})).map((function(e){return c[e]})),d=yc(l,_,n).map(To).map((function(e){return e.map((function(e){return"object"!==_typeof(e)?a[s[e]]:e.map((function(e){return a[s[e]]}))}))})).map(To);return d.face=a[s[0]],d}},Ac=function flip_solutions(e){var t=e.face,n=e.map(To).map((function(e){return e.reverse()})).map(To);return n.face=t,n},xc=function make_edges_faces_overlap(e,t){var n=e.vertices_coords,r=e.edges_vertices,o=e.edges_vector,i=e.edges_faces;e.faces_edges;var c=e.faces_vertices;o||(o=yo({vertices_coords:n,edges_vertices:r}));var a=Ji({vertices_coords:n,faces_vertices:c}),u=r.map((function(e){return n[e[0]]})),s=r.map((function(){return Array.from(Array(c.length))}));i.forEach((function(e,t){return e.forEach((function(e){s[t][e]=!1}))})),i.forEach((function(e,t){return e.forEach((function(e){s[t][e]=!1}))}));for(var l=r.map((function(e){return e.map((function(e){return n[e]}))})),_=c.map((function(e){return e.map((function(e){return n[e]}))})),d=0;d<a.length;d++)a[d]||_[d].reverse();return s.forEach((function(e,n){return e.forEach((function(e,r){if(!1!==e)if(l[n].map((function(e){return jn.core.overlap_convex_polygon_point(_[r],e,jn.core.exclude,t)})).reduce((function(e,t){return e||t}),!1))s[n][r]=!0;else{var i=jn.core.intersect_convex_polygon_line(_[r],o[n],u[n],jn.core.exclude_s,jn.core.exclude_s,t);s[n][r]=!!i}}))})),s},kc=function make_faces_polygon(e,t){var n=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return jn.core.make_polygon_non_collinear(e,t)}))},wc=function make_faces_faces_overlap(e){for(var t=e.vertices_coords,n=e.faces_vertices,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,o=Array.from(Array(n.length)).map((function(){return Array.from(Array(n.length))})),i=kc({vertices_coords:t,faces_vertices:n},r),c=0;c<n.length-1;c++)for(var a=c+1;a<n.length;a++){var u=jn.core.overlap_convex_polygons(i[c],i[a],r);o[c][a]=u,o[a][c]=u}return o},Ec=function make_edges_edges_parallel(e,t){var n=e.vertices_coords,r=e.edges_vertices,o=e.edges_vector;o||(o=yo({vertices_coords:n,edges_vertices:r}));for(var i=o.length,c=Array.from(Array(i)).map((function(){return Array.from(Array(i))})),a=0;a<i-1;a++)for(var u=a+1;u<i;u++){var s=jn.core.parallel(o[a],o[u],t);c[a][u]=s,c[u][a]=s}return c},Oc=function overwrite_edges_overlaps(e,t,n,r,o){for(var i=0;i<e.length-1;i++)for(var c=i+1;c<e.length;c++)e[i][c]&&(e[i][c]=jn.core.overlap_line_line(t[i],n[i],t[c],n[c],r,r,o),e[c][i]=e[i][c])},Cc=function make_edges_edges_crossing(e,t){var n=e.vertices_coords,r=e.edges_vertices,o=e.edges_vector;o||(o=yo({vertices_coords:n,edges_vertices:r}));for(var i=r.map((function(e){return n[e[0]]})),c=Ec({vertices_coords:n,edges_vertices:r,edges_vector:o},t).map((function(e){return e.map((function(e){return!e}))})),a=0;a<c.length;a++)c[a][a]=void 0;return Oc(c,o,i,jn.core.exclude_s,t),c},jc=function make_edges_edges_parallel_overlap(e,t){var n=e.vertices_coords,r=e.edges_vertices,o=e.edges_vector;o||(o=yo({vertices_coords:n,edges_vertices:r}));var i=r.map((function(e){return n[e[0]]})),c=Ec({vertices_coords:n,edges_vertices:r,edges_vector:o},t);return Oc(c,o,i,jn.core.exclude_s,t),c},Mc=Object.freeze({__proto__:null,make_edges_edges_parallel:Ec,make_edges_edges_crossing:Cc,make_edges_edges_parallel_overlap:jc}),Pc=Object.assign(Object.create(null),{assign:$o,add_vertices:Ro,add_edges:Di,split_edge:Mi,split_face:Ni,flat_fold:tc,clean:$r,get_circular_edges:Br,get_duplicate_edges:Vr,get_duplicate_vertices:Dr,get_collinear_vertices:No,count:kr,implied:Xr,fragment:Do,remove:qr,populate:Mo,subgraph:Wo,explode_faces:pi,clip:Gi,intersect_convex_face_line:zi,join_collinear_edges:function join_collinear_edges(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.vertices_edges,o=e.edges_vector;arguments.length>1&&void 0!==arguments[1]||jn.core.EPSILON,o||(o=yo({vertices_coords:t,edges_vertices:n})),r||(r=no({edges_vertices:n}));for(var i=r.map((function(e,t){return 2===e.length?t:void 0})).filter((function(e){return void 0!==e})),c=i.map((function(e){return r[e]})).map((function(e){return e.map((function(e){return o[e]}))})).map((function(e){var t;return(t=jn.core).parallel.apply(t,_toConsumableArray(e))})),a=i.filter((function(e,t){return c[t]})),u=a.map((function(e){return r[e]})).map((function(e){return e[0]<e[1]?e:[e[1],e[0]]})),s={},l=0;l<u.length;l++)void 0===s[u[l][1]]?s[u[l][1]]=!0:console.log("WARNING. cannot safely remove edges. some overlaps");var _=u.map((function(e){return e[0]})),d=u.map((function(e){return e[1]})),p=d.map((function(e){return n[e]})).map((function(e,t){return e[0]===a[t]?e[1]:e[1]===a[t]?e[0]:void console.log("WARNING, removed edge cannot find vertex")}));return _.forEach((function(e,t){n[e][0]===a[t]?n[e][0]=p[t]:n[e][1]===a[t]?n[e][1]=p[t]:console.log("WARNING, joining edges cannot find vertex")})),{vertices:a,edges:d}},make_vertex_faces_layer:bc,make_vertices_faces_layer:function make_vertices_faces_layer(e){var t=arguments.length>2?arguments[2]:void 0;e.vertices_sectors||(e.vertices_sectors=lo(e));var n=Ji(e).map((function(e){return!e})),r=e.vertices_sectors.map((function(n,r){return bc(e,r,t)})),o=r.map((function(e){return n[e.face]}));return r.map((function(e,t){return o[t]?Ac(e):e}))},make_edges_faces_overlap:xc,make_faces_faces_overlap:wc},jo,Mc,di,ri,fi,$i,ei,Ko,Kr,yi,Ar,to,zo,Bo,ic,Jr,Fr,Lr),Sc={},zc=function make_rect_vertices_coords(e,t){return[[0,0],[e,0],[e,t],[0,t]]},Nc=function make_closed_polygon(e){return Mo({vertices_coords:e,edges_vertices:e.map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array(e.length).fill("B")})},Ic=[null,null,null,"triangle",null,"pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];Ic.map((function(e,t){return null===e?t:void 0})).filter((function(e){return void 0!==e})).forEach((function(e){return delete Ic[e]})),Ic.forEach((function(e,t){Sc[e]=function(){return Nc(jn.core.make_regular_polygon_side_length(t))}})),Sc.square=function(){return Nc(zc(1,1))},Sc.rectangle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nc(zc(e,t))},Sc.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return Nc(jn.core.make_regular_polygon(e))},Sc.kite=function(){return Mo({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:Array.from("BBBBBBVVF")})};var Lc=Object.create(null),qc={graph:Vi,cp:Zi,origami:rc},Tc={graph:function graph(){return{}},cp:Sc.square,origami:Sc.square};Object.keys(qc).forEach((function(e){Lc[e]=function(){var t=Array.from(arguments).filter((function(e){return br(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Mo(Object.assign.apply(Object,[Object.create(qc[e]),t.length?{}:Tc[e]()].concat(_toConsumableArray(t),[{file_spec:rr,file_creator:or}])))},Lc[e].prototype=qc[e],Lc[e].prototype.constructor=Lc[e],Object.keys(Sc).forEach((function(t){Lc[e][t]=function(){return Lc[e](Sc[t].apply(Sc,arguments))}}))})),Object.assign(Lc.graph,Pc);var Fc=function cubrt(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)},Bc=function axiom6ud(e,t,n,r){if(Math.abs(1-jn.core.dot2(e.u,n)/e.d)<.02)return[];var o=jn.core.rotate90(e.u),i=jn.core.subtract2(jn.core.add2(n,jn.core.scale2(e.u,e.d)),jn.core.scale2(r,2)),c=jn.core.subtract2(jn.core.scale2(e.u,e.d),n),a=jn.core.dot2(r,t.u)-t.d,u=2*jn.core.dot2(c,o),s=jn.core.dot2(c,c),l=jn.core.dot2(jn.core.add2(i,c),o),_=jn.core.dot2(i,c),d=jn.core.dot2(o,t.u),p=jn.core.dot2(c,t.u),v=d,g=a+l*d+p,m=a*u+_*d+l*p,h=a*s+_*p,b=0;return Math.abs(m)>jn.core.EPSILON&&(b=1),Math.abs(g)>jn.core.EPSILON&&(b=2),Math.abs(v)>jn.core.EPSILON&&(b=3),function polynomial(e,t,n,r,o){switch(e){case 1:return[-o/r];case 2:var i=Math.pow(r,2)-4*n*o;if(i<-jn.core.EPSILON)return[];var c=-r/(2*n);if(i<jn.core.EPSILON)return[c];var a=Math.sqrt(i)/(2*n);return[c+a,c-a];case 3:var u=n/t,s=r/t,l=o/t,_=(3*s-Math.pow(u,2))/9,d=(9*u*s-27*l-2*Math.pow(u,3))/54,p=Math.pow(_,3)+Math.pow(d,2),v=-u/3;if(p>0){var g=Math.sqrt(p);return[v+Fc(d+g)+Fc(d-g)]}if(Math.abs(p)<jn.core.EPSILON){var m=Math.pow(d,1/3);return d<0?[]:[v+2*m,v-m]}var h=Math.sqrt(-p),b=Math.atan2(h,d)/3,k=Math.pow(Math.pow(d,2)-p,1/6),w=k*Math.cos(b),E=k*Math.sin(b);return[v+2*w,v-w-Math.sqrt(3)*E,v-w+Math.sqrt(3)*E];default:return[]}}(b,v,g,m,h).map((function(t){return jn.core.add2(jn.core.scale2(e.u,e.d),jn.core.scale2(o,t))})).map((function(e){return{p:e,u:jn.core.normalize2(jn.core.subtract2(e,n))}})).map((function(e){return{u:e.u,d:jn.core.dot2(e.u,jn.core.midpoint2(e.p,n))}}))},Vc=Object.freeze({__proto__:null,axiom1ud:function axiom1ud(e,t){var n=jn.core.normalize2(jn.core.rotate90(jn.core.subtract2(t,e)));return{u:n,d:jn.core.dot2(jn.core.add2(e,t),n)/2}},axiom2ud:function axiom2ud(e,t){var n=jn.core.normalize2(jn.core.subtract2(t,e));return{u:n,d:jn.core.dot2(jn.core.add2(e,t),n)/2}},axiom3ud:function axiom3ud(e,t){var n=function intersection_ud(e,t){var n=jn.core.cross2(e.u,t.u);if(!(Math.abs(n)<jn.core.EPSILON))return[(e.d*t.u[1]-t.d*e.u[1])/n,(t.d*e.u[0]-e.d*t.u[0])/n]}(e,t);return void 0===n?[{u:e.u,d:(e.d+t.d*jn.core.dot2(e.u,t.u))/2}]:[jn.core.add2,jn.core.subtract2].map((function(n){return jn.core.normalize2(n(e.u,t.u))})).map((function(e){return{u:e,d:jn.core.dot2(n,e)}}))},axiom4ud:function axiom4ud(e,t){var n=jn.core.rotate90(e.u);return{u:n,d:jn.core.dot2(t,n)}},axiom5ud:function axiom5ud(e,t,n){var r=jn.core.dot2(t,e.u),o=e.d-r,i=jn.core.distance2(t,n);if(o>i)return[];var c=Math.sqrt(i*i-o*o),a=jn.core.scale2(e.u,o),u=jn.core.add2(t,a),s=jn.core.scale2(jn.core.rotate90(e.u),c);return(c<jn.core.EPSILON?[u]:[jn.core.add2(u,s),jn.core.subtract2(u,s)]).map((function(e){return jn.core.normalize2(jn.core.subtract2(n,e))})).map((function(e){return{u:e,d:jn.core.dot2(t,e)}}))},axiom6ud:Bc,axiom7ud:function axiom7ud(e,t,n){var r=jn.core.rotate90(e.u),o=jn.core.dot2(r,t.u);if(!(Math.abs(o)<jn.core.EPSILON)){var i=jn.core.dot2(n,r),c=jn.core.dot2(n,t.u);return{u:r,d:(t.d+2*i*o-c)/(2*o)}}}}),Gc=function axiom3(e,t){return jn.core.bisect_lines2(e.vector,e.origin,t.vector,t.origin)},Dc=function axiom5(e,t,n){return(jn.core.intersect_circle_line(jn.core.distance2(t,n),t,e.vector,e.origin,jn.core.include_l)||[]).map((function(e){var t;return{vector:jn.core.normalize2(jn.core.rotate90((t=jn.core).subtract2.apply(t,_toConsumableArray(jn.core.resize_up(e,n))))),origin:jn.core.midpoint2(n,e)}}))},Rc=function axiom6(e,t,n,r){return Bc(jn.core.vector_origin_to_ud(e),jn.core.vector_origin_to_ud(t),n,r).map(jn.core.ud_to_vector_origin)},Uc=function axiom7(e,t,n){var r,o=jn.core.intersect_line_line(e.vector,e.origin,t.vector,n,jn.core.include_l,jn.core.include_l);return void 0===o?void 0:{vector:jn.core.normalize2(jn.core.rotate90((r=jn.core).subtract2.apply(r,_toConsumableArray(jn.core.resize_up(o,n))))),origin:jn.core.midpoint2(n,o)}},Zc=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){var n;return{vector:jn.core.normalize2((n=jn.core).subtract2.apply(n,_toConsumableArray(jn.core.resize_up(t,e)))),origin:e}},axiom2:function axiom2(e,t){var n;return{vector:jn.core.normalize2(jn.core.rotate90((n=jn.core).subtract2.apply(n,_toConsumableArray(jn.core.resize_up(t,e))))),origin:jn.core.midpoint2(e,t)}},axiom3:Gc,axiom4:function axiom4(e,t){return{vector:jn.core.rotate90(jn.core.normalize2(e.vector)),origin:t}},axiom5:Dc,axiom6:Rc,axiom7:Uc}),Hc=function reflect_point(e,t){var n=jn.core.make_matrix2_reflect(e.vector,e.origin);return jn.core.multiply_matrix2_vector2(n,t)},Jc=function validate_axiom1_2(e,t){return[e.points.map((function(e){return jn.core.overlap_convex_polygon_point(t,e,ear.math.include)})).reduce((function(e,t){return e&&t}),!0)]},$c=[null,Jc,Jc,function validate_axiom3(e,t){var n=e.lines.map((function(e){return jn.core.clip_line_in_convex_polygon(t,e.vector,e.origin,jn.core.include,jn.core.include_l)}));if(void 0===n[0]||void 0===n[1])return[!1,!1];var r=Gc(e.lines[0],e.lines[1]),o=r.map((function(e){return void 0===e?void 0:jn.core.intersect_convex_polygon_line(t,e.vector,e.origin,ear.math.include_s,ear.math.exclude_l)})),i=[0,1].map((function(e){return void 0!==o[e]})),c=r.map((function(e,t){return void 0===e?void 0:[Hc(e,n[0][0]),Hc(e,n[0][1])]})).map((function(e,t){return void 0!==e&&(jn.core.overlap_line_point(jn.core.subtract(n[1][1],n[1][0]),n[1][0],e[0],jn.core.include_s)||jn.core.overlap_line_point(jn.core.subtract(n[1][1],n[1][0]),n[1][0],e[1],jn.core.include_s)||jn.core.overlap_line_point(jn.core.subtract(e[1],e[0]),e[0],n[1][0],jn.core.include_s)||jn.core.overlap_line_point(jn.core.subtract(e[1],e[0]),e[0],n[1][1],jn.core.include_s))}));return[0,1].map((function(e){return!0===c[e]&&!0===i[e]}))},function validate_axiom4(e,t){var n=jn.core.intersect_line_line(e.lines[0].vector,e.lines[0].origin,jn.core.rotate90(e.lines[0].vector),e.points[0],jn.core.include_l,jn.core.include_l);return[[e.points[0],n].filter((function(e){return void 0!==e})).map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)})).reduce((function(e,t){return e&&t}),!0)]},function validate_axiom5(e,t){var n=Dc(e.lines[0],e.points[0],e.points[1]);if(0===n.length)return[];var r=e.points.map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)})).reduce((function(e,t){return e&&t}),!0);return n.map((function(t){return Hc(t,e.points[1])})).map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)})).map((function(e){return e&&r}))},function validate_axiom6(e,t){var n=Rc(e.lines[0],e.lines[1],e.points[0],e.points[1]);if(0===n.length)return[];if(!e.points.map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)})).reduce((function(e,t){return e&&t}),!0))return n.map((function(){return!1}));var r=n.map((function(t){return Hc(t,e.points[0])})).map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)})),o=n.map((function(t){return Hc(t,e.points[1])})).map((function(e){return jn.core.overlap_convex_polygon_point(t,e,jn.core.include)}));return n.map((function(e,t){return r[t]&&o[t]}))},function validate_axiom7(e,t){var n=jn.core.overlap_convex_polygon_point(t,e.points[0],jn.core.include),r=Uc(e.lines[1],e.lines[0],e.points[0]);if(void 0===r)return[!1];var o=Hc(r,e.points[0]),i=jn.core.overlap_convex_polygon_point(t,o,jn.core.include),c=void 0!==jn.core.intersect_convex_polygon_line(t,e.lines[1].vector,e.lines[1].origin,jn.core.include_s,jn.core.include_l);return[n&&i&&c]}];delete $c[0];var Wc=function validate_axiom(e,t,n){var r="object"===_typeof(n)&&n.vertices_coords?Yo(n).vertices.map((function(e){return n.vertices_coords[e]})):n;return $c[e](t,r)};Object.keys($c).forEach((function(e){Wc[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Wc.apply(void 0,[e].concat(n))}}));var Xc=function axiom_returns_array(e){switch(e){case 3:case"3":case 5:case"5":case 6:case"6":return!0;default:return!1}},Yc=function check_params(e){return{points:(e.points||[]).map((function(e){return jn.core.get_vector(e)})),lines:(e.lines||[]).map((function(e){return jn.core.get_line(e)})),lines_ud:(e.lines||[]).map((function(e){return void 0!==e.u&&void 0!==e.d?e:void 0})).filter((function(e){return void 0!==e}))}},Kc=function axiom_boundaryless(e,t){return t.lines_ud.length===t.lines.length?function axiom_normal_distance(e,t){var n=Vc["axiom".concat(e,"ud")].apply(Vc,_toConsumableArray(t.lines_ud).concat(_toConsumableArray(t.points)));return(Xc(e)?n:[n].filter((function(e){return void 0!==e}))).map((function(e){return jn.line.ud(e)}))}(e,t):function axiom_vector_origin(e,t){var n=Zc["axiom".concat(e)].apply(Zc,_toConsumableArray(t.lines).concat(_toConsumableArray(t.points)));return(Xc(e)?n:[n].filter((function(e){return void 0!==e}))).map((function(e){return jn.line(e)}))}(e,t)},Qc=function filter_with_boundary(e,t,n,r){null!=r&&Wc(e,t,r).forEach((function(e,t){e||delete n[t]}))},ea=function axiom(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Yc(t),o=Kc(e,r);return Qc(e,r,o,n),o};Object.keys(Zc).forEach((function(e){ea[e]=Zc[e]})),Object.keys(Vc).forEach((function(e){ea[e]=Vc[e]})),[1,2,3,4,5,6,7].forEach((function(e){ea[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ea.apply(void 0,[e].concat(n))}})),ea.validate=Wc;var ta=function line_line_for_arrows(e,t){return jn.core.intersect_line_line(e.vector,e.origin,t.vector,t.origin,jn.core.include_l,jn.core.include_l)},na=function reflect_point(e,t){var n=jn.core.make_matrix2_reflect(e.vector,e.origin);return jn.core.multiply_matrix2_vector2(n,t)},ra=function boundary_for_arrows(e){var t=e.vertices_coords;return jn.core.convex_hull(t)},oa=function widest_perp(e,t,n){var r=ra(e);if(void 0===n){var o,i=jn.core.clip_line_in_convex_polygon(r,t.vector,t.origin,jn.core.exclude,jn.core.include_l);n=(o=jn.core).midpoint.apply(o,_toConsumableArray(i))}var c=jn.core.rotate270(t.vector),a=jn.core.clip_line_in_convex_polygon(r,c,n,jn.core.exclude,jn.core.include_l).map((function(e){return jn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=jn.core.scale(jn.core.normalize(c),a);return jn.segment(jn.core.add(n,jn.core.flip(u)),jn.core.add(n,u))},ia=function between_2_segments(e,t,n){var r,o=t.map((function(e){return jn.core.midpoint(e[0],e[1])})),i=(r=jn.line).fromPoints.apply(r,_toConsumableArray(o)),c=jn.intersect(n,i),a=jn.line(n.vector.rotate90(),c);return jn.segment(e.lines.map((function(e){return jn.intersect(e,a)})))},ca=[null,function axiom_1_arrows(e,t){return ea(1,e).map((function(e){return[oa(t,e)]}))},function axiom_2_arrows(e){return[[jn.segment(e.points)]]},function axiom_3_arrows(e,t){var n=ra(t),r=e.lines.map((function(e){return jn.core.clip_line_in_convex_polygon(n,e.vector,e.origin,jn.core.exclude,jn.core.include_l)})),o=r.map((function(e){return jn.core.subtract(e[1],e[0])})),i=jn.core.intersect_line_line(o[0],r[0][0],o[1],r[1][0],jn.core.exclude_s,jn.core.exclude_s);return i?ea(3,e).map((function(t){return function between_2_intersecting_segments(e,t,n,r){var o=e.lines.map((function(e){return e.vector})),i=o.map(jn.core.flip),c=o.concat(i).map((function(e){return jn.ray(e,t)})),a=c.filter((function(e){return jn.core.dot(e.vector,n.vector)>0&&jn.core.cross2(e.vector,n.vector)>0})).shift(),u=c.filter((function(e){return jn.core.dot(e.vector,n.vector)>0&&jn.core.cross2(e.vector,n.vector)<0})).shift(),s=c.filter((function(e){return jn.core.dot(e.vector,n.vector)<0&&jn.core.cross2(e.vector,n.vector)>0})).shift(),l=c.filter((function(e){return jn.core.dot(e.vector,n.vector)<0&&jn.core.cross2(e.vector,n.vector)<0})).shift(),_=[a,u,s,l].map((function(e){return jn.core.intersect_convex_polygon_line(r,e.vector,e.origin,jn.core.exclude_s,jn.core.exclude_r).shift().shift()})),d=_.map((function(e){return jn.core.distance(e,t)})),p=d[0]<d[1]?_[0]:_[1],v=d[0]<d[1]?jn.core.add(u.origin,u.vector.normalize().scale(d[0])):jn.core.add(a.origin,a.vector.normalize().scale(d[1])),g=d[2]<d[3]?_[2]:_[3],m=d[2]<d[3]?jn.core.add(l.origin,l.vector.normalize().scale(d[2])):jn.core.add(s.origin,s.vector.normalize().scale(d[3]));return[jn.segment(p,v),jn.segment(g,m)]}(e,i,t,n)})):[ia(e,r,ea(3,e).filter((function(e){return void 0!==e})).shift())]},function axiom_4_arrows(e,t){return ea(4,e).map((function(n){return[oa(t,n,ta(n,e.lines[0]))]}))},function axiom_5_arrows(e){return ea(5,e).map((function(t){return[jn.segment(e.points[1],na(t,e.points[1]))]}))},function axiom_6_arrows(e){return ea(6,e).map((function(t){return e.points.map((function(e){return jn.segment(e,na(t,e))}))}))},function axiom_7_arrows(e,t){return ea(7,e).map((function(n){return[jn.segment(e.points[0],na(n,e.points[0])),oa(t,n,ta(n,e.lines[1]))]}))}];delete ca[0];var aa=function axiom_arrows(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.points?t.points.map((function(e){return jn.core.get_vector(e)})):void 0,r=t.lines?t.lines.map((function(e){return jn.core.get_line(e)})):void 0,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];return ca[e].apply(ca,[{points:n,lines:r}].concat(i))};Object.keys(ca).forEach((function(e){aa[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return aa.apply(void 0,[e].concat(n))}}));var ua=Object.assign(Object.create(null),{axiom_arrows:aa,simple_arrow:function simple_arrow(e,t){var n=jn.core.convex_hull(e.vertices_coords),r=jn.core.enclosing_rectangle(n),o=function widest_perpendicular(e,t,n){if(void 0===n){var r,o=jn.core.clip_line_in_convex_polygon(e,t.vector,t.origin,jn.core.exclude,jn.core.include_l);if(void 0===o)return;n=(r=jn.core).midpoint.apply(r,_toConsumableArray(o))}var i=jn.core.rotate90(t.vector),c=jn.core.clip_line_in_convex_polygon(e,i,n,jn.core.exclude,jn.core.include_l).map((function(e){return jn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),a=jn.core.scale(jn.core.normalize(i),c);return jn.segment(jn.core.add(n,jn.core.flip(a)),jn.core.add(n,a))}(n,t);if(void 0!==o){var i=ear.math.subtract(o[1],o[0]),c=ear.math.magnitude(i),a=ear.math.dot(i,[1,0]),u=r.width<r.height?r.width:r.height;return o.head={width:.1*u,height:.15*u},o.bend=a>0?.3:-.3,o.padding=.05*c,o}}}),sa=function make_tortilla_tortilla_edges_crossing(e,t,n){var r=t.map((function(e){return 2===e.length&&e[0]!==e[1]})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})),o=Cc(e,n),i=zr(o);return r.map((function(e){return i[e]})).map((function(e,t){return{tortilla_edge:r[t],crossing_edges:e}})).filter((function(e){return e.crossing_edges.length}))},fa=function make_tortillas_faces_crossing(e,t,n){for(var r=Ji(e),o=kc(e,n),i=0;i<o.length;i++)r[i]||o[i].reverse();var c=t.map((function(e){return 2===e.length&&e[0]!==e[1]})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})),a=c.map((function(t){return e.edges_vertices[t]})).map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),u=a.map((function(e){return jn.core.subtract2(e[1],e[0])})),s=[];return c.forEach((function(e){s[e]=[]})),c.map((function(e,t){return o.map((function(e,r){return jn.core.clip_line_in_convex_polygon(e,u[t],a[t][0],jn.core.exclude,jn.core.exclude_s,n)})).map((function(e,t){return void 0!==e}))})).forEach((function(e,t){return e.forEach((function(e,n){e&&s[c[t]].push(n)}))})),s},la=function make_tortilla_tortilla_faces_crossing(e,t,n){return sa(e,t,n),fa(e,t,n).map((function(t,n){return t.map((function(t){return[e.edges_faces[n],[t,t]]}))})).reduce((function(e,t){return e.concat(t)}),[])},_a=Object.freeze({__proto__:null,make_tortilla_tortilla_edges_crossing:sa,make_tortillas_faces_crossing:fa,make_tortilla_tortilla_faces_crossing:la}),da=function make_edges_faces_side(e,t){var n=e.edges_vertices.map((function(t){return e.vertices_coords[t[0]]})),r=e.edges_vertices.map((function(t){return jn.core.subtract2(e.vertices_coords[t[1]],e.vertices_coords[t[0]])}));return e.edges_faces.map((function(e,o){return e.map((function(e){return jn.core.cross2(jn.core.subtract2(t[e],n[o]),r[o])})).map((function(e){return Math.sign(e)}))}))},pa=function make_tacos_faces_side(e,t,n,r){var o=n.map((function(t){return e.edges_vertices[t[0]].map((function(t){return e.vertices_coords[t]}))})),i=o.map((function(e){return e[0]})),c=o.map((function(e){return jn.core.subtract2(e[1],e[0])}));return r.map((function(e){return e.map((function(e){return e.map((function(e){return t[e]}))}))})).map((function(e,t){return e.map((function(e){return e.map((function(e){return jn.core.cross2(jn.core.subtract2(e,i[t]),c[t])})).map((function(e){return Math.sign(e)}))}))}))},va=function classify_faces_pair(e){return 1===e[0]&&-1===e[1]||-1===e[0]&&1===e[1]?"both":1===e[0]&&1===e[1]?"right":-1===e[0]&&-1===e[1]?"left":void 0},ga=function is_taco_taco(e){return e[0]===e[1]&&"both"!==e[0]},ma=function is_tortilla_tortilla(e){return e[0]===e[1]&&"both"===e[0]},ha=function is_taco_tortilla(e){return e[0]!==e[1]&&("both"===e[0]||"both"===e[1])},ya=function make_taco_tortilla(e,t,n){var r="left"===t[0]||"left"===t[1]?-1:1,o="both"===t[0]?_toConsumableArray(e[1]):_toConsumableArray(e[0]),i="both"===t[0]?0:1;return{taco:o,tortilla:n[i][0]===r?e[i][0]:e[i][1]}},ba=function make_tortilla_tortilla(e,t){if(void 0!==e)return t[0][0]===t[1][0]?e:[e[0],[e[1][1],e[1][0]]]},Aa=function make_tacos_tortillas(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON,n=Oo(e),r=da(e,n),o=jc(e,t),i=Nr(o).filter((function(t){return t.map((function(t){return e.edges_faces[t].length>1})).reduce((function(e,t){return e&&t}),!0)})),c=i.map((function(t){return t.map((function(t){return e.edges_faces[t]}))})),a=pa(e,n,i,c),u=a.map((function(e,t){return e.map(va)})),s=u.map((function(e,t){return ga(e)?c[t]:void 0})).filter((function(e){return void 0!==e})),l=u.map((function(e,t){return ma(e)?c[t]:void 0})).map((function(e,t){return ba(e,a[t])})).filter((function(e){return void 0!==e})),_=la(e,r,t),d=l.concat(_),p=u.map((function(e,t){return ha(e)?ya(c[t],u[t],a[t]):void 0})).filter((function(e){return void 0!==e})),v=xc(e,t),g=zr(v).map((function(e,t){return r[t].length>1&&r[t][0]===r[t][1]?e:[]})),m=g.map((function(t,n){return{taco:e.edges_faces[n],tortillas:t}})).filter((function(e){return e.tortillas.length})),h=m.map((function(e){return e.tortillas.map((function(t){return{taco:_toConsumableArray(e.taco),tortilla:t}}))})).reduce((function(e,t){return e.concat(t)}),[]),b=p.concat(h).sort((function(e,t){return e.tortilla-t.tortilla}));return{taco_taco:s,tortilla_tortilla:d,taco_tortilla:b}},xa=function make_transitivity_trios(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jn.core.EPSILON;t||(t=wc(e,r)),n||(n=Ji(e));var o=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))}));o.forEach((function(e,t){n[t]||e.reverse()}));for(var i=e.faces_vertices.map((function(){return[]})),c=0;c<i.length-1;c++)for(var a=c+1;a<i.length;a++)if(t[c][a]){var u=jn.core.intersect_polygon_polygon(o[c],o[a],r);u&&(i[c][a]=u)}for(var s=[],l=0;l<i.length-1;l++)for(var _=l+1;_<i.length;_++)if(i[l][_])for(var d=_+1;d<i.length;d++)if(l!==d&&_!==d&&t[l][d]&&t[_][d]){var p=jn.core.intersect_polygon_polygon(i[l][_],o[d],r);p&&s.push([l,_,d].sort((function(e,t){return e-t})))}return s},ka=function filter_transitivity(e,t){var n={};return t.taco_taco.map((function(e){return[[e[0][0],e[0][1],e[1][0]],[e[0][0],e[0][1],e[1][1]],[e[0][0],e[1][0],e[1][1]],[e[0][1],e[1][0],e[1][1]]]})).forEach((function(e){return e.map((function(e){return e.sort((function(e,t){return e-t})).join(" ")})).forEach((function(e){n[e]=!0}))})),t.taco_tortilla.map((function(e){return[e.taco[0],e.taco[1],e.tortilla]})).map((function(e){return e.sort((function(e,t){return e-t})).join(" ")})).forEach((function(e){n[e]=!0})),e.filter((function(e){return void 0===n[e.join(" ")]}))},wa=function make_maps(e){return e.map((function(e){var t=e.map((function(e){return e[0]<e[1]}));return{face_keys:e.map((function(e,n){return t[n]?"".concat(e[0]," ").concat(e[1]):"".concat(e[1]," ").concat(e[0])})),keys_ordered:t}}))},Ea=function make_taco_maps(e,t){var n=function refactor_pairs(e,t){var n={};return n.taco_taco=e.taco_taco.map((function(e){return[[e[0][0],e[0][1]],[e[1][0],e[1][1]],[e[1][0],e[0][1]],[e[0][0],e[1][1]],[e[0][0],e[1][0]],[e[0][1],e[1][1]]]})),n.taco_tortilla=e.taco_tortilla.map((function(e){return[[e.taco[0],e.taco[1]],[e.taco[0],e.tortilla],[e.tortilla,e.taco[1]]]})),n.tortilla_tortilla=e.tortilla_tortilla.map((function(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]})),n.transitivity=t.map((function(e){return[[e[0],e[1]],[e[1],e[2]],[e[2],e[0]]]})),n}(e,t);return{taco_taco:wa(n.taco_taco),taco_tortilla:wa(n.taco_tortilla),tortilla_tortilla:wa(n.tortilla_tortilla),transitivity:wa(n.transitivity)}},Oa=function make_conditions(e,t,n){n||(n=Ji(e)),t||(t=wc(e));var r={},o={0:0,1:2,2:1};Nr(t).map((function(e){return e.join(" ")})).forEach((function(e){r[e]=0}));var i={M:1,m:1,V:2,v:2};return e.edges_faces.forEach((function(t,c){var a=e.edges_assignment[c],u=i[a];if(!(t.length<2||void 0===u)){var s=n[t[0]]?u:o[u],l="".concat(t[0]," ").concat(t[1]),_="".concat(t[1]," ").concat(t[0]);l in r&&(r[l]=s),_ in r&&(r[_]=o[s])}})),r},Ca=function make_lookup(e){var t=e[0].length,n=Array.from(Array(t+1)).map((function(){return{}}));Array.from(Array(Math.pow(2,t))).map((function(e,t){return t.toString(2)})).map((function(e){return Array.from(e).map((function(e){return parseInt(e)+1})).join("")})).map((function(e){return("11111"+e).slice(-t)})).forEach((function(e){n[0][e]=!1})),e.forEach((function(e){n[0][e]=!0})),Array.from(Array(t)).map((function(e,t){return t+1})).map((function(e){return Array.from(Array(Math.pow(3,t))).map((function(e,t){return t.toString(3)})).map((function(e){return("000000"+e).slice(-t)})).forEach((function(t){return function check_state(e,t,n){var r=Array.from(n).map((function(e){return parseInt(e)}));if(r.filter((function(e){return 0===e})).length===t){e[t][n]=!1;for(var o=!1,i=0;i<r.length;i++){var c=[];if(0===r[i]){for(var a=1;a<=2;a++)r[i]=a,!1!==e[t-1][r.join("")]&&c.push([i,a]);r[i]=0,c.length>0&&!1===o&&(o=[]),1===c.length&&o.push(c[0])}}!1!==o&&0===o.length&&(o=!0),e[t][n]=o}}(n,e,t)}))}));var r=[];Array.from(Array(t+1)).map((function(e,n){return t-n})).forEach((function(e){var t=[];Object.keys(n[e]).forEach((function(r){var o=n[e][r];o.constructor===Array&&(o=o[0]),t.push([r,o])})),r=r.concat(t)})),r.sort((function(e,t){return parseInt(e[0])-parseInt(t[0])}));var o={};return r.forEach((function(e){o[e[0]]=Object.freeze(e[1])})),Object.freeze(o)},ja={taco_taco:Ca(["111112","111121","111222","112111","121112","121222","122111","122212","211121","211222","212111","212221","221222","222111","222212","222221"]),taco_tortilla:Ca(["112","121","212","221"]),tortilla_tortilla:Ca(["11","22"]),transitivity:Ca(["112","121","122","211","212","221"])},Ma=Object.freeze(Object.keys(ja)),Pa={0:0,1:2,2:1},Sa=function fill_layers_from_conditions(e,t,n){return e.forEach((function(r,o){return t[o].face_keys.forEach((function(r,i){if(r in n){if(0!==n[r]){var c=t[o].keys_ordered[i]?n[r]:Pa[n[r]];if(0!==e[o][i]&&e[o][i]!==c)throw"fill conflict";e[o][i]=c}}else console.warn(r,"not in conditions")}))}))},za=function infer_next_steps(e,t,n){return e.map((function(r,o){var i=t[o],c=r.join(""),a=n[c];if(!1===a)throw"unsolvable";if(!0!==a){if(0!==r[a[0]]&&r[a[0]]!==a[1])throw"infer conflict";return e[o][a[0]]=a[1],[i.face_keys[a[0]],i.keys_ordered[a[0]]?a[1]:Pa[a[1]]]}})).filter((function(e){return void 0!==e}))},Na=function complete_suggestions_loop(e,t,n,r){var o;do{try{for(var i=0;i<Ma.length;i++){var c=Ma[i];Sa(e[c],t[c],n)}(o=Ma.map((function(n){return za(e[n],t[n],ja[n])})).reduce((function(e,t){return e.concat(t)}),[])).forEach((function(e){n[e[0]]=e[1]}))}catch(e){return!1}}while(o.length>0);return!0},Ia=function hashCode(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t},La={0:0,1:1,2:-1},qa={0:0,1:1,"-1":2},Ta=function unsigned_to_signed_conditions(e){return Object.keys(e).forEach((function(t){e[t]=La[e[t]]})),e},Fa=Object.freeze({__proto__:null,unsigned_to_signed_conditions:Ta,signed_to_unsigned_conditions:function signed_to_unsigned_conditions(e){return Object.keys(e).forEach((function(t){e[t]=qa[e[t]]})),e}}),Ba=function count_zeros(e){return Object.keys(e).filter((function(t){return 0===e[t]})).length},Va=Object.freeze(Object.keys(ja)),Ga=function solver_single(e,t,n){var r,o=new Date,i=0,c=0,a={},u={taco_taco:t.taco_taco.map((function(e){return Array(6).fill(0)})),taco_tortilla:t.taco_tortilla.map((function(e){return Array(3).fill(0)})),tortilla_tortilla:t.tortilla_tortilla.map((function(e){return Array(2).fill(0)})),transitivity:t.transitivity.map((function(e){return Array(3).fill(0)}))};Na(u,t,n);var s=function _loop(){i++;var e=Object.keys(n).map((function(e){return 0===n[e]?e:void 0})).filter((function(e){return void 0!==e}));if(0===e.length)return r=n,"break";var o={},s=e.map((function(e,r){return[1,2].map((function(r){if(!o[e]||!o[e][r]){var i=JSON.parse(JSON.stringify(n));if(a[JSON.stringify(i)])console.log("early hash caught!");else{var s=function duplicate_unsolved_layers(e){var t={};return Va.forEach((function(e){t[e]=[]})),Va.forEach((function(n){return e[n].forEach((function(e,r){-1!==e.indexOf(0)&&(t[n][r]=_toConsumableArray(e))}))})),t}(u);if(i[e]=r,c++,Na(s,t,i))return Object.keys(i).filter((function(e){return 0===n[e]})).forEach((function(e){o[e]||(o[e]={}),o[e][r]=!0})),{conditions:i,layers:s,zero_count:Ba(i)}}}})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[]).sort((function(e,t){return t.zero_count-e.zero_count})),l=s.map((function(e){return JSON.stringify(e.conditions)})).map((function(e){return Ia(e)})).map((function(e,t){if(!a[e])return a[e]=s[t],s[t]})).filter((function(e){return void 0!==e}));if(!l.length)return console.warn("ran out of successes"),{v:void 0};n=l[0].conditions,u=l[0].layers};do{var l=s();if("break"===l)break;if("object"===_typeof(l))return l.v}while(void 0===r);return Ta(r),console.log("".concat(Date.now()-o,"ms recurse_count"),i,"inner_loop_count",c),r},Da=Object.freeze(Object.keys(ja)),Ra=function recursive_solver(e,t,n){var r=new Date,o=0,i=0,c={},a={taco_taco:t.taco_taco.map((function(e){return Array(6).fill(0)})),taco_tortilla:t.taco_tortilla.map((function(e){return Array(3).fill(0)})),tortilla_tortilla:t.tortilla_tortilla.map((function(e){return Array(2).fill(0)})),transitivity:t.transitivity.map((function(e){return Array(3).fill(0)}))};Na(a,t,n);var u=n,s=function recurse(e,n){o++;var r=Object.keys(n).map((function(e){return 0===n[e]?e:void 0})).filter((function(e){return void 0!==e}));if(0===r.length)return[n];var a={},u=r.map((function(r,o){return[1,2].map((function(o){if(!a[r]||!a[r][o])if(function precheck(e,t,n,r){try{Da.forEach((function(o){return e.forEach((function(e,i){for(var c=t[o][i],a=0;a<c.face_keys.length;a++)if(c.face_keys[a]===n){var u=c.keys_ordered[a]?r:flip[r],s=_toConsumableArray(e);s[a]=u;var l=s.join("");if(!1===ja[o][l])throw console.log("precheck found a fail case",n,o,l,ja[type][l]),"precheck"}}))}))}catch(e){return!1}return!0}(e,t,r,o))console.log("precheck caught!");else{var u=JSON.parse(JSON.stringify(n));if(c[JSON.stringify(u)])console.log("early hash caught!");else{var s=function duplicate_unsolved_layers(e){var t={};return Da.forEach((function(e){t[e]=[]})),Da.forEach((function(n){return e[n].forEach((function(e,r){-1!==e.indexOf(0)&&(t[n][r]=_toConsumableArray(e))}))})),t}(e);if(u[r]=o,i++,Na(s,t,u))return Object.keys(u).filter((function(e){return 0===n[e]})).forEach((function(e){a[e]||(a[e]={}),a[e][o]=!0})),{conditions:u,layers:s}}}})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[]);return u.map((function(e){return JSON.stringify(e.conditions)})).map((function(e){return Ia(e)})).map((function(e,t){if(!c[e])return c[e]=u[t],u[t]})).filter((function(e){return void 0!==e})).map((function(e){return recurse(e.layers,e.conditions)})).reduce((function(e,t){return e.concat(t)}),[])}(a,n);s.certain=JSON.parse(JSON.stringify(u));for(var l=0;l<s.length;l++)Ta(s[l]);return Ta(s.certain),console.log("".concat(Date.now()-r,"ms recurse_count"),o,"inner_loop_count",i),s},Ua=function dividing_axis(e,t,n){var r=Co(e).map((function(e){return jn.core.subtract2(e,t.origin)})).map((function(e){return jn.core.cross2(t.vector,e)})).map((function(e){return Math.sign(e)})),o=Object.keys(n).map((function(e){var t=e.split(" ");if(0!==n[e])return 2===n[e]&&t.reverse(),1===r[t[0]]&&-1===r[t[1]]||(-1!==r[t[0]]||1!==r[t[1]])&&void 0})).filter((function(e){return void 0!==e}));if(o.reduce((function(e,t){return e&&t===o[0]}),!0)){var i=o[0];Object.keys(n).forEach((function(e){var t=e.split(" ");0===n[e]&&r[t[0]]!==r[t[1]]&&(1===r[t[0]]&&-1===r[t[1]]&&(n[e]=i?1:2),-1===r[t[0]]&&1===r[t[1]]&&(n[e]=i?2:1))}))}else console.warn("line is not a dividing axis")},Za=Object.freeze({__proto__:null,dividing_axis:Ua}),Ha=function make_maps_and_conditions(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6,n=wc(e,t),r=Ji(e),o=Oa(e,n,r),i=Aa(e,t),c=xa(e,n,r,t),a=ka(c,i),u=Ea(i,a);return{maps:u,conditions:o}},Ja=function all_layer_conditions(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6,n=Ha(e,t);return Ra(0,n.maps,n.conditions)},$a=function make_maps_and_conditions_dividing_axis(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,o=wc(e,r),i=Ji(e),c=Oa(e,o,i);Ua(t,n,c);var a=Aa(e,r),u=xa(e,o,i,r),s=ka(u,a),l=Ea(a,s);return{maps:l,conditions:c}},Wa=Object.freeze({__proto__:null,one_layer_conditions:function one_layer_conditions(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6,n=Ha(e,t);return Ga(0,n.maps,n.conditions)},all_layer_conditions:Ja,one_layer_conditions_with_axis:function one_layer_conditions_with_axis(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,o=$a(e,t,n,r);return Ga(0,o.maps,o.conditions)},all_layer_conditions_with_axis:function all_layer_conditions_with_axis(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,o=$a(e,t,n,r);return Ra(0,o.maps,o.conditions)}}),Xa=function conditions_to_matrix(e){var t=Object.keys(e).map((function(e){return e.split(" ").map((function(e){return parseInt(e)}))})),n=[];t.reduce((function(e,t){return e.concat(t)}),[]).forEach((function(e){return n[e]=void 0}));var r=n.map((function(){return[]}));return t.map((function(t){var n=_slicedToArray(t,2),o=n[0],i=n[1];r[o][i]=e["".concat(o," ").concat(i)],r[i][o]=-e["".concat(o," ").concat(i)]})),r},Ya=function topological_order(e){for(var t=Xa(e),n=t.map((function(e,t){return e.map((function(e){return-1===e?1:0})).reduce((function(e,t){return e+t}),0)})),r=[],o=n.length,i=0;i<o;i++){var c=n.indexOf(0);if(-1===c)return console.warn("cycle detected"),[];r.push(c),t[c].forEach((function(e,t){1===e&&n[t]--})),delete n[c]}return r.reverse()},Ka=Object.freeze({__proto__:null,faces_layer_to_edges_assignments:function faces_layer_to_edges_assignments(e,t){var n=[],r=Ji(e);return(e.edges_faces?e.edges_faces:po(e)).forEach((function(e,o){if(1===e.length&&(n[o]="B"),2===e.length){var i=e.map((function(e){return r[e]}));if(i[0]===i[1])return"F";var c=e.map((function(e){return t[e]})),a=c[0]<c[1],u=i[0]?a:!a;n[o]=u?"V":"M"}})),n}}),Qa=function maekawa_assignments(e){var t=function get_unassigned_indices(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r}));if(e.includes("B")||e.includes("b"))return n;var r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),o=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-o[t])}))},eu=Object.assign(Object.create(null),{make_faces_layers:function make_faces_layers(e,t){return Ja(e,t).map(Ya).map(To)},make_faces_layers_async:function make_faces_layers_async(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,r=new Promise((function(e,t){setTimeout((function(){return t()}),n)})),o=new Promise((function(n,r){return n(Ja(e,t))}));return Promise.race([o,r]).then((function(e){return e.map(Ya).map(To)})).catch((function(e){return console.warn("make_faces_layers_async timeout. to increase timeout, use third parameter (graph, epsilon, timeout)"),[]}))},assignment_solver:function assignment_solver(e,t,n){null==t&&(t=e.map((function(){return"U"})));var r=Qa(t),o=r.map((function(t){return yc(e,t,n)}));return r.map((function(e,t){return t})).filter((function(e){return o[e].length>0})).map((function(e){return{assignment:r[e],layer:o[e]}}))},single_vertex_solver:yc,validate_layer_solver:lc,validate_taco_taco_face_pairs:sc,validate_taco_tortilla_strip:uc,table:ja,topological_order:Ya,make_conditions:Oa,conditions_to_matrix:Xa,make_tacos_tortillas:Aa,make_folded_strip_tacos:cc,make_transitivity_trios:xa},Wa,Fa,Ka,Za,_a,mc),tu=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var o=0;o<e.length;o+=1){if(t>n&&("V"===e[o]||"v"===e[o]))return o;if(n>t&&("M"===e[o]||"m"===e[o]))return o}},nu=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(Cr,0)}))},ru=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){var t;return(t=jn.core).counter_clockwise_angle_radians.apply(t,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return nu(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return jn.core.is_counter_clockwise_between(t,e[n],e[(n+1)%e.length])?t:void 0}))},ou=function kawasaki_solutions_vectors(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return ru(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))},iu=Object.freeze({__proto__:null,alternating_sum:nu,alternating_sum_difference:function alternating_sum_difference(e){var t=e.reduce(Cr,0)/2;return nu(e).map((function(e){return e-t}))},kawasaki_solutions_radians:ru,kawasaki_solutions_vectors:ou}),cu=Object.freeze({__proto__:null,kawasaki_solutions:function kawasaki_solutions(e,t){var n=e.vertices_coords,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_vectors;i||(i=yo({vertices_coords:n,edges_vertices:o})),r||(r=make_vertices_edges({edges_vertices:o}));var c=r[t].map((function(e){return i[e]})),a=jn.core.counter_clockwise_order2(c).map((function(e){return c[e]}));return ou(a)}}),au={M:-1,m:-1,V:1,v:1},uu=Object.freeze({__proto__:null,validate_maekawa:function validate_maekawa(e){var t=e.edges_vertices,n=e.vertices_edges,r=e.edges_assignment;n||(n=no({edges_vertices:t}));var o=Array(n.length).fill(!1);return Xo({edges_vertices:t,edges_assignment:r}).forEach((function(e){o[e]=!0})),n.map((function(e){return e.map((function(e){return au[r[e]]})).reduce((function(e,t){return e+t}),0)})).map((function(e,t){return o[t]||2===e||-2===e})).map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},validate_kawasaki:function validate_kawasaki(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_assignment,c=e.edges_vector,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn.core.EPSILON;n||(n=oo({vertices_coords:t,vertices_edges:r,edges_vertices:o}));var u=Array(t.length).fill(!1);Xo({edges_vertices:o,edges_assignment:i}).forEach((function(e){u[e]=!0}));var s=lo({vertices_coords:t,vertices_vertices:n,edges_vertices:o,edges_vector:c}).map((function(e){return nu(e)})).map((function(e,t){return u[t]||Math.abs(e[0]-e[1])<a}));return s.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))}}),su=Object.assign(Object.create(null),{maekawa_assignments:Qa,fold_angles4:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=tu(t);if(void 0!==r){var o=e[(r+1)%e.length],i=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(o)*Math.cos(i)+Math.sin(o)*Math.sin(i)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(o)*Math.sin(i)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},iu,cu,uu),fu={axioms:{ar:[null,"   ","        ","        ","          ","         ","            ","          "],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una lnea entre dos puntos","dobla dos puntos juntos","dobla y une dos lneas","dobla una lnea sobre s misma, doblndola hacia un punto","dobla un punto hasta una lnea, doblndola a travs de otro punto","dobla un punto hacia una lnea y otro punto hacia otra lnea","dobla un punto hacia una lnea y otra lnea sobre s misma"],fr:[null,"crez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-mme  l'aide d'un pli qui passe par un point","rabattez un point sur une ligne  l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-mme"],hi:[null,"        ","         ","        ","                  ","                 ","                   ","                      "],jp:[null,"2","2","2","","","",""],ko:[null,"    ","   ","   ","      ","  ,    ","       ","       "],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto at uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto at uma linha e outro ponto at outra linha","dobre um ponto at uma linha e outra linha sobre si mesma"],ru:[null,"    ","   ","   ","   ,   ","   ,    ","         ","        "],tr:[null,"iki noktadan geen bir izgi boyunca katla","iki noktay birbirine katla","iki izgiyi birbirine katla","bir noktadan kvrarak kendi zerindeki bir izgi boyunca katla","baka bir noktadan kvrarak bir noktay bir izgiye katla","bir noktay bir izgiye ve baka bir noktay baka bir izgiye katla","bir noktay bir izgiye ve baka bir izgiyi kendi zerine katla"],vi:[null,"to mt np gp i qua hai im","to np gp bng cch gp mt im ny sang im khc","to np gp bng cch gp mt ng ln mt ng khc","to mt np gp i qua mt im v a mt ng ln trn chnh n","to mt np gp i qua im u tin v a im th hai ln ng thng","to mt np gp mang im u tin n ng u tin v im th hai cho ng th hai","to mt np gp mang li mt im cho mt ng v a mt ng th hai ln trn chnh n"],zh:[null,"","","","","","",""]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaa",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"",mountain:"",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",blintz:"",squash:"",flip:""}}},lu={},_u={stroke:Qn},du={},pu={m:{stroke:"red"},v:{stroke:"blue"},f:{stroke:"lightgray"}},vu=function edges_path_data(e){return function edges_coords(e){var t=e.vertices_coords,n=e.edges_vertices;return t&&n?n.map((function(e){return e.map((function(e){return t[e]}))})):[]}(e).map((function(e){return function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])}(e)})).join("")},gu=function edges_path_data_assign(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment;if(!t||!n)return{};if(!r)return{u:vu({vertices_coords:t,edges_vertices:n})};var o=function edges_assignment_indices(e){var t={u:[],f:[],v:[],m:[],b:[]},n=e[Jn].map((function(e){return lr[e]}));return e.edges_vertices.map((function(e,t){return n[t]||"u"})).forEach((function(e,n){return t[e].push(n)})),t}({vertices_coords:t,edges_vertices:n,edges_assignment:r});return Object.keys(o).forEach((function(e){o[e]=vu({vertices_coords:t,edges_vertices:o[e].map((function(e){return n[e]}))})})),Object.keys(o).forEach((function(e){""===o[e]&&delete o[e]})),o},mu=function edges_paths_assign(t){var n=t.vertices_coords,r=t.edges_vertices,o=t.edges_assignment,i=gu({vertices_coords:n,edges_vertices:r,edges_assignment:o});return Object.keys(i).forEach((function(t){var n=e.svg.path(i[t]);n.setAttributeNS(null,Fn,fr[t]),i[t]=n})),i},hu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},yu={back:{fill:er},front:{fill:"#ddd"}},bu={back:{opacity:.1},front:{opacity:.1}},Au={},xu={stroke:Qn,"stroke-linejoin":"bevel"},ku={stroke:tr,fill:Qn,"stroke-linejoin":"bevel"},wu={fill:tr},Eu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},Ou=function finalize_faces(e,t,n,r){var o=oc(e),i=null!=e.faces_layer&&e.faces_layer.length===e.faces_vertices.length,c=[[Xn],[Yn]],a=Ji(e);return a.map((function(e){return e?c[0]:c[1]})).forEach((function(e,n){t[n].setAttributeNS(null,Fn,e),Eu(t[n],o?i?yu[e]:bu[e]:Au[e]),Eu(t[n],r[e])})),(i?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e.faces_layer).map((function(e){return t[e]})):t).forEach((function(e){return n.appendChild(e)})),Object.defineProperty(n,Xn,{get:function get(){return t.filter((function(e,t){return a[t]}))}}),Object.defineProperty(n,Yn,{get:function get(){return t.filter((function(e,t){return!a[t]}))}}),Eu(n,o?i?xu:ku:wu),n},Cu={fill:tr},ju={stroke:Qn,fill:er},Mu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},Pu={vertices:function vertices_circle(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();return t&&t.vertices_coords?(t.vertices_coords.map((function(t){return e.svg.circle(t[0],t[1],.01)})).forEach((function(e){return r.appendChild(e)})),r.setAttributeNS(null,"fill",tr),Object.keys(n).forEach((function(e){return r.setAttributeNS(null,e,n[e])})),r):r},edges:function edges_paths(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t)return r;var o=oc(t),i=mu(t);return Object.keys(i).forEach((function(e){i[e].setAttributeNS(null,Fn,fr[e]),hu(i[e],o?du[e]:pu[e]),hu(i[e],n[e]),hu(i[e],n[fr[e]]),r.appendChild(i[e]),Object.defineProperty(r,fr[e],{get:function get(){return i[e]}})})),hu(r,o?lu:_u),hu(r,n.stroke?{stroke:n.stroke}:{}),r},faces:function faces_draw_function(t,n){return null!=t&&null!=t.faces_vertices?function faces_vertices_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t||!t.vertices_coords||!t.faces_vertices)return r;var o=t.faces_vertices.map((function(e){return e.map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}))})).map((function(t){return e.svg.polygon(t)}));return o.forEach((function(e,t){return e.setAttributeNS(null,Bn,t)})),r.setAttributeNS(null,"fill",er),Ou(t,o,r,n)}(t,n):function faces_edges_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!t||Hn in t==0||Zn in t==0||Un in t==0)return r;var o=t.faces_edges.map((function(e){return e.map((function(e){return t.edges_vertices[e]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}))})).map((function(t){return e.svg.polygon(t)}));return o.forEach((function(e,t){return e.setAttributeNS(null,Bn,t)})),r.setAttributeNS(null,"fill","white"),Ou(t,o,r,n)}(t,n)},boundaries:function boundaries_polygon(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.svg.g();if(!(t&&t.vertices_coords&&t.edges_vertices&&t.edges_assignment))return r;var o=Yo(t).vertices.map((function(e){return[0,1].map((function(n){return t.vertices_coords[e][n]}))}));if(0===o.length)return r;var i=e.svg.polygon(o);return i.setAttributeNS(null,Fn,Wn),r.appendChild(i),Mu(r,oc(t)?Cu:ju),Object.keys(n).forEach((function(e){return r.setAttributeNS(null,e,n[e])})),r}},Su=function draw_group(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Pu[e].apply(Pu,n);return o.setAttributeNS(null,Fn,e),o},zu=function DrawGroups(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[Rn,Dn,Gn,Vn].map((function(n){return Su(n,e,t[n])}))};[Rn,Dn,Gn,Vn].forEach((function(e){zu[e]=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Su(e,t,n[e])}}));var Nu,Iu=function fold_classes(e){return[e.file_classes?e.file_classes:[],e.frame_classes?e.frame_classes:[]].reduce((function(e,t){return e.concat(t)}))},Lu=function bounding_rect(e){var t=e.vertices_coords;if(!(null==t||t.length<=0)){var n=Array(2).fill(1/0),r=Array(2).fill(-1/0);return t.forEach((function(e){e[0]<n[0]&&(n[0]=e[0]),e[0]>r[0]&&(r[0]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>r[1]&&(r[1]=e[1])})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?void 0:[n[0],n[1],r[0]-n[0],r[1]-n[1]]}},qu=function make_svg_attributes(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r={overflow:"visible"};if(!e)return r;var o=Lu(e);if(o&&n){r.viewBox=o.join(" ");var i=Math.max(o[2],o[3]);r[nr]=i/100,r.width=o[2],r.height=o[3]}return r.class=["origami"].concat(Iu(e)).join(" "),r},Tu=function setR(e,t){for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].setAttributeNS(null,"r",t)},Fu=function drawInto(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i=r.filter((function(e){return _typeof(e)===Tn})).shift()||{},c=r.filter((function(e){return _typeof(e)===Ln})).shift(),a=qu(t,i,c);Object.keys(a).forEach((function(t){return e.setAttributeNS(null,t,a[t])}));var u=zu(t,i);return u.filter((function(e){return e.childNodes.length>0})).forEach((function(t){return e.appendChild(t)})),a[nr]&&Tu(u[3],2*a[nr]),Object.keys(zu).forEach((function(t,n){return Object.defineProperty(e,t,{get:function get(){return u[n]}})})),e},Bu=function FOLDtoSVG(t,n,r){return Fu(e.svg(),t,n,r)};Object.keys(zu).forEach((function(e){Bu[e]=zu[e]})),Bu.drawInto=Fu,Object.defineProperty(Bu,"linker",{enumerable:!1,value:function linker(e){e.graph.svg=this;var t={svg:this};Object.keys(t).forEach((function(n){e.graph.prototype[n]=function(){return t[n].apply(t,[this].concat(Array.prototype.slice.call(arguments)))}}))}.bind(Bu)});var Vu={init:function init(){}};function SVG(){return Vu.init.apply(Vu,arguments)}var Gu="class",Du="function",Ru="undefined",Uu="number",Zu="string",Hu="object",Ju="svg",$u="path",Wu="id",Xu="style",Yu="viewBox",Ku="transform",Qu="points",es="stroke",ts="none",ns="arrow",rs="head",os="tail",is=("undefined"==typeof window?"undefined":_typeof(window))!==Ru&&_typeof(window.document)!==Ru,cs=("undefined"==typeof process?"undefined":_typeof(process))!==Ru&&null!=process.versions&&null!=process.versions.node,as=("undefined"==typeof self?"undefined":_typeof(self))===Hu&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,us=Object.freeze({__proto__:null,isBrowser:is,isNode:cs,isWebWorker:as}),ss=function(){var e={};if(cs){var t=require("@xmldom/xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else is&&(e=window);return e}(),fs="http://www.w3.org/2000/svg",ls={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},_s=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},ds=function arcPath(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==o)return"";var c=_s(r,n),a=_s(o,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],_=Math.atan2(s,l)>0?0:1,d=i?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return d+=["a ",n,n,0,_,1,u[0],u[1]].join(" "),i&&(d+=" Z"),d},ps=function arcArguments(e,t,n,r,o){return[ds(e,t,n,r,o,!1)]},vs={arc:{nodeName:$u,attributes:["d"],args:ps,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",ps.apply(void 0,n))}}}},gs=function wedgeArguments(e,t,n,r,o){return[ds(e,t,n,r,o,!0)]},ms={wedge:{nodeName:$u,args:gs,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",gs.apply(void 0,n))}}}},hs=128,ys=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-hs)/hs*2+1})).map((function(o){return[e+(o+1)*n*.5,t+Math.pow(o,2)*r]}))},bs={parabola:{nodeName:"polyline",attributes:[Qu],args:function parabolaPathString(e,t,n,r){return[ys(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},As=function regularPolygonArguments(e,t,n,r){var o=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return o.map((function(t,n){return t+r*e[n]}))}))},xs={regularPolygon:{nodeName:"polygon",attributes:[Qu],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[As(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},ks={roundRect:{nodeName:$u,attributes:["d"],args:function roundRectArguments(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o>n/2&&(o=n/2),o>r/2&&(o=r/2);var i=n-2*o,c=r-2*o,a="A".concat(o," ").concat(o," 0 0 1");return["M".concat(e+(n-i)/2,",").concat(t),"h".concat(i),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-o,",").concat(t+r),"h".concat(-i),a,"".concat(e,",").concat(t+r-o),"v".concat(-c),a,"".concat(e+o,",").concat(t)].join(" ")}}},ws={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},Es=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===Du},Os=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return Es(arguments[0])&&_typeof(arguments[0])!==Zu?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return Es(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},Cs=function flatten_arrays(){return Os(arguments).reduce((function(e,t){return e.concat(t)}),[])},js=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===Uu})).concat(t.filter((function(e){return _typeof(e)===Hu&&null!==e})).map((function(e){return _typeof(e.x)===Uu?[e.x,e.y]:_typeof(e[0])===Uu?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},Ms=function magnitudeSq2(e){return Math.pow(e[0],2)+Math.pow(e[1],2)},Ps=function magnitude2(e){return Math.sqrt(Ms(e))},Ss=function distanceSq2(e,t){return Ms(Is(e,t))},zs=function distance2(e,t){return Math.sqrt(Ss(e,t))},Ns=function add2(e,t){return[e[0]+t[0],e[1]+t[1]]},Is=function sub2(e,t){return[e[0]-t[0],e[1]-t[1]]},Ls=function scale2(e,t){return[e[0]*t,e[1]*t]},qs=Object.freeze({__proto__:null,magnitudeSq2:Ms,magnitude2:Ps,distanceSq2:Ss,distance2:zs,add2:Ns,sub2:Is,scale2:Ls}),Ts=[os,rs],Fs=function stringifyPoint(e){return e.join(",")},Bs=function pointsToPath(e){return"M"+e.map((function(e){return e.join(",")})).join("L")+"Z"},Vs=function setArrowheadOptions(e,t,n){"boolean"===_typeof(t)?e.options[n].visible=t:_typeof(t)===Hu?(Object.assign(e.options[n],t),null==t.visible&&(e.options[n].visible=!0)):null==t&&(e.options[n].visible=!0)},Gs=function setArrowStyle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.getElementsByClassName("".concat(ns,"-").concat(n))[0];Object.keys(t).map((function(e){return{key:e,fn:r[ws.toCamel(e)]}})).filter((function(e){return _typeof(e.fn)===Du})).forEach((function(e){return e.fn(t[e.key])}))},Ds=function redraw(e){var t=function makeArrowPaths(e){var t=[[0,1],[2,3]].map((function(t){return t.map((function(t){return e.points[t]||0}))})),n=Is(t[1],t[0]),r=Ns(t[0],Ls(n,.5)),o=Ps(n),i=Ts.map((function(t){return e[t].visible?(1+e[t].padding)*e[t].height*2.5:0})).reduce((function(e,t){return e+t}),0);if(o<i){var c=0===o?[i,0]:Ls(n,i/o);t=[Is,Ns].map((function(e){return e(r,Ls(c,.5))})),n=Is(t[1],t[0])}var a=[n[1],-n[0]],u=Ns(r,Ls(a,e.bend)),s=t.map((function(e){return Is(u,e)})),l=s.map((function(e){return Ps(e)})),_=s.map((function(e,t){return 0===l[t]?e:Ls(e,1/l[t])})),d=_.map((function(e){return Ls(e,-1)})),p=d.map((function(e){return[e[1],-e[0]]})),v=Ts.map((function(t,n){return e[t].padding?e[t].padding:e.padding?e.padding:0})),g=Ts.map((function(t,n){return e[t].height*(e[t].visible?1:0)})).map((function(e,t){return e+v[t]})),m=t.map((function(e,t){return Ns(e,Ls(_[t],g[t]))}));a=[(n=Is(m[1],m[0]))[1],-n[0]],r=Ns(m[0],Ls(n,.5)),u=Ns(r,Ls(a,e.bend));var h=m.map((function(t,n){return Ns(t,Ls(Is(u,t),e.pinch))})),b=Ts.map((function(t,n){return[Ns(m[n],Ls(d[n],e[t].height)),Ns(m[n],Ls(p[n],e[t].width/2)),Ns(m[n],Ls(p[n],-e[t].width/2))]}));return{line:"M".concat(Fs(m[0]),"C").concat(Fs(h[0]),",").concat(Fs(h[1]),",").concat(Fs(m[1])),tail:Bs(b[0]),head:Bs(b[1])}}(e.options);return Object.keys(t).map((function(t){return{path:t,element:e.getElementsByClassName("".concat(ns,"-").concat(t))[0]}})).filter((function(e){return e.element})).map((function(e){return e.element.setAttribute("d",t[e.path]),e})).filter((function(t){return e.options[t.path]})).forEach((function(t){return t.element.setAttribute("visibility",e.options[t.path].visible?"visible":"hidden")})),e},Rs=function setPoints$3(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.options.points=js.apply(void 0,_toConsumableArray(Cs.apply(void 0,n))).slice(0,4),Ds(e)},Us={setPoints:Rs,points:Rs,bend:function bend$1(e,t){return e.options.bend=t,Ds(e)},pinch:function pinch$1(e,t){return e.options.pinch=t,Ds(e)},padding:function padding(e,t){return e.options.padding=t,Ds(e)},head:function head(e,t){return Vs(e,t,rs),Gs(e,t,rs),Ds(e)},tail:function tail(e,t){return Vs(e,t,os),Gs(e,t,os),Ds(e)},getLine:function getLine(e){return e.getElementsByClassName("".concat(ns,"-line"))[0]},getHead:function getHead(e){return e.getElementsByClassName("".concat(ns,"-").concat(rs))[0]},getTail:function getTail(e){return e.getElementsByClassName("".concat(ns,"-").concat(os))[0]}},Zs=Object.keys({head:{visible:!1,width:8,height:10,padding:0},tail:{visible:!1,width:8,height:10,padding:0},bend:0,padding:0,pinch:.618,points:[]}),Hs=function matchingOptions(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)if(_typeof(t[r])===Hu)for(var o=Object.keys(t[r]),i=0;i<o.length;i++)if(Zs.includes(o[i]))return t[r]},Js={arrow:{nodeName:"g",attributes:[],args:function args(){return[]},methods:Us,init:function init(e){e.setAttribute(Gu,ns);var t=["line",os,rs].map((function(t){return SVG.path().setClass("".concat(ns,"-").concat(t)).appendTo(e)}));t[0].setAttribute(Xu,"fill:none;"),t[1].setAttribute(es,ts),t[2].setAttribute(es,ts),e.options={head:{visible:!1,width:8,height:10,padding:0},tail:{visible:!1,width:8,height:10,padding:0},bend:0,padding:0,pinch:.618,points:[]};for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];Us.setPoints.apply(Us,[e].concat(r));var i=Hs.apply(void 0,r);return i&&Object.keys(i).filter((function(e){return Us[e]})).forEach((function(t){return Us[t](e,i[t])})),e}}},$s=function makeCurvePath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=[e[0]||0,e[1]||0],o=[e[2]||0,e[3]||0],i=Is(o,r),c=Ns(r,Ls(i,.5)),a=[i[1],-i[0]],u=Ns(c,Ls(a,t)),s=Ns(r,Ls(Is(u,r),n)),l=Ns(o,Ls(Is(u,o),n));return"M".concat(r[0],",").concat(r[1],"C").concat(s[0],",").concat(s[1]," ").concat(l[0],",").concat(l[1]," ").concat(o[0],",").concat(o[1])},Ws=function getNumbersFromPathCommand(e){return e.slice(1).split(/[, ]+/).map((function(e){return parseFloat(e)}))},Xs=function getCurveEndpoints(e){var t=function getMoveTos(e){return e.match(/[Mm][(0-9), .-]+/).map((function(e){return Ws(e)}))}(e).shift(),n=function getCurveTos(e){return e.match(/[Cc][(0-9), .-]+/).map((function(e){return Ws(e)}))}(e).shift(),r=t?[t[t.length-2],t[t.length-1]]:[0,0],o=n?[n[n.length-2],n[n.length-1]]:[0,0];return[].concat(r,o)},Ys=function setPoints$2(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=js.apply(void 0,_toConsumableArray(Cs.apply(void 0,n))).slice(0,4);return e.setAttribute("d",$s(o,e._bend,e._pinch)),e},Ks={curve:{nodeName:$u,attributes:["d"],args:function curveArguments(){return[$s(js.apply(void 0,_toConsumableArray(Cs.apply(void 0,arguments))))]},methods:{setPoints:Ys,bend:function bend(e,t){return e._bend=t,Ys.apply(void 0,[e].concat(_toConsumableArray(Xs(e.getAttribute("d")))))},pinch:function pinch(e,t){return e._pinch=t,Ys.apply(void 0,[e].concat(_toConsumableArray(Xs(e.getAttribute("d")))))}}}},Qs={};Object.assign(Qs,vs,ms,bs,xs,ks,Js,Ks);var ef=Object.keys(Qs),tf=[ls.h,ls.p,ls.i],nf=[ls.g,ls.v,ls.t,ef],rf={svg:[ls.s,ls.d].concat(tf).concat(nf),g:nf,text:[ls.cT],linearGradient:[ls.cG],radialGradient:[ls.cG],defs:tf,filter:[ls.cF],marker:nf,symbol:nf,clipPath:nf,mask:nf},of=Object.create(null);Object.keys(rf).forEach((function(e){of[e]=rf[e].reduce((function(e,t){return e.concat(t)}),[])}));var cf=function viewBoxValue(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=1,c=n/i-n,a=e-c-o,u=t-c-o,s=n+2*c+2*o,l=r+2*c+2*o;return[a,u,s,l].join(" ")};function viewBox$1(){var e=js.apply(void 0,_toConsumableArray(Cs(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?cf.apply(void 0,_toConsumableArray(e)):void 0}var af=function cdata(e){return(new ss.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},uf=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},sf=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},ff=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),sf(e,t)},lf={removeChildren:uf,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(ws.toKebab(n),t[n])}))}},_f=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},df=function parse(e){return(new ss.DOMParser).parseFromString(e,"text/xml")},pf=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return _f(e.documentElement)},vf=function sync(e){if(_typeof(e)===Zu||e instanceof String)try{return pf(df(e))}catch(e){return e}if(null!=e.childNodes)return e},gf=function Load(e){return function isFilename(e){return _typeof(e)===Zu&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&is&&_typeof(ss.fetch)===Du?function async(e){return new Promise((function(t,n){if(_typeof(e)===Zu||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return pf(df(e))})).then((function(e){return e.nodeName===Ju?e:e.getElementsByTagName(Ju)[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof ss.Document)return asyncDone(e)}))}(e):vf(e)};var mf=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:Zu,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=ss.document.createElementNS(fs,Xu);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(ss.document.styleSheets)for(var t=0;t<ss.document.styleSheets.length;t+=1){var n=ss.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),o=0;o<r.length;o+=1){var i=r[o];"cssText"in i?e.push(i.cssText):e.push("".concat(i.selectorText," {\n").concat(i.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,o=!1,i=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[i]+n[l],o=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(o=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],o=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],o||(i-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=o?n[l]:u[i++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\//)>-1?c=c+=o?n[l]:u[--i]+n[l]:n[l].search(/\/>/)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[i]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new ss.XMLSerializer).serializeToString(e));return t.download&&is&&!cs&&function downloadInBrowser(e,t){var n=new ss.Blob([t],{type:"text/plain"}),r=ss.document.createElement("a");r.setAttribute("href",ss.URL.createObjectURL(n)),r.setAttribute("download",e),ss.document.body.appendChild(r),r.click(),ss.document.body.removeChild(r)}(t.filename,r),t.output===Ju?e:r},hf=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=1===n.length&&_typeof(n[0])===Zu?n[0]:viewBox$1.apply(void 0,n);return o&&e.setAttribute(Yu,o),e},yf=function getViewBox(e){var t=e.getAttribute(Yu);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},bf=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var o=r.matrixTransform(e.getScreenCTM().inverse());return[o.x,o.y]},Af=Object.freeze({__proto__:null,setViewBox:hf,getViewBox:yf,convertToViewBox:bf}),xf=function loadSVG(e,t){var n=gf(t);if(null!=n)return _typeof(n.then)===Du?n.then((function(t){return ff(e,t)})):ff(e,n)},kf=function getFrame(e){var t=yf(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===Du){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},wf="svg-background-rectangle",Ef=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(Xu);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(Xu),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(af(t)),n},Of={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),uf(e)},size:hf,setViewBox:hf,getViewBox:yf,padding:function setPadding(e,t){var n=yf(e);return void 0!==n&&hf.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(Gu)===wf})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(kf(e))))).setAttribute(Gu,wf),n.setAttribute(es,ts),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return kf(e)[2]},getHeight:function getHeight(e){return kf(e)[3]},stylesheet:function stylesheet(e,t){return Ef.call(this,e,t)},load:xf,save:mf},Cf={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},jf={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},Mf=Object.values(jf).reduce((function(e,t){return e.concat(t)}),[]),Pf=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},Sf=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return Pf(e,n,t[r])})),e.hasOwnProperty("press"))||Pf(e,"press",(n=Cf.math).vector.apply(n,_toConsumableArray(t)))},zf=function TouchEvents(e){var t=[],n=[];Object.keys(jf).forEach((function(e){jf[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){Sf(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),Sf(e,t)}};Object.keys(jf).forEach((function(t){var o="on"+ws.capitalized(t);Object.defineProperty(e,o,{set:function set(o){return null==o?function removeHandler(t){return jf[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):jf[t].forEach((function(i){var c=function handlerFunc(n){var i=null!=n.touches?n.touches[0]:n;if(void 0!==i){var c,a=bf(e,i.clientX,i.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return Pf(n,e,a[t])})),!n.hasOwnProperty("position"))Pf(n,"position",(c=Cf.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}o(n)};e.addEventListener&&(n[i].push(c),e.addEventListener(i,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return Mf.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},Nf=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},If=function Animation(e){var t,n,r={},o=0,i=function removeHandlers(){ss.cancelAnimationFrame&&ss.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,o=0};Object.defineProperty(e,"play",{set:function set(e){if(i(),null!=e){var c=Nf();r[c]=function handlerFunc(i){t||(t=i,o=0),e({time:.001*(i-t),frame:o}),o+=1,r[c]&&(n=ss.requestAnimationFrame(r[c]))},ss.requestAnimationFrame&&(n=ss.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:i,enumerable:!0})},Lf=[["cx","cy"],["x","y"]],qf=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),Lf.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},o=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),i=function setPosition(){js.apply(void 0,_toConsumableArray(Cs.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),_typeof(t.delegate)===Du&&t.delegate.apply(t.pointsContainer,[o,t.pointsContainer])};return t.delegate=void 0,t.setPosition=i,t.onMouseMove=function(e){return n.selected?i(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(Ss(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),[Ju,"updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),o},Tf=function controls(e,t,n){var r,o,i=Array.from(Array(t)).map((function(){return qf(e)})),c=function protocol(e){return _typeof(o)===Du?o.call(i,e,r,i):void 0};i.forEach((function(e){e.delegate=c,e.pointsContainer=i}));e.onPress=function mousePressedHandler(e){i.length>0&&(r=i.map((function(t,n){return{i:n,d:Ss(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,i[r].selected=!0)},e.onMove=function mouseMovedHandler(e){i.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){i.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(i,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(i,"selected",{get:function get(){return i[r]}}),Object.defineProperty(i,"add",{value:function value(t){i.push(qf(e))}}),i.removeAll=function(){for(;i.length>0;)i.pop().remove()};var a={onChange:function onChange(e,t){if(o=e,!0===t){var n=i.length-1;e.call(i,i[n],n,i)}},position:function position(e){return i.forEach((function(t,n){return t.setPosition(e.call(i,t,n,i))}))},svg:function svg(e){return i.forEach((function(t,n){t.svg=e.call(i,t,n,i)}))}};return Object.keys(a).forEach((function(e){i[e]=function(){return _typeof(arguments[0])===Du&&a[e].apply(a,arguments),i}})),i.parent=function(e){return null!=e&&null!=e.appendChild&&i.forEach((function(t){e.appendChild(t.svg)})),i},i},Ff=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tf.call.apply(Tf,[e,e].concat(n))}},Bf=(new ss.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,Vf={svg:{args:function args(){return[viewBox$1(js.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:Of,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Zu})).forEach((function(t){return xf(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof Bf})).filter((function(e){return _typeof(e.appendChild)===Du})).forEach((function(t){return t.appendChild(e)})),zf(e),If(e),Ff(e)}}},Gf=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n.map((function(e){return vf(e)})).filter((function(e){return void 0!==e}));return o.filter((function(e){return e.tagName===Ju})).forEach((function(t){return sf(e,t)})),o.filter((function(e){return e.tagName!==Ju})).forEach((function(t){return e.appendChild(t)})),e},Df={g:{init:Gf,methods:{load:Gf}}},Rf=Object.assign(Object.create(null),{svg:[Yu],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:[Qu],polyline:[Qu],path:["d"],text:["x","y"],mask:[Wu],symbol:[Wu],clipPath:[Wu,"clip-rule"],marker:[Wu,"markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),Uf=function setRadius(e,t){return e.setAttribute(Rf.circle[2],t),e},Zf=function setOrigin(e,t,n){return _toConsumableArray(js.apply(void 0,_toConsumableArray(Cs(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Rf.circle[n],t)})),e},Hf=function fromPoints(e,t,n,r){return[e,t,zs([e,t],[n,r])]},Jf={circle:{args:function args(e,t,n,r){var o=js.apply(void 0,_toConsumableArray(Cs(e,t,n,r)));switch(o.length){case 0:case 1:return[,,].concat(_toConsumableArray(o));case 2:case 3:return o;default:return Hf.apply(void 0,_toConsumableArray(o))}},methods:{radius:Uf,setRadius:Uf,origin:Zf,setOrigin:Zf,center:Zf,setCenter:Zf,position:Zf,setPosition:Zf}}},$f=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Rf.ellipse[n],t)})),e},Wf=function setCenter(e,t,n){return _toConsumableArray(js.apply(void 0,_toConsumableArray(Cs(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Rf.ellipse[n],t)})),e},Xf={ellipse:{args:function args(e,t,n,r){var o=js.apply(void 0,_toConsumableArray(Cs(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(o));default:return o}},methods:{radius:$f,setRadius:$f,origin:Wf,setOrigin:Wf,center:Wf,setCenter:Wf,position:Wf,setPosition:Wf}}},Yf=function Args$1(){return js.apply(void 0,_toConsumableArray(Os.apply(void 0,arguments))).slice(0,4)},Kf={line:{args:Yf,methods:{setPoints:function setPoints$1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Yf.apply(void 0,n).forEach((function(t,n){return e.setAttribute(Rf.line[n],t)})),e}}}},Qf=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,el=/-?[0-9]*\.?\d+/g,tl={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(tl).forEach((function(e){var t=tl[e];tl[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var nl=function getD(e){var t=e.getAttribute("d");return null==t?"":t},rl=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.setAttribute("d","".concat(nl(e)).concat(t).concat(Cs.apply(void 0,r).join(" "))),e},ol=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=Qf.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(el);return e.en=tl[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(nl(e))},il={addCommand:rl,appendCommand:rl,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:ol,get:ol,getD:function getD(e){return e.getAttribute("d")}};Object.keys(tl).forEach((function(e){il[tl[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return rl.apply(void 0,[t,e].concat(r))}}));var cl={path:{methods:il}},al=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Rf.rect[n],t)})),e},ul=function setRectOrigin(e,t,n){return _toConsumableArray(js.apply(void 0,_toConsumableArray(Cs(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Rf.rect[n],t)})),e},sl=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},fl={rect:{args:function args(e,t,n,r){var o=js.apply(void 0,_toConsumableArray(Cs(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:case 3:return sl([,,].concat(_toConsumableArray(o)));default:return sl(o)}},methods:{origin:ul,setOrigin:ul,center:ul,setCenter:ul,size:al,setSize:al}}},ll={style:{init:function init(e,t){e.textContent="",e.appendChild(af(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(af(t)),e}}}},_l={text:{args:function args(e,t,n){return js.apply(void 0,_toConsumableArray(Cs(e,t,n))).slice(0,2)},init:function init(e,t,n,r,o){var i=[t,n,r,o].filter((function(e){return _typeof(e)===Zu})).shift();i&&e.appendChild(ss.document.createTextNode(i))}}},dl=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===Zu||e instanceof String})).shift()||Nf()},pl=function args(){return[dl.apply(void 0,arguments)]},vl={mask:{args:pl},clipPath:{args:pl},symbol:{args:pl},marker:{args:pl,methods:{size:hf,setViewBox:hf}}},gl=function getPoints(e){var t=e.getAttribute(Qu);return null==t?"":t},ml=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},hl=function stringifyArgs(){return[ml.apply(void 0,_toConsumableArray(js.apply(void 0,_toConsumableArray(Os.apply(void 0,arguments)))))]},yl=function setPoints(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute(Qu,hl.apply(void 0,n)[0]),e},bl=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute(Qu,[gl(e),hl.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},Al=function Args(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===Zu?[arguments.length<=0?void 0:arguments[0]]:hl.apply(void 0,arguments)},xl={polyline:{args:Al,methods:{setPoints:yl,addPoint:bl}},polygon:{args:Al,methods:{setPoints:yl,addPoint:bl}}},kl=Object.assign({},Vf,Df,Jf,Xf,Kf,cl,fl,ll,_l,vl,xl),wl={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(ls).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===Rf[e]})).forEach((function(e){Rf[e]=[]})),[[[Ju,"defs","g"].concat(ls.v,ls.t),wl.presentation],[["filter"],wl.effects],[ls.cT.concat("text"),wl.text],[ls.cF,wl.effects],[ls.cG,wl.gradient]].forEach((function(e){return e[0].forEach((function(t){Rf[t]=Rf[t].concat(e[1])}))}));var El=function getClassList(e){if(null==e)return[];var t=e.getAttribute(Gu);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},Ol={addClass:function addClass(e,t){var n=El(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,Gu,n.join(" "))},removeClass:function removeClass(e,t){var n=El(e).filter((function(e){return e!==t}));e.setAttributeNS(null,Gu,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,Gu,t)},setId:function setId(e,t){e.setAttributeNS(null,Wu,t)}},Cl=function getAttr(e){var t=e.getAttribute(Ku);return null==t||""===t?void 0:t},jl={clearTransform:function clearTransform(e){return e.removeAttribute(Ku),e}};["translate","rotate","scale","matrix"].forEach((function(e){jl[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.setAttribute(Ku,[Cl(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var Ml={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){Ml[ws.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===Zu)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(Wu);return"url(#".concat(t,")")}return""}(n))}}));var Pl={};(Nu=ls.v).push.apply(Nu,_toConsumableArray(Object.keys(Qs))),Object.keys(Qs).forEach((function(e){Qs[e].attributes=void 0===Qs[e].attributes?_toConsumableArray(wl.presentation):Qs[e].attributes.concat(wl.presentation)})),Object.assign(Pl,kl,Qs),Object.keys(ls).forEach((function(e){return ls[e].filter((function(e){return void 0===Pl[e]})).forEach((function(e){Pl[e]={}}))}));var Sl=function passthrough(){return Array.from(arguments)};Object.keys(Pl).forEach((function(e){Pl[e].nodeName||(Pl[e].nodeName=e),Pl[e].init||(Pl[e].init=Sl),Pl[e].args||(Pl[e].args=Sl),Pl[e].methods||(Pl[e].methods={}),Pl[e].attributes||(Pl[e].attributes=Rf[e]||[])}));var zl=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){Pl[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};zl(Cs(ls.t,ls.v,ls.g,ls.s,ls.p,ls.i,ls.h,ls.d),Ol),zl(Cs(ls.t,ls.v,ls.g,ls.s,ls.p,ls.i,ls.h,ls.d),lf),zl(Cs(ls.v,ls.g,ls.s),jl),zl(Cs(ls.t,ls.v,ls.g),Ml);var Nl={svg:{version:"1.1",xmlns:fs},style:{type:"text/css"}},Il=function RequiredAttributes(e,t){Nl[t]&&Object.keys(Nl[t]).forEach((function(n){return e.setAttribute(n,Nl[t][n])}))},Ll={},ql=function constructor(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=ss.document.createElementNS(fs,Pl[e].nodeName);return Il(c,e),(t=Pl[e]).init.apply(t,[c].concat(o)),(n=Pl[e]).args.apply(n,o).forEach((function(t,n){null!=Pl[e].attributes[n]&&c.setAttribute(Pl[e].attributes[n],t)})),Pl[e].attributes.forEach((function(e){Object.defineProperty(c,ws.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(Pl[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=Pl[e].methods[t]).call.apply(n,[Ll,c].concat(Array.prototype.slice.call(arguments)))}})})),of[e]&&of[e].forEach((function(e){var t=function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t};Pl[e].static&&Object.keys(Pl[e].static).forEach((function(n){t[n]=function(){var t;return(t=Pl[e].static)[n].apply(t,[c].concat(Array.prototype.slice.call(arguments)))}})),Object.defineProperty(c,e,{value:t})})),c};Ll.Constructor=ql;var Tl={};Object.keys(ls).forEach((function(e){return ls[e].forEach((function(e){Tl[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ql.apply(void 0,[e].concat(n))}}))}));var Fl=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Du})).forEach((function(t){return t.call(e,e)}))};Vu.init=function(){var e=arguments,t=ql.apply(void 0,[Ju].concat(Array.prototype.slice.call(arguments)));return"loading"===ss.document.readyState?ss.document.addEventListener("DOMContentLoaded",(function(){return Fl.apply(void 0,[t].concat(_toConsumableArray(e)))})):Fl.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t},SVG.NS=fs,SVG.linker=function Linker(e){e.graph&&e.origami&&(e.svg=this,function link_rabbitear_math(e,t){["segment","circle","ellipse","rect","polygon"].filter((function(e){return t[e]&&t[e].prototype})).forEach((function(n){t[n].prototype.svg=function(){return e.path(this.svgPath())}})),Cf.math.vector=t.vector}(this,e),function link_rabbitear_graph(e,t){var n="origami";Pl[n]={nodeName:"svg",init:function init(e){for(var n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return(n=t.graph.svg).drawInto.apply(n,[e].concat(o))},args:function args(){return[]},methods:Pl.svg.methods,attributes:Pl.svg.attributes,static:{}},Object.keys(t.graph.svg).forEach((function(e){Pl[n].static[e]=function(n){for(var r,o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];var a=(r=t.graph.svg)[e].apply(r,i);return n.appendChild(a),a}})),of[n]=_toConsumableArray(of.svg),of.svg.push(n),of.g.push(n),e[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ql.apply(void 0,[n].concat(t))},Object.keys(t.graph.svg).forEach((function(r){e[n][r]=t.graph.svg[r]}))}(this,e))}.bind(SVG),Object.assign(SVG,Tl),SVG.core=Object.assign(Object.create(null),{load:gf,save:mf,coordinates:js,flatten:Cs,attributes:Rf,children:of,cdata:af,detect:us},ws,Ol,lf,qs,jl,Af);var Bl=("undefined"==typeof window?"undefined":_typeof(window))!==In&&_typeof(window.document)!==In,Vl=("undefined"==typeof process?"undefined":_typeof(process))!==In&&null!=process.versions&&null!=process.versions.node;("undefined"==typeof self?"undefined":_typeof(self))===Tn&&self.constructor&&self.constructor.name;var Gl=function(){var e={};if(Vl){var t=require("@xmldom/xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Bl&&(e=window);return e}(),Dl=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(jn.core.mag_squared(t)<jn.core.EPSILON)return[];for(var o=jn.core.normalize(t),i=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return jn.core.cross3(e,o)})).sort((function(e,t){return jn.core.magnitude(t)-jn.core.magnitude(e)})).shift(),c=[jn.core.normalize(i)],a=1;a<4;a+=1)c.push(jn.core.cross3(c[a-1],o));var u=c.map((function(e){return jn.core.scale(e,n)})),s=[-r,r].map((function(e){return jn.core.scale(o,e)})),l=0===r?e:e.map((function(e,t){return jn.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return jn.core.add(e,t)}))})).reduce(Er,[])},Rl=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=Gl.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(Er,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(Er,[]),o=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(Er,[]),i=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(Er,[]).reduce(Er,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(o,3)),c.setIndex(i),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,o=e.edges_coords,i=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=Gl.THREE;o||(o=n.map((function(e){return e.map((function(e){return t[e]}))}))),i||(i=o.map((function(e){return jn.core.subtract(e[1],e[0])}))),o=o.map((function(e){return e.map((function(e){return jn.core.resize(3,e)}))})),i=i.map((function(e){return jn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(Er,[]).reduce(Er,[]).reduce(Er,[]),_=o.map((function(e,t){return Dl(e,i[t],c,a)})).reduce(Er,[]).reduce(Er,[]),d=i.map((function(e){if(jn.core.mag_squared(e)<jn.core.EPSILON)throw"degenerate edge";var t=jn.core.normalize(e);jn.core.scale(t,c);var n=jn.core.scale(jn.core.normalize(jn.core.cross3(e,[0,0,-1])),c),r=jn.core.scale(jn.core.normalize(jn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(Er,[]).reduce(Er,[]),p=o.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(Er,[]),v=new u.BufferGeometry;return v.setAttribute("position",new u.Float32BufferAttribute(_,3)),v.setAttribute("normal",new u.Float32BufferAttribute(d,3)),v.setAttribute("color",new u.Float32BufferAttribute(l,3)),v.setIndex(p),v.computeVertexNormals(),v}}),Ul=Object.assign(e,Lc,{math:jn.core,axiom:ea,diagram:ua,layer:eu,vertex:su,text:fu,webgl:Rl});return Object.keys(jn).filter((function(e){return"core"!==e})).forEach((function(e){Ul[e]=jn[e]})),Object.defineProperty(Ul,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(Ul)}),Ul.use(Bu),Ul.use(SVG),Ul}));
